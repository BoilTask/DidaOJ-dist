import{bm as De,bn as jt,bo as B,s as a,bp as o,bq as P,br as D,ap as k,n as ee,r as c,bs as oe,bt as M,aD as de,g as xt,o as te,bu as H,bv as Vt,bw as $t,bx as at,F as Q,by as se,bz as le,aM as Rt,bA as Ge,bB as Ke,q as he,y as Ee,J as Se,bC as nt,c as be,a0 as zt,bD as Ae,u as We,bE as Re,ac as Dt,bF as Et,bG as At,bH as Mt,bI as Ht,B as qt,bJ as Ut}from"./node_modules-DPCfXZqM.js";import{R as _e,C as ge,a as re,B as q,F as Le,b as Ie,I as we,L as Ft,M as ot,c as lt,S as Ot,H as Nt,d as Gt,e as Kt,f as me,g as Bt,h as Xt,A as Wt,i as Jt,j as Yt,T as ke,k as ce,D as Me,l as He,m as st,O as rt,n as ut,P as Zt,o as it,p as ct,q as Qt,r as ea,s as ta,t as aa,u as na,v as oa}from"./tdesign-vue-next-DlSqpfBf.js";import{V as ne}from"./vditor-DArazWIS.js";import{e as Ze}from"./monaco-editor-DCUKHC_e.js";import{H as la,v as sa}from"./highlight.js-D9zWiMxS.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const C of r.addedNodes)C.tagName==="LINK"&&C.rel==="modulepreload"&&s(C)}).observe(document,{childList:!0,subtree:!0});function n(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerPolicy&&(r.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?r.credentials="include":l.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(l){if(l.ep)return;l.ep=!0;const r=n(l);fetch(l.href,r)}})();var ye=(e=>(e.Manage="i-manage",e.ManageJudge="i-manage-judge",e.ManageProblem="i-manage-problem",e))(ye||{});const ra={"r-admin":["i-manage","i-manage-judge","i-manage-problem"]};function ua(e){if(e==null)return[];const t=[];for(const n of e){const s=ra[n];s!=null&&t.push(...s)}return[...new Set(t)]}function ia(e,t){if(e==null||t==null)return!1;const n=ua(e);for(const s of t)if(!n.includes(s))return!1;return!0}const pe=De("user",{state:()=>({token:"",userId:-1,username:"",nickname:"",roles:[]}),getters:{getToken(){return this.token},getUserId(){return this.userId},getUsername(){return this.username},getNickname(){return this.nickname}},actions:{clear(){this.$patch({token:"",userId:-1,username:"",nickname:"",roles:[]})},loadResponse(e){this.$patch({token:e.token,userId:e.user_id,username:e.username,nickname:e.nickname,roles:e.roles})},isLogin(){return this.token!=null&&this.token!=""},hasAuth(e){return this.hasAllAuths([e])},hasAllAuths(e){return e?ia(this.roles,e):!0}},persist:!0}),ca="https://oj-api.didapipa.com/",J=jt.create({baseURL:ca,timeout:6e4,withCredentials:!0,headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});J.interceptors.request.use(e=>{const n=pe().getToken;return n&&(e.headers["X-Token"]=n),e},e=>Promise.reject(e));J.interceptors.response.use(function(e){return e.data},function(e){return Promise.reject(e)});function da(e,t){return J({url:"/user/login",method:"post",data:{username:e,password:t}})}function ma(){return J({url:"/user/login/refresh",method:"post"})}const dt=De("login",{state:()=>({Loaded:!1}),getters:{isLoaded(){return this.Loaded}}}),Te=De("webStyle",{state:()=>({title:""}),getters:{getTitle(){return this.title}},actions:{setTitle(e){this.title=e}}}),qe=De("sidebarStyle",{state:()=>({showSidebar:!1,forceHiddenSidebar:!1,menuActiveName:"",menuList:[]}),getters:{getMenuList(){return this.menuList}},actions:{setSidebarShow(e){this.showSidebar=e},setForceHiddenSidebar(e){this.forceHiddenSidebar=e},setMenuActiveName(e){this.menuActiveName=e},clearMenuList(){this.menuList=[]},setMenuList(e){this.menuList=e},addMenuList(e){this.menuList.push(e)}}}),Y=(e,t)=>{const n=e.__vccOpts||e;for(const[s,l]of t)n[s]=l;return n},pa={},fa={class:"sh-main"};function _a(e,t){const n=re,s=ge,l=_e;return P(),B("div",fa,[a(l,null,{default:o(()=>[a(s,{span:6},{default:o(()=>[a(n,{title:"正在完善，欢迎提供意见建议"},{default:o(()=>t[0]||(t[0]=[D("p",null,[D("a",{href:"https://codeoj.cn/",target:"_blank"},"CodeOJ"),k("的迁移计划")],-1),D("p",null,"正在开发中",-1)])),_:1})]),_:1})]),_:1})])}const ga=Y(pa,[["render",_a],["__scopeId","data-v-13691e65"]]),va={class:"sh-main"},ha=ee({__name:"View404",setup(e){let t=oe(),n=c(t.fullPath);return(s,l)=>{const r=q;return P(),B("div",va,[D("p",null,M(de(n)),1),l[2]||(l[2]=D("p",null,"该页面无效或已被迁移，请重新选择访问目标",-1)),a(r,{theme:"primary",onClick:l[0]||(l[0]=()=>s.$router.push("/"))},{default:o(()=>l[1]||(l[1]=[k("返回首页")])),_:1})])}}}),mt=Y(ha,[["__scopeId","data-v-d4218944"]]);let Be=null;async function ba(){Be=await wa()}function ya(e,t="zh"){if(Be==null)return[!1,e.toString()];const n=Be[e.toString()];if(!n)return[!1,e.toString()];let s=n[t];return s||(t="zh",s=n[t]),s?[!0,s]:[!1,e.toString()]}async function wa(){return new Promise((e,t)=>{e({404:{zh:"接口未找到"},1e3:{zh:"系统错误"},10001:{zh:"权限异常，请重新登陆后再试"},10002:{zh:"参数不符合要求"},10003:{zh:"未找到目标数据"},100001:{zh:"用户名不存在或密码不匹配"}})})}function ae(){const{appContext:e}=xt();return{globalProperties:e.config.globalProperties}}function Ce(){return 1e3}function pt(e,t,n=3e3){e.$message.success({duration:n,content:t})}function ie(e,t,n=3e3){e.$message.info({duration:n,content:t})}function ue(e,t,n=3e3){e.$message.error({duration:n,content:t})}function N(e,t,n=3e3){const[s,l]=ya(t),r=s?l:`系统错误，错误提示[${l}]`;e.$message.error({duration:n,content:r})}const ka={class:"dida-login-footer"},Ca=ee({__name:"LoginView",setup(e){const{globalProperties:t}=ae(),n=pe(),s=c(!1),l=c({account:"",password:""}),r=()=>{ie(t,"重置成功")},C=({validateResult:j,firstError:b})=>{s.value||da(l.value.account,l.value.password).then(u=>{if(u.code===0){n.loadResponse(u.data),ie(t,"登录成功");let v=t.$route.query.redirect_uri;v||(v="/user/"+u.data.username),t.$router.push({path:v})}else N(t,u.code)}).catch(u=>{console.error("Login error",u),ue(t,"登录失败")})};return te(()=>{if(n.isLogin()){t.$router.push({path:"/user"});return}}),(j,b)=>{const u=we,v=Ie,d=q,L=Le,S=Ft,z=re;return P(),H(z,{class:"yj-login-card",title:"欢迎使用DidaOJ~"},{default:o(()=>[a(L,{ref:"form",data:l.value,colon:!0,onReset:r,onSubmit:C,class:"yj-login-form","label-width":0},{default:o(()=>[a(v,{name:"account"},{default:o(()=>[a(u,{modelValue:l.value.account,"onUpdate:modelValue":b[0]||(b[0]=x=>l.value.account=x),clearable:"",placeholder:"请输入账户名"},{"prefix-icon":o(()=>[a(de(Vt))]),_:1},8,["modelValue"])]),_:1}),a(v,{name:"password"},{default:o(()=>[a(u,{modelValue:l.value.password,"onUpdate:modelValue":b[1]||(b[1]=x=>l.value.password=x),type:"password",clearable:"",placeholder:"请输入密码"},{"prefix-icon":o(()=>[a(de($t))]),_:1},8,["modelValue"])]),_:1}),a(v,null,{default:o(()=>[a(d,{theme:"primary",type:"submit",block:"",loading:s.value},{default:o(()=>b[2]||(b[2]=[k("登录")])),_:1},8,["loading"])]),_:1})]),_:1},8,["data"]),D("div",ka,[a(S,null,{default:o(()=>b[3]||(b[3]=[k("忘记密码")])),_:1}),a(S,null,{default:o(()=>b[4]||(b[4]=[k("注册账户")])),_:1})])]),_:1})}}}),Sa=Y(Ca,[["__scopeId","data-v-b3cb57db"]]),La={};function Ia(e,t){return" TODO "}const Ta=Y(La,[["render",Ia]]),Je=[{name:"home",path:"/",title:"首页",showSidebar:!1,disableGenerateTab:!0,component:ga},{name:"problem",path:"/problem",title:"题目",icon:"dashboard",showSidebar:!0,redirect:"problem-list"},{name:"judge",path:"/judge",title:"评测",icon:"dashboard",showSidebar:!0,redirect:"judge-list"},{name:"contest",path:"/contest",title:"比赛",icon:"dashboard",showSidebar:!0,redirect:"contest-list"},{name:"contest-detail",title:"比赛",path:"/contest",showSidebar:!0,disableGenerateTab:!0,redirect:"contest-list"},{name:"manage",path:"/manage",title:"管理",icon:"dashboard",showSidebar:!0,redirect:"manage-judge",auths:[ye.Manage]},{name:"login",path:"/login",title:"登陆",showSidebar:!1,disableGenerateTab:!0,component:Sa},{name:"user",path:"/user/:username+",title:"用户",showSidebar:!1,needLogin:!0,disableGenerateTab:!0,component:Ta},{name:"404",path:"/404",title:"404",showSidebar:!1,disableGenerateTab:!0,component:mt}],Pa=e=>Je.find(t=>t.name==e),ja=e=>{const t=[];return Je.forEach(n=>{!n.disableGenerateTab&&e.hasAllAuths(n.auths)&&t.push(n)}),t},xa=e=>{Je.forEach(t=>{const n={name:t.name,path:t.path,meta:{title:t.title,tab:t.name,showSidebar:t.showSidebar,needLogin:t.needLogin,redirect:t.redirect,tabAuths:t.auths},component:t.component};e.push(n)})},Va=ee({__name:"HeaderContent",setup(e){const t=dt(),n=pe(),{globalProperties:s}=ae(),l=c(t.isLoaded),r=c(!1),C=c(n.getUsername),j=c(n.getNickname),b=c(),u=()=>{b.value=ja(n)};t.$subscribe((L,S)=>{l.value=S.Loaded}),n.$subscribe((L,S)=>{C.value=S.username,j.value=S.nickname,r.value=S.token!="",u()});const v=()=>{s.$router.currentRoute.value.name!=="login"&&s.$router.push({name:"login",query:{redirect_uri:s.$router.currentRoute.value.fullPath}})},d=()=>{n.clear(),s.$message.success({duration:3e3,content:"注销成功"}),s.$router.push({path:"/login",query:{redirect_uri:s.$router.currentRoute.value.fullPath}})};return te(()=>{u()}),(L,S)=>{const z=at("router-link"),x=lt,R=ot,V=Ot,U=Nt;return P(),H(U,{modelValue:L.$route.meta.tab,"onUpdate:modelValue":S[0]||(S[0]=y=>L.$route.meta.tab=y),class:"sh-menu","expand-type":"popup"},{logo:o(()=>[a(z,{to:"/",class:"sh-logo"},{default:o(()=>S[1]||(S[1]=[k("DidaOJ")])),_:1})]),operations:o(()=>[l.value&&r.value?(P(),H(V,{key:0,title:j.value},{icon:o(()=>[a(x,{name:"user"})]),default:o(()=>[a(R,{value:"user",to:{path:"/user/"+C.value}},{default:o(()=>S[2]||(S[2]=[k("个人空间")])),_:1},8,["to"]),a(R,{value:"user_logout",onClick:d},{default:o(()=>S[3]||(S[3]=[k(" 注销")])),_:1})]),_:1},8,["title"])):l.value?(P(),H(R,{key:2,value:"login",onClick:v},{icon:o(()=>[a(x,{name:"login"})]),default:o(()=>[S[5]||(S[5]=k(" 登录 "))]),_:1})):(P(),H(R,{key:1,value:"login"},{icon:o(()=>[a(x,{name:"login"})]),default:o(()=>[S[4]||(S[4]=k(" ... "))]),_:1}))]),default:o(()=>[(P(!0),B(Q,null,se(b.value,y=>(P(),H(R,{key:y.name,value:y.name,to:{name:y.name}},{icon:o(()=>[y.icon?(P(),H(x,{key:0,name:y.icon},null,8,["name"])):le("",!0)]),default:o(()=>[k(" "+M(y.title),1)]),_:2},1032,["value","to"]))),128))]),_:1},8,["modelValue"])}}}),$a=Y(Va,[["__scopeId","data-v-9fdb245f"]]);function ft(e){return e.children!==void 0}function Ra(e){return e.children!==void 0}const za={id:"menu-container"},Da=ee({__name:"SidebarContent",setup(e){const t=qe(),n=c(!1),s=c(null),l=c(t.menuActiveName),r=c(t.menuList),C=c([]),j=c(!1),b=()=>{l.value=t.menuActiveName;const v=JSON.stringify(r.value),d=JSON.stringify(t.menuList);v!==d&&(C.value.push([...t.menuList]),u())},u=async()=>{if(C.value.length>0&&!j.value){for(j.value=!0;C.value.length>1;)C.value.shift();const v=C.value.shift();n.value=v.length<=0,r.value=[],await he(),s.value&&s.value.updateActiveName(),await new Promise(L=>setTimeout(L,300)),r.value=v,await he(),s.value&&s.value.updateActiveName();const d=300;await new Promise(L=>setTimeout(L,d)),j.value=!1,await u()}};return t.$subscribe((v,d)=>{b()}),te(()=>{b()}),(v,d)=>{const L=lt,S=ot,z=Kt,x=Gt,R=me;return P(),B(Q,null,[D("div",za,[a(x,{modelValue:l.value,"onUpdate:modelValue":d[0]||(d[0]=V=>l.value=V),theme:"light",class:"sh-menu-container"},{default:o(()=>[a(Rt,{name:"move-left"},{default:o(()=>[(P(!0),B(Q,null,se(r.value,(V,U)=>(P(),B(Q,{key:U},[de(Ra)(V)?(P(),H(z,{key:0,title:V.title},{default:o(()=>[(P(!0),B(Q,null,se(V.children,(y,I)=>(P(),H(S,{key:y.name,value:y.name,to:y.to},Ge({default:o(()=>[k(" "+M(y.title),1)]),_:2},[y.icon?{name:"icon",fn:o(()=>[a(L,{name:y.icon,class:Ke(y.iconClass)},null,8,["name","class"])]),key:"0"}:void 0]),1032,["value","to"]))),128))]),_:2},1032,["title"])):(P(),H(S,{key:V.name,value:V.name,to:V.to},Ge({default:o(()=>[k(" "+M(V.title),1)]),_:2},[V.icon?{name:"icon",fn:o(()=>[a(L,{name:V.icon,class:Ke(V.iconClass)},null,8,["name","class"])]),key:"0"}:void 0]),1032,["value","to"]))],64))),128))]),_:1})]),_:1},8,["modelValue"])]),a(R,{size:"small",loading:n.value,"show-overlay":!0,attach:"#menu-container",class:"sh-sidebar-loading",style:{"align-items":"flex-start","padding-top":"100px"}},null,8,["loading"])],64)}}}),Ea=Y(Da,[["__scopeId","data-v-96e2d89f"]]),Aa={};function Ma(e,t){return null}const Ha=Y(Aa,[["render",Ma]]),qa={class:"footer"},Ua={class:"footer-left"},Fa={class:"foot-time"},Oa={class:"footer-center"},Na={href:"https://boiltask.com",target:"_blank"},Ga={class:"footer-right"},Ka={class:"foot-text"},Ba={href:"https://github.com/hpu-user/DiDaOJ-web",target:"_blank"},Xa=ee({__name:"FooterContent",setup(e){const t=c("");function n(){t.value=new Date().toLocaleString()}return te(()=>{n(),setInterval(()=>{n()},1e3)}),(s,l)=>{const r=q;return P(),B("div",qa,[D("div",Ua,[D("p",Fa,M(t.value),1)]),D("div",Oa,[D("a",Na,[a(r,{theme:"default",variant:"outline",ghost:!0},{default:o(()=>l[0]||(l[0]=[k("@BoilTask")])),_:1})])]),D("div",Ga,[D("p",Ka,[D("a",Ba,[a(r,{theme:"default",variant:"outline",ghost:!0},{default:o(()=>l[1]||(l[1]=[k("@didaoj-web")])),_:1})])])])])}}}),Wa=Y(Xa,[["__scopeId","data-v-400ac98b"]]),Ve=20,Oe=100,Ne=50,Ja=ee({__name:"ForceHiddenSidebarButton",setup(e){let t=qe();const n=c({x:window.innerWidth-Oe-Ve,y:window.innerHeight-Ne-Ve}),s=c(window.innerWidth),l=c(window.innerHeight);let r=!1,C={x:0,y:0};const j=V=>{r=!0;const U=V.clientX??V.touches[0].clientX,y=V.clientY??V.touches[0].clientY;C={x:U-n.value.x,y:y-n.value.y},document.addEventListener("mousemove",b),document.addEventListener("touchmove",b),document.addEventListener("mouseup",u),document.addEventListener("touchend",u)},b=V=>{if(!r)return;const U=V.clientX??V.touches[0].clientX,y=V.clientY??V.touches[0].clientY;let I=U-C.x,$=y-C.y;I=Math.max(0,Math.min(I,s.value-Oe)),$=Math.max(0,Math.min($,l.value-Ne)),n.value={x:I,y:$}},u=()=>{r=!1,document.removeEventListener("mousemove",b),document.removeEventListener("touchmove",b),document.removeEventListener("mouseup",u),document.removeEventListener("touchend",u)},v=()=>{s.value=window.innerWidth,l.value=window.innerHeight,n.value={x:Math.min(n.value.x,s.value-Oe-Ve),y:Math.min(n.value.y,l.value-Ne-Ve)}};let d=c(t.forceHiddenSidebar),L=c(t.forceHiddenSidebar);const S=()=>{d.value=!d.value,t.setForceHiddenSidebar(d.value)},z=()=>{L.value||(L.value=!0,t.setForceHiddenSidebar(d.value))},x=()=>{L.value&&(L.value=!1,t.setForceHiddenSidebar(!1))},R=V=>{V>=800?x():z()};return R(s.value),Ee(s,V=>{R(V)}),te(()=>{window.addEventListener("resize",v)}),Se(()=>{window.removeEventListener("resize",v)}),(V,U)=>{const y=q;return de(L)?(P(),H(y,{key:0,class:"draggable-button",style:nt({top:`${n.value.y}px`,left:`${n.value.x}px`}),onMousedown:j,onTouchstart:j,variant:"dashed",theme:"primary",onClick:S},{default:o(()=>[k(M(de(d)?"显示":"隐藏"),1)]),_:1},8,["style"])):le("",!0)}}}),Ya=Y(Ja,[["__scopeId","data-v-1aee5506"]]),Za={class:"sh-main"},Qa=ee({__name:"View403",setup(e){let t=oe();const n=c("");return te(()=>{t.query.target?n.value=t.query.target:n.value=t.fullPath}),(s,l)=>{const r=q;return P(),B("div",Za,[D("p",null,M(n.value),1),l[2]||(l[2]=D("p",null,"该页面无访问权限，请更换访问目标或重新登陆后再试",-1)),a(r,{theme:"primary",onClick:l[0]||(l[0]=()=>s.$router.push("/"))},{default:o(()=>l[1]||(l[1]=[k("返回首页")])),_:1})])}}}),_t=Y(Qa,[["__scopeId","data-v-777362b3"]]),$e="DidaOJ",en=ee({__name:"App",setup(e){const{globalProperties:t}=ae(),n=dt(),s=pe(),l=Te(),r=qe();n.$patch({Loaded:!1});const C=s.getToken,j=c(!1),b=c(!1);l.title&&l.title.length>0?document.title=l.title+" - "+$e:document.title=$e,l.$subscribe((L,S)=>{S.title&&S.title.length>0?document.title=S.title+" - "+$e:document.title=$e}),r.$subscribe((L,S)=>{j.value=S.showSidebar,b.value=j.value&&!S.forceHiddenSidebar});const u=oe(),v=be(()=>{const L=u.meta.auths;return L?!s.hasAllAuths(L):!1});function d(){t.$message.warning({duration:3e3,content:"登陆状态失效"}),n.$patch({Loaded:!0}),s.clear()}return te(()=>{if(C==""){n.$patch({Loaded:!0});return}ma().then(L=>{L.code==0?(s.loadResponse(L.data),n.$patch({Loaded:!0})):(N(t,L.code),n.$patch({Loaded:!0}),s.clear())}).catch(L=>{console.log(L),d()})}),(L,S)=>{const z=Bt,x=Wt,R=at("RouterView"),V=Jt,U=Xt,y=Yt;return P(),B(Q,null,[a(U,null,{default:o(()=>[a(z,{class:"sh-header"},{default:o(()=>[a($a)]),_:1}),a(U,null,{default:o(()=>[a(zt,{name:"slide"},{default:o(()=>[b.value?(P(),H(x,{key:0,class:"sh-sidebar"},{default:o(()=>[a(Ea)]),_:1})):le("",!0)]),_:1}),a(U,{class:Ke(["sh-main-layout",{expanded:!b.value}])},{default:o(()=>[a(Ha),a(V,{class:"sh-main-content"},{default:o(()=>[v.value?(P(),H(_t,{key:0})):(P(),H(R,{key:1}))]),_:1}),a(Wa)]),_:1},8,["class"])]),_:1})]),_:1}),j.value?(P(),H(Ya,{key:0})):le("",!0),a(y,{container:"body",offset:["24px","80px"],size:"small"})],64)}}}),tn=Y(en,[["__scopeId","data-v-044043ee"]]);var gt=(e=>(e[e.Unknown=-1]="Unknown",e[e.C=0]="C",e[e.Cpp=1]="Cpp",e[e.Java=2]="Java",e[e.Python=3]="Python",e[e.Pascal=4]="Pascal",e[e.Golang=5]="Golang",e[e.Max=6]="Max",e))(gt||{});function vt(){const e=[-1,4,5,6];return Object.values(gt).filter(t=>typeof t=="number"&&!e.includes(t)).map(t=>({value:t,label:ht(t)}))}function an(e){return e>-1&&e<6}function ht(e){switch(e){case 0:return"C";case 1:return"C++";case 2:return"Java";case 3:return"Python";case 4:return"Pascal";case 5:return"Golang";default:return"Unknown"}}function Ye(e){switch(e){case 0:return"c";case 1:return"cpp";case 2:return"java";case 3:return"python";case 4:return"pascal";case 5:return"golang";default:return"text"}}var W=(e=>(e[e.Init=0]="Init",e[e.Rejudge=1]="Rejudge",e[e.Submitting=2]="Submitting",e[e.Queuing=3]="Queuing",e[e.Compiling=4]="Compiling",e[e.Running=5]="Running",e[e.Accept=6]="Accept",e[e.PE=7]="PE",e[e.WA=8]="WA",e[e.TLE=9]="TLE",e[e.MLE=10]="MLE",e[e.OLE=11]="OLE",e[e.RE=12]="RE",e[e.CE=13]="CE",e[e.CLE=14]="CLE",e[e.JudgeFail=15]="JudgeFail",e[e.SubmitFail=16]="SubmitFail",e[e.Unknown=17]="Unknown",e))(W||{});const nn=e=>{switch(e){case 0:return"普通评测";case 1:return"特殊评测";default:return"未知"}},ze=e=>{switch(e){case 0:return"等待处理";case 1:return"重新评测";case 2:return"提交中";case 3:return"队列中";case 4:return"编译中";case 5:return"运行中";case 6:return"通过";case 7:return"格式错误";case 8:return"答案错误";case 9:return"超时";case 10:return"内存超限";case 11:return"输出超限";case 12:return"运行错误";case 13:return"编译错误";case 14:return"编译超限";case 15:return"评测失败";case 16:return"提交失败";case 17:return"未知";default:return e}};function on(){const e=[17];return Object.values(W).filter(t=>typeof t=="number"&&!e.includes(t)).map(t=>({value:t,label:ze(t)}))}function ve(e){switch(e){case 0:case 1:case 2:case 3:case 4:case 5:return!0;default:return!1}}function bt(e){var n;const t={};if(t.id=e.id,t.problemId=e.problem_id,t.status=e.status,ve(e.status)?t.score="-":t.score=e.score.toString(),e.time?t.time=Math.ceil(e.time/1e6)+"ms":t.time="-",e.memory?t.memory=(e.memory/1024/1024).toFixed(2)+"MB":t.memory="-",t.language=ht(e.language),t.codeLength=e.code_length,e.approve_time?t.approveTime=new Date(e.approve_time).toLocaleString():t.approveTime="-",t.author=e.author,t.authorUsername=e.author_username,t.authorNickname=e.author_nickname,t.code=e.code,t.compileMessage=e.compile_message,t.taskCurrent=e.task_current,t.taskTotal=e.task_total,t.task=[],e.task)for(let s=0;s<((n=e.task)==null?void 0:n.length);s++){const l=e.task[s],r={};r.taskId=l.task_id,r.status=l.status,l.time?r.time=Math.ceil(l.time/1e6)+"ms":r.time="-",l.memory?r.memory=(l.memory/1024/1024).toFixed(2)+"MB":r.memory="-",r.score=l.score,r.content=l.content,r.waHint=l.wa_hint,!r.content&&!r.waHint&&(r.content="无提示信息"),t.task.push(r)}return t}function ln(e,t,n){return J({url:"/judge/approve",method:"post",data:{problem_id:e,language:t,code:n}})}function yt(e){return J({url:"/judge?id="+e,method:"get"})}function sn(e,t,n,s,l,r){const C=new URLSearchParams({problem_id:e,username:t,language:String(n),status:String(s),page:String(l),page_size:String(r)});return J({url:`/judge/list?${C.toString()}`,method:"get"})}function rn(){return J({url:"/judge/rejudge/recently",method:"post"})}function un(e){return J({url:"/judge/rejudge/problem",method:"post",data:{id:e}})}function cn(){return J({url:"/judge/rejudge/all",method:"post",timeout:0})}function dn(e){return J({url:"/judge/rejudge",method:"post",data:{id:e}})}var Xe=(e=>(e[e.None=0]="None",e[e.Attempt=1]="Attempt",e[e.Accept=2]="Accept",e))(Xe||{});function Ue(e,t){const n={};if(n.id=e.id,n.author=e.author,n.title=e.title,n.tags=[],e.tags)for(const s of e.tags){const l=t[s];l&&n.tags.push(l)}return n.accept=e.accept,n.attempt=e.attempt,e.description!=null&&(n.description=e.description),e.time_limit!=null&&(n.timeLimit=e.time_limit.toString()+" ms"),e.memory_limit!=null&&(n.memoryLimit=(e.memory_limit/1024).toFixed(2)+" MB"),e.judge_type!=null&&(n.judgeType=nn(e.judge_type)),e.insert_time!=null&&(n.insertTime=new Date(e.insert_time).toLocaleString()),e.update_time!=null&&(n.updateTime=new Date(e.update_time).toLocaleString()),e.creator_nickname!=null&&(n.creatorNickname=e.creator_nickname),e.source!=null&&(n.source=e.source),e.judge_md5!=null&&(n.judgeMd5=e.judge_md5),n}function wt(e){return J({url:"/problem?id="+e,method:"get"})}function kt(e){return J({url:"/problem/tag/list?max_count="+e,method:"get"})}function mn(e){return J({url:"/problem/judge?id="+e,method:"get"})}function pn(e,t,n,s){return J({url:"/problem/list?title="+e+"&tag="+t+"&page="+n+"&page_size="+s,method:"get"})}function fn(e,t,n,s,l,r,C){return J({url:"/problem/edit",method:"post",data:{id:e,title:t,time_limit:n,memory_limit:s,source:l,tags:r,description:C}})}function _n(e,t){return J({url:"/problem/judge/data/download?id="+e+"&key="+t,method:"get"})}function gn(e,t){const n=new FormData;return n.append("id",e),n.append("zip",t),J({url:"/problem/judge/data",method:"post",data:n,headers:{"Content-Type":"multipart/form-data"},timeout:1e3*60*5})}const vn={style:{margin:"10px"}};function hn(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!We(e)}const bn=ee({__name:"ProblemList",setup(e){const t=oe(),n=Ae(),{globalProperties:s}=ae();let l=null;const r=c(!1),C={};let j={};const b=c([{title:"ID",colKey:"id",cell:(p,h)=>{let m=V(h.row.id);return a(q,{variant:"dashed",theme:m,onClick:()=>R(h.row.id)},{default:()=>[h.row.id]})}},{title:"标题",colKey:"title",cell:(p,h)=>a(q,{variant:"text",onClick:()=>R(h.row.id)},{default:()=>[h.row.title]})},{title:"标签",colKey:"tags",cell:(p,h)=>{const m=h.row.tags;if(!m||m.length===0)return"";let T=[];for(let f=0;f<m.length;f++){const _=m[f];T.push(a(q,{key:f,theme:"default",variant:"outline"},{default:()=>[_.name]}))}return a(ce,null,hn(T)?T:{default:()=>[T]})}},{title:"正确",colKey:"accept"},{title:"提交",colKey:"attempt"}]),u=c(!1);let v=1,d=50;const L=c({defaultPageSize:d,defaultCurrent:v,total:0,pageSizeOptions:[50,100]}),S=c(),z=c(),x=c({title:"",tag:""}),R=p=>{p&&n.push({path:"/problem/"+p})},V=p=>{if(!p||!j)return"default";const h=j[p];if(!h)return"default";switch(h){case Xe.Accept:return"success";case Xe.Attempt:return"warning";default:return"default"}},U=async()=>{await n.push({query:{...t.query,title:x.value.title,tag:x.value.tag,page:1,page_size:L.value.defaultPageSize}})},y=p=>{p&&n.push({query:{...t.query,title:"",tag:p.name,page:1,page_size:L.value.defaultPageSize}})},I=async(p,h)=>{u.value=!0;try{const{current:m,pageSize:T}=p,f=await pn(x.value.title,x.value.tag,m,T);if(S.value=[],f.code===0){const _=f.data.list;if(!_||_.length<=0){L.value={...L.value,total:0},j=null,ie(s,"未找到记录");return}_.forEach(i=>{var A;const g=Ue(i,C);(A=S.value)==null||A.push(g)}),L.value={...L.value,total:f.data.total_count},j=f.data.problem_attempt_status}else h&&N(s,f.code)}catch(m){console.error(m),N(s,Ce())}finally{u.value=!1}},$=async p=>{await n.push({query:{...t.query,page:p.current,page_size:p.pageSize}})};return te(async()=>{u.value=!0,z.value=[],kt(-1).then(p=>{if(p.code===0){z.value=p.data.list,r.value=p.data.total_count>p.data.list.length;for(let h=0;h<p.data.list.length;h++){const m=p.data.list[h];C[m.id]=m}l=Ee(()=>t.query,h=>{x.value.title=h.title||"",x.value.tag=h.tag||"";const m=parseInt(h.page)||L.value.defaultCurrent,T=parseInt(h.page_size)||L.value.defaultPageSize;v=m,d=T,L.value={...L.value,current:v,pageSize:d},I({current:v,pageSize:d},!0)},{immediate:!0})}else r.value=!0}).catch(p=>{console.error(p),r.value=!0})}),Se(()=>{l&&l()}),(p,h)=>{const m=ke,T=re,f=ge,_=we,i=Ie,g=q,A=Le,F=_e;return P(),H(F,null,{default:o(()=>[a(f,{span:9},{default:o(()=>[a(T,{style:{margin:"10px"}},{default:o(()=>[a(m,{data:S.value,columns:b.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:L.value,loading:u.value,onPageChange:$},null,8,["data","columns","pagination","loading"])]),_:1})]),_:1}),a(f,{span:3},{default:o(()=>[D("div",vn,[a(T,{class:"sh-card"},{default:o(()=>[a(A,{model:x.value},{default:o(()=>[a(i,{label:"标题"},{default:o(()=>[a(_,{modelValue:x.value.title,"onUpdate:modelValue":h[0]||(h[0]=E=>x.value.title=E),placeholder:"暂不支持模糊查询"},null,8,["modelValue"])]),_:1}),a(i,{label:"标签"},{default:o(()=>[a(_,{modelValue:x.value.tag,"onUpdate:modelValue":h[1]||(h[1]=E=>x.value.tag=E),placeholder:"暂不支持模糊查询"},null,8,["modelValue"])]),_:1}),a(i,null,{default:o(()=>[a(g,{theme:"primary",onClick:U},{default:o(()=>h[3]||(h[3]=[k("搜索")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(T,{class:"sh-card sh-background-black"},{default:o(()=>[(P(!0),B(Q,null,se(z.value,E=>(P(),H(g,{class:"sh-tag-button",theme:"default",variant:"outline",ghost:!0,onClick:()=>y(E)},{default:o(()=>[k(M(E.name),1)]),_:2},1032,["onClick"]))),256)),r.value?(P(),H(g,{key:0,class:"sh-tag-button",theme:"default",variant:"outline",ghost:!0,onClick:h[2]||(h[2]=()=>p.$router.push("/problem/tags"))},{default:o(()=>h[4]||(h[4]=[k(" ... ")])),_:1})):le("",!0)]),_:1})])]),_:1})]),_:1})}}}),yn=Y(bn,[["__scopeId","data-v-a6493d7d"]]);function Fe(e){e.querySelectorAll("pre > code:not([data-copy-attached])").forEach(n=>{n.setAttribute("data-copy-attached","true");const s=n.parentElement,l=document.createElement("div");l.className="copy-wrapper";const r=document.createElement("button");r.className="copy-btn",r.innerText="复制",r.addEventListener("click",async()=>{try{await navigator.clipboard.writeText(n.innerText),r.innerText="已复制",setTimeout(()=>r.innerText="复制",1500)}catch{r.innerText="失败"}}),s.replaceWith(l),l.appendChild(r),l.appendChild(s)})}const wn=["innerHTML"],kn={style:{margin:"12px"}},Cn={key:0,class:"dida-edit-container"},Sn={class:"dida-operation-container"},Ln={class:"dida-code-submit-div"},In=ee({__name:"ProblemDetail",setup(e){let t=oe();const{globalProperties:n}=ae(),s=Te(),l=pe();let r=c("");const C=c(""),j=c(null),b=c(!1),u=c(null);let v=null;const d=c(null),L={},S=c(""),z=c([]);z.value=vt();const x=be(()=>l.hasAuth(ye.ManageProblem)),R=h=>{h&&X.push({name:"problem-list",query:{...t.query,title:"",tag:h.name}})},V=()=>{X.push({name:"manage-problem",params:{problemId:C.value}})},U=()=>{X.push({name:"judge-list",query:{problem_id:C.value}})},y=()=>{},I=()=>{X.push({name:"problem-recommend",params:{problemId:C.value}})},$=async()=>{if(!C.value){ue(n,"问题ID无效");return}const h=parseInt(S.value);if(!an(h)){ue(n,"请选择所编写的语言");return}const m=v==null?void 0:v.getValue();if(!m){ue(n,"请输入所需提交的代码");return}const T=await ln(C.value,h,m);if(T.code!==0){N(n,T.code);return}ie(n,"提交成功，正在跳转到详情页面");const f=T.data.id;await X.push({path:"/judge/"+f})},p=h=>{v&&Ze.setModelLanguage(v.getModel(),Ye(h))};return te(async()=>{if(Array.isArray(t.params.problemId)?C.value=t.params.problemId[0]:C.value=t.params.problemId,!C.value){ue(n,"题目不存在"),await X.push({name:"problem"});return}b.value=!0;const h=await wt(C.value);if(h.code!==0){b.value=!1,N(n,h.code),await X.push({name:"problem"});return}h.data.tags&&h.data.tags.forEach(f=>{L[f.id]=f}),u.value=Ue(h.data.problem,L),s.setTitle(u.value.title+" - "+s.getTitle);let m=u.value.description;const T={math:{inlineDigit:!0,engine:"KaTeX"}};r.value=await ne.md2html(m,T),await he(()=>{j.value&&(ne.mathRender(j.value),ne.highlightRender({lineNumber:!0,enable:!0},j.value),Fe(j.value),d.value&&(v=Ze.create(d.value,{value:"",language:"cpp",minimap:{enabled:!0},colorDecorators:!0,readOnly:!1,theme:"vs-dark"}))),b.value=!1})}),(h,m)=>{const T=re,f=ge,_=q,i=He,g=ce,A=Me,F=rt,E=st,O=_e,G=me;return P(),H(G,{loading:b.value},{default:o(()=>[a(O,{class:"dida-main-content"},{default:o(()=>[a(f,{span:8},{default:o(()=>[a(T,{style:{margin:"10px"}},{default:o(()=>[D("div",{innerHTML:de(r),ref_key:"markdownRef",ref:j},null,8,wn)]),_:1})]),_:1}),a(f,{span:4},{default:o(()=>[D("div",kn,[x.value?(P(),B("div",Cn,[a(_,{onClick:V},{default:o(()=>m[1]||(m[1]=[k("编辑")])),_:1})])):le("",!0),a(A,{layout:"vertical",bordered:!0},{default:o(()=>[a(i,{label:"标题"},{default:o(()=>{var w;return[k(M((w=u.value)==null?void 0:w.title),1)]}),_:1}),a(i,{label:"时间限制"},{default:o(()=>{var w;return[k(M((w=u.value)==null?void 0:w.timeLimit),1)]}),_:1}),a(i,{label:"内存限制"},{default:o(()=>{var w;return[k(M((w=u.value)==null?void 0:w.memoryLimit),1)]}),_:1}),a(i,{label:"判题方式"},{default:o(()=>{var w;return[k(M((w=u.value)==null?void 0:w.judgeType),1)]}),_:1}),a(i,{label:"正确提交"},{default:o(()=>{var w;return[k(M((w=u.value)==null?void 0:w.accept),1)]}),_:1}),a(i,{label:"提交总数"},{default:o(()=>{var w;return[k(M((w=u.value)==null?void 0:w.attempt),1)]}),_:1}),a(i,{label:"创建时间"},{default:o(()=>{var w;return[k(M((w=u.value)==null?void 0:w.insertTime),1)]}),_:1}),a(i,{label:"更新时间"},{default:o(()=>{var w;return[k(M((w=u.value)==null?void 0:w.updateTime),1)]}),_:1}),a(i,{label:"上传用户"},{default:o(()=>{var w;return[k(M((w=u.value)==null?void 0:w.creatorNickname),1)]}),_:1}),a(i,{label:"题目来源"},{default:o(()=>{var w;return[k(M((w=u.value)==null?void 0:w.source),1)]}),_:1}),a(i,{label:"标签"},{default:o(()=>[a(g,null,{default:o(()=>{var w;return[(P(!0),B(Q,null,se((w=u.value)==null?void 0:w.tags,K=>(P(),H(_,{key:K.id,variant:"dashed",onClick:()=>R(K)},{default:o(()=>[k(M(K.name),1)]),_:2},1032,["onClick"]))),128))]}),_:1})]),_:1})]),_:1}),D("div",Sn,[a(g,null,{default:o(()=>[a(_,{onClick:U},{default:o(()=>m[2]||(m[2]=[k("提交记录")])),_:1}),a(_,{onClick:y},{default:o(()=>m[3]||(m[3]=[k("题目讨论")])),_:1}),a(_,{onClick:I},{default:o(()=>m[4]||(m[4]=[k("题目推荐")])),_:1})]),_:1})]),D("div",Ln,[a(g,null,{default:o(()=>[a(E,{modelValue:S.value,"onUpdate:modelValue":m[0]||(m[0]=w=>S.value=w),label:"语言：",placeholder:"请选择提交语言","auto-width":"",clearable:"",onChange:p},{default:o(()=>[(P(!0),B(Q,null,se(z.value,w=>(P(),H(F,{key:w.value,value:w.value,label:w.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"]),a(_,{onClick:$},{default:o(()=>m[5]||(m[5]=[k("提交")])),_:1})]),_:1}),D("div",{ref_key:"codeEditRef",ref:d,class:"dida-code-editor"},null,512)])])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),Tn=Y(In,[["__scopeId","data-v-79d5d698"]]),Pn={};function jn(e,t){return" TODO "}const xn=Y(Pn,[["render",jn]]),Vn=["innerHTML"];function $n(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!We(e)}const Rn=ee({__name:"JudgeJobList",setup(e){const t=oe(),n=Ae(),{globalProperties:s}=ae();let l=!1,r=null;const C=c(!1),j=c(""),b=c(""),u=c(null),v=c(!1),d=c({problemId:"",username:"",language:void 0,status:void 0}),L=c([{title:"ID",colKey:"id",cell:(i,g)=>a(q,{variant:"text",onClick:()=>p(g.row.id)},{default:()=>[g.row.id]})},{title:"问题",colKey:"problemId",cell:(i,g)=>a(q,{variant:"text",onClick:()=>$(g.row.problemId)},{default:()=>[g.row.problemId]})},{title:"状态",colKey:"status",align:"center",cell:(i,g)=>{const A=g.row.status,F=ze(A);let E;switch(A){case W.Init:case W.Rejudge:case W.Compiling:case W.Running:E="default";break;case W.Accept:E="success";break;case W.PE:E="warning";break;default:E="danger";break}let O=[];return ve(A)&&O.push(a(me,{text:g.row.state,size:"small",class:"dida-status-loading"},null)),O.push(a("span",null,[F])),a(q,{theme:E,variant:"outline",onClick:()=>p(g.row.id)},$n(O)?O:{default:()=>[O]})}},{title:"分数",colKey:"score"},{title:"时间",colKey:"time"},{title:"内存",colKey:"memory"},{title:"代码",colKey:"code",cell:(i,g)=>a(q,{theme:"default",onClick:()=>I(g.row.id)},{default:()=>[g.row.language+" / "+g.row.codeLength]})},{title:"作者",colKey:"author",width:200,cell:(i,g)=>a(q,{variant:"text",onClick:()=>h(g.row.authorUsername)},{default:()=>[g.row.authorNickname]})},{title:"提交时间",colKey:"approveTime",width:180}]),S=c(!1);let z=1,x=50;const R=c({current:z,pageSize:x,defaultCurrent:z,defaultPageSize:x,total:0,pageSizeOptions:[50,100]}),V=c(),U=c([]);U.value=vt();const y=c([]);y.value=on();const I=async i=>{if(i){v.value=!0,C.value=!0,j.value=i,b.value="";try{const g=await yt(i);if(g.code===0){const A=g.data,E=`\`\`\`${Ye(A.language)}
${A.code}
\`\`\``,O={};b.value=await ne.md2html(E,O),await he(()=>{u.value&&(ne.highlightRender({lineNumber:!0,enable:!0},u.value),Fe(u.value))})}else N(s,g.code)}finally{v.value=!1}}},$=i=>{i&&n.push({path:"/problem/"+i})},p=i=>{i&&n.push({path:"/judge/"+i})},h=i=>{i&&n.push({path:"/user/"+i})},m=async()=>{await n.push({query:{...t.query,page:1,page_size:x,problem_id:d.value.problemId,username:d.value.username,language:d.value.language,status:d.value.status}})},T=async()=>{d.value.problemId="",d.value.username="",d.value.language=void 0,d.value.status=void 0,await n.push({query:{...t.query,page:1,page_size:x,problem_id:"",username:"",language:void 0,status:void 0}})},f=async(i,g)=>{g&&(S.value=!0);let A=!1;try{const{current:F,pageSize:E}=i,O=await sn(d.value.problemId,d.value.username,d.value.language,d.value.status,F,E);V.value=[],O.code===0?O.data.list&&O.data.list.length>0?(O.data.list.forEach(w=>{var xe;const K=bt(w);(xe=V.value)==null||xe.push(K),ve(w.status)&&(A=!0)}),R.value={...R.value,total:O.data.total_count}):(ie(s,"未找到记录"),R.value={...R.value,total:0}):g&&N(s,O.code)}catch(F){console.error(F),g&&N(s,Ce())}finally{g&&(S.value=!1),A&&l&&setTimeout(()=>{f({current:z,pageSize:x},!1)},5e3)}},_=async i=>{await n.push({query:{...t.query,page:i.current,page_size:i.pageSize}})};return te(async()=>{l=!0,r=Ee(()=>t.query,i=>{d.value.problemId=i.problem_id||"",d.value.username=i.username||"",i.language!=null?d.value.language=Number(i.language):d.value.language=void 0,i.status!=null?d.value.status=Number(i.status):d.value.status=void 0;const g=parseInt(i.page)||R.value.defaultCurrent,A=parseInt(i.page_size)||R.value.defaultPageSize;z=g,x=A,R.value.pageSizeOptions.includes(x)||(x=R.value.defaultPageSize),R.value={...R.value,current:z,pageSize:x},f({current:z,pageSize:x},!0)},{immediate:!0})}),Se(()=>{l=!1,r&&r()}),(i,g)=>{const A=we,F=Ie,E=rt,O=st,G=q,w=ce,K=Le,xe=ke,It=re,Tt=me,Pt=ut;return P(),B(Q,null,[a(It,{style:{margin:"10px"}},{default:o(()=>[a(K,{layout:"inline",onSubmit:m,onReset:T},{default:o(()=>[a(F,{label:"题号"},{default:o(()=>[a(A,{modelValue:d.value.problemId,"onUpdate:modelValue":g[0]||(g[0]=Z=>d.value.problemId=Z),placeholder:"请输入完整题号"},null,8,["modelValue"])]),_:1}),a(F,{label:"用户"},{default:o(()=>[a(A,{modelValue:d.value.username,"onUpdate:modelValue":g[1]||(g[1]=Z=>d.value.username=Z),placeholder:"仅支持输入完整用户名"},null,8,["modelValue"])]),_:1}),a(F,{label:"语言"},{default:o(()=>[a(O,{modelValue:d.value.language,"onUpdate:modelValue":g[2]||(g[2]=Z=>d.value.language=Z),placeholder:"请选择提交语言","auto-width":"",clearable:""},{default:o(()=>[(P(!0),B(Q,null,se(U.value,Z=>(P(),H(E,{key:Z.value,value:Z.value,label:Z.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(F,{label:"状态"},{default:o(()=>[a(O,{modelValue:d.value.status,"onUpdate:modelValue":g[3]||(g[3]=Z=>d.value.status=Z),placeholder:"请选择评测状态","auto-width":"",clearable:""},{default:o(()=>[(P(!0),B(Q,null,se(y.value,Z=>(P(),H(E,{key:Z.value,value:Z.value,label:Z.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(F,null,{default:o(()=>[a(w,null,{default:o(()=>[a(G,{theme:"primary",type:"submit"},{default:o(()=>g[6]||(g[6]=[k("搜索")])),_:1}),a(G,{theme:"default",variant:"base",type:"reset"},{default:o(()=>g[7]||(g[7]=[k("重置")])),_:1})]),_:1})]),_:1})]),_:1}),a(xe,{data:V.value,columns:L.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:R.value,loading:S.value,onPageChange:_},null,8,["data","columns","pagination","loading"])]),_:1}),a(Pt,{visible:C.value,"onUpdate:visible":g[4]||(g[4]=Z=>C.value=Z),header:j.value,width:"800px","cancel-btn":null,"close-btn":!1,onConfirm:g[5]||(g[5]=Z=>C.value=!1)},{default:o(()=>[a(Tt,{loading:v.value},{default:o(()=>[D("div",{innerHTML:b.value,ref_key:"markdownCodeRef",ref:u,style:{"min-height":"100px"}},null,8,Vn)]),_:1},8,["loading"])]),_:1},8,["visible","header"])],64)}}}),zn=Y(Rn,[["__scopeId","data-v-19c4033b"]]),Dn=["innerHTML"],En={key:2,class:"dida-edit-container"};function Qe(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!We(e)}const An=ee({__name:"JudgeJobDetail",setup(e){const t=oe(),n=Ae(),s=pe(),{globalProperties:l}=ae();let r=!1,C=-1;const j=c(null),b=c(""),u=c(null),v=c(0),d=c(null),L=c({from:"#5a96ff",to:"#00A870"});let S=!1;const z=c([{title:"ID",colKey:"id"},{title:"问题",colKey:"problemId",cell:(m,T)=>a(q,{variant:"text",onClick:()=>I(T.row.problemId)},{default:()=>[T.row.problemId]})},{title:"状态",colKey:"status",align:"center",cell:(m,T)=>{const f=T.row.status,_=ze(f);let i;switch(f){case W.Init:case W.Rejudge:case W.Compiling:case W.Running:i="default";break;case W.Accept:i="success";break;case W.PE:i="warning";break;default:i="danger";break}let g=[];return ve(f)&&g.push(a(me,{text:T.row.state,size:"small",class:"dida-status-loading"},null)),g.push(a("span",null,[_])),a(q,{theme:i,variant:"outline"},Qe(g)?g:{default:()=>[g]})}},{title:"分数",colKey:"score"},{title:"时间",colKey:"time"},{title:"内存",colKey:"memory"},{title:"代码",colKey:"language",cell:(m,T)=>a("span",null,[T.row.language+" / "+T.row.codeLength])},{title:"作者",colKey:"author",width:200,cell:(m,T)=>a(q,{variant:"text",onClick:()=>$(T.row.authorUsername)},{default:()=>[T.row.authorNickname]})},{title:"提交时间",colKey:"approveTime",width:180}]),x=c(!1),R=c(!1),V=c(),U=be(()=>s.hasAuth(ye.ManageJudge)),y=async()=>{if(!R.value){R.value=!0;try{const m=await dn(C);m.code===0?await h(!0):N(l,m.code)}catch(m){console.error(m),N(l,Ce())}finally{R.value=!1}}},I=m=>{m&&n.push({path:"/problem/"+m})},$=m=>{m&&n.push({path:"/user/"+m})},p=m=>{const T=m.status,f=ze(T);let _;switch(T){case W.Init:case W.Rejudge:case W.Compiling:case W.Running:_="default";break;case W.Accept:_="success";break;case W.PE:_="warning";break;default:_="danger";break}return a(ce,null,{default:()=>[a(q,{theme:"default",variant:"outline"},{default:()=>[m.taskId]}),a(q,{theme:_,variant:"outline"},Qe(f)?f:{default:()=>[f]}),a("span",null,[k("分数："),m.score]),a("span",null,[k("用时："),m.time]),a("span",null,[k("内存："),m.memory])]})},h=async m=>{var f;m&&(x.value=!0);let T=!1;try{const _=await yt(C);if(V.value=[],_.code===0){const i=_.data,g=bt(i);(f=V.value)==null||f.push(g),L.value.to="#00A870",ve(i.status)?(d.value="active",g.taskTotal>0?(v.value=g.taskCurrent/g.taskTotal*100,g.taskCurrent>=g.taskTotal&&(v.value=99)):v.value=0):(v.value=100,i.status===W.Accept?d.value="success":i.status===W.PE?(L.value.to="#F57C20",d.value="warning"):(L.value.to="#F56C6C",d.value="error"));const A={};if(i.code){const E=`\`\`\`${Ye(i.language)}
${i.code}
\`\`\``;b.value=await ne.md2html(E,A),await he(()=>{u.value&&(S||(S=!0,ne.highlightRender({lineNumber:!0,enable:!0},u.value)),Fe(u.value))})}j.value=g,ve(i.status)&&(T=!0)}else m&&N(l,_.code)}catch(_){console.error(_),m&&N(l,Ce())}finally{m&&(x.value=!1),T&&r&&setTimeout(()=>{h(!1)},5e3)}};return te(async()=>{if(r=!0,t.params.judgeId&&t.params.judgeId.length===1)C=parseInt(t.params.judgeId[0]);else{await n.push({name:"judge"});return}await h(!0)}),Se(()=>{r=!1}),(m,T)=>{var E,O;const f=Zt,_=ke,i=re,g=it,A=ct,F=q;return P(),B(Q,null,[a(f,{color:L.value,status:d.value,class:"dida-job-progress",percentage:v.value},null,8,["color","status","percentage"]),a(i,{style:{margin:"10px"}},{default:o(()=>[a(_,{data:V.value,columns:z.value,"row-key":"id","vertical-align":"top",hover:!0,loading:x.value},null,8,["data","columns","loading"])]),_:1}),D("div",{innerHTML:b.value,ref_key:"markdownCodeRef",ref:u},null,8,Dn),(E=j.value)!=null&&E.compileMessage?(P(),H(i,{key:0,class:"compile-message"},{default:o(()=>{var G;return[k(M((G=j.value)==null?void 0:G.compileMessage),1)]}),_:1})):le("",!0),((O=j.value)==null?void 0:O.task.length)>0?(P(),H(A,{key:1,class:"task-panel"},{default:o(()=>{var G;return[(P(!0),B(Q,null,se((G=j.value)==null?void 0:G.task,w=>(P(),H(g,{key:w.taskId,header:()=>p(w)},{default:o(()=>[k(M(w.content)+" "+M(w.waHint),1)]),_:2},1032,["header"]))),128))]}),_:1})):le("",!0),U.value?(P(),B("div",En,[a(F,{onClick:y,loading:R.value},{default:o(()=>T[0]||(T[0]=[k("重新评测")])),_:1},8,["loading"])])):le("",!0)],64)}}}),Mn=Y(An,[["__scopeId","data-v-d6dae396"]]);function Hn(e){let t="";for(e++;e>0;)e--,t=String.fromCharCode(65+e%26)+t,e=Math.floor(e/26);return t}async function Ct(e){const t={};if(t.id=e.id,t.ownerId=e.owner_id,t.ownerUsername=e.owner_username,t.ownerNickname=e.owner_nickname,t.title=e.title,t.startTime=new Date(e.start_time).toLocaleString(),t.endTime=new Date(e.end_time).toLocaleString(),e.descriptions){t.descriptions=[];const n={math:{inlineDigit:!0,engine:"KaTeX"}};for(let s=0;s<e.descriptions.length;s++){const l=e.descriptions[s],r={};r.title=l.title,r.content=await ne.md2html(l.content,n),r.sort=l.sort,t.descriptions.push(r)}}if(t.notification=e.notification,e.problems){t.problems=[],e.problems.sort((n,s)=>n.sort-s.sort);for(let n=0;n<e.problems.length;n++){const s=e.problems[n];s.accept||(s.accept=0),s.attempt||(s.attempt=0),s.id=Hn(n),t.problems.push(s)}}return t}function qn(e){return J({url:"/contest?id="+e,method:"get"})}function Un(e,t){return J({url:"/contest/list?page="+e+"&page_size="+t,method:"get"})}function Fn(e){return J({url:"/contest/create",method:"post",data:e})}const On={style:{margin:"10px"}},Nn=ee({__name:"ContestList",setup(e){const t=oe(),n=Ae(),{globalProperties:s}=ae();let l=null;const r=c(!1),C=c(!1),j=c([{title:"ID",colKey:"id",width:"100",cell:($,p)=>a(q,{variant:"text",onClick:()=>x(p.row.id)},{default:()=>[p.row.id]})},{title:"标题",colKey:"title",cell:($,p)=>a(q,{variant:"text",onClick:()=>x(p.row.id)},{default:()=>[p.row.title]})},{title:"负责人",colKey:"ownerNickname",width:"200"},{title:"开始时间",colKey:"startTime",width:"180"},{title:"结束时间",colKey:"endTime",width:"180"}]),b=c(!1);let u=1,v=50;const d=c({defaultPageSize:v,defaultCurrent:u,total:0,pageSizeOptions:[50,100]}),L=c(),S=c({title:"",username:""}),z=c({title:"",description:"",open_time:[]}),x=$=>{$&&n.push({path:"/contest/"+$})},R=async()=>{await n.push({query:{...t.query,title:S.value.title,username:S.value.username,page:1,page_size:d.value.defaultPageSize}})},V=async($,p)=>{var h;b.value=!0;try{const{current:m,pageSize:T}=$,f=await Un(m,T);if(L.value=[],f.code===0){const _=f.data.list;for(let i=0;i<_.length;i++){const g=_[i],A=await Ct(g);(h=L.value)==null||h.push(A)}d.value={...d.value,total:f.data.total_count}}else p&&N(s,f.code)}catch(m){console.error(m),N(s,Ce())}finally{b.value=!1}},U=async $=>{await n.push({query:{...t.query,page:$.current,page_size:$.pageSize}})},y=()=>{r.value=!0},I=async()=>{C.value=!0,console.log("contestCreateForm",z.value),Fn(z.value).then($=>{$.code===0?(ie(s,"创建比赛成功"),r.value=!1,n.push({path:"/contest/"+$.data.id})):N(s,$.code)}).finally(()=>{C.value=!1})};return te(async()=>{l=Ee(()=>t.query,$=>{S.value.title=$.title||"",S.value.username=$.username||"";const p=parseInt($.page)||d.value.defaultCurrent,h=parseInt($.page_size)||d.value.defaultPageSize;u=p,v=h,d.value={...d.value,current:u,pageSize:v},V({current:u,pageSize:v},!0)},{immediate:!0})}),Se(()=>{l&&l()}),($,p)=>{const h=ke,m=re,T=ge,f=we,_=Ie,i=q,g=Le,A=ce,F=_e,E=Qt,O=ut;return P(),B(Q,null,[a(F,null,{default:o(()=>[a(T,{span:9},{default:o(()=>[a(m,{style:{margin:"10px"}},{default:o(()=>[a(h,{data:L.value,columns:j.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:d.value,loading:b.value,onPageChange:U},null,8,["data","columns","pagination","loading"])]),_:1})]),_:1}),a(T,{span:3},{default:o(()=>[D("div",On,[a(m,{class:"sh-card"},{default:o(()=>[a(g,{model:S.value},{default:o(()=>[a(_,{label:"标题"},{default:o(()=>[a(f,{modelValue:S.value.title,"onUpdate:modelValue":p[0]||(p[0]=G=>S.value.title=G),placeholder:"暂不支持模糊查询"},null,8,["modelValue"])]),_:1}),a(_,{label:"负责人"},{default:o(()=>[a(f,{modelValue:S.value.username,"onUpdate:modelValue":p[1]||(p[1]=G=>S.value.username=G),placeholder:"仅支持输入完整用户名"},null,8,["modelValue"])]),_:1}),a(_,null,{default:o(()=>[a(i,{theme:"primary",onClick:R},{default:o(()=>p[6]||(p[6]=[k("提交")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(m,{class:"sh-card"},{default:o(()=>[a(A,null,{default:o(()=>[a(i,{onClick:y},{default:o(()=>p[7]||(p[7]=[k("创建")])),_:1})]),_:1})]),_:1})])]),_:1})]),_:1}),a(O,{visible:r.value,"onUpdate:visible":p[5]||(p[5]=G=>r.value=G),header:"创建比赛",onConfirm:I,"confirm-loading":C.value},{default:o(()=>[a(g,{"label-width":80,model:z.value,onSubmit:p[4]||(p[4]=Re(()=>{},["prevent"]))},{default:o(()=>[a(_,{label:"标题"},{default:o(()=>[a(f,{modelValue:z.value.title,"onUpdate:modelValue":p[2]||(p[2]=G=>z.value.title=G),placeholder:"请输入标题"},null,8,["modelValue"])]),_:1}),a(_,{label:"开启时间"},{default:o(()=>[a(E,{"enable-time-picker":"","allow-input":"",clearable:"",modelValue:z.value.open_time,"onUpdate:modelValue":p[3]||(p[3]=G=>z.value.open_time=G)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","confirm-loading"])],64)}}}),fe=Y(Nn,[["__scopeId","data-v-22712534"]]),Gn=["innerHTML"],Kn={style:{margin:"12px"}},Bn=ee({__name:"ContestDetail",setup(e){let t=oe();const{globalProperties:n}=ae(),s=c(""),l=c(!1),r=c(null),C=c([{title:"ID",colKey:"id",cell:(b,u)=>a(q,{variant:"text"},{default:()=>[u.row.id]})},{title:"标题",colKey:"title",cell:(b,u)=>a(q,{variant:"text"},{default:()=>[u.row.title]})},{title:"正确",colKey:"accept"},{title:"提交",colKey:"attempt"}]),j=c([]);return te(async()=>{if(t.params.contestId&&t.params.contestId.length===1)s.value=t.params.contestId[0];else{await X.push({name:"contest"});return}l.value=!0;const b=await qn(s.value);if(b.code!==0){l.value=!1,N(n,b.code),await X.push({name:"contest"});return}r.value=await Ct(b.data),j.value=r.value.problems,await he(()=>{const u=document.querySelectorAll(".contest-description");u&&u.length>0&&u.forEach(v=>{ne.mathRender(v),ne.highlightRender({lineNumber:!0,enable:!0},v),Fe(v)}),l.value=!1})}),(b,u)=>{const v=ea,d=q,L=ce,S=it,z=ct,x=ke,R=re,V=ge,U=He,y=Me,I=_e,$=me;return P(),H($,{loading:l.value},{default:o(()=>[a(I,{class:"dida-main-content"},{default:o(()=>[a(V,{span:8},{default:o(()=>{var p,h,m;return[D("h1",null,M((p=r.value)==null?void 0:p.title),1),(h=r.value)!=null&&h.notification?(P(),H(v,{key:0,theme:"info",message:(m=r.value)==null?void 0:m.notification},null,8,["message"])):le("",!0),a(z,{"default-value":[0],"expand-icon":!1,borderless:!0},{default:o(()=>{var T;return[(P(!0),B(Q,null,se((T=r.value)==null?void 0:T.descriptions,(f,_)=>(P(),H(S,{key:_,header:f.title},Ge({default:o(()=>[D("div",{innerHTML:f.content,class:"dida-content-description"},null,8,Gn)]),_:2},[_===0?{name:"headerRightContent",fn:o(()=>[a(L,{size:"small"},{default:o(()=>[a(d,{size:"small"},{default:o(()=>u[0]||(u[0]=[k("收起全部")])),_:1}),a(d,{size:"small"},{default:o(()=>u[1]||(u[1]=[k("展开全部")])),_:1})]),_:1})]),key:"0"}:void 0]),1032,["header"]))),128))]}),_:1}),a(R,{style:{margin:"10px"}},{default:o(()=>[a(x,{data:j.value,columns:C.value,"row-key":"id","vertical-align":"top",hover:!0},null,8,["data","columns"])]),_:1})]}),_:1}),a(V,{span:4},{default:o(()=>[D("div",Kn,[a(y,{layout:"vertical",bordered:!0},{default:o(()=>[a(U,{label:"开始时间"},{default:o(()=>{var p;return[k(M((p=r.value)==null?void 0:p.startTime),1)]}),_:1})]),_:1})])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),Xn=Y(Bn,[["__scopeId","data-v-7aec72d2"]]),Wn=ee({__name:"ManageJudge",setup(e){const{globalProperties:t}=ae(),n=c(""),s=c(!1),l=c(!1),r=async()=>{const b=await rn();if(b.code!==0){N(t,b.code);return}ie(t,"重判成功")},C=async()=>{if(n.value===""){N(t,"请输入问题Id");return}s.value=!0;try{const b=await un(n.value);if(b.code!==0){N(t,b.code);return}ie(t,"重判成功")}finally{s.value=!1}},j=async()=>{l.value=!0;try{const b=await cn();if(b.code!==0){N(t,b.code);return}ie(t,"重判成功")}finally{l.value=!1}};return(b,u)=>{const v=q,d=re,L=we,S=ce;return P(),B(Q,null,[a(d,{class:"yj-manage-card",title:"重判最近提交"},{default:o(()=>[a(v,{onClick:r},{default:o(()=>u[1]||(u[1]=[k("重判")])),_:1})]),_:1}),a(d,{class:"yj-manage-card",title:"重判问题"},{default:o(()=>[a(S,null,{default:o(()=>[a(L,{modelValue:n.value,"onUpdate:modelValue":u[0]||(u[0]=z=>n.value=z),placeholder:"输入问题Id"},null,8,["modelValue"]),a(v,{onClick:C,loading:s.value},{default:o(()=>u[2]||(u[2]=[k("重判")])),_:1},8,["loading"])]),_:1})]),_:1}),a(d,{class:"yj-manage-card",title:"重判所有"},{default:o(()=>[a(v,{onClick:j,theme:"danger",loading:l.value},{default:o(()=>u[3]||(u[3]=[k("重判")])),_:1},8,["loading"])]),_:1})],64)}}}),Jn=Y(Wn,[["__scopeId","data-v-2535f7cd"]]),Yn={style:{margin:"10px"}},Zn={key:1},Qn={style:{margin:"12px"}},eo={class:"dida-edit-container"},to=ee({__name:"ProblemEdit",setup(e){let t=oe();const{globalProperties:n}=ae(),s=Te(),l=c(""),r=c(!1);let C=null;const j=c(!1),b=c(null),u=c({title:"",timeLimit:0,memoryLimit:0,source:"",tags:[]}),v=c([]),d=c([]),L=be(()=>{const y=[],I=v.value;for(let $=0,p=I.length;$<p;$++)I[$].value&&y.push(I[$].value);return y}),S=(y,I)=>{const{trigger:$,index:p,item:h}=I;if($==="clear"&&(v.value=[]),["tag-remove","backspace"].includes($)&&v.value.splice(p,1),$==="enter"){for(let T=0;T<d.value.length;T++){const f=d.value[T];if(f.label===h){for(let _=0;_<v.value.length;_++)if(v.value[_].label===f.label)return;v.value.push(f);return}}const m={label:h,value:h};v.value.push(m),d.value=d.value.concat(m)}},z=(y,{current:I,type:$})=>{if(!I){v.value=$==="check"?d.value.slice(1):[];return}if($==="check"){const p=d.value.find(h=>h.value===I);if(!p)return;v.value.push(p)}else v.value=v.value.filter(p=>p.value!==I)},x=()=>{X.push({name:"problem-detail",params:{problemId:l.value}})},R=()=>{X.push({name:"manage-problem-judge",params:{problemId:l.value}})},V=async()=>{if(C){j.value=!0,u.value.tags=[];for(let y=0;y<v.value.length;y++){const I=v.value[y];I&&I.label&&u.value.tags.push(I.label)}try{const y=await fn(l.value,u.value.title,u.value.timeLimit,u.value.memoryLimit,u.value.source,u.value.tags,C.getValue());if(j.value=!0,y.code!==0){N(n,y.code);return}y.data!=null&&(b.value.updateTime=new Date(y.data).toLocaleString()),pt(n,"保存成功")}finally{j.value=!1}}},U=async()=>{const y=await wt(l.value);if(y.code!==0){N(n,y.code),console.error("problem get failed",y.code),await X.push({name:"problem"});return}const I=y.data.problem;if(b.value=Ue(I,{}),u.value.title=I.title,u.value.timeLimit=I.time_limit,u.value.memoryLimit=I.memory_limit,u.value.source=I.source,u.value.tags=[],v.value=[],y.data.tags)for(let h=0;h<y.data.tags.length;h++){const m=y.data.tags[h];m&&m.name&&(u.value.tags.push(m.name),v.value.push({label:m.name,value:m.id}))}s.setTitle(I.title+" - "+s.getTitle);let $=I.description;const p={after:()=>{C==null||C.setValue($)}};C=new ne("codeEditRef",p),r.value=!1};return te(async()=>{if(Array.isArray(t.params.problemId)?l.value=t.params.problemId[0]:l.value=t.params.problemId,!l.value){ue(n,"题目不存在"),await X.push({name:"problem"});return}r.value=!0,kt(-1).then(async y=>{y.code===0?(y.data.list&&y.data.list.forEach(I=>{d.value.push({label:I.name,value:I.id})}),await U()):(N(n,y.code),console.error("problem tag get failed",y.code),await X.push({name:"problem"}))}).catch(async y=>{console.error(y),N(n,"获取数据异常"),await X.push({name:"problem"})})}),(y,I)=>{const $=we,p=Ie,h=ta,m=na,T=aa,f=Le,_=re,i=ge,g=q,A=ce,F=He,E=Me,O=_e,G=me;return P(),H(G,{loading:r.value},{default:o(()=>[a(O,null,{default:o(()=>[a(i,{span:8},{default:o(()=>[D("div",Yn,[a(_,{class:"sh-card"},{default:o(()=>[a(f,{model:u.value},{default:o(()=>[a(p,{label:"标题"},{default:o(()=>[a($,{modelValue:u.value.title,"onUpdate:modelValue":I[0]||(I[0]=w=>u.value.title=w),placeholder:"问题标题"},null,8,["modelValue"])]),_:1}),a(p,{label:"时间限制"},{default:o(()=>[a(h,{modelValue:u.value.timeLimit,"onUpdate:modelValue":I[1]||(I[1]=w=>u.value.timeLimit=w),theme:"normal",min:0},{suffix:o(()=>I[4]||(I[4]=[D("span",null,"ms",-1)])),_:1},8,["modelValue"])]),_:1}),a(p,{label:"内存限制"},{default:o(()=>[a(h,{modelValue:u.value.memoryLimit,"onUpdate:modelValue":I[2]||(I[2]=w=>u.value.memoryLimit=w),theme:"normal",min:0},{suffix:o(()=>I[5]||(I[5]=[D("span",null,"KB",-1)])),_:1},8,["modelValue"])]),_:1}),a(p,{label:"来源"},{default:o(()=>[a($,{modelValue:u.value.source,"onUpdate:modelValue":I[3]||(I[3]=w=>u.value.source=w),placeholder:"请输入题目来源"},null,8,["modelValue"])]),_:1}),a(p,{label:"标签"},{default:o(()=>[a(T,{value:v.value,"allow-input":!0,placeholder:"请选择或输入","tag-input-props":{excessTagsDisplayType:"break-line"},"popup-props":{overlayInnerClassName:["narrow-scrollbar"],overlayInnerStyle:{maxHeight:"280px",overflowY:"auto",overscrollBehavior:"contain",padding:"6px"}},clearable:"",multiple:"",onTagChange:S},{panel:o(()=>[d.value.length?(P(),H(m,{key:0,value:L.value,options:d.value,onChange:z},null,8,["value","options"])):(P(),B("div",Zn,"暂无数据"))]),suffixIcon:o(()=>[a(de(Dt))]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1})])]),_:1}),a(i,{span:4},{default:o(()=>[D("div",Qn,[D("div",eo,[a(A,null,{default:o(()=>[a(g,{onClick:V,theme:"danger",loading:j.value},{default:o(()=>I[6]||(I[6]=[k("保存")])),_:1},8,["loading"]),a(g,{onClick:R,theme:"warning"},{default:o(()=>I[7]||(I[7]=[k("判题数据")])),_:1}),a(g,{onClick:x},{default:o(()=>I[8]||(I[8]=[k("查看")])),_:1})]),_:1})]),a(E,{layout:"vertical",bordered:!0},{default:o(()=>[a(F,{label:"创建时间"},{default:o(()=>{var w;return[k(M((w=b.value)==null?void 0:w.insertTime),1)]}),_:1}),a(F,{label:"更新时间"},{default:o(()=>{var w;return[k(M((w=b.value)==null?void 0:w.updateTime),1)]}),_:1}),a(F,{label:"判题方式"},{default:o(()=>{var w;return[k(M((w=b.value)==null?void 0:w.judgeType),1)]}),_:1}),a(F,{label:"上传用户"},{default:o(()=>{var w;return[k(M((w=b.value)==null?void 0:w.creatorNickname),1)]}),_:1})]),_:1})])]),_:1})]),_:1}),I[9]||(I[9]=D("div",{id:"codeEditRef",class:"dida-description-editor"},null,-1))]),_:1},8,["loading"])}}}),ao=Y(to,[["__scopeId","data-v-e994311e"]]),no={style:{margin:"10px"}},oo={style:{margin:"12px"}},lo={class:"dida-edit-container"},so=ee({__name:"ProblemJudge",setup(e){let t=oe();const{globalProperties:n}=ae(),s=Te(),l=c(""),r=c(!1),C=c(null);let j=null;const b=c(null),u=c(""),v=c(!1),d=c(!1),L=c([{title:"文件",colKey:"file"},{title:"大小",colKey:"size",width:150,cell:(f,_)=>_.row.size.toFixed(0)+" B"},{title:"最后修改时间",colKey:"lastModified",width:180,cell:(f,_)=>new Date(_.row.lastModified).toLocaleString()},{title:"操作",colKey:"action",width:100,cell:(f,_)=>a(q,{onClick:()=>U(_.row.file)},{default:()=>[k("下载")]})}]),S=c([]),z=be(()=>({border:"2px dashed #ccc",borderRadius:"6px",padding:"20px",textAlign:"center",cursor:"pointer",backgroundColor:v.value?"#f0f9ff":"#fff",transition:"background-color 0.2s ease"})),x=be(()=>u.value?`已选择：${u.value}`:v.value?"松开文件以上传":"拖拽文件到这里，或点击选择文件"),R=()=>{X.push({name:"problem-detail",params:{problemId:l.value}})},V=()=>{X.push({name:"manage-problem",params:{problemId:l.value}})},U=async f=>{const _=await _n(l.value,f);if(_.code!==0){N(n,_.code);return}const i=document.createElement("a");i.href=_.data,i.target="_blank",i.click(),URL.revokeObjectURL(i.href)},y=async()=>{if(!j){ue(n,"请选择压缩包");return}d.value=!0,gn(l.value,j).then(async f=>{f.code==0?(b.value.value=null,j=null,u.value="",r.value=!0,pt(n,"上传成功"),await T()):N(n,f.code)}).catch(f=>{console.log(f),n.$message.error({duration:3e3,content:"申请失败"})}).finally(()=>{d.value=!1})},I=()=>{var f;(f=b.value)==null||f.click()},$=f=>{const _=f.target.files[0];_&&(u.value=_.name,j=_)},p=f=>{v.value=!0},h=()=>{v.value=!1},m=f=>{f.preventDefault(),f.stopPropagation(),v.value=!1;const _=f.dataTransfer.files[0];if(_){u.value=_.name;const i=new DataTransfer;i.items.add(_),b.value.files=i.files,j=_}},T=async()=>{const f=await mn(l.value);if(f.code!==0){N(n,f.code),await X.push({name:"problem"});return}const _=f.data.problem;C.value=Ue(_,{}),s.setTitle(_.title+" - "+s.getTitle),S.value=[],f.data.judges?f.data.judges.forEach(i=>{S.value.push({file:i.key,size:i.size,lastModified:i.last_modified})}):ue(n,"评测数据不存在"),r.value=!1};return te(async()=>{if(Array.isArray(t.params.problemId)?l.value=t.params.problemId[0]:l.value=t.params.problemId,!l.value){ue(n,"题目不存在"),await X.push({name:"problem"});return}r.value=!0,await T()}),(f,_)=>{const i=ke,g=ge,A=q,F=ce,E=He,O=Me,G=_e,w=me;return P(),H(w,{loading:r.value},{default:o(()=>[a(G,null,{default:o(()=>[a(g,{span:7},{default:o(()=>[D("div",no,[D("div",{id:"drop-zone",style:nt(z.value),onClick:I,onDragenter:Re(p,["prevent"]),onDragover:_[0]||(_[0]=Re(()=>{},["prevent"])),onDragleave:Re(h,["prevent"]),onDrop:m},[D("input",{ref_key:"fileInput",ref:b,type:"file",style:{display:"none"},onChange:$},null,544),k(" "+M(x.value),1)],36)]),a(i,{data:S.value,columns:L.value,"row-key":"id","vertical-align":"top",hover:!0},null,8,["data","columns"])]),_:1}),a(g,{span:5},{default:o(()=>[D("div",oo,[D("div",lo,[a(F,null,{default:o(()=>[a(A,{onClick:y,theme:"danger",loading:d.value},{default:o(()=>_[1]||(_[1]=[k("上传")])),_:1},8,["loading"]),a(A,{onClick:V,theme:"warning"},{default:o(()=>_[2]||(_[2]=[k("编辑")])),_:1}),a(A,{onClick:R},{default:o(()=>_[3]||(_[3]=[k("查看")])),_:1})]),_:1})]),a(O,{layout:"vertical",bordered:!0},{default:o(()=>[a(E,{label:"标题"},{default:o(()=>{var K;return[k(M((K=C.value)==null?void 0:K.title),1)]}),_:1}),a(E,{label:"创建时间"},{default:o(()=>{var K;return[k(M((K=C.value)==null?void 0:K.insertTime),1)]}),_:1}),a(E,{label:"更新时间"},{default:o(()=>{var K;return[k(M((K=C.value)==null?void 0:K.updateTime),1)]}),_:1}),a(E,{label:"判题方式"},{default:o(()=>{var K;return[k(M((K=C.value)==null?void 0:K.judgeType),1)]}),_:1}),a(E,{label:"评测数据"},{default:o(()=>{var K;return[k(M((K=C.value)==null?void 0:K.judgeMd5),1)]}),_:1}),a(E,{label:"上传用户"},{default:o(()=>{var K;return[k(M((K=C.value)==null?void 0:K.creatorNickname),1)]}),_:1})]),_:1})])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),ro=Y(so,[["__scopeId","data-v-3be5c9c9"]]),St=[{name:"problem-list",tab:"problem",sidebar:"problem-list",path:"",title:"问题列表",icon:"cpu",component:yn},{name:"problem-detail",tab:"problem",sidebar:"problem-list",path:":problemId+",title:"问题详情",icon:"cpu",component:Tn},{name:"problem-recommend",tab:"problem",sidebar:"problem-recommend",path:"recommend/:problemId*",title:"问题推荐",icon:"cpu",component:xn},{name:"judge-list",tab:"judge",sidebar:"judge-list",path:"",title:"评测列表",icon:"cpu",component:zn},{name:"judge-detail",tab:"judge",sidebar:"judge-list",path:":judgeId+",title:"评测详情",icon:"cpu",component:Mn},{name:"contest-list",tab:"contest",sidebar:"contest-list",path:"",title:"比赛列表",icon:"cpu",component:fe},{name:"contest-recent",tab:"contest",sidebar:"contest-recent",path:"recent",title:"近期比赛",icon:"cpu",component:fe},{name:"contest-detail",tab:"contest-detail",sidebar:"contest-detail",path:":contestId+",title:"比赛详情",icon:"cpu",component:Xn},{name:"contest-problem",tab:"contest-detail",sidebar:"contest-problem",path:":contestId+/problem",title:"问题列表",icon:"cpu",component:fe},{name:"contest-judge",tab:"contest-detail",sidebar:"contest-judge",path:":contestId+/judge",title:"评测列表",icon:"cpu",component:fe},{name:"contest-rank",tab:"contest-detail",sidebar:"contest-rank",path:":contestId+/rank",title:"比赛排名",icon:"cpu",component:fe},{name:"contest-statistics",tab:"contest-detail",sidebar:"contest-statistics",path:":contestId+/statistics",title:"结果统计",icon:"cpu",component:fe},{name:"contest-discuss",tab:"contest-detail",sidebar:"contest-discuss",path:":contestId+/discuss",title:"比赛讨论",icon:"cpu",component:fe},{name:"manage-problem",tab:"manage",sidebar:"manage-problem",disableSidebar:!0,path:"problem/:problemId+",title:"问题编辑",icon:"cpu",component:ao,auths:[ye.ManageProblem]},{name:"manage-problem-judge",tab:"manage",sidebar:"manage-problem-judge",disableSidebar:!0,path:"problem/:problemId+/judge",title:"评测数据",icon:"cpu",component:ro,auths:[ye.ManageProblem]},{name:"manage-judge",tab:"manage",path:"judge",sidebar:"manage-judge",title:"评测管理",icon:"cpu",auths:["i-manage-judge"],component:Jn}],et=(e,t,n,s)=>{s.tab==n&&(s.disableSidebar&&t!=s.sidebar||s.sidebar==null||s.sidebar!=s.name||e.push({name:s.name,title:s.title,icon:s.icon,to:{name:s.name}}))},uo=(e,t)=>{const n=[];return St.forEach(s=>{if(ft(s)){const l=[];s.children.forEach(r=>{et(l,e,t,r)}),l.length>0&&n.push({title:s.title,children:l})}else et(n,e,t,s)}),n},tt=(e,t)=>{const n=Pa(t.tab),s={name:t.name,path:"/"+t.path,meta:{title:t.title+" - "+n.title,tab:t.tab,sidebar:t.sidebar,showSidebar:n.showSidebar,needLogin:n.needLogin||t.needLogin,tabAuths:n.auths,auths:t.auths},component:t.component};n.disablePath||(s.path=n.path+s.path),e.push(s)},io=e=>{St.forEach(t=>{ft(t)?t.children.forEach(n=>{tt(e,n)}):tt(e,t)})},Pe=[];xa(Pe);io(Pe);Pe.push({path:"/403",name:"403",component:_t});Pe.push({path:"/:pathMatch(.*)*",name:"404",component:mt});const X=Et({history:At("/"),routes:Pe});X.beforeEach((e,t,n)=>{if(e.name==null||!X.hasRoute(e.name)){n({name:"home"});return}const s=e.matched[e.matched.length-1].meta;if(s.redirect){n({name:s.redirect});return}if(s.needLogin){const r=pe();if(r.getToken==null||r.getToken==""){n({name:"login",query:{redirect_uri:e.fullPath}});return}}const l=s.tabAuths;if(l&&!pe().hasAllAuths(l)){n({name:"403",query:{target:e.fullPath}});return}n()});X.afterEach((e,t)=>{if(e.name===t.name)return;const n=qe(),s=Te();let l=null;if(e.matched.length>0&&(l=e.matched[e.matched.length-1].meta),l!=null&&l.title&&s.setTitle(l==null?void 0:l.title),l!=null&&l.showSidebar){n.setSidebarShow(!0);const r=uo(l==null?void 0:l.sidebar,l==null?void 0:l.tab);n.setMenuList(r),n.setMenuActiveName(l==null?void 0:l.sidebar)}else n.setSidebarShow(!1)});la.registerLanguage("verilog",sa);const Lt=Mt();Lt.use(Ht);const je=qt(tn);je.use(Lt);je.use(X);je.use(oa);je.use(Ut);je.mount("#app");ba().then(()=>{console.log("Text cache reinitialized")}).catch(e=>{console.error("Text cache reinitialization failed",e)});
