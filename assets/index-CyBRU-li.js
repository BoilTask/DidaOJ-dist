import{bm as Re,bn as kt,bo as G,s as a,bp as o,bq as T,br as R,ap as y,n as Z,r as _,bs as ae,bt as z,aD as ue,g as Ct,o as ee,bu as A,bv as St,bw as Lt,bx as Qe,F as Q,by as oe,bz as ne,aM as It,bA as Fe,bB as Ue,q as ye,y as De,J as ke,bC as et,c as ve,a0 as Tt,bD as Ee,u as Ke,bE as Ve,ac as Pt,bF as xt,bG as jt,bH as Vt,bI as $t,B as Rt,bJ as Dt}from"./node_modules-DPCfXZqM.js";import{R as pe,C as fe,a as le,B as M,F as Ce,b as Se,I as Le,L as Et,M as tt,c as at,S as zt,H as At,d as Mt,e as qt,f as _e,g as Ht,h as Ot,A as Ft,i as Ut,j as Nt,T as be,k as de,D as ze,l as Ae,m as nt,O as ot,P as Gt,n as lt,o as st,p as Kt,q as Bt,r as Xt,s as Wt,t as Yt,u as Jt,v as Zt}from"./tdesign-vue-next-DAz4yQNi.js";import{V as re}from"./vditor-DArazWIS.js";import{e as We}from"./monaco-editor-DCUKHC_e.js";import{H as Qt,v as ea}from"./highlight.js-D9zWiMxS.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const m of r.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&s(m)}).observe(document,{childList:!0,subtree:!0});function n(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerPolicy&&(r.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?r.credentials="include":l.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(l){if(l.ep)return;l.ep=!0;const r=n(l);fetch(l.href,r)}})();var he=(e=>(e.Manage="i-manage",e.ManageJudge="i-manage-judge",e.ManageProblem="i-manage-problem",e))(he||{});const ta={"r-admin":["i-manage","i-manage-judge","i-manage-problem"]};function aa(e){if(e==null)return[];const t=[];for(const n of e){const s=ta[n];s!=null&&t.push(...s)}return[...new Set(t)]}function na(e,t){if(e==null||t==null)return!1;const n=aa(e);for(const s of t)if(!n.includes(s))return!1;return!0}const ie=Re("user",{state:()=>({token:"",userId:-1,username:"",nickname:"",roles:[]}),getters:{getToken(){return this.token},getUserId(){return this.userId},getUsername(){return this.username},getNickname(){return this.nickname}},actions:{clear(){this.$patch({token:"",userId:-1,username:"",nickname:"",roles:[]})},loadResponse(e){this.$patch({token:e.token,userId:e.user_id,username:e.username,nickname:e.nickname,roles:e.roles})},isLogin(){return this.token!=null&&this.token!=""},hasAuth(e){return this.hasAllAuths([e])},hasAllAuths(e){return e?na(this.roles,e):!0}},persist:!0}),oa="https://oj-api.didapipa.com/",W=kt.create({baseURL:oa,timeout:6e4,withCredentials:!0,headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});W.interceptors.request.use(e=>{const n=ie().getToken;return n&&(e.headers["X-Token"]=n),e},e=>Promise.reject(e));W.interceptors.response.use(function(e){return e.data},function(e){return Promise.reject(e)});function la(e,t){return W({url:"/user/login",method:"post",data:{username:e,password:t}})}function sa(){return W({url:"/user/login/refresh",method:"post"})}const rt=Re("login",{state:()=>({Loaded:!1}),getters:{isLoaded(){return this.Loaded}}}),Ie=Re("webStyle",{state:()=>({title:""}),getters:{getTitle(){return this.title}},actions:{setTitle(e){this.title=e}}}),Me=Re("sidebarStyle",{state:()=>({showSidebar:!1,forceHiddenSidebar:!1,menuActiveName:"",menuList:[]}),getters:{getMenuList(){return this.menuList}},actions:{setSidebarShow(e){this.showSidebar=e},setForceHiddenSidebar(e){this.forceHiddenSidebar=e},setMenuActiveName(e){this.menuActiveName=e},clearMenuList(){this.menuList=[]},setMenuList(e){this.menuList=e},addMenuList(e){this.menuList.push(e)}}}),X=(e,t)=>{const n=e.__vccOpts||e;for(const[s,l]of t)n[s]=l;return n},ra={},ua={class:"sh-main"};function ia(e,t){const n=le,s=fe,l=pe;return T(),G("div",ua,[a(l,null,{default:o(()=>[a(s,{span:6},{default:o(()=>[a(n,{title:"正在完善，欢迎提供意见建议"},{default:o(()=>t[0]||(t[0]=[R("p",null,[R("a",{href:"https://codeoj.cn/",target:"_blank"},"CodeOJ"),y("的迁移计划")],-1),R("p",null,"正在开发中",-1)])),_:1})]),_:1})]),_:1})])}const ca=X(ra,[["render",ia],["__scopeId","data-v-78f609f9"]]),da={class:"sh-main"},ma=Z({__name:"View404",setup(e){let t=ae(),n=_(t.fullPath);return(s,l)=>{const r=M;return T(),G("div",da,[R("p",null,z(ue(n)),1),l[2]||(l[2]=R("p",null,"该页面无效或已被迁移，请重新选择访问目标",-1)),a(r,{theme:"primary",onClick:l[0]||(l[0]=()=>s.$router.push("/"))},{default:o(()=>l[1]||(l[1]=[y("返回首页")])),_:1})])}}}),ut=X(ma,[["__scopeId","data-v-d4218944"]]);let Ne=null;async function pa(){Ne=await _a()}function fa(e,t="zh"){if(Ne==null)return[!1,e.toString()];const n=Ne[e.toString()];if(!n)return[!1,e.toString()];let s=n[t];return s||(t="zh",s=n[t]),s?[!0,s]:[!1,e.toString()]}async function _a(){return new Promise((e,t)=>{e({404:{zh:"接口未找到"},1e3:{zh:"系统错误"},10001:{zh:"权限异常，请重新登陆后再试"},10002:{zh:"参数不符合要求"},10003:{zh:"未找到目标数据"},100001:{zh:"用户名不存在或密码不匹配"}})})}function te(){const{appContext:e}=Ct();return{globalProperties:e.config.globalProperties}}function we(){return 1e3}function it(e,t,n=3e3){e.$message.success({duration:n,content:t})}function ce(e,t,n=3e3){e.$message.info({duration:n,content:t})}function se(e,t,n=3e3){e.$message.error({duration:n,content:t})}function F(e,t,n=3e3){const[s,l]=fa(t),r=s?l:`系统错误，错误提示[${l}]`;e.$message.error({duration:n,content:r})}const ga={class:"dida-login-footer"},va=Z({__name:"LoginView",setup(e){const{globalProperties:t}=te(),n=ie(),s=_(!1),l=_({account:"",password:""}),r=()=>{ce(t,"重置成功")},m=({validateResult:P,firstError:S})=>{s.value||la(l.value.account,l.value.password).then(c=>{if(c.code===0){n.loadResponse(c.data),ce(t,"登录成功");let g=t.$route.query.redirect_uri;g||(g="/user/"+c.data.username),t.$router.push({path:g})}else F(t,c.code)}).catch(c=>{console.error("Login error",c),se(t,"登录失败")})};return ee(()=>{if(n.isLogin()){t.$router.push({path:"/user"});return}}),(P,S)=>{const c=Le,g=Se,v=M,k=Ce,w=Et,D=le;return T(),A(D,{class:"yj-login-card",title:"欢迎使用DidaOJ~"},{default:o(()=>[a(k,{ref:"form",data:l.value,colon:!0,onReset:r,onSubmit:m,class:"yj-login-form","label-width":0},{default:o(()=>[a(g,{name:"account"},{default:o(()=>[a(c,{modelValue:l.value.account,"onUpdate:modelValue":S[0]||(S[0]=V=>l.value.account=V),clearable:"",placeholder:"请输入账户名"},{"prefix-icon":o(()=>[a(ue(St))]),_:1},8,["modelValue"])]),_:1}),a(g,{name:"password"},{default:o(()=>[a(c,{modelValue:l.value.password,"onUpdate:modelValue":S[1]||(S[1]=V=>l.value.password=V),type:"password",clearable:"",placeholder:"请输入密码"},{"prefix-icon":o(()=>[a(ue(Lt))]),_:1},8,["modelValue"])]),_:1}),a(g,null,{default:o(()=>[a(v,{theme:"primary",type:"submit",block:"",loading:s.value},{default:o(()=>S[2]||(S[2]=[y("登录")])),_:1},8,["loading"])]),_:1})]),_:1},8,["data"]),R("div",ga,[a(w,null,{default:o(()=>S[3]||(S[3]=[y("忘记密码")])),_:1}),a(w,null,{default:o(()=>S[4]||(S[4]=[y("注册账户")])),_:1})])]),_:1})}}}),ha=X(va,[["__scopeId","data-v-bb5469c5"]]),ba={};function ya(e,t){return" TODO "}const wa=X(ba,[["render",ya]]),Be=[{name:"home",path:"/",title:"首页",showSidebar:!1,disableGenerateTab:!0,component:ca},{name:"problem",path:"/problem",title:"题目",icon:"dashboard",showSidebar:!0,redirect:"problem-list"},{name:"judge",path:"/judge",title:"评测",icon:"dashboard",showSidebar:!0,redirect:"judge-list"},{name:"contest",path:"/contest",title:"比赛",icon:"dashboard",showSidebar:!0,redirect:"contest-list"},{name:"contest-detail",title:"比赛",path:"/contest",showSidebar:!0,disableGenerateTab:!0,redirect:"contest-list"},{name:"manage",path:"/manage",title:"管理",icon:"dashboard",showSidebar:!0,redirect:"manage-judge",auths:[he.Manage]},{name:"login",path:"/login",title:"登陆",showSidebar:!1,disableGenerateTab:!0,component:ha},{name:"user",path:"/user/:username+",title:"用户",showSidebar:!1,needLogin:!0,disableGenerateTab:!0,component:wa},{name:"404",path:"/404",title:"404",showSidebar:!1,disableGenerateTab:!0,component:ut}],ka=e=>Be.find(t=>t.name==e),Ca=e=>{const t=[];return Be.forEach(n=>{!n.disableGenerateTab&&e.hasAllAuths(n.auths)&&t.push(n)}),t},Sa=e=>{Be.forEach(t=>{const n={name:t.name,path:t.path,meta:{title:t.title,tab:t.name,showSidebar:t.showSidebar,needLogin:t.needLogin,redirect:t.redirect,tabAuths:t.auths},component:t.component};e.push(n)})},La=Z({__name:"HeaderContent",setup(e){const t=rt(),n=ie(),{globalProperties:s}=te(),l=_(t.isLoaded),r=_(!1),m=_(n.getUsername),P=_(n.getNickname),S=_(),c=()=>{S.value=Ca(n)};t.$subscribe((k,w)=>{l.value=w.Loaded}),n.$subscribe((k,w)=>{m.value=w.username,P.value=w.nickname,r.value=w.token!="",c()});const g=()=>{s.$router.currentRoute.value.name!=="login"&&s.$router.push({name:"login",query:{redirect_uri:s.$router.currentRoute.value.fullPath}})},v=()=>{n.clear(),s.$message.success({duration:3e3,content:"注销成功"}),s.$router.push({path:"/login",query:{redirect_uri:s.$router.currentRoute.value.fullPath}})};return ee(()=>{c()}),(k,w)=>{const D=Qe("router-link"),V=at,E=tt,j=zt,q=At;return T(),A(q,{modelValue:k.$route.meta.tab,"onUpdate:modelValue":w[0]||(w[0]=b=>k.$route.meta.tab=b),class:"sh-menu","expand-type":"popup"},{logo:o(()=>[a(D,{to:"/",class:"sh-logo"},{default:o(()=>w[1]||(w[1]=[y("DidaOJ")])),_:1})]),operations:o(()=>[l.value&&r.value?(T(),A(j,{key:0,title:P.value},{icon:o(()=>[a(V,{name:"user"})]),default:o(()=>[a(E,{value:"user",to:{path:"/user/"+m.value}},{default:o(()=>w[2]||(w[2]=[y("个人空间")])),_:1},8,["to"]),a(E,{value:"user_logout",onClick:v},{default:o(()=>w[3]||(w[3]=[y(" 注销")])),_:1})]),_:1},8,["title"])):l.value?(T(),A(E,{key:2,value:"login",onClick:g},{icon:o(()=>[a(V,{name:"login"})]),default:o(()=>[w[5]||(w[5]=y(" 登录 "))]),_:1})):(T(),A(E,{key:1,value:"login"},{icon:o(()=>[a(V,{name:"login"})]),default:o(()=>[w[4]||(w[4]=y(" ... "))]),_:1}))]),default:o(()=>[(T(!0),G(Q,null,oe(S.value,b=>(T(),A(E,{key:b.name,value:b.name,to:{name:b.name}},{icon:o(()=>[b.icon?(T(),A(V,{key:0,name:b.icon},null,8,["name"])):ne("",!0)]),default:o(()=>[y(" "+z(b.title),1)]),_:2},1032,["value","to"]))),128))]),_:1},8,["modelValue"])}}}),Ia=X(La,[["__scopeId","data-v-a4891d9b"]]);function ct(e){return e.children!==void 0}function Ta(e){return e.children!==void 0}const Pa={id:"menu-container"},xa=Z({__name:"SidebarContent",setup(e){const t=Me(),n=_(!1),s=_(null),l=_(t.menuActiveName),r=_(t.menuList),m=_([]),P=_(!1),S=()=>{l.value=t.menuActiveName;const g=JSON.stringify(r.value),v=JSON.stringify(t.menuList);g!==v&&(m.value.push([...t.menuList]),c())},c=async()=>{if(m.value.length>0&&!P.value){for(P.value=!0;m.value.length>1;)m.value.shift();const g=m.value.shift();n.value=g.length<=0,r.value=[],await ye(),s.value&&s.value.updateActiveName(),await new Promise(k=>setTimeout(k,300)),r.value=g,await ye(),s.value&&s.value.updateActiveName();const v=300;await new Promise(k=>setTimeout(k,v)),P.value=!1,await c()}};return t.$subscribe((g,v)=>{S()}),ee(()=>{S()}),(g,v)=>{const k=at,w=tt,D=qt,V=Mt,E=_e;return T(),G(Q,null,[R("div",Pa,[a(V,{modelValue:l.value,"onUpdate:modelValue":v[0]||(v[0]=j=>l.value=j),theme:"light",class:"sh-menu-container"},{default:o(()=>[a(It,{name:"move-left"},{default:o(()=>[(T(!0),G(Q,null,oe(r.value,(j,q)=>(T(),G(Q,{key:q},[ue(Ta)(j)?(T(),A(D,{key:0,title:j.title},{default:o(()=>[(T(!0),G(Q,null,oe(j.children,(b,C)=>(T(),A(w,{key:b.name,value:b.name,to:b.to},Fe({default:o(()=>[y(" "+z(b.title),1)]),_:2},[b.icon?{name:"icon",fn:o(()=>[a(k,{name:b.icon,class:Ue(b.iconClass)},null,8,["name","class"])]),key:"0"}:void 0]),1032,["value","to"]))),128))]),_:2},1032,["title"])):(T(),A(w,{key:j.name,value:j.name,to:j.to},Fe({default:o(()=>[y(" "+z(j.title),1)]),_:2},[j.icon?{name:"icon",fn:o(()=>[a(k,{name:j.icon,class:Ue(j.iconClass)},null,8,["name","class"])]),key:"0"}:void 0]),1032,["value","to"]))],64))),128))]),_:1})]),_:1},8,["modelValue"])]),a(E,{size:"small",loading:n.value,"show-overlay":!0,attach:"#menu-container",class:"sh-sidebar-loading",style:{"align-items":"flex-start","padding-top":"100px"}},null,8,["loading"])],64)}}}),ja=X(xa,[["__scopeId","data-v-96e2d89f"]]),Va={};function $a(e,t){return null}const Ra=X(Va,[["render",$a]]),Da={class:"footer"},Ea={class:"footer-left"},za={class:"foot-time"},Aa={class:"footer-center"},Ma={href:"https://boiltask.com",target:"_blank"},qa={class:"footer-right"},Ha={class:"foot-text"},Oa={href:"https://github.com/hpu-user/DiDaOJ-web",target:"_blank"},Fa=Z({__name:"FooterContent",setup(e){const t=_("");function n(){t.value=new Date().toLocaleString()}return ee(()=>{n(),setInterval(()=>{n()},1e3)}),(s,l)=>{const r=M;return T(),G("div",Da,[R("div",Ea,[R("p",za,z(t.value),1)]),R("div",Aa,[R("a",Ma,[a(r,{theme:"default",variant:"outline",ghost:!0},{default:o(()=>l[0]||(l[0]=[y("@BoilTask")])),_:1})])]),R("div",qa,[R("p",Ha,[R("a",Oa,[a(r,{theme:"default",variant:"outline",ghost:!0},{default:o(()=>l[1]||(l[1]=[y("@didaoj-web")])),_:1})])])])])}}}),Ua=X(Fa,[["__scopeId","data-v-400ac98b"]]),xe=20,He=100,Oe=50,Na=Z({__name:"ForceHiddenSidebarButton",setup(e){let t=Me();const n=_({x:window.innerWidth-He-xe,y:window.innerHeight-Oe-xe}),s=_(window.innerWidth),l=_(window.innerHeight);let r=!1,m={x:0,y:0};const P=j=>{r=!0;const q=j.clientX??j.touches[0].clientX,b=j.clientY??j.touches[0].clientY;m={x:q-n.value.x,y:b-n.value.y},document.addEventListener("mousemove",S),document.addEventListener("touchmove",S),document.addEventListener("mouseup",c),document.addEventListener("touchend",c)},S=j=>{if(!r)return;const q=j.clientX??j.touches[0].clientX,b=j.clientY??j.touches[0].clientY;let C=q-m.x,x=b-m.y;C=Math.max(0,Math.min(C,s.value-He)),x=Math.max(0,Math.min(x,l.value-Oe)),n.value={x:C,y:x}},c=()=>{r=!1,document.removeEventListener("mousemove",S),document.removeEventListener("touchmove",S),document.removeEventListener("mouseup",c),document.removeEventListener("touchend",c)},g=()=>{s.value=window.innerWidth,l.value=window.innerHeight,n.value={x:Math.min(n.value.x,s.value-He-xe),y:Math.min(n.value.y,l.value-Oe-xe)}};let v=_(t.forceHiddenSidebar),k=_(t.forceHiddenSidebar);const w=()=>{v.value=!v.value,t.setForceHiddenSidebar(v.value)},D=()=>{k.value||(k.value=!0,t.setForceHiddenSidebar(v.value))},V=()=>{k.value&&(k.value=!1,t.setForceHiddenSidebar(!1))},E=j=>{j>=800?V():D()};return E(s.value),De(s,j=>{E(j)}),ee(()=>{window.addEventListener("resize",g)}),ke(()=>{window.removeEventListener("resize",g)}),(j,q)=>{const b=M;return ue(k)?(T(),A(b,{key:0,class:"draggable-button",style:et({top:`${n.value.y}px`,left:`${n.value.x}px`}),onMousedown:P,onTouchstart:P,variant:"dashed",theme:"primary",onClick:w},{default:o(()=>[y(z(ue(v)?"显示":"隐藏"),1)]),_:1},8,["style"])):ne("",!0)}}}),Ga=X(Na,[["__scopeId","data-v-1aee5506"]]),Ka={class:"sh-main"},Ba=Z({__name:"View403",setup(e){let t=ae();const n=_("");return ee(()=>{t.query.target?n.value=t.query.target:n.value=t.fullPath}),(s,l)=>{const r=M;return T(),G("div",Ka,[R("p",null,z(n.value),1),l[2]||(l[2]=R("p",null,"该页面无访问权限，请更换访问目标或重新登陆后再试",-1)),a(r,{theme:"primary",onClick:l[0]||(l[0]=()=>s.$router.push("/"))},{default:o(()=>l[1]||(l[1]=[y("返回首页")])),_:1})])}}}),dt=X(Ba,[["__scopeId","data-v-8f62f1f8"]]),je="DidaOJ",Xa=Z({__name:"App",setup(e){const{globalProperties:t}=te(),n=rt(),s=ie(),l=Ie(),r=Me();n.$patch({Loaded:!1});const m=s.getToken,P=_(!1),S=_(!1);l.title&&l.title.length>0?document.title=l.title+" - "+je:document.title=je,l.$subscribe((k,w)=>{w.title&&w.title.length>0?document.title=w.title+" - "+je:document.title=je}),r.$subscribe((k,w)=>{P.value=w.showSidebar,S.value=P.value&&!w.forceHiddenSidebar});const c=ae(),g=ve(()=>{const k=c.meta.auths;return k?!s.hasAllAuths(k):!1});function v(){t.$message.warning({duration:3e3,content:"登陆状态失效"}),n.$patch({Loaded:!0}),s.clear()}return ee(()=>{if(m==""){n.$patch({Loaded:!0});return}sa().then(k=>{k.code==0?(s.loadResponse(k.data),n.$patch({Loaded:!0})):(F(t,k.code),n.$patch({Loaded:!0}),s.clear())}).catch(k=>{console.log(k),v()})}),(k,w)=>{const D=Ht,V=Ft,E=Qe("RouterView"),j=Ut,q=Ot,b=Nt;return T(),G(Q,null,[a(q,null,{default:o(()=>[a(D,{class:"sh-header"},{default:o(()=>[a(Ia)]),_:1}),a(q,null,{default:o(()=>[a(Tt,{name:"slide"},{default:o(()=>[S.value?(T(),A(V,{key:0,class:"sh-sidebar"},{default:o(()=>[a(ja)]),_:1})):ne("",!0)]),_:1}),a(q,{class:Ue(["sh-main-layout",{expanded:!S.value}])},{default:o(()=>[a(Ra),a(j,{class:"sh-main-content"},{default:o(()=>[g.value?(T(),A(dt,{key:0})):(T(),A(E,{key:1}))]),_:1}),a(Ua)]),_:1},8,["class"])]),_:1})]),_:1}),P.value?(T(),A(Ga,{key:0})):ne("",!0),a(b,{container:"body",offset:["24px","80px"],size:"small"})],64)}}}),Wa=X(Xa,[["__scopeId","data-v-3cab4566"]]);var mt=(e=>(e[e.Unknown=-1]="Unknown",e[e.C=0]="C",e[e.Cpp=1]="Cpp",e[e.Java=2]="Java",e[e.Python=3]="Python",e[e.Pascal=4]="Pascal",e[e.Golang=5]="Golang",e[e.Max=6]="Max",e))(mt||{});function pt(){const e=[-1,4,5,6];return Object.values(mt).filter(t=>typeof t=="number"&&!e.includes(t)).map(t=>({value:t,label:ft(t)}))}function Ya(e){return e>-1&&e<6}function ft(e){switch(e){case 0:return"C";case 1:return"C++";case 2:return"Java";case 3:return"Python";case 4:return"Pascal";case 5:return"Golang";default:return"Unknown"}}function _t(e){switch(e){case 0:return"c";case 1:return"cpp";case 2:return"java";case 3:return"python";case 4:return"pascal";case 5:return"golang";default:return"text"}}var K=(e=>(e[e.Init=0]="Init",e[e.Rejudge=1]="Rejudge",e[e.Submitting=2]="Submitting",e[e.Queuing=3]="Queuing",e[e.Compiling=4]="Compiling",e[e.Running=5]="Running",e[e.Accept=6]="Accept",e[e.PE=7]="PE",e[e.WA=8]="WA",e[e.TLE=9]="TLE",e[e.MLE=10]="MLE",e[e.OLE=11]="OLE",e[e.RE=12]="RE",e[e.CE=13]="CE",e[e.CLE=14]="CLE",e[e.JudgeFail=15]="JudgeFail",e[e.SubmitFail=16]="SubmitFail",e[e.Unknown=17]="Unknown",e))(K||{});const Ja=e=>{switch(e){case 0:return"普通评测";case 1:return"特殊评测";default:return"未知"}},$e=e=>{switch(e){case 0:return"等待处理";case 1:return"重新评测";case 2:return"提交中";case 3:return"队列中";case 4:return"编译中";case 5:return"运行中";case 6:return"通过";case 7:return"格式错误";case 8:return"答案错误";case 9:return"超时";case 10:return"内存超限";case 11:return"输出超限";case 12:return"运行错误";case 13:return"编译错误";case 14:return"编译超限";case 15:return"评测失败";case 16:return"提交失败";case 17:return"未知";default:return e}};function Za(){const e=[17];return Object.values(K).filter(t=>typeof t=="number"&&!e.includes(t)).map(t=>({value:t,label:$e(t)}))}function ge(e){switch(e){case 0:case 1:case 2:case 3:case 4:case 5:return!0;default:return!1}}function gt(e){var n;const t={};if(t.id=e.id,t.problemId=e.problem_id,t.status=e.status,ge(e.status)?t.score="-":t.score=e.score.toString(),e.time?t.time=Math.ceil(e.time/1e6)+"ms":t.time="-",e.memory?t.memory=(e.memory/1024/1024).toFixed(2)+"MB":t.memory="-",t.language=ft(e.language),t.codeLength=e.code_length,e.approve_time?t.approveTime=new Date(e.approve_time).toLocaleString():t.approveTime="-",t.author=e.author,t.authorUsername=e.author_username,t.authorNickname=e.author_nickname,t.code=e.code,t.compileMessage=e.compile_message,t.taskCurrent=e.task_current,t.taskTotal=e.task_total,t.task=[],e.task)for(let s=0;s<((n=e.task)==null?void 0:n.length);s++){const l=e.task[s],r={};r.taskId=l.task_id,r.status=l.status,l.time?r.time=Math.ceil(l.time/1e6)+"ms":r.time="-",l.memory?r.memory=(l.memory/1024/1024).toFixed(2)+"MB":r.memory="-",r.score=l.score,r.content=l.content,r.waHint=l.wa_hint,!r.content&&!r.waHint&&(r.content="无提示信息"),t.task.push(r)}return t}function Qa(e,t,n){return W({url:"/judge/approve",method:"post",data:{problem_id:e,language:t,code:n}})}function en(e){return W({url:"/judge?id="+e,method:"get"})}function tn(e,t,n,s,l,r){const m=new URLSearchParams({problem_id:e,username:t,language:String(n),status:String(s),page:String(l),page_size:String(r)});return W({url:`/judge/list?${m.toString()}`,method:"get"})}function an(){return W({url:"/judge/rejudge/recently",method:"post"})}function nn(){return W({url:"/judge/rejudge/all",method:"post",timeout:0})}function on(e){return W({url:"/judge/rejudge",method:"post",data:{id:e}})}var Ge=(e=>(e[e.None=0]="None",e[e.Attempt=1]="Attempt",e[e.Accept=2]="Accept",e))(Ge||{});function qe(e,t){const n={};if(n.id=e.id,n.author=e.author,n.title=e.title,n.tags=[],e.tags)for(const s of e.tags){const l=t[s];l&&n.tags.push(l)}return n.accept=e.accept,n.attempt=e.attempt,e.description!=null&&(n.description=e.description),e.time_limit!=null&&(n.timeLimit=e.time_limit.toString()+" ms"),e.memory_limit!=null&&(n.memoryLimit=(e.memory_limit/1024).toFixed(2)+" MB"),e.judge_type!=null&&(n.judgeType=Ja(e.judge_type)),e.insert_time!=null&&(n.insertTime=new Date(e.insert_time).toLocaleString()),e.update_time!=null&&(n.updateTime=new Date(e.update_time).toLocaleString()),e.creator_nickname!=null&&(n.creatorNickname=e.creator_nickname),e.source!=null&&(n.source=e.source),e.judge_md5!=null&&(n.judgeMd5=e.judge_md5),n}function vt(e){return W({url:"/problem?id="+e,method:"get"})}function ht(e){return W({url:"/problem/tag/list?max_count="+e,method:"get"})}function ln(e){return W({url:"/problem/judge?id="+e,method:"get"})}function sn(e,t,n,s){return W({url:"/problem/list?title="+e+"&tag="+t+"&page="+n+"&page_size="+s,method:"get"})}function rn(e,t,n,s,l,r,m){return W({url:"/problem/edit",method:"post",data:{id:e,title:t,time_limit:n,memory_limit:s,source:l,tags:r,description:m}})}function un(e,t){return W({url:"/problem/judge/data/download?id="+e+"&key="+t,method:"get"})}function cn(e,t){const n=new FormData;return n.append("id",e),n.append("zip",t),W({url:"/problem/judge/data",method:"post",data:n,headers:{"Content-Type":"multipart/form-data"},timeout:1e3*60*5})}const dn={style:{margin:"10px"}};function mn(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ke(e)}const pn=Z({__name:"ProblemList",setup(e){const t=ae(),n=Ee(),{globalProperties:s}=te();let l=null;const r=_(!1),m={};let P={};const S=_([{title:"ID",colKey:"id",cell:(i,u)=>{let d=j(u.row.id);return a(M,{variant:"dashed",theme:d,onClick:()=>E(u.row.id)},{default:()=>[u.row.id]})}},{title:"标题",colKey:"title",cell:(i,u)=>a(M,{variant:"text",onClick:()=>E(u.row.id)},{default:()=>[u.row.title]})},{title:"标签",colKey:"tags",cell:(i,u)=>{const d=u.row.tags;if(!d||d.length===0)return"";let h=[];for(let f=0;f<d.length;f++){const p=d[f];h.push(a(M,{key:f,theme:"default",variant:"outline"},{default:()=>[p.name]}))}return a(de,null,mn(h)?h:{default:()=>[h]})}},{title:"正确",colKey:"accept"},{title:"提交",colKey:"attempt"}]),c=_(!1);let g=1,v=50;const k=_({defaultPageSize:v,defaultCurrent:g,total:0,pageSizeOptions:[50,100]}),w=_(),D=_(),V=_({title:"",tag:""}),E=i=>{i&&n.push({path:"/problem/"+i})},j=i=>{if(!i||!P)return"default";const u=P[i];if(!u)return"default";switch(u){case Ge.Accept:return"success";case Ge.Attempt:return"warning";default:return"default"}},q=async()=>{await n.push({query:{...t.query,title:V.value.title,tag:V.value.tag,page:1,page_size:k.value.defaultPageSize}})},b=i=>{i&&n.push({query:{...t.query,title:"",tag:i.name,page:1,page_size:k.value.defaultPageSize}})},C=async(i,u)=>{c.value=!0;try{const{current:d,pageSize:h}=i,f=await sn(V.value.title,V.value.tag,d,h);if(w.value=[],f.code===0){const p=f.data.list;if(!p||p.length<=0){k.value={...k.value,total:0},P=null,ce(s,"未找到记录");return}p.forEach(I=>{var U;const $=qe(I,m);(U=w.value)==null||U.push($)}),k.value={...k.value,total:f.data.total_count},P=f.data.problem_attempt_status}else u&&F(s,f.code)}catch(d){console.error(d),F(s,we())}finally{c.value=!1}},x=async i=>{await n.push({query:{...t.query,page:i.current,page_size:i.pageSize}})};return ee(async()=>{c.value=!0,D.value=[],ht(-1).then(i=>{if(i.code===0){D.value=i.data.list,r.value=i.data.total_count>i.data.list.length;for(let u=0;u<i.data.list.length;u++){const d=i.data.list[u];m[d.id]=d}l=De(()=>t.query,u=>{V.value.title=u.title||"",V.value.tag=u.tag||"";const d=parseInt(u.page)||k.value.defaultCurrent,h=parseInt(u.page_size)||k.value.defaultPageSize;g=d,v=h,k.value={...k.value,current:g,pageSize:v},C({current:g,pageSize:v},!0)},{immediate:!0})}else r.value=!0}).catch(i=>{console.error(i),r.value=!0})}),ke(()=>{l&&l()}),(i,u)=>{const d=be,h=le,f=fe,p=Le,I=Se,$=M,U=Ce,Y=pe;return T(),A(Y,null,{default:o(()=>[a(f,{span:9},{default:o(()=>[a(h,{style:{margin:"10px"}},{default:o(()=>[a(d,{data:w.value,columns:S.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:k.value,loading:c.value,onPageChange:x},null,8,["data","columns","pagination","loading"])]),_:1})]),_:1}),a(f,{span:3},{default:o(()=>[R("div",dn,[a(h,{class:"sh-card"},{default:o(()=>[a(U,{model:V.value},{default:o(()=>[a(I,{label:"标题"},{default:o(()=>[a(p,{modelValue:V.value.title,"onUpdate:modelValue":u[0]||(u[0]=O=>V.value.title=O),placeholder:"暂不支持模糊查询"},null,8,["modelValue"])]),_:1}),a(I,{label:"标签"},{default:o(()=>[a(p,{modelValue:V.value.tag,"onUpdate:modelValue":u[1]||(u[1]=O=>V.value.tag=O),placeholder:"暂不支持模糊查询"},null,8,["modelValue"])]),_:1}),a(I,null,{default:o(()=>[a($,{theme:"primary",onClick:q},{default:o(()=>u[3]||(u[3]=[y("搜索")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(h,{class:"sh-card sh-background-black"},{default:o(()=>[(T(!0),G(Q,null,oe(D.value,O=>(T(),A($,{class:"sh-tag-button",theme:"default",variant:"outline",ghost:!0,onClick:()=>b(O)},{default:o(()=>[y(z(O.name),1)]),_:2},1032,["onClick"]))),256)),r.value?(T(),A($,{key:0,class:"sh-tag-button",theme:"default",variant:"outline",ghost:!0,onClick:u[2]||(u[2]=()=>i.$router.push("/problem/tags"))},{default:o(()=>u[4]||(u[4]=[y(" ... ")])),_:1})):ne("",!0)]),_:1})])]),_:1})]),_:1})}}}),fn=X(pn,[["__scopeId","data-v-6d4b777e"]]);function Xe(e){e.querySelectorAll("pre > code:not([data-copy-attached])").forEach(n=>{n.setAttribute("data-copy-attached","true");const s=n.parentElement,l=document.createElement("div");l.className="copy-wrapper";const r=document.createElement("button");r.className="copy-btn",r.innerText="复制",r.addEventListener("click",async()=>{try{await navigator.clipboard.writeText(n.innerText),r.innerText="已复制",setTimeout(()=>r.innerText="复制",1500)}catch{r.innerText="失败"}}),s.replaceWith(l),l.appendChild(r),l.appendChild(s)})}const _n=["innerHTML"],gn={style:{margin:"12px"}},vn={key:0,class:"dida-edit-container"},hn={class:"dida-operation-container"},bn={class:"dida-code-submit-div"},yn=Z({__name:"ProblemDetail",setup(e){let t=ae();const{globalProperties:n}=te(),s=Ie(),l=ie();let r=_("");const m=_(""),P=_(null),S=_(!1),c=_(null);let g=null;const v=_(null),k={},w=_(""),D=_([]);D.value=pt();const V=ve(()=>l.hasAuth(he.ManageProblem)),E=u=>{u&&N.push({name:"problem-list",query:{...t.query,title:"",tag:u.name}})},j=()=>{N.push({name:"manage-problem",params:{problemId:m.value}})},q=()=>{N.push({name:"judge-list",query:{problem_id:m.value}})},b=()=>{},C=()=>{N.push({name:"problem-recommend",params:{problemId:m.value}})},x=async()=>{if(!m.value){se(n,"问题ID无效");return}const u=parseInt(w.value);if(!Ya(u)){se(n,"请选择所编写的语言");return}const d=g==null?void 0:g.getValue();if(!d){se(n,"请输入所需提交的代码");return}const h=await Qa(m.value,u,d);if(h.code!==0){F(n,h.code);return}ce(n,"提交成功，正在跳转到详情页面");const f=h.data.id;await N.push({path:"/judge/"+f})},i=u=>{g&&We.setModelLanguage(g.getModel(),_t(u))};return ee(async()=>{if(Array.isArray(t.params.problemId)?m.value=t.params.problemId[0]:m.value=t.params.problemId,!m.value){se(n,"题目不存在"),await N.push({name:"problem"});return}S.value=!0;const u=await vt(m.value);if(u.code!==0){S.value=!1,F(n,u.code),await N.push({name:"problem"});return}u.data.tags&&u.data.tags.forEach(f=>{k[f.id]=f}),c.value=qe(u.data.problem,k),s.setTitle(c.value.title+" - "+s.getTitle);let d=c.value.description;const h={math:{inlineDigit:!0,engine:"KaTeX"}};r.value=await re.md2html(d,h),await ye(()=>{P.value&&(re.mathRender(P.value),re.highlightRender({lineNumber:!0,enable:!0},P.value),Xe(P.value),v.value&&(g=We.create(v.value,{value:"",language:"cpp",minimap:{enabled:!0},colorDecorators:!0,readOnly:!1,theme:"vs-dark"}))),S.value=!1})}),(u,d)=>{const h=le,f=fe,p=M,I=Ae,$=de,U=ze,Y=ot,O=nt,H=pe,B=_e;return T(),A(B,{loading:S.value},{default:o(()=>[a(H,{class:"dida-main-content"},{default:o(()=>[a(f,{span:8},{default:o(()=>[a(h,{style:{margin:"10px"}},{default:o(()=>[R("div",{innerHTML:ue(r),ref_key:"markdownRef",ref:P},null,8,_n)]),_:1})]),_:1}),a(f,{span:4},{default:o(()=>[R("div",gn,[V.value?(T(),G("div",vn,[a(p,{onClick:j},{default:o(()=>d[1]||(d[1]=[y("编辑")])),_:1})])):ne("",!0),a(U,{layout:"vertical",bordered:!0},{default:o(()=>[a(I,{label:"标题"},{default:o(()=>{var L;return[y(z((L=c.value)==null?void 0:L.title),1)]}),_:1}),a(I,{label:"时间限制"},{default:o(()=>{var L;return[y(z((L=c.value)==null?void 0:L.timeLimit),1)]}),_:1}),a(I,{label:"内存限制"},{default:o(()=>{var L;return[y(z((L=c.value)==null?void 0:L.memoryLimit),1)]}),_:1}),a(I,{label:"判题方式"},{default:o(()=>{var L;return[y(z((L=c.value)==null?void 0:L.judgeType),1)]}),_:1}),a(I,{label:"正确提交"},{default:o(()=>{var L;return[y(z((L=c.value)==null?void 0:L.accept),1)]}),_:1}),a(I,{label:"提交总数"},{default:o(()=>{var L;return[y(z((L=c.value)==null?void 0:L.attempt),1)]}),_:1}),a(I,{label:"创建时间"},{default:o(()=>{var L;return[y(z((L=c.value)==null?void 0:L.insertTime),1)]}),_:1}),a(I,{label:"更新时间"},{default:o(()=>{var L;return[y(z((L=c.value)==null?void 0:L.updateTime),1)]}),_:1}),a(I,{label:"上传用户"},{default:o(()=>{var L;return[y(z((L=c.value)==null?void 0:L.creatorNickname),1)]}),_:1}),a(I,{label:"题目来源"},{default:o(()=>{var L;return[y(z((L=c.value)==null?void 0:L.source),1)]}),_:1}),a(I,{label:"标签"},{default:o(()=>[a($,null,{default:o(()=>{var L;return[(T(!0),G(Q,null,oe((L=c.value)==null?void 0:L.tags,J=>(T(),A(p,{key:J.id,variant:"dashed",onClick:()=>E(J)},{default:o(()=>[y(z(J.name),1)]),_:2},1032,["onClick"]))),128))]}),_:1})]),_:1})]),_:1}),R("div",hn,[a($,null,{default:o(()=>[a(p,{onClick:q},{default:o(()=>d[2]||(d[2]=[y("提交记录")])),_:1}),a(p,{onClick:b},{default:o(()=>d[3]||(d[3]=[y("题目讨论")])),_:1}),a(p,{onClick:C},{default:o(()=>d[4]||(d[4]=[y("题目推荐")])),_:1})]),_:1})]),R("div",bn,[a($,null,{default:o(()=>[a(O,{modelValue:w.value,"onUpdate:modelValue":d[0]||(d[0]=L=>w.value=L),label:"语言：",placeholder:"请选择提交语言","auto-width":"",clearable:"",onChange:i},{default:o(()=>[(T(!0),G(Q,null,oe(D.value,L=>(T(),A(Y,{key:L.value,value:L.value,label:L.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"]),a(p,{onClick:x},{default:o(()=>d[5]||(d[5]=[y("提交")])),_:1})]),_:1}),R("div",{ref_key:"codeEditRef",ref:v,class:"dida-code-editor"},null,512)])])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),wn=X(yn,[["__scopeId","data-v-6e73045f"]]),kn={};function Cn(e,t){return" TODO "}const Sn=X(kn,[["render",Cn]]);function Ln(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ke(e)}const In=Z({__name:"JudgeJobList",setup(e){const t=ae(),n=Ee(),{globalProperties:s}=te();let l=!1,r=null;const m=_({problemId:"",username:"",language:void 0,status:void 0}),P=_([{title:"ID",colKey:"id",cell:(i,u)=>a(M,{variant:"text",onClick:()=>E(u.row.id)},{default:()=>[u.row.id]})},{title:"问题",colKey:"problemId",cell:(i,u)=>a(M,{variant:"text",onClick:()=>V(u.row.problemId)},{default:()=>[u.row.problemId]})},{title:"状态",colKey:"status",align:"center",cell:(i,u)=>{const d=u.row.status,h=$e(d);let f;switch(d){case K.Init:case K.Rejudge:case K.Compiling:case K.Running:f="default";break;case K.Accept:f="success";break;case K.PE:f="warning";break;default:f="danger";break}let p=[];return ge(d)&&p.push(a(_e,{text:u.row.state,size:"small",class:"dida-status-loading"},null)),p.push(a("span",null,[h])),a(M,{theme:f,variant:"outline",onClick:()=>E(u.row.id)},Ln(p)?p:{default:()=>[p]})}},{title:"分数",colKey:"score"},{title:"时间",colKey:"time"},{title:"内存",colKey:"memory"},{title:"代码",colKey:"code",cell:(i,u)=>a(M,{theme:"default",onClick:()=>E(u.row.id)},{default:()=>[u.row.language+" / "+u.row.codeLength]})},{title:"作者",colKey:"author",width:200,cell:(i,u)=>a(M,{variant:"text",onClick:()=>j(u.row.authorUsername)},{default:()=>[u.row.authorNickname]})},{title:"提交时间",colKey:"approveTime",width:180}]),S=_(!1);let c=1,g=50;const v=_({current:c,pageSize:g,defaultCurrent:c,defaultPageSize:g,total:0,pageSizeOptions:[50,100]}),k=_(),w=_([]);w.value=pt();const D=_([]);D.value=Za();const V=i=>{i&&n.push({path:"/problem/"+i})},E=i=>{i&&n.push({path:"/judge/"+i})},j=i=>{i&&n.push({path:"/user/"+i})},q=async()=>{await n.push({query:{...t.query,page:1,page_size:g,problem_id:m.value.problemId,username:m.value.username,language:m.value.language,status:m.value.status}})},b=async()=>{m.value.problemId="",m.value.username="",m.value.language=void 0,m.value.status=void 0,await n.push({query:{...t.query,page:1,page_size:g,problem_id:"",username:"",language:void 0,status:void 0}})},C=async(i,u)=>{u&&(S.value=!0);let d=!1;try{const{current:h,pageSize:f}=i,p=await tn(m.value.problemId,m.value.username,m.value.language,m.value.status,h,f);k.value=[],p.code===0?p.data.list&&p.data.list.length>0?(p.data.list.forEach($=>{var Y;const U=gt($);(Y=k.value)==null||Y.push(U),ge($.status)&&(d=!0)}),v.value={...v.value,total:p.data.total_count}):(ce(s,"未找到记录"),v.value={...v.value,total:0}):u&&F(s,p.code)}catch(h){console.error(h),u&&F(s,we())}finally{u&&(S.value=!1),d&&l&&setTimeout(()=>{C({current:c,pageSize:g},!1)},5e3)}},x=async i=>{await n.push({query:{...t.query,page:i.current,page_size:i.pageSize}})};return ee(async()=>{l=!0,r=De(()=>t.query,i=>{m.value.problemId=i.problem_id||"",m.value.username=i.username||"",i.language!=null?m.value.language=Number(i.language):m.value.language=void 0,i.status!=null?m.value.status=Number(i.status):m.value.status=void 0;const u=parseInt(i.page)||v.value.defaultCurrent,d=parseInt(i.page_size)||v.value.defaultPageSize;c=u,g=d,v.value.pageSizeOptions.includes(g)||(g=v.value.defaultPageSize),v.value={...v.value,current:c,pageSize:g},C({current:c,pageSize:g},!0)},{immediate:!0})}),ke(()=>{l=!1,r&&r()}),(i,u)=>{const d=Le,h=Se,f=ot,p=nt,I=M,$=de,U=Ce,Y=be,O=le;return T(),A(O,{style:{margin:"10px"}},{default:o(()=>[a(U,{layout:"inline",onSubmit:q,onReset:b},{default:o(()=>[a(h,{label:"题号"},{default:o(()=>[a(d,{modelValue:m.value.problemId,"onUpdate:modelValue":u[0]||(u[0]=H=>m.value.problemId=H),placeholder:"请输入完整题号"},null,8,["modelValue"])]),_:1}),a(h,{label:"用户"},{default:o(()=>[a(d,{modelValue:m.value.username,"onUpdate:modelValue":u[1]||(u[1]=H=>m.value.username=H),placeholder:"仅支持输入完整用户名"},null,8,["modelValue"])]),_:1}),a(h,{label:"语言"},{default:o(()=>[a(p,{modelValue:m.value.language,"onUpdate:modelValue":u[2]||(u[2]=H=>m.value.language=H),placeholder:"请选择提交语言","auto-width":"",clearable:""},{default:o(()=>[(T(!0),G(Q,null,oe(w.value,H=>(T(),A(f,{key:H.value,value:H.value,label:H.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(h,{label:"状态"},{default:o(()=>[a(p,{modelValue:m.value.status,"onUpdate:modelValue":u[3]||(u[3]=H=>m.value.status=H),placeholder:"请选择评测状态","auto-width":"",clearable:""},{default:o(()=>[(T(!0),G(Q,null,oe(D.value,H=>(T(),A(f,{key:H.value,value:H.value,label:H.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(h,null,{default:o(()=>[a($,null,{default:o(()=>[a(I,{theme:"primary",type:"submit"},{default:o(()=>u[4]||(u[4]=[y("搜索")])),_:1}),a(I,{theme:"default",variant:"base",type:"reset"},{default:o(()=>u[5]||(u[5]=[y("重置")])),_:1})]),_:1})]),_:1})]),_:1}),a(Y,{data:k.value,columns:P.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:v.value,loading:S.value,onPageChange:x},null,8,["data","columns","pagination","loading"])]),_:1})}}}),Tn=X(In,[["__scopeId","data-v-c62ef0c1"]]),Pn=["innerHTML"],xn={key:2,class:"dida-edit-container"};function Ye(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ke(e)}const jn=Z({__name:"JudgeJobDetail",setup(e){const t=ae(),n=Ee(),s=ie(),{globalProperties:l}=te();let r=!1,m=-1;const P=_(null),S=_(""),c=_(null),g=_(0),v=_(null),k=_({from:"#5a96ff",to:"#00A870"});let w=!1;const D=_([{title:"ID",colKey:"id"},{title:"问题",colKey:"problemId",cell:(d,h)=>a(M,{variant:"text",onClick:()=>C(h.row.problemId)},{default:()=>[h.row.problemId]})},{title:"状态",colKey:"status",align:"center",cell:(d,h)=>{const f=h.row.status,p=$e(f);let I;switch(f){case K.Init:case K.Rejudge:case K.Compiling:case K.Running:I="default";break;case K.Accept:I="success";break;case K.PE:I="warning";break;default:I="danger";break}let $=[];return ge(f)&&$.push(a(_e,{text:h.row.state,size:"small",class:"dida-status-loading"},null)),$.push(a("span",null,[p])),a(M,{theme:I,variant:"outline"},Ye($)?$:{default:()=>[$]})}},{title:"分数",colKey:"score"},{title:"时间",colKey:"time"},{title:"内存",colKey:"memory"},{title:"代码",colKey:"language",cell:(d,h)=>a("span",null,[h.row.language+" / "+h.row.codeLength])},{title:"作者",colKey:"author",width:200,cell:(d,h)=>a(M,{variant:"text",onClick:()=>x(h.row.authorUsername)},{default:()=>[h.row.authorNickname]})},{title:"提交时间",colKey:"approveTime",width:180}]),V=_(!1),E=_(!1),j=_(),q=ve(()=>s.hasAuth(he.ManageJudge)),b=async()=>{if(!E.value){E.value=!0;try{const d=await on(m);d.code===0?await u(!0):F(l,d.code)}catch(d){console.error(d),F(l,we())}finally{E.value=!1}}},C=d=>{d&&n.push({path:"/problem/"+d})},x=d=>{d&&n.push({path:"/user/"+d})},i=d=>{const h=d.status,f=$e(h);let p;switch(h){case K.Init:case K.Rejudge:case K.Compiling:case K.Running:p="default";break;case K.Accept:p="success";break;case K.PE:p="warning";break;default:p="danger";break}return a(de,null,{default:()=>[a(M,{theme:"default",variant:"outline"},{default:()=>[d.taskId]}),a(M,{theme:p,variant:"outline"},Ye(f)?f:{default:()=>[f]}),a("span",null,[y("分数："),d.score]),a("span",null,[y("用时："),d.time]),a("span",null,[y("内存："),d.memory])]})},u=async d=>{var f;d&&(V.value=!0);let h=!1;try{const p=await en(m);if(j.value=[],p.code===0){const I=p.data,$=gt(I);(f=j.value)==null||f.push($),k.value.to="#00A870",ge(I.status)?(v.value="active",$.taskTotal>0?(g.value=$.taskCurrent/$.taskTotal*100,$.taskCurrent>=$.taskTotal&&(g.value=99)):g.value=0):(g.value=100,I.status===K.Accept?v.value="success":I.status===K.PE?(k.value.to="#F57C20",v.value="warning"):(k.value.to="#F56C6C",v.value="error"));const U={};if(I.code){const O=`\`\`\`${_t(I.language)}
${I.code}
\`\`\``;S.value=await re.md2html(O,U),await ye(()=>{c.value&&(w||(w=!0,re.highlightRender({lineNumber:!0,enable:!0},c.value)),Xe(c.value))})}P.value=$,ge(I.status)&&(h=!0)}else d&&F(l,p.code)}catch(p){console.error(p),d&&F(l,we())}finally{d&&(V.value=!1),h&&r&&setTimeout(()=>{u(!1)},5e3)}};return ee(async()=>{if(r=!0,t.params.judgeId&&t.params.judgeId.length===1)m=parseInt(t.params.judgeId[0]);else{await n.push({name:"judge"});return}await u(!0)}),ke(()=>{r=!1}),(d,h)=>{var O,H;const f=Gt,p=be,I=le,$=lt,U=st,Y=M;return T(),G(Q,null,[a(f,{color:k.value,status:v.value,class:"dida-job-progress",percentage:g.value},null,8,["color","status","percentage"]),a(I,{style:{margin:"10px"}},{default:o(()=>[a(p,{data:j.value,columns:D.value,"row-key":"id","vertical-align":"top",hover:!0,loading:V.value},null,8,["data","columns","loading"])]),_:1}),R("div",{innerHTML:S.value,ref_key:"markdownCodeRef",ref:c},null,8,Pn),(O=P.value)!=null&&O.compileMessage?(T(),A(I,{key:0,class:"compile-message"},{default:o(()=>{var B;return[y(z((B=P.value)==null?void 0:B.compileMessage),1)]}),_:1})):ne("",!0),((H=P.value)==null?void 0:H.task.length)>0?(T(),A(U,{key:1,class:"task-panel"},{default:o(()=>{var B;return[(T(!0),G(Q,null,oe((B=P.value)==null?void 0:B.task,L=>(T(),A($,{key:L.taskId,header:()=>i(L)},{default:o(()=>[y(z(L.content)+" "+z(L.waHint),1)]),_:2},1032,["header"]))),128))]}),_:1})):ne("",!0),q.value?(T(),G("div",xn,[a(Y,{onClick:b,loading:E.value},{default:o(()=>h[0]||(h[0]=[y("重新评测")])),_:1},8,["loading"])])):ne("",!0)],64)}}}),Vn=X(jn,[["__scopeId","data-v-9b3735e5"]]);function $n(e){let t="";for(e++;e>0;)e--,t=String.fromCharCode(65+e%26)+t,e=Math.floor(e/26);return t}async function bt(e){const t={};if(t.id=e.id,t.ownerId=e.owner_id,t.ownerUsername=e.owner_username,t.ownerNickname=e.owner_nickname,t.title=e.title,t.startTime=new Date(e.start_time).toLocaleString(),t.endTime=new Date(e.end_time).toLocaleString(),e.descriptions){t.descriptions=[];const n={math:{inlineDigit:!0,engine:"KaTeX"}};for(let s=0;s<e.descriptions.length;s++){const l=e.descriptions[s],r={};r.title=l.title,r.content=await re.md2html(l.content,n),r.sort=l.sort,t.descriptions.push(r)}}if(t.notification=e.notification,e.problems){t.problems=[],e.problems.sort((n,s)=>n.sort-s.sort);for(let n=0;n<e.problems.length;n++){const s=e.problems[n];s.accept||(s.accept=0),s.attempt||(s.attempt=0),s.id=$n(n),t.problems.push(s)}}return t}function Rn(e){return W({url:"/contest?id="+e,method:"get"})}function Dn(e,t){return W({url:"/contest/list?page="+e+"&page_size="+t,method:"get"})}function En(e){return W({url:"/contest/create",method:"post",data:e})}const zn={style:{margin:"10px"}},An=Z({__name:"ContestList",setup(e){const t=ae(),n=Ee(),{globalProperties:s}=te();let l=null;const r=_(!1),m=_(!1),P=_([{title:"ID",colKey:"id",width:"100",cell:(x,i)=>a(M,{variant:"text",onClick:()=>V(i.row.id)},{default:()=>[i.row.id]})},{title:"标题",colKey:"title",cell:(x,i)=>a(M,{variant:"text",onClick:()=>V(i.row.id)},{default:()=>[i.row.title]})},{title:"负责人",colKey:"ownerNickname",width:"200"},{title:"开始时间",colKey:"startTime",width:"180"},{title:"结束时间",colKey:"endTime",width:"180"}]),S=_(!1);let c=1,g=50;const v=_({defaultPageSize:g,defaultCurrent:c,total:0,pageSizeOptions:[50,100]}),k=_(),w=_({title:"",username:""}),D=_({title:"",description:"",open_time:[]}),V=x=>{x&&n.push({path:"/contest/"+x})},E=async()=>{await n.push({query:{...t.query,title:w.value.title,username:w.value.username,page:1,page_size:v.value.defaultPageSize}})},j=async(x,i)=>{var u;S.value=!0;try{const{current:d,pageSize:h}=x,f=await Dn(d,h);if(k.value=[],f.code===0){const p=f.data.list;for(let I=0;I<p.length;I++){const $=p[I],U=await bt($);(u=k.value)==null||u.push(U)}v.value={...v.value,total:f.data.total_count}}else i&&F(s,f.code)}catch(d){console.error(d),F(s,we())}finally{S.value=!1}},q=async x=>{await n.push({query:{...t.query,page:x.current,page_size:x.pageSize}})},b=()=>{r.value=!0},C=async()=>{m.value=!0,console.log("contestCreateForm",D.value),En(D.value).then(x=>{x.code===0?(ce(s,"创建比赛成功"),r.value=!1,n.push({path:"/contest/"+x.data.id})):F(s,x.code)}).finally(()=>{m.value=!1})};return ee(async()=>{l=De(()=>t.query,x=>{w.value.title=x.title||"",w.value.username=x.username||"";const i=parseInt(x.page)||v.value.defaultCurrent,u=parseInt(x.page_size)||v.value.defaultPageSize;c=i,g=u,v.value={...v.value,current:c,pageSize:g},j({current:c,pageSize:g},!0)},{immediate:!0})}),ke(()=>{l&&l()}),(x,i)=>{const u=be,d=le,h=fe,f=Le,p=Se,I=M,$=Ce,U=de,Y=pe,O=Kt,H=Bt;return T(),G(Q,null,[a(Y,null,{default:o(()=>[a(h,{span:9},{default:o(()=>[a(d,{style:{margin:"10px"}},{default:o(()=>[a(u,{data:k.value,columns:P.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:v.value,loading:S.value,onPageChange:q},null,8,["data","columns","pagination","loading"])]),_:1})]),_:1}),a(h,{span:3},{default:o(()=>[R("div",zn,[a(d,{class:"sh-card"},{default:o(()=>[a($,{model:w.value},{default:o(()=>[a(p,{label:"标题"},{default:o(()=>[a(f,{modelValue:w.value.title,"onUpdate:modelValue":i[0]||(i[0]=B=>w.value.title=B),placeholder:"暂不支持模糊查询"},null,8,["modelValue"])]),_:1}),a(p,{label:"负责人"},{default:o(()=>[a(f,{modelValue:w.value.username,"onUpdate:modelValue":i[1]||(i[1]=B=>w.value.username=B),placeholder:"仅支持输入完整用户名"},null,8,["modelValue"])]),_:1}),a(p,null,{default:o(()=>[a(I,{theme:"primary",onClick:E},{default:o(()=>i[6]||(i[6]=[y("提交")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(d,{class:"sh-card"},{default:o(()=>[a(U,null,{default:o(()=>[a(I,{onClick:b},{default:o(()=>i[7]||(i[7]=[y("创建")])),_:1})]),_:1})]),_:1})])]),_:1})]),_:1}),a(H,{visible:r.value,"onUpdate:visible":i[5]||(i[5]=B=>r.value=B),header:"创建比赛",onConfirm:C,"confirm-loading":m.value},{default:o(()=>[a($,{"label-width":80,model:D.value,onSubmit:i[4]||(i[4]=Ve(()=>{},["prevent"]))},{default:o(()=>[a(p,{label:"标题"},{default:o(()=>[a(f,{modelValue:D.value.title,"onUpdate:modelValue":i[2]||(i[2]=B=>D.value.title=B),placeholder:"请输入标题"},null,8,["modelValue"])]),_:1}),a(p,{label:"开启时间"},{default:o(()=>[a(O,{"enable-time-picker":"","allow-input":"",clearable:"",modelValue:D.value.open_time,"onUpdate:modelValue":i[3]||(i[3]=B=>D.value.open_time=B)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","confirm-loading"])],64)}}}),me=X(An,[["__scopeId","data-v-98695ddd"]]),Mn=["innerHTML"],qn={style:{margin:"12px"}},Hn=Z({__name:"ContestDetail",setup(e){let t=ae();const{globalProperties:n}=te(),s=_(""),l=_(!1),r=_(null),m=_([{title:"ID",colKey:"id",cell:(S,c)=>a(M,{variant:"text"},{default:()=>[c.row.id]})},{title:"标题",colKey:"title",cell:(S,c)=>a(M,{variant:"text"},{default:()=>[c.row.title]})},{title:"正确",colKey:"accept"},{title:"提交",colKey:"attempt"}]),P=_([]);return ee(async()=>{if(t.params.contestId&&t.params.contestId.length===1)s.value=t.params.contestId[0];else{await N.push({name:"contest"});return}l.value=!0;const S=await Rn(s.value);if(S.code!==0){l.value=!1,F(n,S.code),await N.push({name:"contest"});return}r.value=await bt(S.data),P.value=r.value.problems,await ye(()=>{const c=document.querySelectorAll(".contest-description");c&&c.length>0&&c.forEach(g=>{re.mathRender(g),re.highlightRender({lineNumber:!0,enable:!0},g),Xe(g)}),l.value=!1})}),(S,c)=>{const g=Xt,v=M,k=de,w=lt,D=st,V=be,E=le,j=fe,q=Ae,b=ze,C=pe,x=_e;return T(),A(x,{loading:l.value},{default:o(()=>[a(C,{class:"dida-main-content"},{default:o(()=>[a(j,{span:8},{default:o(()=>{var i,u,d;return[R("h1",null,z((i=r.value)==null?void 0:i.title),1),(u=r.value)!=null&&u.notification?(T(),A(g,{key:0,theme:"info",message:(d=r.value)==null?void 0:d.notification},null,8,["message"])):ne("",!0),a(D,{"default-value":[0],"expand-icon":!1,borderless:!0},{default:o(()=>{var h;return[(T(!0),G(Q,null,oe((h=r.value)==null?void 0:h.descriptions,(f,p)=>(T(),A(w,{key:p,header:f.title},Fe({default:o(()=>[R("div",{innerHTML:f.content,class:"dida-content-description"},null,8,Mn)]),_:2},[p===0?{name:"headerRightContent",fn:o(()=>[a(k,{size:"small"},{default:o(()=>[a(v,{size:"small"},{default:o(()=>c[0]||(c[0]=[y("收起全部")])),_:1}),a(v,{size:"small"},{default:o(()=>c[1]||(c[1]=[y("展开全部")])),_:1})]),_:1})]),key:"0"}:void 0]),1032,["header"]))),128))]}),_:1}),a(E,{style:{margin:"10px"}},{default:o(()=>[a(V,{data:P.value,columns:m.value,"row-key":"id","vertical-align":"top",hover:!0},null,8,["data","columns"])]),_:1})]}),_:1}),a(j,{span:4},{default:o(()=>[R("div",qn,[a(b,{layout:"vertical",bordered:!0},{default:o(()=>[a(q,{label:"开始时间"},{default:o(()=>{var i;return[y(z((i=r.value)==null?void 0:i.startTime),1)]}),_:1})]),_:1})])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),On=X(Hn,[["__scopeId","data-v-7aec72d2"]]),Fn=Z({__name:"ManageJudge",setup(e){const{globalProperties:t}=te(),n=_(!1),s=async()=>{const r=await an();if(r.code!==0){F(t,r.code);return}ce(t,"重判成功")},l=async()=>{n.value=!0;try{const r=await nn();if(r.code!==0){F(t,r.code);return}ce(t,"重判成功")}finally{n.value=!1}};return(r,m)=>{const P=M,S=le;return T(),G(Q,null,[a(S,{class:"yj-manage-card",title:"重判最近提交"},{default:o(()=>[a(P,{onClick:s},{default:o(()=>m[0]||(m[0]=[y("重判")])),_:1})]),_:1}),a(S,{class:"yj-manage-card",title:"重判所有"},{default:o(()=>[a(P,{onClick:l,theme:"danger",loading:n.value},{default:o(()=>m[1]||(m[1]=[y("重判")])),_:1},8,["loading"])]),_:1})],64)}}}),Un=X(Fn,[["__scopeId","data-v-7fb4e65b"]]),Nn={style:{margin:"10px"}},Gn={key:1},Kn={style:{margin:"12px"}},Bn={class:"dida-edit-container"},Xn=Z({__name:"ProblemEdit",setup(e){let t=ae();const{globalProperties:n}=te(),s=Ie(),l=_(""),r=_(!1);let m=null;const P=_(!1),S=_(null),c=_({title:"",timeLimit:0,memoryLimit:0,source:"",tags:[]}),g=_([]),v=_([]),k=ve(()=>{const b=[],C=g.value;for(let x=0,i=C.length;x<i;x++)C[x].value&&b.push(C[x].value);return b}),w=(b,C)=>{const{trigger:x,index:i,item:u}=C;if(x==="clear"&&(g.value=[]),["tag-remove","backspace"].includes(x)&&g.value.splice(i,1),x==="enter"){for(let h=0;h<v.value.length;h++){const f=v.value[h];if(f.label===u){for(let p=0;p<g.value.length;p++)if(g.value[p].label===f.label)return;g.value.push(f);return}}const d={label:u,value:u};g.value.push(d),v.value=v.value.concat(d)}},D=(b,{current:C,type:x})=>{if(!C){g.value=x==="check"?v.value.slice(1):[];return}if(x==="check"){const i=v.value.find(u=>u.value===C);if(!i)return;g.value.push(i)}else g.value=g.value.filter(i=>i.value!==C)},V=()=>{N.push({name:"problem-detail",params:{problemId:l.value}})},E=()=>{N.push({name:"manage-problem-judge",params:{problemId:l.value}})},j=async()=>{if(m){P.value=!0,c.value.tags=[];for(let b=0;b<g.value.length;b++){const C=g.value[b];C&&C.label&&c.value.tags.push(C.label)}try{const b=await rn(l.value,c.value.title,c.value.timeLimit,c.value.memoryLimit,c.value.source,c.value.tags,m.getValue());if(P.value=!0,b.code!==0){F(n,b.code);return}it(n,"保存成功")}finally{P.value=!1}}},q=async()=>{const b=await vt(l.value);if(b.code!==0){F(n,b.code),console.error("problem get failed",b.code),await N.push({name:"problem"});return}const C=b.data.problem;if(S.value=qe(C,{}),c.value.title=C.title,c.value.timeLimit=C.time_limit,c.value.memoryLimit=C.memory_limit,c.value.source=C.source,c.value.tags=[],g.value=[],b.data.tags)for(let u=0;u<b.data.tags.length;u++){const d=b.data.tags[u];d&&d.name&&(c.value.tags.push(d.name),g.value.push({label:d.name,value:d.id}))}s.setTitle(C.title+" - "+s.getTitle);let x=C.description;const i={after:()=>{m==null||m.setValue(x)}};m=new re("codeEditRef",i),r.value=!1};return ee(async()=>{if(Array.isArray(t.params.problemId)?l.value=t.params.problemId[0]:l.value=t.params.problemId,!l.value){se(n,"题目不存在"),await N.push({name:"problem"});return}r.value=!0,ht(-1).then(async b=>{b.code===0?(b.data.list&&b.data.list.forEach(C=>{v.value.push({label:C.name,value:C.id})}),await q()):(F(n,b.code),console.error("problem tag get failed",b.code),await N.push({name:"problem"}))}).catch(async b=>{console.error(b),F(n,"获取数据异常"),await N.push({name:"problem"})})}),(b,C)=>{const x=Le,i=Se,u=Wt,d=Jt,h=Yt,f=Ce,p=le,I=fe,$=M,U=de,Y=Ae,O=ze,H=pe,B=_e;return T(),A(B,{loading:r.value},{default:o(()=>[a(H,null,{default:o(()=>[a(I,{span:8},{default:o(()=>[R("div",Nn,[a(p,{class:"sh-card"},{default:o(()=>[a(f,{model:c.value},{default:o(()=>[a(i,{label:"标题"},{default:o(()=>[a(x,{modelValue:c.value.title,"onUpdate:modelValue":C[0]||(C[0]=L=>c.value.title=L),placeholder:"问题标题"},null,8,["modelValue"])]),_:1}),a(i,{label:"时间限制"},{default:o(()=>[a(u,{modelValue:c.value.timeLimit,"onUpdate:modelValue":C[1]||(C[1]=L=>c.value.timeLimit=L),theme:"normal",min:0},{suffix:o(()=>C[4]||(C[4]=[R("span",null,"ms",-1)])),_:1},8,["modelValue"])]),_:1}),a(i,{label:"内存限制"},{default:o(()=>[a(u,{modelValue:c.value.memoryLimit,"onUpdate:modelValue":C[2]||(C[2]=L=>c.value.memoryLimit=L),theme:"normal",min:0},{suffix:o(()=>C[5]||(C[5]=[R("span",null,"KB",-1)])),_:1},8,["modelValue"])]),_:1}),a(i,{label:"来源"},{default:o(()=>[a(x,{modelValue:c.value.source,"onUpdate:modelValue":C[3]||(C[3]=L=>c.value.source=L),placeholder:"请输入题目来源"},null,8,["modelValue"])]),_:1}),a(i,{label:"标签"},{default:o(()=>[a(h,{value:g.value,"allow-input":!0,placeholder:"请选择或输入","tag-input-props":{excessTagsDisplayType:"break-line"},"popup-props":{overlayInnerClassName:["narrow-scrollbar"],overlayInnerStyle:{maxHeight:"280px",overflowY:"auto",overscrollBehavior:"contain",padding:"6px"}},clearable:"",multiple:"",onTagChange:w},{panel:o(()=>[v.value.length?(T(),A(d,{key:0,value:k.value,options:v.value,onChange:D},null,8,["value","options"])):(T(),G("div",Gn,"暂无数据"))]),suffixIcon:o(()=>[a(ue(Pt))]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1})])]),_:1}),a(I,{span:4},{default:o(()=>[R("div",Kn,[R("div",Bn,[a(U,null,{default:o(()=>[a($,{onClick:j,theme:"danger",loading:P.value},{default:o(()=>C[6]||(C[6]=[y("保存")])),_:1},8,["loading"]),a($,{onClick:E,theme:"warning"},{default:o(()=>C[7]||(C[7]=[y("判题数据")])),_:1}),a($,{onClick:V},{default:o(()=>C[8]||(C[8]=[y("查看")])),_:1})]),_:1})]),a(O,{layout:"vertical",bordered:!0},{default:o(()=>[a(Y,{label:"创建时间"},{default:o(()=>{var L;return[y(z((L=S.value)==null?void 0:L.insertTime),1)]}),_:1}),a(Y,{label:"更新时间"},{default:o(()=>{var L;return[y(z((L=S.value)==null?void 0:L.updateTime),1)]}),_:1}),a(Y,{label:"上传用户"},{default:o(()=>{var L;return[y(z((L=S.value)==null?void 0:L.creatorNickname),1)]}),_:1})]),_:1})])]),_:1})]),_:1}),C[9]||(C[9]=R("div",{id:"codeEditRef",class:"dida-description-editor"},null,-1))]),_:1},8,["loading"])}}}),Wn=X(Xn,[["__scopeId","data-v-3945c736"]]),Yn={style:{margin:"10px"}},Jn={style:{margin:"12px"}},Zn={class:"dida-edit-container"},Qn=Z({__name:"ProblemJudge",setup(e){let t=ae();const{globalProperties:n}=te(),s=Ie(),l=_(""),r=_(!1),m=_(null);let P=null;const S=_(null),c=_(""),g=_(!1),v=_(!1),k=_([{title:"文件",colKey:"file"},{title:"操作",colKey:"action",cell:(f,p)=>a(M,{onClick:()=>q(p.row.file)},{default:()=>[y("下载")]})}]),w=_([]),D=ve(()=>({border:"2px dashed #ccc",borderRadius:"6px",padding:"20px",textAlign:"center",cursor:"pointer",backgroundColor:g.value?"#f0f9ff":"#fff",transition:"background-color 0.2s ease"})),V=ve(()=>c.value?`已选择：${c.value}`:g.value?"松开文件以上传":"拖拽文件到这里，或点击选择文件"),E=()=>{N.push({name:"problem-detail",params:{problemId:l.value}})},j=()=>{N.push({name:"manage-problem",params:{problemId:l.value}})},q=async f=>{const p=await un(l.value,f);if(p.code!==0){F(n,p.code);return}const I=document.createElement("a");I.href=p.data,I.target="_blank",I.click(),URL.revokeObjectURL(I.href)},b=async()=>{if(!P){se(n,"请选择压缩包");return}v.value=!0,cn(l.value,P).then(async f=>{f.code==0?(S.value.value=null,P=null,c.value="",r.value=!0,it(n,"上传成功"),await h()):F(n,f.code)}).catch(f=>{console.log(f),n.$message.error({duration:3e3,content:"申请失败"})}).finally(()=>{v.value=!1})},C=()=>{var f;(f=S.value)==null||f.click()},x=f=>{const p=f.target.files[0];p&&(c.value=p.name,P=p)},i=f=>{g.value=!0},u=()=>{g.value=!1},d=f=>{f.preventDefault(),f.stopPropagation(),g.value=!1;const p=f.dataTransfer.files[0];if(p){c.value=p.name;const I=new DataTransfer;I.items.add(p),S.value.files=I.files,P=p}},h=async()=>{const f=await ln(l.value);if(f.code!==0){F(n,f.code),await N.push({name:"problem"});return}const p=f.data.problem;m.value=qe(p,{}),s.setTitle(p.title+" - "+s.getTitle),w.value=[],f.data.judges?f.data.judges.forEach(I=>{w.value.push({file:I})}):se(n,"评测数据不存在"),r.value=!1};return ee(async()=>{if(Array.isArray(t.params.problemId)?l.value=t.params.problemId[0]:l.value=t.params.problemId,!l.value){se(n,"题目不存在"),await N.push({name:"problem"});return}r.value=!0,await h()}),(f,p)=>{const I=be,$=fe,U=M,Y=de,O=Ae,H=ze,B=pe,L=_e;return T(),A(L,{loading:r.value},{default:o(()=>[a(B,null,{default:o(()=>[a($,{span:7},{default:o(()=>[R("div",Yn,[R("div",{id:"drop-zone",style:et(D.value),onClick:C,onDragenter:Ve(i,["prevent"]),onDragover:p[0]||(p[0]=Ve(()=>{},["prevent"])),onDragleave:Ve(u,["prevent"]),onDrop:d},[R("input",{ref_key:"fileInput",ref:S,type:"file",style:{display:"none"},onChange:x},null,544),y(" "+z(V.value),1)],36)]),a(I,{data:w.value,columns:k.value,"row-key":"id","vertical-align":"top",hover:!0},null,8,["data","columns"])]),_:1}),a($,{span:5},{default:o(()=>[R("div",Jn,[R("div",Zn,[a(Y,null,{default:o(()=>[a(U,{onClick:b,theme:"danger",loading:v.value},{default:o(()=>p[1]||(p[1]=[y("上传")])),_:1},8,["loading"]),a(U,{onClick:j,theme:"warning"},{default:o(()=>p[2]||(p[2]=[y("编辑")])),_:1}),a(U,{onClick:E},{default:o(()=>p[3]||(p[3]=[y("查看")])),_:1})]),_:1})]),a(H,{layout:"vertical",bordered:!0},{default:o(()=>[a(O,{label:"标题"},{default:o(()=>{var J;return[y(z((J=m.value)==null?void 0:J.title),1)]}),_:1}),a(O,{label:"创建时间"},{default:o(()=>{var J;return[y(z((J=m.value)==null?void 0:J.insertTime),1)]}),_:1}),a(O,{label:"更新时间"},{default:o(()=>{var J;return[y(z((J=m.value)==null?void 0:J.updateTime),1)]}),_:1}),a(O,{label:"上传用户"},{default:o(()=>{var J;return[y(z((J=m.value)==null?void 0:J.creatorNickname),1)]}),_:1}),a(O,{label:"评测数据"},{default:o(()=>{var J;return[y(z((J=m.value)==null?void 0:J.judgeMd5),1)]}),_:1})]),_:1})])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),eo=X(Qn,[["__scopeId","data-v-3d6a7ec7"]]),yt=[{name:"problem-list",tab:"problem",sidebar:"problem-list",path:"",title:"问题列表",icon:"cpu",component:fn},{name:"problem-detail",tab:"problem",sidebar:"problem-list",path:":problemId+",title:"问题详情",icon:"cpu",component:wn},{name:"problem-recommend",tab:"problem",sidebar:"problem-recommend",path:"recommend/:problemId*",title:"问题推荐",icon:"cpu",component:Sn},{name:"judge-list",tab:"judge",sidebar:"judge-list",path:"",title:"评测列表",icon:"cpu",component:Tn},{name:"judge-detail",tab:"judge",sidebar:"judge-list",path:":judgeId+",title:"评测详情",icon:"cpu",component:Vn},{name:"contest-list",tab:"contest",sidebar:"contest-list",path:"",title:"比赛列表",icon:"cpu",component:me},{name:"contest-recent",tab:"contest",sidebar:"contest-recent",path:"recent",title:"近期比赛",icon:"cpu",component:me},{name:"contest-detail",tab:"contest-detail",sidebar:"contest-detail",path:":contestId+",title:"比赛详情",icon:"cpu",component:On},{name:"contest-problem",tab:"contest-detail",sidebar:"contest-problem",path:":contestId+/problem",title:"问题列表",icon:"cpu",component:me},{name:"contest-judge",tab:"contest-detail",sidebar:"contest-judge",path:":contestId+/judge",title:"评测列表",icon:"cpu",component:me},{name:"contest-rank",tab:"contest-detail",sidebar:"contest-rank",path:":contestId+/rank",title:"比赛排名",icon:"cpu",component:me},{name:"contest-statistics",tab:"contest-detail",sidebar:"contest-statistics",path:":contestId+/statistics",title:"结果统计",icon:"cpu",component:me},{name:"contest-discuss",tab:"contest-detail",sidebar:"contest-discuss",path:":contestId+/discuss",title:"比赛讨论",icon:"cpu",component:me},{name:"manage-problem",tab:"manage",sidebar:"manage-problem",disableSidebar:!0,path:"problem/:problemId+",title:"问题编辑",icon:"cpu",component:Wn,auths:[he.ManageProblem]},{name:"manage-problem-judge",tab:"manage",sidebar:"manage-problem-judge",disableSidebar:!0,path:"problem/:problemId+/judge",title:"评测数据",icon:"cpu",component:eo,auths:[he.ManageProblem]},{name:"manage-judge",tab:"manage",path:"judge",sidebar:"manage-judge",title:"评测管理",icon:"cpu",auths:["i-manage-judge"],component:Un}],Je=(e,t,n,s)=>{s.tab==n&&(s.disableSidebar&&t!=s.sidebar||s.sidebar==null||s.sidebar!=s.name||e.push({name:s.name,title:s.title,icon:s.icon,to:{name:s.name}}))},to=(e,t)=>{const n=[];return yt.forEach(s=>{if(ct(s)){const l=[];s.children.forEach(r=>{Je(l,e,t,r)}),l.length>0&&n.push({title:s.title,children:l})}else Je(n,e,t,s)}),n},Ze=(e,t)=>{const n=ka(t.tab),s={name:t.name,path:"/"+t.path,meta:{title:t.title+" - "+n.title,tab:t.tab,sidebar:t.sidebar,showSidebar:n.showSidebar,needLogin:n.needLogin||t.needLogin,tabAuths:n.auths,auths:t.auths},component:t.component};n.disablePath||(s.path=n.path+s.path),e.push(s)},ao=e=>{yt.forEach(t=>{ct(t)?t.children.forEach(n=>{Ze(e,n)}):Ze(e,t)})},Te=[];Sa(Te);ao(Te);Te.push({path:"/403",name:"403",component:dt});Te.push({path:"/:pathMatch(.*)*",name:"404",component:ut});const N=xt({history:jt("/"),routes:Te});N.beforeEach((e,t,n)=>{if(e.name==null||!N.hasRoute(e.name)){n({name:"home"});return}const s=e.matched[e.matched.length-1].meta;if(s.redirect){n({name:s.redirect});return}if(s.needLogin){const r=ie();if(r.getToken==null||r.getToken==""){n({name:"login",query:{redirect_uri:e.fullPath}});return}}const l=s.tabAuths;if(l&&!ie().hasAllAuths(l)){n({name:"403",query:{target:e.fullPath}});return}n()});N.afterEach((e,t)=>{if(e.name===t.name)return;const n=Me(),s=Ie();let l=null;if(e.matched.length>0&&(l=e.matched[e.matched.length-1].meta),l!=null&&l.title&&s.setTitle(l==null?void 0:l.title),l!=null&&l.showSidebar){n.setSidebarShow(!0);const r=to(l==null?void 0:l.sidebar,l==null?void 0:l.tab);n.setMenuList(r),n.setMenuActiveName(l==null?void 0:l.sidebar)}else n.setSidebarShow(!1)});Qt.registerLanguage("verilog",ea);const wt=Vt();wt.use($t);const Pe=Rt(Wa);Pe.use(wt);Pe.use(N);Pe.use(Zt);Pe.use(Dt);Pe.mount("#app");pa().then(()=>{console.log("Text cache reinitialized")}).catch(e=>{console.error("Text cache reinitialization failed",e)});
