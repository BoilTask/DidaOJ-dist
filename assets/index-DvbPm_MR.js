import{bm as Se,bn as ft,bo as H,s as a,bp as l,bq as k,br as A,ao as C,n as F,r as d,bs as te,bt as D,aD as se,g as _t,o as W,bu as z,bv as ht,bw as gt,bx as Fe,F as K,by as J,bz as oe,aM as vt,q as ce,bA as ze,bB as Re,y as Ce,J as me,bC as bt,c as yt,a0 as wt,bD as Le,u as De,bE as kt,bF as St,bG as Ct,bH as Lt,bI as It,B as Pt,bJ as Tt}from"./node_modules-CrmNcrhb.js";import{R as pe,C as fe,a as ne,B as E,F as Ie,b as Pe,I as Te,L as xt,S as Vt,M as Be,c as Xe,H as $t,d as jt,e as _e,f as zt,g as Rt,h as Et,A as At,i as Dt,j as Mt,k as ie,T as he,D as We,l as Ye,m as Ze,O as Je,n as Qe,o as et,p as qt,q as Ht,r as Ot,s as Gt}from"./tdesign-vue-next-D5WNY8GD.js";import{V as ae}from"./vditor-DArazWIS.js";import{e as Oe}from"./monaco-editor-DCUKHC_e.js";import{H as Nt,v as Kt}from"./highlight.js-D9zWiMxS.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();const Ut={"r-admin":["i-manage","i-manage-problem","i-manage-judge"]};function Ft(e){if(e==null)return[];const t=[];for(const n of e){const s=Ut[n];s!=null&&t.push(...s)}return[...new Set(t)]}function Bt(e,t){if(e==null||t==null)return!1;const n=Ft(e);for(const s of t)if(!n.includes(s))return!1;return!0}const ue=Se("user",{state:()=>({token:"",userId:-1,username:"",nickname:"",roles:[]}),getters:{getToken(){return this.token},getUserId(){return this.userId},getUsername(){return this.username},getNickname(){return this.nickname}},actions:{clear(){this.$patch({token:"",userId:-1,username:"",nickname:"",roles:[]})},loadResponse(e){this.$patch({token:e.token,userId:e.user_id,username:e.username,nickname:e.nickname,roles:e.roles})},isLogin(){return this.token!=null&&this.token!=""},hasAllAuths(e){return e?Bt(this.roles,e):!0}},persist:!0}),Xt="https://oj-api.didapipa.com/",X=ft.create({baseURL:Xt,timeout:6e4,withCredentials:!0,headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});X.interceptors.request.use(e=>{const n=ue().getToken;return n&&(e.headers["X-Token"]=n),e},e=>Promise.reject(e));X.interceptors.response.use(function(e){return e.data},function(e){return Promise.reject(e)});function Wt(e,t){return X({url:"/user/login",method:"post",data:{username:e,password:t}})}function Yt(){return X({url:"/user/login/refresh",method:"post"})}const tt=Se("login",{state:()=>({Loaded:!1}),getters:{isLoaded(){return this.Loaded}}}),Me=Se("webStyle",{state:()=>({title:""}),getters:{getTitle(){return this.title}},actions:{setTitle(e){this.title=e}}}),xe=Se("sidebarStyle",{state:()=>({showSidebar:!1,forceHiddenSidebar:!1,menuActiveName:"",menuList:[]}),getters:{getMenuList(){return this.menuList}},actions:{setSidebarShow(e){this.showSidebar=e},setForceHiddenSidebar(e){this.forceHiddenSidebar=e},setMenuActiveName(e){this.menuActiveName=e},clearMenuList(){this.menuList=[]},setMenuList(e){this.menuList=e},addMenuList(e){this.menuList.push(e)}}}),O=(e,t)=>{const n=e.__vccOpts||e;for(const[s,o]of t)n[s]=o;return n},Zt={},Jt={class:"sh-main"};function Qt(e,t){const n=ne,s=fe,o=pe;return k(),H("div",Jt,[a(o,null,{default:l(()=>[a(s,{span:6},{default:l(()=>[a(n,{title:"正在完善，欢迎提供意见建议"},{default:l(()=>t[0]||(t[0]=[A("p",null,[A("a",{href:"https://codeoj.cn/",target:"_blank"},"CodeOJ"),C("的迁移计划")],-1),A("p",null,"正在开发中",-1)])),_:1})]),_:1})]),_:1})])}const en=O(Zt,[["render",Qt],["__scopeId","data-v-13691e65"]]),tn={class:"sh-main"},nn=F({__name:"View404",setup(e){let t=te(),n=d(t.fullPath);return(s,o)=>{const r=E;return k(),H("div",tn,[A("p",null,D(se(n)),1),o[2]||(o[2]=A("p",null,"该页面无效或已被迁移，请重新选择访问目标",-1)),a(r,{theme:"primary",onClick:o[0]||(o[0]=()=>s.$router.push("/"))},{default:l(()=>o[1]||(o[1]=[C("返回首页")])),_:1})])}}}),nt=O(nn,[["__scopeId","data-v-d4218944"]]);let Ee=null;async function an(){Ee=await ln()}function on(e,t="zh"){if(Ee==null)return[!1,e.toString()];const n=Ee[e.toString()];if(!n)return[!1,e.toString()];let s=n[t];return s||(t="zh",s=n[t]),s?[!0,s]:[!1,e.toString()]}async function ln(){return new Promise((e,t)=>{e({404:{zh:"接口未找到"},1e3:{zh:"系统错误"},10001:{zh:"权限异常，请重新登陆后再试"},10002:{zh:"参数不符合要求"},10003:{zh:"未找到目标数据"},100001:{zh:"用户名不存在或密码不匹配"}})})}function Q(){const{appContext:e}=_t();return{globalProperties:e.config.globalProperties}}function Ve(){return 1e3}function re(e,t,n=3e3){e.$message.info({duration:n,content:t})}function we(e,t,n=3e3){e.$message.error({duration:n,content:t})}function U(e,t,n=3e3){const[s,o]=on(t),r=s?o:`系统错误，错误提示[${o}]`;e.$message.error({duration:n,content:r})}const sn={class:"dida-login-footer"},rn=F({__name:"LoginView",setup(e){const{globalProperties:t}=Q(),n=ue(),s=d(!1),o=d({account:"",password:""}),r=()=>{re(t,"重置成功")},c=({validateResult:$,firstError:m})=>{s.value||Wt(o.value.account,o.value.password).then(_=>{if(_.code===0){n.loadResponse(_.data),re(t,"登录成功");let b=t.$route.query.redirect_uri;b||(b="/user/"+_.data.username),t.$router.push({path:b})}else U(t,_.code)}).catch(_=>{console.error("Login error",_),we(t,"登录失败")})};return W(()=>{if(n.isLogin()){t.$router.push({path:"/user"});return}}),($,m)=>{const _=Te,b=Pe,y=E,h=Ie,g=xt,R=ne;return k(),z(R,{class:"yj-login-card",title:"欢迎使用DidaOJ~"},{default:l(()=>[a(h,{ref:"form",data:o.value,colon:!0,onReset:r,onSubmit:c,class:"yj-login-form","label-width":0},{default:l(()=>[a(b,{name:"account"},{default:l(()=>[a(_,{modelValue:o.value.account,"onUpdate:modelValue":m[0]||(m[0]=x=>o.value.account=x),clearable:"",placeholder:"请输入账户名"},{"prefix-icon":l(()=>[a(se(ht))]),_:1},8,["modelValue"])]),_:1}),a(b,{name:"password"},{default:l(()=>[a(_,{modelValue:o.value.password,"onUpdate:modelValue":m[1]||(m[1]=x=>o.value.password=x),type:"password",clearable:"",placeholder:"请输入密码"},{"prefix-icon":l(()=>[a(se(gt))]),_:1},8,["modelValue"])]),_:1}),a(b,null,{default:l(()=>[a(y,{theme:"primary",type:"submit",block:"",loading:s.value},{default:l(()=>m[2]||(m[2]=[C("登录")])),_:1},8,["loading"])]),_:1})]),_:1},8,["data"]),A("div",sn,[a(g,null,{default:l(()=>m[3]||(m[3]=[C("忘记密码")])),_:1}),a(g,null,{default:l(()=>m[4]||(m[4]=[C("注册账户")])),_:1})])]),_:1})}}}),un=O(rn,[["__scopeId","data-v-b3cb57db"]]),cn={};function dn(e,t){return" TODO "}const mn=O(cn,[["render",dn]]),qe=[{name:"home",path:"/",title:"首页",showSidebar:!1,disableGenerateTab:!0,component:en},{name:"problem",path:"/problem",title:"题目",icon:"dashboard",showSidebar:!0,redirect:"problem-list"},{name:"judge",path:"/judge",title:"评测",icon:"dashboard",showSidebar:!0,redirect:"judge-list"},{name:"contest",path:"/contest",title:"比赛",icon:"dashboard",showSidebar:!0,redirect:"contest-list"},{name:"contest-detail",title:"比赛",path:"/contest",showSidebar:!0,disableGenerateTab:!0,redirect:"contest-list"},{name:"manage",path:"/manage",title:"管理",icon:"dashboard",showSidebar:!0,redirect:"manage-problem",auths:["i-manage"]},{name:"login",path:"/login",title:"登陆",showSidebar:!1,disableGenerateTab:!0,component:un},{name:"user",path:"/user/:username+",title:"用户",showSidebar:!1,needLogin:!0,disableGenerateTab:!0,component:mn},{name:"404",path:"/404",title:"404",showSidebar:!1,disableGenerateTab:!0,component:nt}],pn=e=>qe.find(t=>t.name==e),fn=e=>{const t=[];return qe.forEach(n=>{!n.disableGenerateTab&&e.hasAllAuths(n.auths)&&t.push(n)}),t},_n=e=>{qe.forEach(t=>{const n={name:t.name,path:t.path,meta:{title:t.title,tab:t.name,showSidebar:t.showSidebar,needLogin:t.needLogin,redirect:t.redirect,tabAuths:t.auths},component:t.component};e.push(n)})},hn=F({__name:"HeaderContent",setup(e){const t=tt(),n=ue(),{globalProperties:s}=Q(),o=d(t.isLoaded),r=d(!1),c=d(n.getUsername),$=d(n.getNickname),m=d(),_=()=>{m.value=fn(n)};t.$subscribe((h,g)=>{o.value=g.Loaded}),n.$subscribe((h,g)=>{c.value=g.username,$.value=g.nickname,r.value=g.token!="",_()});const b=()=>{s.$router.currentRoute.value.name!=="login"&&s.$router.push({name:"login",query:{redirect_uri:s.$router.currentRoute.value.fullPath}})},y=()=>{n.clear(),s.$message.success({duration:3e3,content:"注销成功"}),s.$router.push({path:"/login",query:{redirect_uri:s.$router.currentRoute.value.fullPath}})};return W(()=>{_()}),(h,g)=>{const R=Fe("router-link"),x=Xe,L=Be,p=Vt,j=$t;return k(),z(j,{modelValue:h.$route.meta.tab,"onUpdate:modelValue":g[0]||(g[0]=w=>h.$route.meta.tab=w),class:"sh-menu","expand-type":"popup"},{logo:l(()=>[a(R,{to:"/",class:"sh-logo"},{default:l(()=>g[1]||(g[1]=[C("DidaOJ")])),_:1})]),operations:l(()=>[o.value&&r.value?(k(),z(p,{key:0,title:$.value},{icon:l(()=>[a(x,{name:"user"})]),default:l(()=>[a(L,{value:"user",to:{path:"/user/"+c.value}},{default:l(()=>g[2]||(g[2]=[C("个人空间")])),_:1},8,["to"]),a(L,{value:"user_logout",onClick:y},{default:l(()=>g[3]||(g[3]=[C(" 注销")])),_:1})]),_:1},8,["title"])):o.value?(k(),z(L,{key:2,value:"login",onClick:b},{icon:l(()=>[a(x,{name:"login"})]),default:l(()=>[g[5]||(g[5]=C(" 登录 "))]),_:1})):(k(),z(L,{key:1,value:"login"},{icon:l(()=>[a(x,{name:"login"})]),default:l(()=>[g[4]||(g[4]=C(" ... "))]),_:1}))]),default:l(()=>[(k(!0),H(K,null,J(m.value,w=>(k(),z(L,{key:w.name,value:w.name,to:{name:w.name}},{icon:l(()=>[w.icon?(k(),z(x,{key:0,name:w.icon},null,8,["name"])):oe("",!0)]),default:l(()=>[C(" "+D(w.title),1)]),_:2},1032,["value","to"]))),128))]),_:1},8,["modelValue"])}}}),gn=O(hn,[["__scopeId","data-v-9fdb245f"]]);function at(e){return e.children!==void 0}function vn(e){return e.children!==void 0}const bn={id:"menu-container"},yn=F({__name:"SidebarContent",setup(e){const t=xe(),n=d(!1),s=d(null),o=d(t.menuActiveName),r=d(t.menuList),c=d([]),$=d(!1),m=()=>{o.value=t.menuActiveName;const b=JSON.stringify(r.value),y=JSON.stringify(t.menuList);b!==y&&(c.value.push([...t.menuList]),_())},_=async()=>{if(c.value.length>0&&!$.value){for($.value=!0;c.value.length>1;)c.value.shift();const b=c.value.shift();n.value=b.length<=0,r.value=[],await ce(),s.value&&s.value.updateActiveName(),await new Promise(h=>setTimeout(h,300)),r.value=b,await ce(),s.value&&s.value.updateActiveName();const y=300;await new Promise(h=>setTimeout(h,y)),$.value=!1,await _()}};return t.$subscribe((b,y)=>{m()}),W(()=>{m()}),(b,y)=>{const h=Xe,g=Be,R=zt,x=jt,L=_e;return k(),H(K,null,[A("div",bn,[a(x,{modelValue:o.value,"onUpdate:modelValue":y[0]||(y[0]=p=>o.value=p),theme:"light",class:"sh-menu-container"},{default:l(()=>[a(vt,{name:"move-left"},{default:l(()=>[(k(!0),H(K,null,J(r.value,(p,j)=>(k(),H(K,{key:j},[se(vn)(p)?(k(),z(R,{key:0,title:p.title},{default:l(()=>[(k(!0),H(K,null,J(p.children,(w,P)=>(k(),z(g,{key:w.name,value:w.name,to:w.to},ze({default:l(()=>[C(" "+D(w.title),1)]),_:2},[w.icon?{name:"icon",fn:l(()=>[a(h,{name:w.icon,class:Re(w.iconClass)},null,8,["name","class"])]),key:"0"}:void 0]),1032,["value","to"]))),128))]),_:2},1032,["title"])):(k(),z(g,{key:p.name,value:p.name,to:p.to},ze({default:l(()=>[C(" "+D(p.title),1)]),_:2},[p.icon?{name:"icon",fn:l(()=>[a(h,{name:p.icon,class:Re(p.iconClass)},null,8,["name","class"])]),key:"0"}:void 0]),1032,["value","to"]))],64))),128))]),_:1})]),_:1},8,["modelValue"])]),a(L,{size:"small",loading:n.value,"show-overlay":!0,attach:"#menu-container",class:"sh-sidebar-loading",style:{"align-items":"flex-start","padding-top":"100px"}},null,8,["loading"])],64)}}}),wn=O(yn,[["__scopeId","data-v-96e2d89f"]]),kn={};function Sn(e,t){return null}const Cn=O(kn,[["render",Sn]]),Ln={class:"footer"},In={class:"footer-left"},Pn={class:"foot-time"},Tn={class:"footer-center"},xn={href:"https://boiltask.com",target:"_blank"},Vn={class:"footer-right"},$n={class:"foot-text"},jn={href:"https://github.com/hpu-user/DiDaOJ-web",target:"_blank"},zn=F({__name:"FooterContent",setup(e){const t=d("");function n(){t.value=new Date().toLocaleString()}return W(()=>{n(),setInterval(()=>{n()},1e3)}),(s,o)=>{const r=E;return k(),H("div",Ln,[A("div",In,[A("p",Pn,D(t.value),1)]),A("div",Tn,[A("a",xn,[a(r,{theme:"default",variant:"outline",ghost:!0},{default:l(()=>o[0]||(o[0]=[C("@BoilTask")])),_:1})])]),A("div",Vn,[A("p",$n,[A("a",jn,[a(r,{theme:"default",variant:"outline",ghost:!0},{default:l(()=>o[1]||(o[1]=[C("@didaoj-web")])),_:1})])])])])}}}),Rn=O(zn,[["__scopeId","data-v-400ac98b"]]),be=20,$e=100,je=50,En=F({__name:"ForceHiddenSidebarButton",setup(e){let t=xe();const n=d({x:window.innerWidth-$e-be,y:window.innerHeight-je-be}),s=d(window.innerWidth),o=d(window.innerHeight);let r=!1,c={x:0,y:0};const $=p=>{r=!0;const j=p.clientX??p.touches[0].clientX,w=p.clientY??p.touches[0].clientY;c={x:j-n.value.x,y:w-n.value.y},document.addEventListener("mousemove",m),document.addEventListener("touchmove",m),document.addEventListener("mouseup",_),document.addEventListener("touchend",_)},m=p=>{if(!r)return;const j=p.clientX??p.touches[0].clientX,w=p.clientY??p.touches[0].clientY;let P=j-c.x,v=w-c.y;P=Math.max(0,Math.min(P,s.value-$e)),v=Math.max(0,Math.min(v,o.value-je)),n.value={x:P,y:v}},_=()=>{r=!1,document.removeEventListener("mousemove",m),document.removeEventListener("touchmove",m),document.removeEventListener("mouseup",_),document.removeEventListener("touchend",_)},b=()=>{s.value=window.innerWidth,o.value=window.innerHeight,n.value={x:Math.min(n.value.x,s.value-$e-be),y:Math.min(n.value.y,o.value-je-be)}};let y=d(t.forceHiddenSidebar),h=d(t.forceHiddenSidebar);const g=()=>{y.value=!y.value,t.setForceHiddenSidebar(y.value)},R=()=>{h.value||(h.value=!0,t.setForceHiddenSidebar(y.value))},x=()=>{h.value&&(h.value=!1,t.setForceHiddenSidebar(!1))},L=p=>{p>=800?x():R()};return L(s.value),Ce(s,p=>{L(p)}),W(()=>{window.addEventListener("resize",b)}),me(()=>{window.removeEventListener("resize",b)}),(p,j)=>{const w=E;return se(h)?(k(),z(w,{key:0,class:"draggable-button",style:bt({top:`${n.value.y}px`,left:`${n.value.x}px`}),onMousedown:$,onTouchstart:$,variant:"dashed",theme:"primary",onClick:g},{default:l(()=>[C(D(se(y)?"显示":"隐藏"),1)]),_:1},8,["style"])):oe("",!0)}}}),An=O(En,[["__scopeId","data-v-1aee5506"]]),Dn={class:"sh-main"},Mn=F({__name:"View403",setup(e){let t=te();const n=d("");return W(()=>{t.query.target?n.value=t.query.target:n.value=t.fullPath}),(s,o)=>{const r=E;return k(),H("div",Dn,[A("p",null,D(n.value),1),o[2]||(o[2]=A("p",null,"该页面无访问权限，请更换访问目标或重新登陆后再试",-1)),a(r,{theme:"primary",onClick:o[0]||(o[0]=()=>s.$router.push("/"))},{default:l(()=>o[1]||(o[1]=[C("返回首页")])),_:1})])}}}),ot=O(Mn,[["__scopeId","data-v-777362b3"]]),ye="DidaOJ",qn=F({__name:"App",setup(e){const{globalProperties:t}=Q(),n=tt(),s=ue(),o=Me(),r=xe();n.$patch({Loaded:!1});const c=s.getToken,$=d(!1),m=d(!1);o.title&&o.title.length>0?document.title=o.title+" - "+ye:document.title=ye,o.$subscribe((h,g)=>{g.title&&g.title.length>0?document.title=g.title+" - "+ye:document.title=ye}),r.$subscribe((h,g)=>{$.value=g.showSidebar,m.value=$.value&&!g.forceHiddenSidebar});const _=te(),b=yt(()=>{const h=_.meta.auths;return h?!s.hasAllAuths(h):!1});function y(){t.$message.warning({duration:3e3,content:"登陆状态失效"}),n.$patch({Loaded:!0}),s.clear()}return W(()=>{if(c==""){n.$patch({Loaded:!0});return}Yt().then(h=>{h.code==0?(s.loadResponse(h.data),n.$patch({Loaded:!0})):(U(t,h.code),n.$patch({Loaded:!0}),s.clear())}).catch(h=>{console.log(h),y()})}),(h,g)=>{const R=Rt,x=At,L=Fe("RouterView"),p=Dt,j=Et,w=Mt;return k(),H(K,null,[a(j,null,{default:l(()=>[a(R,{class:"sh-header"},{default:l(()=>[a(gn)]),_:1}),a(j,null,{default:l(()=>[a(wt,{name:"slide"},{default:l(()=>[m.value?(k(),z(x,{key:0,class:"sh-sidebar"},{default:l(()=>[a(wn)]),_:1})):oe("",!0)]),_:1}),a(j,{class:Re(["sh-main-layout",{expanded:!m.value}])},{default:l(()=>[a(Cn),a(p,{class:"sh-main-content"},{default:l(()=>[b.value?(k(),z(ot,{key:0})):(k(),z(L,{key:1}))]),_:1}),a(Rn)]),_:1},8,["class"])]),_:1})]),_:1}),$.value?(k(),z(An,{key:0})):oe("",!0),a(w,{container:"body",offset:["24px","80px"],size:"small"})],64)}}}),Hn=O(qn,[["__scopeId","data-v-044043ee"]]);var lt=(e=>(e[e.Unknown=-1]="Unknown",e[e.C=0]="C",e[e.Cpp=1]="Cpp",e[e.Java=2]="Java",e[e.Python=3]="Python",e[e.Pascal=4]="Pascal",e[e.Golang=5]="Golang",e[e.Max=6]="Max",e))(lt||{});function st(){const e=[-1,4,5,6];return Object.values(lt).filter(t=>typeof t=="number"&&!e.includes(t)).map(t=>({value:t,label:rt(t)}))}function On(e){return e>-1&&e<6}function rt(e){switch(e){case 0:return"C";case 1:return"C++";case 2:return"Java";case 3:return"Python";case 4:return"Pascal";case 5:return"Golang";default:return"Unknown"}}function ut(e){switch(e){case 0:return"c";case 1:return"cpp";case 2:return"java";case 3:return"python";case 4:return"pascal";case 5:return"golang";default:return"text"}}var q=(e=>(e[e.Init=0]="Init",e[e.Rejudge=1]="Rejudge",e[e.Submitting=2]="Submitting",e[e.Queuing=3]="Queuing",e[e.Compiling=4]="Compiling",e[e.Running=5]="Running",e[e.Accept=6]="Accept",e[e.PE=7]="PE",e[e.WA=8]="WA",e[e.TLE=9]="TLE",e[e.MLE=10]="MLE",e[e.OLE=11]="OLE",e[e.RE=12]="RE",e[e.CE=13]="CE",e[e.CLE=14]="CLE",e[e.JudgeFail=15]="JudgeFail",e[e.SubmitFail=16]="SubmitFail",e[e.Unknown=17]="Unknown",e))(q||{});const Gn=e=>{switch(e){case 0:return"普通评测";case 1:return"特殊评测";default:return"未知"}},ke=e=>{switch(e){case 0:return"等待处理";case 1:return"重新评测";case 2:return"提交中";case 3:return"队列中";case 4:return"编译中";case 5:return"运行中";case 6:return"通过";case 7:return"格式错误";case 8:return"答案错误";case 9:return"超时";case 10:return"内存超限";case 11:return"输出超限";case 12:return"运行错误";case 13:return"编译错误";case 14:return"编译超限";case 15:return"评测失败";case 16:return"提交失败";case 17:return"未知";default:return e}};function Nn(){const e=[17];return Object.values(q).filter(t=>typeof t=="number"&&!e.includes(t)).map(t=>({value:t,label:ke(t)}))}function de(e){switch(e){case 0:case 1:case 2:case 4:case 5:return!0;default:return!1}}function it(e){var n;const t={};if(t.id=e.id,t.problemId=e.problem_id,t.status=e.status,de(e.status)?t.score="-":t.score=e.score.toString(),e.time?t.time=Math.ceil(e.time/1e6)+"ms":t.time="-",e.memory?t.memory=(e.memory/1024/1024).toFixed(2)+"MB":t.memory="-",t.language=rt(e.language),t.codeLength=e.code_length,e.approve_time?t.approveTime=new Date(e.approve_time).toLocaleString():t.approveTime="-",t.author=e.author,t.authorUsername=e.author_username,t.authorNickname=e.author_nickname,t.code=e.code,t.compileMessage=e.compile_message,t.task=[],e.task)for(let s=0;s<((n=e.task)==null?void 0:n.length);s++){const o=e.task[s],r={};r.taskId=o.task_id,r.status=o.status,o.time?r.time=Math.ceil(o.time/1e6)+"ms":r.time="-",o.memory?r.memory=(o.memory/1024/1024).toFixed(2)+"MB":r.memory="-",r.score=o.score,r.content=o.content,r.waHint=o.wa_hint,!r.content&&!r.waHint&&(r.content="无提示信息"),t.task.push(r)}return t}function Kn(e,t,n){return X({url:"/judge/approve",method:"post",data:{problem_id:e,language:t,code:n}})}function Un(e){return X({url:"/judge?id="+e,method:"get"})}function Fn(e,t,n,s,o,r){const c=new URLSearchParams({problem_id:e,username:t,language:String(n),status:String(s),page:String(o),page_size:String(r)});return X({url:`/judge/list?${c.toString()}`,method:"get"})}function Bn(){return X({url:"/judge/rejudge/recently",method:"post"})}var Ae=(e=>(e[e.None=0]="None",e[e.Attempt=1]="Attempt",e[e.Accept=2]="Accept",e))(Ae||{});function ct(e,t){const n={};if(n.id=e.id,n.author=e.author,n.title=e.title,n.tags=[],e.tags)for(const s of e.tags){const o=t[s];o&&n.tags.push(o)}return n.accept=e.accept,n.attempt=e.attempt,e.description!=null&&(n.description=e.description),e.time_limit!=null&&(n.timeLimit=e.time_limit.toString()+" ms"),e.memory_limit!=null&&(n.memoryLimit=(e.memory_limit/1024).toFixed(2)+" MB"),e.judge_type!=null&&(n.judgeType=Gn(e.judge_type)),e.insert_time!=null&&(n.insertTime=new Date(e.insert_time).toLocaleString()),e.update_time!=null&&(n.updateTime=new Date(e.update_time).toLocaleString()),e.creator_nickname!=null&&(n.creatorNickname=e.creator_nickname),e.source!=null&&(n.source=e.source),n}function Xn(e){return X({url:"/problem?id="+e,method:"get"})}function Wn(e){return X({url:"/problem/tag/list?max_count="+e,method:"get"})}function Yn(e,t,n,s){return X({url:"/problem/list?title="+e+"&tag="+t+"&page="+n+"&page_size="+s,method:"get"})}const Zn={style:{margin:"10px"}};function Jn(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!De(e)}const Qn=F({__name:"ProblemList",setup(e){const t=te(),n=Le(),{globalProperties:s}=Q();let o=null;const r=d(!1),c={};let $={};const m=d([{title:"ID",colKey:"id",cell:(u,i)=>{let f=p(i.row.id);return a(E,{variant:"dashed",theme:f,onClick:()=>L(i.row.id)},{default:()=>[i.row.id]})}},{title:"标题",colKey:"title",cell:(u,i)=>a(E,{variant:"text",onClick:()=>L(i.row.id)},{default:()=>[i.row.title]})},{title:"标签",colKey:"tags",cell:(u,i)=>{const f=i.row.tags;if(!f||f.length===0)return"";let I=[];for(let T=0;T<f.length;T++){const V=f[T];I.push(a(E,{key:T,theme:"default",variant:"outline"},{default:()=>[V.name]}))}return a(ie,null,Jn(I)?I:{default:()=>[I]})}},{title:"正确",colKey:"accept"},{title:"提交",colKey:"attempt"}]),_=d(!1);let b=1,y=50;const h=d({defaultPageSize:y,defaultCurrent:b,total:0,pageSizeOptions:[50,100]}),g=d(),R=d(),x=d({title:"",tag:""}),L=u=>{u&&n.push({path:"/problem/"+u})},p=u=>{if(!u||!$)return"default";const i=$[u];if(!i)return"default";switch(i){case Ae.Accept:return"success";case Ae.Attempt:return"warning";default:return"default"}},j=async()=>{await n.push({query:{...t.query,title:x.value.title,tag:x.value.tag,page:1,page_size:h.value.defaultPageSize}})},w=u=>{u&&n.push({query:{...t.query,title:"",tag:u.name,page:1,page_size:h.value.defaultPageSize}})},P=async(u,i)=>{_.value=!0;try{const{current:f,pageSize:I}=u,T=await Yn(x.value.title,x.value.tag,f,I);if(g.value=[],T.code===0){const V=T.data.list;if(!V||V.length<=0){h.value={...h.value,total:0},$=null,re(s,"未找到记录");return}V.forEach(G=>{var B;const N=ct(G,c);(B=g.value)==null||B.push(N)}),h.value={...h.value,total:T.data.total_count},$=T.data.problem_attempt_status}else i&&U(s,T.code)}catch(f){console.error(f),U(s,Ve())}finally{_.value=!1}},v=async u=>{await n.push({query:{...t.query,page:u.current,page_size:u.pageSize}})};return W(async()=>{R.value=[],Wn(-1).then(u=>{if(u.code===0){R.value=u.data.list,r.value=u.data.total_count>u.data.list.length;for(let i=0;i<u.data.list.length;i++){const f=u.data.list[i];c[f.id]=f}o=Ce(()=>t.query,i=>{x.value.title=i.title||"",x.value.tag=i.tag||"";const f=parseInt(i.page)||h.value.defaultCurrent,I=parseInt(i.page_size)||h.value.defaultPageSize;b=f,y=I,h.value={...h.value,defaultCurrent:b,defaultPageSize:y},P({current:b,pageSize:y},!0)},{immediate:!0})}else r.value=!0}).catch(u=>{console.error(u),r.value=!0})}),me(()=>{o&&o()}),(u,i)=>{const f=he,I=ne,T=fe,V=Te,G=Pe,N=E,B=Ie,Z=pe;return k(),z(Z,null,{default:l(()=>[a(T,{span:9},{default:l(()=>[a(I,{style:{margin:"10px"}},{default:l(()=>[a(f,{data:g.value,columns:m.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:h.value,loading:_.value,onPageChange:v},null,8,["data","columns","pagination","loading"])]),_:1})]),_:1}),a(T,{span:3},{default:l(()=>[A("div",Zn,[a(I,{class:"sh-card"},{default:l(()=>[a(B,{model:x.value},{default:l(()=>[a(G,{label:"标题"},{default:l(()=>[a(V,{modelValue:x.value.title,"onUpdate:modelValue":i[0]||(i[0]=S=>x.value.title=S),placeholder:"暂不支持模糊查询"},null,8,["modelValue"])]),_:1}),a(G,{label:"标签"},{default:l(()=>[a(V,{modelValue:x.value.tag,"onUpdate:modelValue":i[1]||(i[1]=S=>x.value.tag=S),placeholder:"暂不支持模糊查询"},null,8,["modelValue"])]),_:1}),a(G,null,{default:l(()=>[a(N,{theme:"primary",onClick:j},{default:l(()=>i[3]||(i[3]=[C("搜索")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(I,{class:"sh-card sh-background-black"},{default:l(()=>[(k(!0),H(K,null,J(R.value,S=>(k(),z(N,{class:"sh-tag-button",theme:"default",variant:"outline",ghost:!0,onClick:()=>w(S)},{default:l(()=>[C(D(S.name),1)]),_:2},1032,["onClick"]))),256)),r.value?(k(),z(N,{key:0,class:"sh-tag-button",theme:"default",variant:"outline",ghost:!0,onClick:i[2]||(i[2]=()=>u.$router.push("/problem/tags"))},{default:l(()=>i[4]||(i[4]=[C(" ... ")])),_:1})):oe("",!0)]),_:1})])]),_:1})]),_:1})}}}),Ge=O(Qn,[["__scopeId","data-v-e53dbd2f"]]);function He(e){e.querySelectorAll("pre > code:not([data-copy-attached])").forEach(n=>{n.setAttribute("data-copy-attached","true");const s=n.parentElement,o=document.createElement("div");o.className="copy-wrapper";const r=document.createElement("button");r.className="copy-btn",r.innerText="复制",r.addEventListener("click",async()=>{try{await navigator.clipboard.writeText(n.innerText),r.innerText="已复制",setTimeout(()=>r.innerText="复制",1500)}catch{r.innerText="失败"}}),s.replaceWith(o),o.appendChild(r),o.appendChild(s)})}const ea=["innerHTML"],ta={style:{margin:"12px"}},na={class:"dida-operation-container"},aa={class:"dida-code-submit-div"},oa=F({__name:"ProblemDetail",setup(e){let t=te();const{globalProperties:n}=Q(),s=Me();let o=d("");const r=d(""),c=d(null),$=d(!1),m=d(null);let _=null;const b=d(null),y={},h=d(""),g=d([]);g.value=st();const R=P=>{P&&Y.push({name:"problem-list",query:{...t.query,title:"",tag:P.name}})},x=()=>{Y.push({name:"judge-list",query:{problem_id:r.value}})},L=()=>{},p=()=>{Y.push({name:"problem-recommend",params:{problemId:r.value}})},j=async()=>{if(!r.value){we(n,"问题ID无效");return}const P=parseInt(h.value);if(!On(P)){we(n,"请选择所编写的语言");return}const v=_==null?void 0:_.getValue();if(!v){we(n,"请输入所需提交的代码");return}const u=await Kn(r.value,P,v);if(u.code!==0){U(n,u.code);return}re(n,"提交成功，正在跳转到详情页面");const i=u.data.id;await Y.push({path:"/judge/"+i})},w=P=>{_&&Oe.setModelLanguage(_.getModel(),ut(P))};return W(async()=>{if(t.params.problemId&&t.params.problemId.length===1)r.value=t.params.problemId[0];else{await Y.push({name:"problem"});return}$.value=!0;const P=await Xn(r.value);if(P.code!==0){$.value=!1,U(n,P.code),await Y.push({name:"problem"});return}P.data.tags&&P.data.tags.forEach(i=>{y[i.id]=i}),m.value=ct(P.data.problem,y),s.setTitle(m.value.title+" - "+s.getTitle);let v=m.value.description;const u={math:{inlineDigit:!0,engine:"KaTeX"}};o.value=await ae.md2html(v,u),await ce(()=>{c.value&&(ae.mathRender(c.value),ae.highlightRender({lineNumber:!0,enable:!0},c.value),He(c.value),b.value&&(_=Oe.create(b.value,{value:"",language:"cpp",minimap:{enabled:!0},colorDecorators:!0,readOnly:!1,theme:"vs-dark"}))),$.value=!1})}),(P,v)=>{const u=ne,i=fe,f=Ye,I=E,T=ie,V=We,G=Je,N=Ze,B=pe,Z=_e;return k(),z(Z,{loading:$.value},{default:l(()=>[a(B,{class:"dida-main-content"},{default:l(()=>[a(i,{span:8},{default:l(()=>[a(u,{style:{margin:"10px"}},{default:l(()=>[A("div",{innerHTML:se(o),ref_key:"markdownRef",ref:c},null,8,ea)]),_:1})]),_:1}),a(i,{span:4},{default:l(()=>[A("div",ta,[a(V,{layout:"vertical",bordered:!0},{default:l(()=>[a(f,{label:"标题"},{default:l(()=>{var S;return[C(D((S=m.value)==null?void 0:S.title),1)]}),_:1}),a(f,{label:"时间限制"},{default:l(()=>{var S;return[C(D((S=m.value)==null?void 0:S.timeLimit),1)]}),_:1}),a(f,{label:"内存限制"},{default:l(()=>{var S;return[C(D((S=m.value)==null?void 0:S.memoryLimit),1)]}),_:1}),a(f,{label:"判题方式"},{default:l(()=>{var S;return[C(D((S=m.value)==null?void 0:S.judgeType),1)]}),_:1}),a(f,{label:"正确提交"},{default:l(()=>{var S;return[C(D((S=m.value)==null?void 0:S.accept),1)]}),_:1}),a(f,{label:"提交总数"},{default:l(()=>{var S;return[C(D((S=m.value)==null?void 0:S.attempt),1)]}),_:1}),a(f,{label:"创建时间"},{default:l(()=>{var S;return[C(D((S=m.value)==null?void 0:S.insertTime),1)]}),_:1}),a(f,{label:"更新时间"},{default:l(()=>{var S;return[C(D((S=m.value)==null?void 0:S.updateTime),1)]}),_:1}),a(f,{label:"上传用户"},{default:l(()=>{var S;return[C(D((S=m.value)==null?void 0:S.creatorNickname),1)]}),_:1}),a(f,{label:"题目来源"},{default:l(()=>{var S;return[C(D((S=m.value)==null?void 0:S.source),1)]}),_:1}),a(f,{label:"标签"},{default:l(()=>[a(T,null,{default:l(()=>{var S;return[(k(!0),H(K,null,J((S=m.value)==null?void 0:S.tags,M=>(k(),z(I,{key:M.id,variant:"dashed",onClick:()=>R(M)},{default:l(()=>[C(D(M.name),1)]),_:2},1032,["onClick"]))),128))]}),_:1})]),_:1})]),_:1}),A("div",na,[a(T,null,{default:l(()=>[a(I,{onClick:x},{default:l(()=>v[1]||(v[1]=[C("提交记录")])),_:1}),a(I,{onClick:L},{default:l(()=>v[2]||(v[2]=[C("题目讨论")])),_:1}),a(I,{onClick:p},{default:l(()=>v[3]||(v[3]=[C("题目推荐")])),_:1})]),_:1})]),A("div",aa,[a(T,null,{default:l(()=>[a(N,{modelValue:h.value,"onUpdate:modelValue":v[0]||(v[0]=S=>h.value=S),label:"语言：",placeholder:"请选择提交语言","auto-width":"",clearable:"",onChange:w},{default:l(()=>[(k(!0),H(K,null,J(g.value,S=>(k(),z(G,{key:S.value,value:S.value,label:S.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"]),a(I,{onClick:j},{default:l(()=>v[4]||(v[4]=[C("提交")])),_:1})]),_:1}),A("div",{ref_key:"codeEditRef",ref:b,class:"dida-code-editor"},null,512)])])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),la=O(oa,[["__scopeId","data-v-b531a672"]]),sa={};function ra(e,t){return" TODO "}const ua=O(sa,[["render",ra]]);function ia(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!De(e)}const ca=F({__name:"JudgeJobList",setup(e){const t=te(),n=Le(),{globalProperties:s}=Q();let o=!1,r=null;const c=d({problemId:"",username:"",language:void 0,status:void 0}),$=d([{title:"ID",colKey:"id",cell:(u,i)=>a(E,{variant:"text",onClick:()=>L(i.row.id)},{default:()=>[i.row.id]})},{title:"问题",colKey:"problemId",cell:(u,i)=>a(E,{variant:"text",onClick:()=>x(i.row.problemId)},{default:()=>[i.row.problemId]})},{title:"状态",colKey:"status",align:"center",cell:(u,i)=>{const f=i.row.status,I=ke(f);let T;switch(f){case q.Init:case q.Rejudge:case q.Compiling:case q.Running:T="default";break;case q.Accept:T="success";break;case q.PE:T="warning";break;default:T="danger";break}let V=[];return de(f)&&V.push(a(_e,{text:i.row.state,size:"small",class:"dida-status-loading"},null)),V.push(a("span",null,[I])),a(E,{theme:T,variant:"outline",onClick:()=>L(i.row.id)},ia(V)?V:{default:()=>[V]})}},{title:"分数",colKey:"score"},{title:"时间",colKey:"time"},{title:"内存",colKey:"memory"},{title:"代码",colKey:"code",cell:(u,i)=>a(E,{theme:"default",onClick:()=>L(i.row.id)},{default:()=>[i.row.language+" / "+i.row.codeLength]})},{title:"作者",colKey:"author",width:200,cell:(u,i)=>a(E,{variant:"text",onClick:()=>p(i.row.authorUsername)},{default:()=>[i.row.authorNickname]})},{title:"提交时间",colKey:"approveTime",width:180}]),m=d(!1);let _=1,b=50;const y=d({defaultPageSize:b,defaultCurrent:_,total:0,pageSizeOptions:[50,100]}),h=d(),g=d([]);g.value=st();const R=d([]);R.value=Nn();const x=u=>{u&&n.push({path:"/problem/"+u})},L=u=>{u&&n.push({path:"/judge/"+u})},p=u=>{u&&n.push({path:"/user/"+u})},j=async()=>{await n.push({query:{...t.query,page:1,page_size:b,problem_id:c.value.problemId,username:c.value.username,language:c.value.language,status:c.value.status}})},w=async()=>{c.value.problemId="",c.value.username="",c.value.language=void 0,c.value.status=void 0,await n.push({query:{...t.query,page:1,page_size:b,problem_id:"",username:"",language:void 0,status:void 0}})},P=async(u,i)=>{i&&(m.value=!0);let f=!1;try{const{current:I,pageSize:T}=u,V=await Fn(c.value.problemId,c.value.username,c.value.language,c.value.status,I,T);h.value=[],V.code===0?V.data.list&&V.data.list.length>0?(V.data.list.forEach(N=>{var Z;const B=it(N);(Z=h.value)==null||Z.push(B),de(N.status)&&(f=!0)}),y.value={...y.value,total:V.data.total_count}):(re(s,"未找到记录"),y.value={...y.value,total:0}):i&&U(s,V.code)}catch(I){console.error(I),i&&U(s,Ve())}finally{i&&(m.value=!1),f&&o&&setTimeout(()=>{P({current:_,pageSize:b},!1)},5e3)}},v=async u=>{await n.push({query:{...t.query,page:u.current,page_size:u.pageSize}})};return W(async()=>{o=!0,r=Ce(()=>t.query,u=>{c.value.problemId=u.problem_id||"",c.value.username=u.username||"",u.language!=null?c.value.language=Number(u.language):c.value.language=void 0,u.status!=null?c.value.status=Number(u.status):c.value.status=void 0;const i=parseInt(u.page)||y.value.defaultCurrent,f=parseInt(u.page_size)||y.value.defaultPageSize;_=i,b=f,y.value={...y.value,defaultCurrent:_,defaultPageSize:b},P({current:_,pageSize:b},!0)},{immediate:!0})}),me(()=>{o=!1,r&&r()}),(u,i)=>{const f=Te,I=Pe,T=Je,V=Ze,G=E,N=ie,B=Ie,Z=he,S=ne;return k(),z(S,{style:{margin:"10px"}},{default:l(()=>[a(B,{layout:"inline",onSubmit:j,onReset:w},{default:l(()=>[a(I,{label:"题号"},{default:l(()=>[a(f,{modelValue:c.value.problemId,"onUpdate:modelValue":i[0]||(i[0]=M=>c.value.problemId=M),placeholder:"请输入完整题号"},null,8,["modelValue"])]),_:1}),a(I,{label:"用户"},{default:l(()=>[a(f,{modelValue:c.value.username,"onUpdate:modelValue":i[1]||(i[1]=M=>c.value.username=M),placeholder:"仅支持输入完整用户名"},null,8,["modelValue"])]),_:1}),a(I,{label:"语言"},{default:l(()=>[a(V,{modelValue:c.value.language,"onUpdate:modelValue":i[2]||(i[2]=M=>c.value.language=M),placeholder:"请选择提交语言","auto-width":"",clearable:""},{default:l(()=>[(k(!0),H(K,null,J(g.value,M=>(k(),z(T,{key:M.value,value:M.value,label:M.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(I,{label:"状态"},{default:l(()=>[a(V,{modelValue:c.value.status,"onUpdate:modelValue":i[3]||(i[3]=M=>c.value.status=M),placeholder:"请选择评测状态","auto-width":"",clearable:""},{default:l(()=>[(k(!0),H(K,null,J(R.value,M=>(k(),z(T,{key:M.value,value:M.value,label:M.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(I,null,{default:l(()=>[a(N,null,{default:l(()=>[a(G,{theme:"primary",type:"submit"},{default:l(()=>i[4]||(i[4]=[C("搜索")])),_:1}),a(G,{theme:"default",variant:"base",type:"reset"},{default:l(()=>i[5]||(i[5]=[C("重置")])),_:1})]),_:1})]),_:1})]),_:1}),a(Z,{data:h.value,columns:$.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:y.value,loading:m.value,onPageChange:v},null,8,["data","columns","pagination","loading"])]),_:1})}}}),da=O(ca,[["__scopeId","data-v-609b5c5b"]]),ma=["innerHTML"];function Ne(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!De(e)}const pa=F({__name:"JudgeJobDetail",setup(e){const t=te(),n=Le(),{globalProperties:s}=Q();let o=!1,r=-1;const c=d(null),$=d(""),m=d(null),_=d([{title:"ID",colKey:"id"},{title:"问题",colKey:"problemId",cell:(L,p)=>a(E,{variant:"text",onClick:()=>h(p.row.problemId)},{default:()=>[p.row.problemId]})},{title:"状态",colKey:"status",align:"center",cell:(L,p)=>{const j=p.row.status,w=ke(j);let P;switch(j){case q.Init:case q.Rejudge:case q.Compiling:case q.Running:P="default";break;case q.Accept:P="success";break;case q.PE:P="warning";break;default:P="danger";break}let v=[];return de(j)&&v.push(a(_e,{text:p.row.state,size:"small",class:"dida-status-loading"},null)),v.push(a("span",null,[w])),a(E,{theme:P,variant:"outline"},Ne(v)?v:{default:()=>[v]})}},{title:"分数",colKey:"score"},{title:"时间",colKey:"time"},{title:"内存",colKey:"memory"},{title:"代码",colKey:"language",cell:(L,p)=>a("span",null,[p.row.language+" / "+p.row.codeLength])},{title:"作者",colKey:"author",cell:(L,p)=>a(E,{variant:"text",onClick:()=>g(p.row.authorUsername)},{default:()=>[p.row.authorNickname]})},{title:"提交时间",colKey:"approveTime",width:180}]),b=d(!1),y=d(),h=L=>{L&&n.push({path:"/problem/"+L})},g=L=>{L&&n.push({path:"/user/"+L})},R=L=>{const p=L.status,j=ke(p);let w;switch(p){case q.Init:case q.Rejudge:case q.Compiling:case q.Running:w="default";break;case q.Accept:w="success";break;case q.PE:w="warning";break;default:w="danger";break}return a(ie,null,{default:()=>[a(E,{theme:"default",variant:"outline"},{default:()=>[L.taskId]}),a(E,{theme:w,variant:"outline"},Ne(j)?j:{default:()=>[j]}),a("span",null,[C("分数："),L.score]),a("span",null,[C("用时："),L.time]),a("span",null,[C("内存："),L.memory])]})},x=async L=>{var j;L&&(b.value=!0);let p=!1;try{const w=await Un(r);if(y.value=[],w.code===0){const P=w.data,v=it(P);(j=y.value)==null||j.push(v);const u={};if(P.code){const f=`\`\`\`${ut(P.language)}
${P.code}
\`\`\``;$.value=await ae.md2html(f,u),await ce(()=>{m.value&&(ae.highlightRender({lineNumber:!0,enable:!0},m.value),He(m.value))})}c.value=v,de(P.status)&&(p=!0)}else L&&U(s,w.code)}catch(w){console.error(w),L&&U(s,Ve())}finally{L&&(b.value=!1),p&&o&&setTimeout(()=>{x(!1)},5e3)}};return W(async()=>{if(o=!0,t.params.judgeId&&t.params.judgeId.length===1)r=parseInt(t.params.judgeId[0]);else{await n.push({name:"judge"});return}await x(!0)}),me(()=>{o=!1}),(L,p)=>{var u,i;const j=he,w=ne,P=et,v=Qe;return k(),H(K,null,[a(w,{style:{margin:"10px"}},{default:l(()=>[a(j,{data:y.value,columns:_.value,"row-key":"id","vertical-align":"top",hover:!0,loading:b.value},null,8,["data","columns","loading"])]),_:1}),A("div",{innerHTML:$.value,ref_key:"markdownCodeRef",ref:m},null,8,ma),(u=c.value)!=null&&u.compileMessage?(k(),z(w,{key:0,class:"compile-message"},{default:l(()=>{var f;return[C(D((f=c.value)==null?void 0:f.compileMessage),1)]}),_:1})):oe("",!0),((i=c.value)==null?void 0:i.task.length)>0?(k(),z(v,{key:1,class:"task-panel"},{default:l(()=>{var f;return[(k(!0),H(K,null,J((f=c.value)==null?void 0:f.task,I=>(k(),z(P,{key:I.taskId,header:()=>R(I)},{default:l(()=>[C(D(I.content)+" "+D(I.waHint),1)]),_:2},1032,["header"]))),128))]}),_:1})):oe("",!0)],64)}}}),fa=O(pa,[["__scopeId","data-v-dff28af3"]]);function _a(e){let t="";for(e++;e>0;)e--,t=String.fromCharCode(65+e%26)+t,e=Math.floor(e/26);return t}async function dt(e){const t={};if(t.id=e.id,t.ownerId=e.owner_id,t.ownerUsername=e.owner_username,t.ownerNickname=e.owner_nickname,t.title=e.title,t.startTime=new Date(e.start_time).toLocaleString(),t.endTime=new Date(e.end_time).toLocaleString(),e.descriptions){t.descriptions=[];const n={math:{inlineDigit:!0,engine:"KaTeX"}};for(let s=0;s<e.descriptions.length;s++){const o=e.descriptions[s],r={};r.title=o.title,r.content=await ae.md2html(o.content,n),r.sort=o.sort,t.descriptions.push(r)}}if(t.notification=e.notification,e.problems){t.problems=[],e.problems.sort((n,s)=>n.sort-s.sort);for(let n=0;n<e.problems.length;n++){const s=e.problems[n];s.accept||(s.accept=0),s.attempt||(s.attempt=0),s.id=_a(n),t.problems.push(s)}}return t}function ha(e){return X({url:"/contest?id="+e,method:"get"})}function ga(e,t){return X({url:"/contest/list?page="+e+"&page_size="+t,method:"get"})}function va(e){return X({url:"/contest/create",method:"post",data:e})}const ba={style:{margin:"10px"}},ya=F({__name:"ContestList",setup(e){const t=te(),n=Le(),{globalProperties:s}=Q();let o=null;const r=d(!1),c=d(!1),$=d([{title:"ID",colKey:"id",width:"100",cell:(v,u)=>a(E,{variant:"text",onClick:()=>x(u.row.id)},{default:()=>[u.row.id]})},{title:"标题",colKey:"title",cell:(v,u)=>a(E,{variant:"text",onClick:()=>x(u.row.id)},{default:()=>[u.row.title]})},{title:"负责人",colKey:"ownerNickname",width:"200"},{title:"开始时间",colKey:"startTime",width:"180"},{title:"结束时间",colKey:"endTime",width:"180"}]),m=d(!1);let _=1,b=50;const y=d({defaultPageSize:b,defaultCurrent:_,total:0,pageSizeOptions:[50,100]}),h=d(),g=d({title:"",username:""}),R=d({title:"",description:"",open_time:[]}),x=v=>{v&&n.push({path:"/contest/"+v})},L=async()=>{await n.push({query:{...t.query,title:g.value.title,username:g.value.username,page:1,page_size:y.value.defaultPageSize}})},p=async(v,u)=>{var i;m.value=!0;try{const{current:f,pageSize:I}=v,T=await ga(f,I);if(h.value=[],T.code===0){const V=T.data.list;for(let G=0;G<V.length;G++){const N=V[G],B=await dt(N);(i=h.value)==null||i.push(B)}y.value={...y.value,total:T.data.total_count}}else u&&U(s,T.code)}catch(f){console.error(f),U(s,Ve())}finally{m.value=!1}},j=async v=>{await n.push({query:{...t.query,page:v.current,page_size:v.pageSize}})},w=()=>{r.value=!0},P=async()=>{c.value=!0,console.log("contestCreateForm",R.value),va(R.value).then(v=>{v.code===0?(re(s,"创建比赛成功"),r.value=!1,n.push({path:"/contest/"+v.data.id})):U(s,v.code)}).finally(()=>{c.value=!1})};return W(async()=>{o=Ce(()=>t.query,v=>{g.value.title=v.title||"",g.value.username=v.username||"";const u=parseInt(v.page)||y.value.defaultCurrent,i=parseInt(v.page_size)||y.value.defaultPageSize;_=u,b=i,y.value={...y.value,defaultCurrent:_,defaultPageSize:b},p({current:_,pageSize:b},!0)},{immediate:!0})}),me(()=>{o&&o()}),(v,u)=>{const i=he,f=ne,I=fe,T=Te,V=Pe,G=E,N=Ie,B=ie,Z=pe,S=Ht,M=qt;return k(),H(K,null,[a(Z,null,{default:l(()=>[a(I,{span:9},{default:l(()=>[a(f,{style:{margin:"10px"}},{default:l(()=>[a(i,{data:h.value,columns:$.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:y.value,loading:m.value,onPageChange:j},null,8,["data","columns","pagination","loading"])]),_:1})]),_:1}),a(I,{span:3},{default:l(()=>[A("div",ba,[a(f,{class:"sh-card"},{default:l(()=>[a(N,{model:g.value},{default:l(()=>[a(V,{label:"标题"},{default:l(()=>[a(T,{modelValue:g.value.title,"onUpdate:modelValue":u[0]||(u[0]=ee=>g.value.title=ee),placeholder:"暂不支持模糊查询"},null,8,["modelValue"])]),_:1}),a(V,{label:"负责人"},{default:l(()=>[a(T,{modelValue:g.value.username,"onUpdate:modelValue":u[1]||(u[1]=ee=>g.value.username=ee),placeholder:"仅支持输入完整用户名"},null,8,["modelValue"])]),_:1}),a(V,null,{default:l(()=>[a(G,{theme:"primary",onClick:L},{default:l(()=>u[6]||(u[6]=[C("提交")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(f,{class:"sh-card"},{default:l(()=>[a(B,null,{default:l(()=>[a(G,{onClick:w},{default:l(()=>u[7]||(u[7]=[C("创建")])),_:1})]),_:1})]),_:1})])]),_:1})]),_:1}),a(M,{visible:r.value,"onUpdate:visible":u[5]||(u[5]=ee=>r.value=ee),header:"创建比赛",onConfirm:P,"confirm-loading":c.value},{default:l(()=>[a(N,{"label-width":80,model:R.value,onSubmit:u[4]||(u[4]=kt(()=>{},["prevent"]))},{default:l(()=>[a(V,{label:"标题"},{default:l(()=>[a(T,{modelValue:R.value.title,"onUpdate:modelValue":u[2]||(u[2]=ee=>R.value.title=ee),placeholder:"请输入标题"},null,8,["modelValue"])]),_:1}),a(V,{label:"开启时间"},{default:l(()=>[a(S,{"enable-time-picker":"","allow-input":"",clearable:"",modelValue:R.value.open_time,"onUpdate:modelValue":u[3]||(u[3]=ee=>R.value.open_time=ee)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","confirm-loading"])],64)}}}),le=O(ya,[["__scopeId","data-v-86179fd9"]]),wa=["innerHTML"],ka={style:{margin:"12px"}},Sa=F({__name:"ContestDetail",setup(e){let t=te();const{globalProperties:n}=Q(),s=d(""),o=d(!1),r=d(null),c=d([{title:"ID",colKey:"id",cell:(m,_)=>a(E,{variant:"text"},{default:()=>[_.row.id]})},{title:"标题",colKey:"title",cell:(m,_)=>a(E,{variant:"text"},{default:()=>[_.row.title]})},{title:"正确",colKey:"accept"},{title:"提交",colKey:"attempt"}]),$=d([]);return W(async()=>{if(t.params.contestId&&t.params.contestId.length===1)s.value=t.params.contestId[0];else{await Y.push({name:"contest"});return}o.value=!0;const m=await ha(s.value);if(m.code!==0){o.value=!1,U(n,m.code),await Y.push({name:"contest"});return}r.value=await dt(m.data),$.value=r.value.problems,await ce(()=>{const _=document.querySelectorAll(".contest-description");_&&_.length>0&&_.forEach(b=>{ae.mathRender(b),ae.highlightRender({lineNumber:!0,enable:!0},b),He(b)}),o.value=!1})}),(m,_)=>{const b=Ot,y=E,h=ie,g=et,R=Qe,x=he,L=ne,p=fe,j=Ye,w=We,P=pe,v=_e;return k(),z(v,{loading:o.value},{default:l(()=>[a(P,{class:"dida-main-content"},{default:l(()=>[a(p,{span:8},{default:l(()=>{var u,i,f;return[A("h1",null,D((u=r.value)==null?void 0:u.title),1),(i=r.value)!=null&&i.notification?(k(),z(b,{key:0,theme:"info",message:(f=r.value)==null?void 0:f.notification},null,8,["message"])):oe("",!0),a(R,{"default-value":[0],"expand-icon":!1,borderless:!0},{default:l(()=>{var I;return[(k(!0),H(K,null,J((I=r.value)==null?void 0:I.descriptions,(T,V)=>(k(),z(g,{key:V,header:T.title},ze({default:l(()=>[A("div",{innerHTML:T.content,class:"dida-content-description"},null,8,wa)]),_:2},[V===0?{name:"headerRightContent",fn:l(()=>[a(h,{size:"small"},{default:l(()=>[a(y,{size:"small"},{default:l(()=>_[0]||(_[0]=[C("收起全部")])),_:1}),a(y,{size:"small"},{default:l(()=>_[1]||(_[1]=[C("展开全部")])),_:1})]),_:1})]),key:"0"}:void 0]),1032,["header"]))),128))]}),_:1}),a(L,{style:{margin:"10px"}},{default:l(()=>[a(x,{data:$.value,columns:c.value,"row-key":"id","vertical-align":"top",hover:!0},null,8,["data","columns"])]),_:1})]}),_:1}),a(p,{span:4},{default:l(()=>[A("div",ka,[a(w,{layout:"vertical",bordered:!0},{default:l(()=>[a(j,{label:"开始时间"},{default:l(()=>{var u;return[C(D((u=r.value)==null?void 0:u.startTime),1)]}),_:1})]),_:1})])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),Ca=O(Sa,[["__scopeId","data-v-7aec72d2"]]),La=F({__name:"ManageJudge",setup(e){const{globalProperties:t}=Q(),n=async()=>{const s=await Bn();if(s.code!==0){U(t,s.code);return}re(t,"重判成功")};return(s,o)=>{const r=E,c=ne;return k(),z(c,{class:"yj-manage-card",title:"重判"},{default:l(()=>[a(r,{onClick:n},{default:l(()=>o[0]||(o[0]=[C("重判")])),_:1})]),_:1})}}}),Ia=O(La,[["__scopeId","data-v-5ec0c045"]]),mt=[{name:"problem-list",tab:"problem",sidebar:"problem-list",path:"",title:"问题列表",icon:"cpu",component:Ge},{name:"problem-detail",tab:"problem",sidebar:"problem-list",path:":problemId+",title:"问题详情",icon:"cpu",component:la},{name:"problem-recommend",tab:"problem",sidebar:"problem-recommend",path:"recommend/:problemId*",title:"问题推荐",icon:"cpu",component:ua},{name:"judge-list",tab:"judge",sidebar:"judge-list",path:"",title:"评测列表",icon:"cpu",component:da},{name:"judge-detail",tab:"judge",sidebar:"judge-list",path:":judgeId+",title:"评测详情",icon:"cpu",component:fa},{name:"contest-list",tab:"contest",sidebar:"contest-list",path:"",title:"比赛列表",icon:"cpu",component:le},{name:"contest-recent",tab:"contest",sidebar:"contest-recent",path:"recent",title:"近期比赛",icon:"cpu",component:le},{name:"contest-detail",tab:"contest-detail",sidebar:"contest-detail",path:":contestId+",title:"比赛详情",icon:"cpu",component:Ca},{name:"contest-problem",tab:"contest-detail",sidebar:"contest-problem",path:":contestId+/problem",title:"问题列表",icon:"cpu",component:le},{name:"contest-judge",tab:"contest-detail",sidebar:"contest-judge",path:":contestId+/judge",title:"评测列表",icon:"cpu",component:le},{name:"contest-rank",tab:"contest-detail",sidebar:"contest-rank",path:":contestId+/rank",title:"比赛排名",icon:"cpu",component:le},{name:"contest-statistics",tab:"contest-detail",sidebar:"contest-statistics",path:":contestId+/statistics",title:"结果统计",icon:"cpu",component:le},{name:"contest-discuss",tab:"contest-detail",sidebar:"contest-discuss",path:":contestId+/discuss",title:"比赛讨论",icon:"cpu",component:le},{name:"manage-problem",tab:"manage",path:"problem",sidebar:"manage-problem",title:"问题管理",icon:"cpu",auths:["i-manage-problem"],component:Ge},{name:"manage-judge",tab:"manage",path:"judge",sidebar:"manage-judge",title:"评测管理",icon:"cpu",auths:["i-manage-judge"],component:Ia}],Ke=(e,t,n)=>{n.tab==t&&(n.disableSidebar||n.sidebar==null||n.sidebar!=n.name||e.push({name:n.name,title:n.title,icon:n.icon,to:{name:n.name}}))},Pa=e=>{const t=[];return mt.forEach(n=>{if(at(n)){const s=[];n.children.forEach(o=>{Ke(s,e,o)}),s.length>0&&t.push({title:n.title,children:s})}else Ke(t,e,n)}),t},Ue=(e,t)=>{const n=pn(t.tab),s={name:t.name,path:"/"+t.path,meta:{title:t.title+" - "+n.title,tab:t.tab,sidebar:t.sidebar,showSidebar:n.showSidebar,needLogin:n.needLogin||t.needLogin,tabAuths:n.auths,auths:t.auths},component:t.component};n.disablePath||(s.path=n.path+s.path),e.push(s)},Ta=e=>{mt.forEach(t=>{at(t)?t.children.forEach(n=>{Ue(e,n)}):Ue(e,t)})},ge=[];_n(ge);Ta(ge);ge.push({path:"/403",name:"403",component:ot});ge.push({path:"/:pathMatch(.*)*",name:"404",component:nt});const Y=St({history:Ct("/"),routes:ge});Y.beforeEach((e,t,n)=>{if(e.name==null||!Y.hasRoute(e.name)){n({name:"home"});return}const s=e.matched[e.matched.length-1].meta;if(s.redirect){n({name:s.redirect});return}if(s.needLogin){const r=ue();if(r.getToken==null||r.getToken==""){n({name:"login",query:{redirect_uri:e.fullPath}});return}}const o=s.tabAuths;if(o&&!ue().hasAllAuths(o)){n({name:"403",query:{target:e.fullPath}});return}n()});Y.afterEach((e,t)=>{if(e.name===t.name)return;const n=xe(),s=Me();let o=null;if(e.matched.length>0&&(o=e.matched[e.matched.length-1].meta),o!=null&&o.title&&s.setTitle(o==null?void 0:o.title),o!=null&&o.showSidebar){n.setSidebarShow(!0);const r=Pa(o==null?void 0:o.tab);n.setMenuList(r),n.setMenuActiveName(o==null?void 0:o.sidebar)}else n.setSidebarShow(!1)});Nt.registerLanguage("verilog",Kt);const pt=Lt();pt.use(It);const ve=Pt(Hn);ve.use(pt);ve.use(Y);ve.use(Gt);ve.use(Tt);ve.mount("#app");an().then(()=>{console.log("Text cache reinitialized")}).catch(e=>{console.error("Text cache reinitialization failed",e)});
