import{bm as Fe,bn as Kt,bo as X,s as a,bp as n,bq as x,br as M,ap as k,n as te,r as g,bs as ie,bt as q,aD as ae,g as Nt,o as oe,bu as N,bv as _t,bw as Ne,bx as gt,F as ee,by as fe,bz as ue,aM as Gt,bA as Qe,bB as et,q as we,y as ze,J as Le,bC as vt,c as Ce,a0 as Ft,bD as Ae,u as Be,bE as Re,ac as Bt,bF as Xt,bG as Wt,bH as Jt,bI as Yt,B as Zt,bJ as Qt}from"./node_modules-CwWekrCs.js";import{R as he,C as be,a as ce,B as O,F as Pe,b as Te,I as ke,L as ht,M as bt,c as yt,S as ea,H as ta,d as aa,e as na,f as ve,g as oa,h as la,A as sa,i as ra,j as ua,T as xe,k as _e,D as Ee,l as Me,m as wt,O as kt,n as nt,P as ia,o as Ct,p as St,q as It,r as ca,s as da,t as ma,u as pa,v as fa,w as _a,x as ga,y as va}from"./tdesign-vue-next-Br0XQrkj.js";import{V as ne}from"./vditor-DArazWIS.js";import{e as it}from"./monaco-editor-DCUKHC_e.js";import{H as ha,v as ba}from"./highlight.js-D9zWiMxS.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const i of l)if(i.type==="childList")for(const v of i.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&s(v)}).observe(document,{childList:!0,subtree:!0});function o(l){const i={};return l.integrity&&(i.integrity=l.integrity),l.referrerPolicy&&(i.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?i.credentials="include":l.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(l){if(l.ep)return;l.ep=!0;const i=o(l);fetch(l.href,i)}})();var Se=(e=>(e.Manage="i-manage",e.ManageJudge="i-manage-judge",e.ManageProblem="i-manage-problem",e))(Se||{});const ya={"r-admin":["i-manage","i-manage-judge","i-manage-problem"]};function wa(e){if(e==null)return[];const t=[];for(const o of e){const s=ya[o];s!=null&&t.push(...s)}return[...new Set(t)]}function ka(e,t){if(e==null||t==null)return!1;const o=wa(e);for(const s of t)if(!o.includes(s))return!1;return!0}const ge=Fe("user",{state:()=>({token:"",userId:-1,username:"",nickname:"",roles:[]}),getters:{getToken(){return this.token},getUserId(){return this.userId},getUsername(){return this.username},getNickname(){return this.nickname}},actions:{clear(){this.$patch({token:"",userId:-1,username:"",nickname:"",roles:[]})},loadResponse(e){this.$patch({token:e.token,userId:e.user_id,username:e.username,nickname:e.nickname,roles:e.roles})},isLogin(){return this.token!=null&&this.token!=""},hasAuth(e){return this.hasAllAuths([e])},hasAllAuths(e){return e?ka(this.roles,e):!0}},persist:!0}),Ca="https://oj-api.didapipa.com/",J=Kt.create({baseURL:Ca,timeout:6e4,withCredentials:!0,headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});J.interceptors.request.use(e=>{const o=ge().getToken;return o&&(e.headers["X-Token"]=o),e},e=>Promise.reject(e));J.interceptors.response.use(function(e){return e.data},function(e){return Promise.reject(e)});function Lt(e,t){return J({url:"/user/login",method:"post",data:{username:e,password:t}})}function Sa(){return J({url:"/user/login/refresh",method:"post"})}const Pt=Fe("login",{state:()=>({Loaded:!1}),getters:{isLoaded(){return this.Loaded}}}),Ve=Fe("webStyle",{state:()=>({title:""}),getters:{getTitle(){return this.title}},actions:{setTitle(e){this.title=e}}}),Xe=Fe("sidebarStyle",{state:()=>({showSidebar:!1,forceHiddenSidebar:!1,menuActiveName:"",menuList:[]}),getters:{getMenuList(){return this.menuList}},actions:{setSidebarShow(e){this.showSidebar=e},setForceHiddenSidebar(e){this.forceHiddenSidebar=e},setMenuActiveName(e){this.menuActiveName=e},clearMenuList(){this.menuList=[]},setMenuList(e){this.menuList=e},addMenuList(e){this.menuList.push(e)}}}),Y=(e,t)=>{const o=e.__vccOpts||e;for(const[s,l]of t)o[s]=l;return o},Ia={},La={class:"sh-main"};function Pa(e,t){const o=ce,s=be,l=he;return x(),X("div",La,[a(l,null,{default:n(()=>[a(s,{span:6},{default:n(()=>[a(o,{title:"正在完善，欢迎提供意见建议"},{default:n(()=>t[0]||(t[0]=[M("p",null,[M("a",{href:"https://codeoj.cn/",target:"_blank"},"CodeOJ"),k("的迁移计划")],-1),M("p",null,"正在开发中",-1)])),_:1})]),_:1})]),_:1})])}const Ta=Y(Ia,[["render",Pa],["__scopeId","data-v-78f609f9"]]),xa={class:"sh-main"},Va=te({__name:"View404",setup(e){let t=ie(),o=g(t.fullPath);return(s,l)=>{const i=O;return x(),X("div",xa,[M("p",null,q(ae(o)),1),l[2]||(l[2]=M("p",null,"该页面无效或已被迁移，请重新选择访问目标",-1)),a(i,{theme:"primary",onClick:l[0]||(l[0]=()=>s.$router.push("/"))},{default:n(()=>l[1]||(l[1]=[k("返回首页")])),_:1})])}}}),Tt=Y(Va,[["__scopeId","data-v-d4218944"]]);let tt=null;async function ja(){tt=await za()}function $a(e,t="zh"){if(tt==null)return[!1,e.toString()];const o=tt[e.toString()];if(!o)return[!1,e.toString()];let s=o[t];return s||(t="zh",s=o[t]),s?[!0,s]:[!1,e.toString()]}async function za(){return new Promise((e,t)=>{e({404:{zh:"接口未找到"},1e3:{zh:"系统错误"},10001:{zh:"权限异常，请重新登陆后再试"},10002:{zh:"参数不符合要求"},10003:{zh:"未找到目标数据"},100001:{zh:"用户名不存在或密码不匹配"}})})}function se(){const{appContext:e}=Nt();return{globalProperties:e.config.globalProperties}}function Ie(){return 1e3}function xt(e,t,o=3e3){e.$message.success({duration:o,content:t})}function pe(e,t,o=3e3){e.$message.info({duration:o,content:t})}function me(e,t,o=3e3){e.$message.error({duration:o,content:t})}function K(e,t,o=3e3){const[s,l]=$a(t),i=s?l:`系统错误，错误提示[${l}]`;e.$message.error({duration:o,content:i})}const Da={class:"dida-login-footer"},Ra=te({__name:"LoginView",setup(e){const{globalProperties:t}=se(),o=ge(),s=g(!1),l=g({account:"",password:""}),i=()=>{pe(t,"重置成功")},v=({validateResult:I,firstError:m})=>{s.value||Lt(l.value.account,l.value.password).then(p=>{if(p.code===0){o.loadResponse(p.data),pe(t,"登录成功");let d=t.$route.query.redirect_uri;d||(d="/user/"+p.data.username),t.$router.push({path:d})}else K(t,p.code)}).catch(p=>{console.error("Login error",p),me(t,"登录失败")})};return oe(()=>{if(o.isLogin()){t.$router.push({path:"/user"});return}}),(I,m)=>{const p=ke,d=Te,u=O,b=Pe,C=ht,V=ce;return x(),N(V,{class:"yj-login-card",title:"欢迎使用DidaOJ~"},{default:n(()=>[a(b,{ref:"form",data:l.value,colon:!0,onReset:i,onSubmit:v,class:"yj-login-form","label-width":0},{default:n(()=>[a(d,{name:"account"},{default:n(()=>[a(p,{modelValue:l.value.account,"onUpdate:modelValue":m[0]||(m[0]=L=>l.value.account=L),clearable:"",placeholder:"请输入账户名"},{"prefix-icon":n(()=>[a(ae(_t))]),_:1},8,["modelValue"])]),_:1}),a(d,{name:"password"},{default:n(()=>[a(p,{modelValue:l.value.password,"onUpdate:modelValue":m[1]||(m[1]=L=>l.value.password=L),type:"password",clearable:"",placeholder:"请输入密码"},{"prefix-icon":n(()=>[a(ae(Ne))]),_:1},8,["modelValue"])]),_:1}),a(d,null,{default:n(()=>[a(u,{theme:"primary",type:"submit",block:"",loading:s.value},{default:n(()=>m[4]||(m[4]=[k("登录")])),_:1},8,["loading"])]),_:1})]),_:1},8,["data"]),M("div",Da,[a(C,{onClick:m[2]||(m[2]=()=>{ae(t).$router.push({name:"login-forget"})})},{default:n(()=>m[5]||(m[5]=[k("忘记密码")])),_:1}),a(C,{onClick:m[3]||(m[3]=()=>{ae(t).$router.push({name:"register"})})},{default:n(()=>m[6]||(m[6]=[k("注册账户")])),_:1})])]),_:1})}}}),Aa=Y(Ra,[["__scopeId","data-v-9450941b"]]),Ea={};function Ma(e,t){return" TODO "}const qa=Y(Ea,[["render",Ma]]),Ua={class:"dida-login-footer"},Ha=te({__name:"RegisterView",setup(e){const{globalProperties:t}=se(),o=ge(),s=g(!1),l=g({account:"",password:"",confirmPassword:"",email:""}),i=()=>{pe(t,"重置成功")},v=({validateResult:I,firstError:m})=>{s.value||Lt(l.value.account,l.value.password).then(p=>{if(p.code===0){o.loadResponse(p.data),pe(t,"登录成功");let d=t.$route.query.redirect_uri;d||(d="/user/"+p.data.username),t.$router.push({path:d})}else K(t,p.code)}).catch(p=>{console.error("Login error",p),me(t,"登录失败")})};return oe(()=>{if(o.isLogin()){t.$router.push({path:"/user"});return}}),(I,m)=>{const p=ke,d=Te,u=O,b=Pe,C=ht,V=ce;return x(),N(V,{class:"yj-login-card",title:"欢迎使用DidaOJ~"},{default:n(()=>[a(b,{ref:"form",data:l.value,colon:!0,onReset:i,onSubmit:v,class:"yj-login-form","label-width":0},{default:n(()=>[a(d,{name:"account"},{default:n(()=>[a(p,{modelValue:l.value.account,"onUpdate:modelValue":m[0]||(m[0]=L=>l.value.account=L),clearable:"",placeholder:"请输入账户名"},{"prefix-icon":n(()=>[a(ae(_t))]),_:1},8,["modelValue"])]),_:1}),a(d,{name:"password"},{default:n(()=>[a(p,{modelValue:l.value.password,"onUpdate:modelValue":m[1]||(m[1]=L=>l.value.password=L),type:"password",clearable:"",placeholder:"请输入密码"},{"prefix-icon":n(()=>[a(ae(Ne))]),_:1},8,["modelValue"])]),_:1}),a(d,{name:"confirm-password"},{default:n(()=>[a(p,{modelValue:l.value.confirmPassword,"onUpdate:modelValue":m[2]||(m[2]=L=>l.value.confirmPassword=L),type:"password",clearable:"",placeholder:"请确认密码"},{"prefix-icon":n(()=>[a(ae(Ne))]),_:1},8,["modelValue"])]),_:1}),a(d,{name:"email"},{default:n(()=>[a(p,{modelValue:l.value.email,"onUpdate:modelValue":m[3]||(m[3]=L=>l.value.email=L),type:"password",clearable:"",placeholder:"邮箱"},{"prefix-icon":n(()=>[a(ae(Ne))]),_:1},8,["modelValue"])]),_:1}),a(d,null,{default:n(()=>[a(u,{theme:"primary",type:"submit",block:"",loading:s.value},{default:n(()=>m[5]||(m[5]=[k("注册")])),_:1},8,["loading"])]),_:1})]),_:1},8,["data"]),M("div",Ua,[a(C,{onClick:m[4]||(m[4]=()=>{ae(t).$router.push({name:"login"})})},{default:n(()=>m[6]||(m[6]=[k("返回登陆")])),_:1})])]),_:1})}}}),Oa=Y(Ha,[["__scopeId","data-v-e840b450"]]),ot=[{name:"home",path:"/",title:"首页",showSidebar:!1,disableGenerateTab:!0,component:Ta},{name:"problem",path:"/problem",title:"题目",icon:"dashboard",showSidebar:!0,redirect:"problem-list"},{name:"judge",path:"/judge",title:"评测",icon:"dashboard",showSidebar:!0,redirect:"judge-list"},{name:"contest",path:"/contest",title:"比赛",icon:"dashboard",showSidebar:!0,redirect:"contest-list"},{name:"contest-detail-tab",title:"比赛",path:"/contest",showSidebar:!0,disableGenerateTab:!0,redirect:"contest-list"},{name:"discuss",title:"讨论",path:"/discuss",showSidebar:!0,redirect:"discuss-list"},{name:"manage",path:"/manage",title:"管理",icon:"dashboard",showSidebar:!0,redirect:"manage-judge",auths:[Se.Manage]},{name:"login",path:"/login",title:"登陆",showSidebar:!1,disableGenerateTab:!0,component:Aa},{name:"register",path:"/register",title:"注册",showSidebar:!1,disableGenerateTab:!0,component:Oa},{name:"user",path:"/user/:username+",title:"用户",showSidebar:!1,needLogin:!0,disableGenerateTab:!0,component:qa},{name:"404",path:"/404",title:"404",showSidebar:!1,disableGenerateTab:!0,component:Tt}],Ka=e=>ot.find(t=>t.name==e),Na=e=>{const t=[];return ot.forEach(o=>{!o.disableGenerateTab&&e.hasAllAuths(o.auths)&&t.push(o)}),t},Ga=e=>{ot.forEach(t=>{const o={name:t.name,path:t.path,meta:{title:t.title,tab:t.name,showSidebar:t.showSidebar,needLogin:t.needLogin,redirect:t.redirect,tabAuths:t.auths},component:t.component};e.push(o)})},Fa=te({__name:"HeaderContent",setup(e){const t=Pt(),o=ge(),{globalProperties:s}=se(),l=g(t.isLoaded),i=g(!1),v=g(o.getUsername),I=g(o.getNickname),m=g(),p=()=>{m.value=Na(o)};t.$subscribe((b,C)=>{l.value=C.Loaded}),o.$subscribe((b,C)=>{v.value=C.username,I.value=C.nickname,i.value=C.token!="",p()});const d=()=>{s.$router.currentRoute.value.name!=="login"&&s.$router.push({name:"login",query:{redirect_uri:s.$router.currentRoute.value.fullPath}})},u=()=>{o.clear(),s.$message.success({duration:3e3,content:"注销成功"}),s.$router.push({path:"/login",query:{redirect_uri:s.$router.currentRoute.value.fullPath}})};return oe(()=>{p()}),(b,C)=>{const V=gt("router-link"),L=yt,z=bt,D=ea,B=ta;return x(),N(B,{modelValue:b.$route.meta.tab,"onUpdate:modelValue":C[0]||(C[0]=S=>b.$route.meta.tab=S),class:"sh-menu","expand-type":"popup"},{logo:n(()=>[a(V,{to:"/",class:"sh-logo"},{default:n(()=>C[1]||(C[1]=[k("DidaOJ")])),_:1})]),operations:n(()=>[l.value&&i.value?(x(),N(D,{key:0,title:I.value},{icon:n(()=>[a(L,{name:"user"})]),default:n(()=>[a(z,{value:"user",to:{path:"/user/"+v.value}},{default:n(()=>C[2]||(C[2]=[k("个人空间")])),_:1},8,["to"]),a(z,{value:"user_logout",onClick:u},{default:n(()=>C[3]||(C[3]=[k(" 注销")])),_:1})]),_:1},8,["title"])):l.value?(x(),N(z,{key:2,value:"login",onClick:d},{icon:n(()=>[a(L,{name:"login"})]),default:n(()=>[C[5]||(C[5]=k(" 登录 "))]),_:1})):(x(),N(z,{key:1,value:"login"},{icon:n(()=>[a(L,{name:"login"})]),default:n(()=>[C[4]||(C[4]=k(" ... "))]),_:1}))]),default:n(()=>[(x(!0),X(ee,null,fe(m.value,S=>(x(),N(z,{key:S.name,value:S.name,to:{name:S.name}},{icon:n(()=>[S.icon?(x(),N(L,{key:0,name:S.icon},null,8,["name"])):ue("",!0)]),default:n(()=>[k(" "+q(S.title),1)]),_:2},1032,["value","to"]))),128))]),_:1},8,["modelValue"])}}}),Ba=Y(Fa,[["__scopeId","data-v-a4891d9b"]]);function Vt(e){return e.children!==void 0}function Xa(e){return e.children!==void 0}const Wa={id:"menu-container"},Ja=te({__name:"SidebarContent",setup(e){const t=Xe(),o=g(!1),s=g(null),l=g(t.menuActiveName),i=g(t.menuList),v=g([]),I=g(!1),m=()=>{l.value=t.menuActiveName;const d=JSON.stringify(i.value),u=JSON.stringify(t.menuList);d!==u&&(v.value.push([...t.menuList]),p())},p=async()=>{if(v.value.length>0&&!I.value){for(I.value=!0;v.value.length>1;)v.value.shift();const d=v.value.shift();o.value=d.length<=0,i.value=[],await we(),s.value&&s.value.updateActiveName(),await new Promise(b=>setTimeout(b,300)),i.value=d,await we(),s.value&&s.value.updateActiveName();const u=300;await new Promise(b=>setTimeout(b,u)),I.value=!1,await p()}};return t.$subscribe((d,u)=>{m()}),oe(()=>{m()}),(d,u)=>{const b=yt,C=bt,V=na,L=aa,z=ve;return x(),X(ee,null,[M("div",Wa,[a(L,{modelValue:l.value,"onUpdate:modelValue":u[0]||(u[0]=D=>l.value=D),theme:"light",class:"sh-menu-container"},{default:n(()=>[a(Gt,{name:"move-left"},{default:n(()=>[(x(!0),X(ee,null,fe(i.value,(D,B)=>(x(),X(ee,{key:B},[ae(Xa)(D)?(x(),N(V,{key:0,title:D.title},{default:n(()=>[(x(!0),X(ee,null,fe(D.children,(S,P)=>(x(),N(C,{key:S.name,value:S.name,to:S.to},Qe({default:n(()=>[k(" "+q(S.title),1)]),_:2},[S.icon?{name:"icon",fn:n(()=>[a(b,{name:S.icon,class:et(S.iconClass)},null,8,["name","class"])]),key:"0"}:void 0]),1032,["value","to"]))),128))]),_:2},1032,["title"])):(x(),N(C,{key:D.name,value:D.name,to:D.to},Qe({default:n(()=>[k(" "+q(D.title),1)]),_:2},[D.icon?{name:"icon",fn:n(()=>[a(b,{name:D.icon,class:et(D.iconClass)},null,8,["name","class"])]),key:"0"}:void 0]),1032,["value","to"]))],64))),128))]),_:1})]),_:1},8,["modelValue"])]),a(z,{size:"small",loading:o.value,"show-overlay":!0,attach:"#menu-container",class:"sh-sidebar-loading",style:{"align-items":"flex-start","padding-top":"100px"}},null,8,["loading"])],64)}}}),Ya=Y(Ja,[["__scopeId","data-v-96e2d89f"]]),Za={};function Qa(e,t){return null}const en=Y(Za,[["render",Qa]]),tn={class:"footer"},an={class:"footer-left"},nn={class:"foot-time"},on={class:"footer-center"},ln={href:"https://boiltask.com",target:"_blank"},sn={class:"footer-right"},rn={class:"foot-text"},un={href:"https://github.com/hpu-user/DiDaOJ-web",target:"_blank"},cn=te({__name:"FooterContent",setup(e){const t=g("");function o(){t.value=new Date().toLocaleString()}return oe(()=>{o(),setInterval(()=>{o()},1e3)}),(s,l)=>{const i=O;return x(),X("div",tn,[M("div",an,[M("p",nn,q(t.value),1)]),M("div",on,[M("a",ln,[a(i,{theme:"default",variant:"outline",ghost:!0},{default:n(()=>l[0]||(l[0]=[k("@BoilTask")])),_:1})])]),M("div",sn,[M("p",rn,[M("a",un,[a(i,{theme:"default",variant:"outline",ghost:!0},{default:n(()=>l[1]||(l[1]=[k("@didaoj-web")])),_:1})])])])])}}}),dn=Y(cn,[["__scopeId","data-v-400ac98b"]]),He=20,Ye=100,Ze=50,mn=te({__name:"ForceHiddenSidebarButton",setup(e){let t=Xe();const o=g({x:window.innerWidth-Ye-He,y:window.innerHeight-Ze-He}),s=g(window.innerWidth),l=g(window.innerHeight);let i=!1,v={x:0,y:0};const I=D=>{i=!0;const B=D.clientX??D.touches[0].clientX,S=D.clientY??D.touches[0].clientY;v={x:B-o.value.x,y:S-o.value.y},document.addEventListener("mousemove",m),document.addEventListener("touchmove",m),document.addEventListener("mouseup",p),document.addEventListener("touchend",p)},m=D=>{if(!i)return;const B=D.clientX??D.touches[0].clientX,S=D.clientY??D.touches[0].clientY;let P=B-v.x,R=S-v.y;P=Math.max(0,Math.min(P,s.value-Ye)),R=Math.max(0,Math.min(R,l.value-Ze)),o.value={x:P,y:R}},p=()=>{i=!1,document.removeEventListener("mousemove",m),document.removeEventListener("touchmove",m),document.removeEventListener("mouseup",p),document.removeEventListener("touchend",p)},d=()=>{s.value=window.innerWidth,l.value=window.innerHeight,o.value={x:Math.min(o.value.x,s.value-Ye-He),y:Math.min(o.value.y,l.value-Ze-He)}};let u=g(t.forceHiddenSidebar),b=g(t.forceHiddenSidebar);const C=()=>{u.value=!u.value,t.setForceHiddenSidebar(u.value)},V=()=>{b.value||(b.value=!0,t.setForceHiddenSidebar(u.value))},L=()=>{b.value&&(b.value=!1,t.setForceHiddenSidebar(!1))},z=D=>{D>=800?L():V()};return z(s.value),ze(s,D=>{z(D)}),oe(()=>{window.addEventListener("resize",d)}),Le(()=>{window.removeEventListener("resize",d)}),(D,B)=>{const S=O;return ae(b)?(x(),N(S,{key:0,class:"draggable-button",style:vt({top:`${o.value.y}px`,left:`${o.value.x}px`}),onMousedown:I,onTouchstart:I,variant:"dashed",theme:"primary",onClick:C},{default:n(()=>[k(q(ae(u)?"显示":"隐藏"),1)]),_:1},8,["style"])):ue("",!0)}}}),pn=Y(mn,[["__scopeId","data-v-1aee5506"]]),fn={class:"sh-main"},_n=te({__name:"View403",setup(e){let t=ie();const o=g("");return oe(()=>{t.query.target?o.value=t.query.target:o.value=t.fullPath}),(s,l)=>{const i=O;return x(),X("div",fn,[M("p",null,q(o.value),1),l[2]||(l[2]=M("p",null,"该页面无访问权限，请更换访问目标或重新登陆后再试",-1)),a(i,{theme:"primary",onClick:l[0]||(l[0]=()=>s.$router.push("/"))},{default:n(()=>l[1]||(l[1]=[k("返回首页")])),_:1})])}}}),jt=Y(_n,[["__scopeId","data-v-8f62f1f8"]]),Oe="DidaOJ",gn=te({__name:"App",setup(e){const{globalProperties:t}=se(),o=Pt(),s=ge(),l=Ve(),i=Xe();o.$patch({Loaded:!1});const v=s.getToken,I=g(!1),m=g(!1);l.title&&l.title.length>0?document.title=l.title+" - "+Oe:document.title=Oe,l.$subscribe((b,C)=>{C.title&&C.title.length>0?document.title=C.title+" - "+Oe:document.title=Oe}),i.$subscribe((b,C)=>{I.value=C.showSidebar,m.value=I.value&&!C.forceHiddenSidebar});const p=ie(),d=Ce(()=>{const b=p.meta.auths;return b?!s.hasAllAuths(b):!1});function u(){t.$message.warning({duration:3e3,content:"登陆状态失效"}),o.$patch({Loaded:!0}),s.clear()}return oe(()=>{if(v==""){o.$patch({Loaded:!0});return}Sa().then(b=>{b.code==0?(s.loadResponse(b.data),o.$patch({Loaded:!0})):(K(t,b.code),o.$patch({Loaded:!0}),s.clear())}).catch(b=>{console.log(b),u()})}),(b,C)=>{const V=oa,L=sa,z=gt("RouterView"),D=ra,B=la,S=ua;return x(),X(ee,null,[a(B,null,{default:n(()=>[a(V,{class:"sh-header"},{default:n(()=>[a(Ba)]),_:1}),a(B,null,{default:n(()=>[a(Ft,{name:"slide"},{default:n(()=>[m.value?(x(),N(L,{key:0,class:"sh-sidebar"},{default:n(()=>[a(Ya)]),_:1})):ue("",!0)]),_:1}),a(B,{class:et(["sh-main-layout",{expanded:!m.value}])},{default:n(()=>[a(en),a(D,{class:"sh-main-content"},{default:n(()=>[d.value?(x(),N(jt,{key:0})):(x(),N(z,{key:1}))]),_:1}),a(dn)]),_:1},8,["class"])]),_:1})]),_:1}),I.value?(x(),N(pn,{key:0})):ue("",!0),a(S,{container:"body",offset:["24px","80px"],size:"small"})],64)}}}),vn=Y(gn,[["__scopeId","data-v-851fc4f3"]]);var $t=(e=>(e[e.Unknown=-1]="Unknown",e[e.C=0]="C",e[e.Cpp=1]="Cpp",e[e.Java=2]="Java",e[e.Python=3]="Python",e[e.Pascal=4]="Pascal",e[e.Golang=5]="Golang",e[e.Max=6]="Max",e))($t||{});function zt(){const e=[-1,4,5,6];return Object.values($t).filter(t=>typeof t=="number"&&!e.includes(t)).map(t=>({value:t,label:Dt(t)}))}function hn(e){return e>-1&&e<6}function Dt(e){switch(e){case 0:return"C";case 1:return"C++";case 2:return"Java";case 3:return"Python";case 4:return"Pascal";case 5:return"Golang";default:return"Unknown"}}function lt(e){switch(e){case 0:return"c";case 1:return"cpp";case 2:return"java";case 3:return"python";case 4:return"pascal";case 5:return"golang";default:return"text"}}var Q=(e=>(e[e.Init=0]="Init",e[e.Rejudge=1]="Rejudge",e[e.Submitting=2]="Submitting",e[e.Queuing=3]="Queuing",e[e.Compiling=4]="Compiling",e[e.Running=5]="Running",e[e.Accept=6]="Accept",e[e.PE=7]="PE",e[e.WA=8]="WA",e[e.TLE=9]="TLE",e[e.MLE=10]="MLE",e[e.OLE=11]="OLE",e[e.RE=12]="RE",e[e.CE=13]="CE",e[e.CLE=14]="CLE",e[e.JudgeFail=15]="JudgeFail",e[e.SubmitFail=16]="SubmitFail",e[e.Unknown=17]="Unknown",e))(Q||{});const bn=e=>{switch(e){case 0:return"普通评测";case 1:return"特殊评测";default:return"未知"}},Ge=e=>{switch(e){case 0:return"等待处理";case 1:return"重新评测";case 2:return"提交中";case 3:return"队列中";case 4:return"编译中";case 5:return"运行中";case 6:return"通过";case 7:return"格式错误";case 8:return"答案错误";case 9:return"超时";case 10:return"内存超限";case 11:return"输出超限";case 12:return"运行错误";case 13:return"编译错误";case 14:return"编译超限";case 15:return"评测失败";case 16:return"提交失败";case 17:return"未知";default:return e}};function yn(){const e=[17];return Object.values(Q).filter(t=>typeof t=="number"&&!e.includes(t)).map(t=>({value:t,label:Ge(t)}))}function je(e){switch(e){case 0:case 1:case 2:case 3:case 4:case 5:return!0;default:return!1}}function Rt(e){var o;const t={};if(t.id=e.id,t.problemId=e.problem_id,t.status=e.status,je(e.status)?t.score="-":t.score=e.score.toString(),e.time?t.time=Math.ceil(e.time/1e6)+"ms":t.time="-",e.memory?t.memory=(e.memory/1024/1024).toFixed(2)+"MB":t.memory="-",t.language=Dt(e.language),t.codeLength=e.code_length,e.approve_time?t.approveTime=new Date(e.approve_time).toLocaleString():t.approveTime="-",t.author=e.author,t.authorUsername=e.author_username,t.authorNickname=e.author_nickname,t.code=e.code,t.compileMessage=e.compile_message,t.taskCurrent=e.task_current,t.taskTotal=e.task_total,t.task=[],e.task)for(let s=0;s<((o=e.task)==null?void 0:o.length);s++){const l=e.task[s],i={};i.taskId=l.task_id,i.status=l.status,l.time?i.time=Math.ceil(l.time/1e6)+"ms":i.time="-",l.memory?i.memory=(l.memory/1024/1024).toFixed(2)+"MB":i.memory="-",i.score=l.score,i.content=l.content,i.waHint=l.wa_hint,!i.content&&!i.waHint&&(i.content="无提示信息"),t.task.push(i)}return t}function wn(e,t,o,s,l){return J({url:"/judge/approve",method:"post",data:{problem_id:e,contest_id:t,problem_index:o,language:s,code:l}})}function At(e){return J({url:"/judge?id="+e,method:"get"})}function kn(e,t,o,s,l,i){const v=new URLSearchParams({problem_id:e,username:t,language:String(o),status:String(s),page:String(l),page_size:String(i)});return J({url:`/judge/list?${v.toString()}`,method:"get"})}function Cn(){return J({url:"/judge/rejudge/recently",method:"post"})}function Sn(e){return J({url:"/judge/rejudge/problem",method:"post",data:{id:e}})}function In(){return J({url:"/judge/rejudge/all",method:"post",timeout:0})}function Ln(e){return J({url:"/judge/rejudge",method:"post",data:{id:e}})}var at=(e=>(e[e.None=0]="None",e[e.Attempt=1]="Attempt",e[e.Accept=2]="Accept",e))(at||{});function We(e,t){const o={};if(o.id=e.id,o.author=e.author,o.title=e.title,o.tags=[],e.tags)for(const s of e.tags){const l=t[s];l&&o.tags.push(l)}return o.accept=e.accept,o.attempt=e.attempt,e.description!=null&&(o.description=e.description),e.time_limit!=null&&(o.timeLimit=e.time_limit.toString()+" ms"),e.memory_limit!=null&&(o.memoryLimit=(e.memory_limit/1024).toFixed(2)+" MB"),e.judge_type!=null&&(o.judgeType=bn(e.judge_type)),e.insert_time!=null&&(o.insertTime=new Date(e.insert_time).toLocaleString()),e.update_time!=null&&(o.updateTime=new Date(e.update_time).toLocaleString()),e.creator_nickname!=null&&(o.creatorNickname=e.creator_nickname),e.source!=null&&(o.source=e.source),e.judge_md5!=null&&(o.judgeMd5=e.judge_md5),o}function Et(e,t,o){const s={};return e?s.id=e:(s.contest_id=t,s.problem_index=o),J({url:`/problem?${new URLSearchParams(s).toString()}`,method:"get"})}function Mt(e){return J({url:"/problem/tag/list?max_count="+e,method:"get"})}function Pn(e){return J({url:"/problem/judge?id="+e,method:"get"})}function Tn(e,t,o,s){return J({url:"/problem/list?title="+e+"&tag="+t+"&page="+o+"&page_size="+s,method:"get"})}function xn(e,t,o,s,l,i,v){return J({url:"/problem/edit",method:"post",data:{id:e,title:t,time_limit:o,memory_limit:s,source:l,tags:i,description:v}})}function Vn(e,t){return J({url:"/problem/judge/data/download?id="+e+"&key="+t,method:"get"})}function jn(e,t){const o=new FormData;return o.append("id",e),o.append("zip",t),J({url:"/problem/judge/data",method:"post",data:o,headers:{"Content-Type":"multipart/form-data"},timeout:1e3*60*5})}const $n={style:{margin:"10px"}};function zn(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Be(e)}const Dn=te({__name:"ProblemList",setup(e){const t=ie(),o=Ae(),{globalProperties:s}=se();let l=null;const i=g(!1),v={};let I={};const m=g([{title:"ID",colKey:"id",cell:(y,T)=>{let h=D(T.row.id);return a(O,{variant:"dashed",theme:h,onClick:()=>z(T.row.id)},{default:()=>[T.row.id]})}},{title:"标题",colKey:"title",cell:(y,T)=>a(O,{variant:"text",onClick:()=>z(T.row.id)},{default:()=>[T.row.title]})},{title:"标签",colKey:"tags",cell:(y,T)=>{const h=T.row.tags;if(!h||h.length===0)return"";let w=[];for(let r=0;r<h.length;r++){const c=h[r];w.push(a(O,{key:r,theme:"default",variant:"outline"},{default:()=>[c.name]}))}return a(_e,null,zn(w)?w:{default:()=>[w]})}},{title:"正确",colKey:"accept"},{title:"提交",colKey:"attempt"}]),p=g(!1);let d=1,u=50;const b=g({current:d,pageSize:u,defaultCurrent:d,defaultPageSize:u,total:0,pageSizeOptions:[50,100]}),C=g(),V=g(),L=g({title:"",tag:""}),z=y=>{y&&o.push({path:"/problem/"+y})},D=y=>{if(!y||!I)return"default";const T=I[y];if(!T)return"default";switch(T){case at.Accept:return"success";case at.Attempt:return"warning";default:return"default"}},B=async()=>{await o.push({query:{...t.query,title:L.value.title,tag:L.value.tag,page:1,page_size:b.value.defaultPageSize}})},S=y=>{y&&o.push({query:{...t.query,title:"",tag:y.name,page:1,page_size:b.value.defaultPageSize}})},P=async(y,T)=>{p.value=!0;try{const{current:h,pageSize:w}=y,r=await Tn(L.value.title,L.value.tag,h,w);if(C.value=[],r.code===0){const c=r.data.list;if(!c||c.length<=0){b.value={...b.value,total:0},I=null,pe(s,"未找到记录");return}c.forEach(f=>{var j;const _=We(f,v);(j=C.value)==null||j.push(_)}),b.value={...b.value,total:r.data.total_count},I=r.data.problem_attempt_status}else T&&K(s,r.code)}catch(h){console.error(h),K(s,Ie())}finally{p.value=!1}},R=async y=>{await o.push({query:{...t.query,page:y.current,page_size:y.pageSize}})};return oe(async()=>{p.value=!0,V.value=[],Mt(-1).then(y=>{if(y.code===0){V.value=y.data.list,i.value=y.data.total_count>y.data.list.length;for(let T=0;T<y.data.list.length;T++){const h=y.data.list[T];v[h.id]=h}l=ze(()=>t.query,T=>{L.value.title=T.title||"",L.value.tag=T.tag||"";const h=parseInt(T.page)||b.value.defaultCurrent,w=parseInt(T.page_size)||b.value.defaultPageSize;d=h,u=w,b.value={...b.value,current:d,pageSize:u},P({current:d,pageSize:u},!0)},{immediate:!0})}else i.value=!0}).catch(y=>{console.error(y),i.value=!0})}),Le(()=>{l&&l()}),(y,T)=>{const h=xe,w=ce,r=be,c=ke,f=Te,_=O,j=Pe,A=he;return x(),N(A,null,{default:n(()=>[a(r,{span:9},{default:n(()=>[a(w,{style:{margin:"10px"}},{default:n(()=>[a(h,{data:C.value,columns:m.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:b.value,loading:p.value,onPageChange:R},null,8,["data","columns","pagination","loading"])]),_:1})]),_:1}),a(r,{span:3},{default:n(()=>[M("div",$n,[a(w,{class:"sh-card"},{default:n(()=>[a(j,{model:L.value},{default:n(()=>[a(f,{label:"标题"},{default:n(()=>[a(c,{modelValue:L.value.title,"onUpdate:modelValue":T[0]||(T[0]=E=>L.value.title=E),placeholder:"暂不支持模糊查询"},null,8,["modelValue"])]),_:1}),a(f,{label:"标签"},{default:n(()=>[a(c,{modelValue:L.value.tag,"onUpdate:modelValue":T[1]||(T[1]=E=>L.value.tag=E),placeholder:"暂不支持模糊查询"},null,8,["modelValue"])]),_:1}),a(f,null,{default:n(()=>[a(_,{theme:"primary",onClick:B},{default:n(()=>T[3]||(T[3]=[k("搜索")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(w,{class:"sh-card sh-background-black"},{default:n(()=>[(x(!0),X(ee,null,fe(V.value,E=>(x(),N(_,{class:"sh-tag-button",theme:"default",variant:"outline",ghost:!0,onClick:()=>S(E)},{default:n(()=>[k(q(E.name),1)]),_:2},1032,["onClick"]))),256)),i.value?(x(),N(_,{key:0,class:"sh-tag-button",theme:"default",variant:"outline",ghost:!0,onClick:T[2]||(T[2]=()=>y.$router.push("/problem/tags"))},{default:n(()=>T[4]||(T[4]=[k(" ... ")])),_:1})):ue("",!0)]),_:1})])]),_:1})]),_:1})}}}),Rn=Y(Dn,[["__scopeId","data-v-0d640f14"]]);function $e(e){e.querySelectorAll("pre > code:not([data-copy-attached])").forEach(o=>{o.setAttribute("data-copy-attached","true");const s=o.parentElement,l=document.createElement("div");l.className="copy-wrapper";const i=document.createElement("button");i.className="copy-btn",i.innerText="复制",i.addEventListener("click",async()=>{try{await navigator.clipboard.writeText(o.innerText),i.innerText="已复制",setTimeout(()=>i.innerText="复制",1500)}catch{i.innerText="失败"}}),s.replaceWith(l),l.appendChild(i),l.appendChild(s)})}function Je(e){let t="";for(;e>0;)e--,t=String.fromCharCode(65+e%26)+t,e=Math.floor(e/26);return t}async function qt(e){const t={};if(t.id=e.id,t.ownerId=e.owner_id,t.ownerUsername=e.owner_username,t.ownerNickname=e.owner_nickname,t.title=e.title,t.startTime=new Date(e.start_time).toLocaleString(),t.endTime=new Date(e.end_time).toLocaleString(),e.descriptions){t.descriptions=[];const o={math:{inlineDigit:!0,engine:"KaTeX"}};for(let s=0;s<e.descriptions.length;s++){const l=e.descriptions[s],i={};i.title=l.title,i.content=await ne.md2html(l.content,o),i.sort=l.sort,t.descriptions.push(i)}}if(t.notification=e.notification,e.problems){t.problems=[],e.problems.sort((o,s)=>o.index-s.index);for(let o=0;o<e.problems.length;o++){const s=e.problems[o];s.accept||(s.accept=0),s.attempt||(s.attempt=0),s.id=Je(s.index),t.problems.push(s)}}return t}function An(e){return J({url:"/contest?id="+e,method:"get"})}function En(e,t){return J({url:"/contest/list?page="+e+"&page_size="+t,method:"get"})}function Mn(e){return J({url:"/contest/create",method:"post",data:e})}const qn=["innerHTML"],Un={style:{margin:"12px"}},Hn={key:0,class:"dida-edit-container"},On={class:"dida-operation-container"},Kn={class:"dida-code-submit-div"},Nn=te({__name:"ProblemDetail",setup(e){let t=ie();const{globalProperties:o}=se(),s=Ve(),l=ge();let i=g(""),v="",I=0,m=0;const p=g(null),d=g(!1),u=g(null);let b=null;const C=g(null),V={},L=g(""),z=g([]);z.value=zt();const D=Ce(()=>l.hasAuth(Se.ManageProblem)),B=w=>{w&&F.push({name:"problem-list",query:{...t.query,title:"",tag:w.name}})},S=()=>{F.push({name:"manage-problem",params:{problemId:v}})},P=()=>{v?F.push({name:"judge-list",query:{problem_id:v}}):F.push({name:"contest-judge-list",params:{contestId:I,problemIndex:m}})},R=()=>{v?F.push({name:"discuss-list-problem",query:{problem_id:v}}):F.push({name:"contest-discuss",params:{contestId:I},query:{problem_id:Je(m)}})},y=()=>{F.push({name:"problem-recommend",params:{problemId:v}})},T=async()=>{if(!v){me(o,"问题ID无效");return}const w=parseInt(L.value);if(!hn(w)){me(o,"请选择所编写的语言");return}const r=b==null?void 0:b.getValue();if(!r){me(o,"请输入所需提交的代码");return}const c=await wn(v,I,m,w,r);if(c.code!==0){K(o,c.code);return}pe(o,"提交成功，正在跳转到详情页面");const f=c.data.id;await F.push({path:"/judge/"+f})},h=w=>{b&&it.setModelLanguage(b.getModel(),lt(w))};return oe(async()=>{if(Array.isArray(t.params.problemId)?v=t.params.problemId[0]:v=t.params.problemId,!v){if(Array.isArray(t.params.contestId)?I=t.params.contestId[0]:I=t.params.contestId,!I){me(o,"题目不存在"),await F.push({name:"problem"});return}if(Array.isArray(t.params.problemIndex)?m=parseInt(t.params.problemIndex[0]):m=parseInt(t.params.problemIndex),!m){me(o,"题目不存在"),await F.push({name:"problem"});return}}d.value=!0;let w=await Et(v,I,m);if(w.code!==0){d.value=!1,K(o,w.code),await F.push({name:"problem"});return}w.data.tags&&w.data.tags.forEach(f=>{V[f.id]=f}),u.value=We(w.data.problem,V),s.setTitle(u.value.title+" - "+s.getTitle);let r=u.value.description;const c={math:{inlineDigit:!0,engine:"KaTeX"}};i.value=await ne.md2html(r,c),await we(()=>{p.value&&(ne.mathRender(p.value),ne.highlightRender({lineNumber:!0,enable:!0},p.value),$e(p.value),C.value&&(b=it.create(C.value,{value:"",language:"cpp",minimap:{enabled:!0},colorDecorators:!0,readOnly:!1,theme:"vs-dark"}))),d.value=!1})}),(w,r)=>{const c=ce,f=be,_=O,j=Me,A=_e,E=Ee,U=kt,G=wt,H=he,W=ve;return x(),N(W,{loading:d.value},{default:n(()=>[a(H,{class:"dida-main-content"},{default:n(()=>[a(f,{span:8},{default:n(()=>[a(c,{style:{margin:"10px"}},{default:n(()=>[M("div",{innerHTML:ae(i),ref_key:"markdownRef",ref:p},null,8,qn)]),_:1})]),_:1}),a(f,{span:4},{default:n(()=>[M("div",Un,[D.value?(x(),X("div",Hn,[a(_,{onClick:S},{default:n(()=>r[1]||(r[1]=[k("编辑")])),_:1})])):ue("",!0),a(E,{layout:"vertical",bordered:!0},{default:n(()=>[a(j,{label:"标题"},{default:n(()=>{var $;return[k(q(($=u.value)==null?void 0:$.title),1)]}),_:1}),a(j,{label:"时间限制"},{default:n(()=>{var $;return[k(q(($=u.value)==null?void 0:$.timeLimit),1)]}),_:1}),a(j,{label:"内存限制"},{default:n(()=>{var $;return[k(q(($=u.value)==null?void 0:$.memoryLimit),1)]}),_:1}),a(j,{label:"判题方式"},{default:n(()=>{var $;return[k(q(($=u.value)==null?void 0:$.judgeType),1)]}),_:1}),a(j,{label:"正确提交"},{default:n(()=>{var $;return[k(q(($=u.value)==null?void 0:$.accept),1)]}),_:1}),a(j,{label:"提交总数"},{default:n(()=>{var $;return[k(q(($=u.value)==null?void 0:$.attempt),1)]}),_:1}),a(j,{label:"创建时间"},{default:n(()=>{var $;return[k(q(($=u.value)==null?void 0:$.insertTime),1)]}),_:1}),a(j,{label:"更新时间"},{default:n(()=>{var $;return[k(q(($=u.value)==null?void 0:$.updateTime),1)]}),_:1}),a(j,{label:"上传用户"},{default:n(()=>{var $;return[k(q(($=u.value)==null?void 0:$.creatorNickname),1)]}),_:1}),a(j,{label:"题目来源"},{default:n(()=>{var $;return[k(q(($=u.value)==null?void 0:$.source),1)]}),_:1}),ae(v)?(x(),N(j,{key:0,label:"标签"},{default:n(()=>[a(A,null,{default:n(()=>{var $;return[(x(!0),X(ee,null,fe(($=u.value)==null?void 0:$.tags,re=>(x(),N(_,{key:re.id,variant:"dashed",onClick:()=>B(re)},{default:n(()=>[k(q(re.name),1)]),_:2},1032,["onClick"]))),128))]}),_:1})]),_:1})):ue("",!0)]),_:1}),M("div",On,[a(A,null,{default:n(()=>[a(_,{onClick:P},{default:n(()=>r[2]||(r[2]=[k("提交记录")])),_:1}),a(_,{onClick:R},{default:n(()=>r[3]||(r[3]=[k("题目讨论")])),_:1}),ae(v)?(x(),N(_,{key:0,onClick:y},{default:n(()=>r[4]||(r[4]=[k("题目推荐")])),_:1})):ue("",!0)]),_:1})]),M("div",Kn,[a(A,null,{default:n(()=>[a(G,{modelValue:L.value,"onUpdate:modelValue":r[0]||(r[0]=$=>L.value=$),label:"语言：",placeholder:"请选择提交语言","auto-width":"",clearable:"",onChange:h},{default:n(()=>[(x(!0),X(ee,null,fe(z.value,$=>(x(),N(U,{key:$.value,value:$.value,label:$.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"]),a(_,{onClick:T},{default:n(()=>r[5]||(r[5]=[k("提交")])),_:1})]),_:1}),M("div",{ref_key:"codeEditRef",ref:C,class:"dida-code-editor"},null,512)])])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),ct=Y(Nn,[["__scopeId","data-v-2307df15"]]),Gn={};function Fn(e,t){return" TODO "}const Bn=Y(Gn,[["render",Fn]]),Xn=["innerHTML"];function Wn(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Be(e)}const Jn=te({__name:"JudgeJobList",setup(e){const t=ie(),o=Ae(),{globalProperties:s}=se();let l=!1,i=null;const v=g(!1),I=g(""),m=g(""),p=g(null),d=g(!1),u=g({problemId:"",username:"",language:void 0,status:void 0}),b=g([{title:"ID",colKey:"id",cell:(f,_)=>a(O,{variant:"text",onClick:()=>y(_.row.id)},{default:()=>[_.row.id]})},{title:"问题",colKey:"problemId",cell:(f,_)=>a(O,{variant:"text",onClick:()=>R(_.row.problemId)},{default:()=>[_.row.problemId]})},{title:"状态",colKey:"status",align:"center",cell:(f,_)=>{const j=_.row.status,A=Ge(j);let E;switch(j){case Q.Init:case Q.Rejudge:case Q.Compiling:case Q.Running:E="default";break;case Q.Accept:E="success";break;case Q.PE:E="warning";break;default:E="danger";break}let U=[];return je(j)&&U.push(a(ve,{text:_.row.state,size:"small",class:"dida-status-loading"},null)),U.push(a("span",null,[A])),a(O,{theme:E,variant:"outline",onClick:()=>y(_.row.id)},Wn(U)?U:{default:()=>[U]})}},{title:"分数",colKey:"score"},{title:"时间",colKey:"time"},{title:"内存",colKey:"memory"},{title:"代码",colKey:"code",cell:(f,_)=>a(O,{theme:"default",onClick:()=>P(_.row.id)},{default:()=>[_.row.language+" / "+_.row.codeLength]})},{title:"作者",colKey:"author",width:200,cell:(f,_)=>a(O,{variant:"text",onClick:()=>T(_.row.authorUsername)},{default:()=>[_.row.authorNickname]})},{title:"提交时间",colKey:"approveTime",width:180}]),C=g(!1);let V=1,L=50;const z=g({current:V,pageSize:L,defaultCurrent:V,defaultPageSize:L,total:0,pageSizeOptions:[50,100]}),D=g(),B=g([]);B.value=zt();const S=g([]);S.value=yn();const P=async f=>{if(f){d.value=!0,v.value=!0,I.value=f,m.value="";try{const _=await At(f);if(_.code===0){const j=_.data,E=`\`\`\`${lt(j.language)}
${j.code}
\`\`\``,U={};m.value=await ne.md2html(E,U),await we(()=>{p.value&&(ne.highlightRender({lineNumber:!0,enable:!0},p.value),$e(p.value))})}else K(s,_.code)}finally{d.value=!1}}},R=f=>{f&&o.push({path:"/problem/"+f})},y=f=>{f&&o.push({path:"/judge/"+f})},T=f=>{f&&o.push({path:"/user/"+f})},h=async()=>{await o.push({query:{...t.query,page:1,page_size:L,problem_id:u.value.problemId,username:u.value.username,language:u.value.language,status:u.value.status}})},w=async()=>{u.value.problemId="",u.value.username="",u.value.language=void 0,u.value.status=void 0,await o.push({query:{...t.query,page:1,page_size:L,problem_id:"",username:"",language:void 0,status:void 0}})},r=async(f,_)=>{_&&(C.value=!0);let j=!1;try{const{current:A,pageSize:E}=f,U=await kn(u.value.problemId,u.value.username,u.value.language,u.value.status,A,E);D.value=[],U.code===0?U.data.list&&U.data.list.length>0?(U.data.list.forEach(H=>{var $;const W=Rt(H);($=D.value)==null||$.push(W),je(H.status)&&(j=!0)}),z.value={...z.value,total:U.data.total_count}):(pe(s,"未找到记录"),z.value={...z.value,total:0}):_&&K(s,U.code)}catch(A){console.error(A),_&&K(s,Ie())}finally{_&&(C.value=!1),j&&l&&setTimeout(()=>{r({current:V,pageSize:L},!1)},5e3)}},c=async f=>{await o.push({query:{...t.query,page:f.current,page_size:f.pageSize}})};return oe(async()=>{l=!0,i=ze(()=>t.query,f=>{u.value.problemId=f.problem_id||"",u.value.username=f.username||"",f.language!=null?u.value.language=Number(f.language):u.value.language=void 0,f.status!=null?u.value.status=Number(f.status):u.value.status=void 0;const _=parseInt(f.page)||z.value.defaultCurrent,j=parseInt(f.page_size)||z.value.defaultPageSize;V=_,L=j,z.value.pageSizeOptions.includes(L)||(L=z.value.defaultPageSize),z.value={...z.value,current:V,pageSize:L},r({current:V,pageSize:L},!0)},{immediate:!0})}),Le(()=>{l=!1,i&&i()}),(f,_)=>{const j=ke,A=Te,E=kt,U=wt,G=O,H=_e,W=Pe,$=xe,re=ce,le=ve,de=nt;return x(),X(ee,null,[a(re,{style:{margin:"10px"}},{default:n(()=>[a(W,{layout:"inline",onSubmit:h,onReset:w},{default:n(()=>[a(A,{label:"题号"},{default:n(()=>[a(j,{modelValue:u.value.problemId,"onUpdate:modelValue":_[0]||(_[0]=Z=>u.value.problemId=Z),placeholder:"请输入完整题号"},null,8,["modelValue"])]),_:1}),a(A,{label:"用户"},{default:n(()=>[a(j,{modelValue:u.value.username,"onUpdate:modelValue":_[1]||(_[1]=Z=>u.value.username=Z),placeholder:"仅支持输入完整用户名"},null,8,["modelValue"])]),_:1}),a(A,{label:"语言"},{default:n(()=>[a(U,{modelValue:u.value.language,"onUpdate:modelValue":_[2]||(_[2]=Z=>u.value.language=Z),placeholder:"请选择提交语言","auto-width":"",clearable:""},{default:n(()=>[(x(!0),X(ee,null,fe(B.value,Z=>(x(),N(E,{key:Z.value,value:Z.value,label:Z.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(A,{label:"状态"},{default:n(()=>[a(U,{modelValue:u.value.status,"onUpdate:modelValue":_[3]||(_[3]=Z=>u.value.status=Z),placeholder:"请选择评测状态","auto-width":"",clearable:""},{default:n(()=>[(x(!0),X(ee,null,fe(S.value,Z=>(x(),N(E,{key:Z.value,value:Z.value,label:Z.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(A,null,{default:n(()=>[a(H,null,{default:n(()=>[a(G,{theme:"primary",type:"submit"},{default:n(()=>_[6]||(_[6]=[k("搜索")])),_:1}),a(G,{theme:"default",variant:"base",type:"reset"},{default:n(()=>_[7]||(_[7]=[k("重置")])),_:1})]),_:1})]),_:1})]),_:1}),a($,{data:D.value,columns:b.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:z.value,loading:C.value,onPageChange:c},null,8,["data","columns","pagination","loading"])]),_:1}),a(de,{visible:v.value,"onUpdate:visible":_[4]||(_[4]=Z=>v.value=Z),header:I.value,width:"800px","cancel-btn":null,"close-btn":!1,onConfirm:_[5]||(_[5]=Z=>v.value=!1)},{default:n(()=>[a(le,{loading:d.value},{default:n(()=>[M("div",{innerHTML:m.value,ref_key:"markdownCodeRef",ref:p,style:{"min-height":"100px"}},null,8,Xn)]),_:1},8,["loading"])]),_:1},8,["visible","header"])],64)}}}),Yn=Y(Jn,[["__scopeId","data-v-6953f5a5"]]),Zn=["innerHTML"],Qn={key:2,class:"dida-edit-container"};function dt(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Be(e)}const eo=te({__name:"JudgeJobDetail",setup(e){const t=ie(),o=Ae(),s=ge(),{globalProperties:l}=se();let i=!1,v=-1;const I=g(null),m=g(""),p=g(null),d=g(0),u=g(null),b=g({from:"#5a96ff",to:"#00A870"});let C=!1;const V=g([{title:"ID",colKey:"id"},{title:"问题",colKey:"problemId",cell:(h,w)=>a(O,{variant:"text",onClick:()=>P(w.row.problemId)},{default:()=>[w.row.problemId]})},{title:"状态",colKey:"status",align:"center",cell:(h,w)=>{const r=w.row.status,c=Ge(r);let f;switch(r){case Q.Init:case Q.Rejudge:case Q.Compiling:case Q.Running:f="default";break;case Q.Accept:f="success";break;case Q.PE:f="warning";break;default:f="danger";break}let _=[];return je(r)&&_.push(a(ve,{text:w.row.state,size:"small",class:"dida-status-loading"},null)),_.push(a("span",null,[c])),a(O,{theme:f,variant:"outline"},dt(_)?_:{default:()=>[_]})}},{title:"分数",colKey:"score"},{title:"时间",colKey:"time"},{title:"内存",colKey:"memory"},{title:"代码",colKey:"language",cell:(h,w)=>a("span",null,[w.row.language+" / "+w.row.codeLength])},{title:"作者",colKey:"author",width:200,cell:(h,w)=>a(O,{variant:"text",onClick:()=>R(w.row.authorUsername)},{default:()=>[w.row.authorNickname]})},{title:"提交时间",colKey:"approveTime",width:180}]),L=g(!1),z=g(!1),D=g(),B=Ce(()=>s.hasAuth(Se.ManageJudge)),S=async()=>{if(!z.value){z.value=!0;try{const h=await Ln(v);h.code===0?await T(!0):K(l,h.code)}catch(h){console.error(h),K(l,Ie())}finally{z.value=!1}}},P=h=>{h&&o.push({path:"/problem/"+h})},R=h=>{h&&o.push({path:"/user/"+h})},y=h=>{const w=h.status,r=Ge(w);let c;switch(w){case Q.Init:case Q.Rejudge:case Q.Compiling:case Q.Running:c="default";break;case Q.Accept:c="success";break;case Q.PE:c="warning";break;default:c="danger";break}return a(_e,null,{default:()=>[a(O,{theme:"default",variant:"outline"},{default:()=>[h.taskId]}),a(O,{theme:c,variant:"outline"},dt(r)?r:{default:()=>[r]}),a("span",null,[k("分数："),h.score]),a("span",null,[k("用时："),h.time]),a("span",null,[k("内存："),h.memory])]})},T=async h=>{var r;h&&(L.value=!0);let w=!1;try{const c=await At(v);if(D.value=[],c.code===0){const f=c.data,_=Rt(f);(r=D.value)==null||r.push(_),b.value.to="#00A870",je(f.status)?(u.value="active",_.taskTotal>0?(d.value=_.taskCurrent/_.taskTotal*100,_.taskCurrent>=_.taskTotal&&(d.value=99)):d.value=0):(d.value=100,f.status===Q.Accept?u.value="success":f.status===Q.PE?(b.value.to="#F57C20",u.value="warning"):(b.value.to="#F56C6C",u.value="error"));const j={};if(f.code){const E=`\`\`\`${lt(f.language)}
${f.code}
\`\`\``;m.value=await ne.md2html(E,j),await we(()=>{p.value&&(C||(C=!0,ne.highlightRender({lineNumber:!0,enable:!0},p.value)),$e(p.value))})}I.value=_,je(f.status)&&(w=!0)}else h&&K(l,c.code)}catch(c){console.error(c),h&&K(l,Ie())}finally{h&&(L.value=!1),w&&i&&setTimeout(()=>{T(!1)},5e3)}};return oe(async()=>{if(i=!0,t.params.judgeId&&t.params.judgeId.length===1)v=parseInt(t.params.judgeId[0]);else{await o.push({name:"judge"});return}await T(!0)}),Le(()=>{i=!1}),(h,w)=>{var E,U;const r=ia,c=xe,f=ce,_=Ct,j=St,A=O;return x(),X(ee,null,[a(r,{color:b.value,status:u.value,class:"dida-job-progress",percentage:d.value},null,8,["color","status","percentage"]),a(f,{style:{margin:"10px"}},{default:n(()=>[a(c,{data:D.value,columns:V.value,"row-key":"id","vertical-align":"top",hover:!0,loading:L.value},null,8,["data","columns","loading"])]),_:1}),M("div",{innerHTML:m.value,ref_key:"markdownCodeRef",ref:p},null,8,Zn),(E=I.value)!=null&&E.compileMessage?(x(),N(f,{key:0,class:"compile-message"},{default:n(()=>{var G;return[k(q((G=I.value)==null?void 0:G.compileMessage),1)]}),_:1})):ue("",!0),((U=I.value)==null?void 0:U.task.length)>0?(x(),N(j,{key:1,class:"task-panel"},{default:n(()=>{var G;return[(x(!0),X(ee,null,fe((G=I.value)==null?void 0:G.task,H=>(x(),N(_,{key:H.taskId,header:()=>y(H)},{default:n(()=>[k(q(H.content)+" "+q(H.waHint),1)]),_:2},1032,["header"]))),128))]}),_:1})):ue("",!0),B.value?(x(),X("div",Qn,[a(A,{onClick:S,loading:z.value},{default:n(()=>w[0]||(w[0]=[k("重新评测")])),_:1},8,["loading"])])):ue("",!0)],64)}}}),to=Y(eo,[["__scopeId","data-v-9b3735e5"]]),ao={style:{margin:"10px"}},no=te({__name:"ContestList",setup(e){const t=ie(),o=Ae(),{globalProperties:s}=se();let l=null;const i=g(!1),v=g(!1),I=g([{title:"ID",colKey:"id",width:"100",cell:(R,y)=>a(O,{variant:"text",onClick:()=>L(y.row.id)},{default:()=>[y.row.id]})},{title:"标题",colKey:"title",cell:(R,y)=>a(O,{variant:"text",onClick:()=>L(y.row.id)},{default:()=>[y.row.title]})},{title:"负责人",colKey:"ownerNickname",width:"200"},{title:"开始时间",colKey:"startTime",width:"180"},{title:"结束时间",colKey:"endTime",width:"180"}]),m=g(!1);let p=1,d=50;const u=g({current:p,pageSize:d,defaultCurrent:p,defaultPageSize:d,total:0,pageSizeOptions:[50,100]}),b=g(),C=g({title:"",username:""}),V=g({title:"",description:"",open_time:[]}),L=R=>{R&&o.push({path:"/contest/"+R})},z=async()=>{await o.push({query:{...t.query,title:C.value.title,username:C.value.username,page:1,page_size:u.value.defaultPageSize}})},D=async(R,y)=>{var T;m.value=!0;try{const{current:h,pageSize:w}=R,r=await En(h,w);if(b.value=[],r.code===0){const c=r.data.list;for(let f=0;f<c.length;f++){const _=c[f],j=await qt(_);(T=b.value)==null||T.push(j)}u.value={...u.value,total:r.data.total_count}}else y&&K(s,r.code)}catch(h){console.error(h),K(s,Ie())}finally{m.value=!1}},B=async R=>{await o.push({query:{...t.query,page:R.current,page_size:R.pageSize}})},S=()=>{i.value=!0},P=async()=>{v.value=!0,console.log("contestCreateForm",V.value),Mn(V.value).then(R=>{R.code===0?(pe(s,"创建比赛成功"),i.value=!1,o.push({path:"/contest/"+R.data.id})):K(s,R.code)}).finally(()=>{v.value=!1})};return oe(async()=>{l=ze(()=>t.query,R=>{C.value.title=R.title||"",C.value.username=R.username||"";const y=parseInt(R.page)||u.value.defaultCurrent,T=parseInt(R.page_size)||u.value.defaultPageSize;p=y,d=T,u.value={...u.value,current:p,pageSize:d},D({current:p,pageSize:d},!0)},{immediate:!0})}),Le(()=>{l&&l()}),(R,y)=>{const T=xe,h=ce,w=be,r=ke,c=Te,f=O,_=Pe,j=_e,A=he,E=It,U=nt;return x(),X(ee,null,[a(A,null,{default:n(()=>[a(w,{span:9},{default:n(()=>[a(h,{style:{margin:"10px"}},{default:n(()=>[a(T,{data:b.value,columns:I.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:u.value,loading:m.value,onPageChange:B},null,8,["data","columns","pagination","loading"])]),_:1})]),_:1}),a(w,{span:3},{default:n(()=>[M("div",ao,[a(h,{class:"sh-card"},{default:n(()=>[a(_,{model:C.value},{default:n(()=>[a(c,{label:"标题"},{default:n(()=>[a(r,{modelValue:C.value.title,"onUpdate:modelValue":y[0]||(y[0]=G=>C.value.title=G),placeholder:"暂不支持模糊查询"},null,8,["modelValue"])]),_:1}),a(c,{label:"负责人"},{default:n(()=>[a(r,{modelValue:C.value.username,"onUpdate:modelValue":y[1]||(y[1]=G=>C.value.username=G),placeholder:"仅支持输入完整用户名"},null,8,["modelValue"])]),_:1}),a(c,null,{default:n(()=>[a(f,{theme:"primary",onClick:z},{default:n(()=>y[6]||(y[6]=[k("提交")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(h,{class:"sh-card"},{default:n(()=>[a(j,null,{default:n(()=>[a(f,{onClick:S},{default:n(()=>y[7]||(y[7]=[k("创建")])),_:1})]),_:1})]),_:1})])]),_:1})]),_:1}),a(U,{visible:i.value,"onUpdate:visible":y[5]||(y[5]=G=>i.value=G),header:"创建比赛",onConfirm:P,"confirm-loading":v.value},{default:n(()=>[a(_,{"label-width":80,model:V.value,onSubmit:y[4]||(y[4]=Re(()=>{},["prevent"]))},{default:n(()=>[a(c,{label:"标题"},{default:n(()=>[a(r,{modelValue:V.value.title,"onUpdate:modelValue":y[2]||(y[2]=G=>V.value.title=G),placeholder:"请输入标题"},null,8,["modelValue"])]),_:1}),a(c,{label:"开启时间"},{default:n(()=>[a(E,{"enable-time-picker":"","allow-input":"",clearable:"",modelValue:V.value.open_time,"onUpdate:modelValue":y[3]||(y[3]=G=>V.value.open_time=G)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","confirm-loading"])],64)}}}),De=Y(no,[["__scopeId","data-v-3e6ea683"]]),oo={style:{margin:"20px"}},lo=["innerHTML"],so={style:{margin:"12px"}},ro=te({__name:"ContestDetail",setup(e){let t=ie();const{globalProperties:o}=se(),s=Ve();let l=0;const i=g(!1),v=g(null),I=g([{title:"问题ID",colKey:"id",cell:(d,u)=>a(O,{variant:"text",onClick:()=>p(l,u.row.index)},{default:()=>[u.row.id]})},{title:"标题",colKey:"title",cell:(d,u)=>a(O,{variant:"text",onClick:()=>p(l,u.row.index)},{default:()=>[u.row.title]})},{title:"正确",colKey:"accept"},{title:"提交",colKey:"attempt"}]),m=g([]),p=(d,u)=>{F.push({name:"contest-problem-detail",params:{contestId:d,problemIndex:u}})};return oe(async()=>{if(Array.isArray(t.params.contestId)?l=t.params.contestId[0]:l=t.params.contestId,!l){await F.push({name:"contest"});return}i.value=!0;const d=await An(l);if(d.code!==0){i.value=!1,K(o,d.code),await F.push({name:"contest"});return}v.value=await qt(d.data),m.value=v.value.problems,s.setTitle(v.value.title+" - "+s.getTitle),await we(()=>{const u=document.querySelectorAll(".dida-content-description");u&&u.length>0&&u.forEach(b=>{ne.mathRender(b),ne.highlightRender({lineNumber:!0,enable:!0},b),$e(b)}),i.value=!1})}),(d,u)=>{const b=ca,C=O,V=_e,L=Ct,z=St,D=xe,B=ce,S=be,P=Me,R=Ee,y=he,T=ve;return x(),N(T,{loading:i.value},{default:n(()=>[a(y,{class:"dida-main-content"},{default:n(()=>[a(S,{span:8},{default:n(()=>{var h,w,r;return[M("div",oo,[M("h1",null,q((h=v.value)==null?void 0:h.title),1),(w=v.value)!=null&&w.notification?(x(),N(b,{key:0,theme:"info",message:(r=v.value)==null?void 0:r.notification},null,8,["message"])):ue("",!0)]),a(z,{"default-value":[0],"expand-icon":!1,borderless:!0},{default:n(()=>{var c;return[(x(!0),X(ee,null,fe((c=v.value)==null?void 0:c.descriptions,(f,_)=>(x(),N(L,{key:_,header:f.title},Qe({default:n(()=>[M("div",{innerHTML:f.content,class:"dida-content-description"},null,8,lo)]),_:2},[_===0?{name:"headerRightContent",fn:n(()=>[a(V,{size:"small"},{default:n(()=>[a(C,{size:"small"},{default:n(()=>u[0]||(u[0]=[k("收起全部")])),_:1}),a(C,{size:"small"},{default:n(()=>u[1]||(u[1]=[k("展开全部")])),_:1})]),_:1})]),key:"0"}:void 0]),1032,["header"]))),128))]}),_:1}),a(B,{style:{margin:"10px"}},{default:n(()=>[a(D,{data:m.value,columns:I.value,"row-key":"id","vertical-align":"top",hover:!0},null,8,["data","columns"])]),_:1})]}),_:1}),a(S,{span:4},{default:n(()=>[M("div",so,[a(R,{layout:"vertical",bordered:!0},{default:n(()=>[a(P,{label:"开始时间"},{default:n(()=>{var h;return[k(q((h=v.value)==null?void 0:h.startTime),1)]}),_:1})]),_:1})])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),uo=Y(ro,[["__scopeId","data-v-5e212303"]]);function Ut(e){const t={};return t.id=e.id,t.authorId=e.author_id,t.authorUsername=e.author_username,t.authorNickname=e.author_nickname,t.title=e.title,t.content=e.content,e.insert_time&&(t.insertTime=new Date(e.insert_time).toLocaleString()),e.modify_time&&(t.modifyTime=new Date(e.modify_time).toLocaleString()),e.update_time&&(t.updateTime=new Date(e.update_time).toLocaleString()),t.problemId=e.problem_id,t.problemTitle=e.problem_title,t.contestId=e.contest_id,t.contestTitle=e.contest_title,t.contestProblemIndex=e.contest_problem_index,t}async function io(e){const t={};if(t.id=e.id,t.authorId=e.author_id,t.authorUsername=e.author_username,t.authorNickname=e.author_nickname,t.content="",e.content){const o={math:{inlineDigit:!0,engine:"KaTeX"}};t.content=await ne.md2html(e.content,o)}return e.insert_time&&(t.insertTime=new Date(e.insert_time).toLocaleString()),e.modify_time&&(t.modifyTime=new Date(e.modify_time).toLocaleString()),e.update_time&&(t.updateTime=new Date(e.update_time).toLocaleString()),t}function co(e){return J({url:"/discuss?id="+e,method:"get"})}function mo(e,t,o,s,l,i){const v={};return e&&(v.contest_id=e),t&&(v.problem_id=t),o&&(v.title=o),s&&(v.username=s),l&&(v.page=l),i&&(v.page_size=i),J({url:`/discuss/list?${new URLSearchParams(v).toString()}`,method:"get"})}function po(e,t,o){return J({url:"/discuss/comment/list?id="+e+"&page="+t+"&page_size="+o,method:"get"})}function fo(e){return J({url:"/discuss/create",method:"post",data:e})}const _o={style:{margin:"10px"}};function go(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Be(e)}const vo=te({__name:"DiscussList",setup(e){const t=ie(),o=Ae(),{globalProperties:s}=se();let l=null;const i=g(!1),v=g(!1);let I=0;const m=g([]),p=[{title:"ID",colKey:"id",width:"100",cell:(r,c)=>a(O,{variant:"text",onClick:()=>P(c.row.id)},{default:()=>[c.row.id]})}],d=[{title:"标题",colKey:"title",cell:(r,c)=>a(O,{variant:"text",onClick:()=>P(c.row.id)},{default:()=>[c.row.title]})},{title:"创建人",colKey:"authorNickname",width:"200"},{title:"创建时间",colKey:"insertTime",width:"180"},{title:"更新时间",colKey:"updateTime",width:"180"}],u=g(!1);let b=1,C=50;const V=g({current:b,pageSize:C,defaultCurrent:b,defaultPageSize:C,total:0,pageSizeOptions:[50,100]}),L=g(),z=g({problemId:"",title:"",username:""}),D=g({title:"",description:"",open_time:[]}),B=r=>{r&&o.push({name:"problem-detail",params:{problemId:r}})},S=(r,c)=>{o.push({name:"contest-problem-detail",params:{contestId:r,problemIndex:c}})},P=r=>{if(r){if(I){o.push({name:"contest-discuss-detail",params:{contestId:I,discussId:r}});return}o.push({name:"discuss-detail",params:{discussId:r}})}},R=async()=>{await o.push({query:{...t.query,problem_id:z.value.problemId,title:z.value.title,username:z.value.username,page:1,page_size:V.value.defaultPageSize}})},y=async(r,c)=>{var f;u.value=!0;try{const{current:_,pageSize:j}=r,A=await mo(I,z.value.problemId,z.value.title,z.value.username,_,j);if(L.value=[],A.code===0){if(A.data.list){const E=A.data.list;for(let U=0;U<E.length;U++){const G=E[U],H=await Ut(G);(f=L.value)==null||f.push(H)}}V.value={...V.value,total:A.data.total_count}}else c&&K(s,A.code)}catch(_){console.error(_),K(s,Ie())}finally{u.value=!1}},T=async r=>{await o.push({query:{...t.query,page:r.current,page_size:r.pageSize}})},h=()=>{i.value=!0},w=async()=>{v.value=!0,console.log("discussCreateForm",D.value),fo(D.value).then(r=>{r.code===0?(pe(s,"创建比赛成功"),i.value=!1,o.push({path:"/discuss/"+r.data.id})):K(s,r.code)}).finally(()=>{v.value=!1})};return oe(async()=>{l=ze(()=>t.query,r=>{Array.isArray(t.params.contestId)?I=t.params.contestId[0]:I=t.params.contestId,m.value=p,I?m.value=m.value.concat([{title:"问题ID",colKey:"contestProblemIndex",width:"100",cell:(_,j)=>{let A;return a(O,{variant:"text",onClick:()=>S(I,j.row.contestProblemIndex)},go(A=Je(j.row.contestProblemIndex))?A:{default:()=>[A]})}}]):m.value=m.value.concat([{title:"问题ID",colKey:"problemId",width:"100",cell:(_,j)=>a(O,{variant:"text",onClick:()=>B(j.row.problemId)},{default:()=>[j.row.problemId]})}]),m.value=m.value.concat(d),z.value.problemId=r.problem_id||"",z.value.title=r.title||"",z.value.username=r.username||"";const c=parseInt(r.page)||V.value.defaultCurrent,f=parseInt(r.page_size)||V.value.defaultPageSize;b=c,C=f,V.value={...V.value,current:b,pageSize:C},y({current:b,pageSize:C},!0)},{immediate:!0})}),Le(()=>{l&&l()}),(r,c)=>{const f=xe,_=ce,j=be,A=ke,E=Te,U=O,G=Pe,H=_e,W=he,$=It,re=nt;return x(),X(ee,null,[a(W,null,{default:n(()=>[a(j,{span:9},{default:n(()=>[a(_,{style:{margin:"10px"}},{default:n(()=>[a(f,{data:L.value,columns:m.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:V.value,loading:u.value,"table-layout":"auto",onPageChange:T},null,8,["data","columns","pagination","loading"])]),_:1})]),_:1}),a(j,{span:3},{default:n(()=>[M("div",_o,[a(_,{class:"sh-card"},{default:n(()=>[a(G,{model:z.value},{default:n(()=>[a(E,{label:"问题ID"},{default:n(()=>[a(A,{modelValue:z.value.problemId,"onUpdate:modelValue":c[0]||(c[0]=le=>z.value.problemId=le),placeholder:"请输入完整问题ID"},null,8,["modelValue"])]),_:1}),a(E,{label:"标题"},{default:n(()=>[a(A,{modelValue:z.value.title,"onUpdate:modelValue":c[1]||(c[1]=le=>z.value.title=le),placeholder:"暂不支持模糊查询"},null,8,["modelValue"])]),_:1}),a(E,{label:"创建人"},{default:n(()=>[a(A,{modelValue:z.value.username,"onUpdate:modelValue":c[2]||(c[2]=le=>z.value.username=le),placeholder:"仅支持输入完整用户名"},null,8,["modelValue"])]),_:1}),a(E,null,{default:n(()=>[a(U,{theme:"primary",onClick:R},{default:n(()=>c[7]||(c[7]=[k("提交")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(_,{class:"sh-card"},{default:n(()=>[a(H,null,{default:n(()=>[a(U,{onClick:h},{default:n(()=>c[8]||(c[8]=[k("创建")])),_:1})]),_:1})]),_:1})])]),_:1})]),_:1}),a(re,{visible:i.value,"onUpdate:visible":c[6]||(c[6]=le=>i.value=le),header:"创建比赛",onConfirm:w,"confirm-loading":v.value},{default:n(()=>[a(G,{"label-width":80,model:D.value,onSubmit:c[5]||(c[5]=Re(()=>{},["prevent"]))},{default:n(()=>[a(E,{label:"标题"},{default:n(()=>[a(A,{modelValue:D.value.title,"onUpdate:modelValue":c[3]||(c[3]=le=>D.value.title=le),placeholder:"请输入标题"},null,8,["modelValue"])]),_:1}),a(E,{label:"开启时间"},{default:n(()=>[a($,{"enable-time-picker":"","allow-input":"",clearable:"",modelValue:D.value.open_time,"onUpdate:modelValue":c[4]||(c[4]=le=>D.value.open_time=le)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","confirm-loading"])],64)}}}),Ke=Y(vo,[["__scopeId","data-v-97dda3a0"]]),ho={key:0,style:{margin:"20px"}},bo=["innerHTML"],yo=["innerHTML"],wo={style:{margin:"10px"}},ko={style:{margin:"10px"}},Co={style:{margin:"10px","text-align":"right"}},So={style:{margin:"12px"}},Io={key:0,class:"dida-edit-container"},Lo=te({__name:"DiscussDetail",setup(e){let t=ie();const{globalProperties:o}=se();let s=null;const l=Ve(),i=ge();let v=g("");const I=g(""),m=g(null),p=g(!1),d=g(null),u=g(!1);let b=1,C=20;const V=g({current:1,total:0,defaultPageSize:C,defaultCurrent:b,pageSizeOptions:[20,50]}),L=g([]),z={},D=Ce(()=>i.hasAuth(Se.ManageDiscuss)),B=h=>{h&&F.push({name:"discuss-list",query:{...t.query,title:"",tag:h.name}})},S=()=>{F.push({name:"manage-discuss",params:{discussId:I.value}})},P=()=>a("div",{class:"t-pagination__total"},[`共 ${V.value.total} 条回复`]),R=()=>{},y=async(h,w)=>{var r;u.value=!0;try{const{current:c,pageSize:f}=h,_=await po(I.value,c,f);if(L.value=[],_.code===0){const j=_.data.list;if(j)for(let A=0;A<j.length;A++){const E=j[A],U=await io(E);(r=L.value)==null||r.push(U),await we(()=>{const G=document.querySelectorAll(".dida-discuss-content");G&&G.length>0&&G.forEach(H=>{ne.mathRender(H),ne.highlightRender({lineNumber:!0,enable:!0},H),$e(H)})})}V.value={...V.value,total:_.data.total_count}}else w&&K(o,_.code)}catch(c){console.error(c),K(o,Ie())}finally{u.value=!1}},T=async h=>{await F.push({query:{...t.query,page:h.current,page_size:h.pageSize}})};return oe(async()=>{if(Array.isArray(t.params.discussId)?I.value=t.params.discussId[0]:I.value=t.params.discussId,!I.value){me(o,"题目不存在"),await F.push({name:"discuss"});return}p.value=!0;const h=await co(I.value);if(h.code!==0){p.value=!1,K(o,h.code),await F.push({name:"discuss"});return}h.data.tags&&h.data.tags.forEach(f=>{z[f.id]=f}),d.value=Ut(h.data.discuss),l.setTitle(d.value.title+" - "+l.getTitle);let w=d.value.content;const r={math:{inlineDigit:!0,engine:"KaTeX"}};v.value=await ne.md2html(w,r),await we(()=>{m.value&&(ne.mathRender(m.value),ne.highlightRender({lineNumber:!0,enable:!0},m.value),$e(m.value)),p.value=!1}),s=ze(()=>t.query,f=>{const _=parseInt(f.page)||V.value.defaultCurrent,j=parseInt(f.page_size)||V.value.defaultPageSize;b=_,C=j,V.value={...V.value,current:b,pageSize:C},y({current:b,pageSize:C},!0)},{immediate:!0});const c={after:()=>{}};new ne("commentEditRef",c)}),Le(()=>{s&&s()}),(h,w)=>{const r=ma,c=da,f=ce,_=_e,j=pa,A=O,E=be,U=Me,G=Ee,H=he,W=ve;return x(),N(W,{loading:p.value},{default:n(()=>[a(H,{class:"dida-main-content"},{default:n(()=>[a(E,{span:8},{default:n(()=>{var $,re,le;return[($=d.value)!=null&&$.problemTitle||(re=d.value)!=null&&re.contestTitle?(x(),X("div",ho,[a(c,{"max-item-width":"300"},{default:n(()=>{var de,Z,st,rt;return[(de=d.value)!=null&&de.contestTitle?(x(),X(ee,{key:0},[a(r,{to:{name:"contest-detail",params:{contestId:(Z=d.value)==null?void 0:Z.contestId}}},{default:n(()=>{var ye;return[k(q((ye=d.value)==null?void 0:ye.contestTitle),1)]}),_:1},8,["to"]),a(r,{to:{name:"contest-problem-detail",params:{problemId:(st=d.value)==null?void 0:st.contestProblemIndex}}},{default:n(()=>{var ye,ut;return[k(q(ae(Je)((ye=d.value)==null?void 0:ye.contestProblemIndex))+" - "+q((ut=d.value)==null?void 0:ut.problemTitle),1)]}),_:1},8,["to"])],64)):(x(),X(ee,{key:1},[a(r,{to:{name:"discuss-list-problem"}},{default:n(()=>w[2]||(w[2]=[k(" 问题讨论")])),_:1}),a(r,{to:{name:"problem-detail",params:{problemId:(rt=d.value)==null?void 0:rt.problemId}}},{default:n(()=>{var ye;return[k(q((ye=d.value)==null?void 0:ye.problemTitle),1)]}),_:1},8,["to"])],64))]}),_:1})])):ue("",!0),a(f,{style:{margin:"10px"},header:(le=d.value)==null?void 0:le.title,"header-bordered":!0},{default:n(()=>[M("div",{innerHTML:ae(v),class:"dida-discuss-content"},null,8,bo)]),_:1},8,["header"]),(x(!0),X(ee,null,fe(L.value,(de,Z)=>(x(),N(f,{key:Z,style:{margin:"10px"},"header-bordered":""},{header:n(()=>[a(_,null,{default:n(()=>[M("span",null,q(de.authorNickname),1),M("span",null,q(de.insertTime),1)]),_:2},1024)]),default:n(()=>[M("div",{innerHTML:de.content,class:"dida-discuss-content"},null,8,yo)]),_:2},1024))),128)),M("div",wo,[a(j,{modelValue:V.value.current,"onUpdate:modelValue":w[0]||(w[0]=de=>V.value.current=de),"page-size":V.value.pageSize,"onUpdate:pageSize":w[1]||(w[1]=de=>V.value.pageSize=de),total:V.value.total,"page-size-options":V.value.pageSizeOptions,"show-page-size":!1,"total-content":P,onChange:T},null,8,["modelValue","page-size","total","page-size-options"])]),M("div",ko,[w[4]||(w[4]=M("div",{id:"commentEditRef",class:"dida-comment-editor"},null,-1)),M("div",Co,[a(_,null,{default:n(()=>[a(A,{theme:"primary",onClick:R},{default:n(()=>w[3]||(w[3]=[k("提交")])),_:1})]),_:1})])])]}),_:1}),a(E,{span:4},{default:n(()=>[M("div",So,[D.value?(x(),X("div",Io,[a(A,{onClick:S},{default:n(()=>w[5]||(w[5]=[k("编辑")])),_:1})])):ue("",!0),a(G,{layout:"vertical",bordered:!0},{default:n(()=>[a(U,{label:"创建时间"},{default:n(()=>{var $;return[k(q(($=d.value)==null?void 0:$.insertTime),1)]}),_:1}),a(U,{label:"编辑时间"},{default:n(()=>{var $;return[k(q(($=d.value)==null?void 0:$.modifyTime),1)]}),_:1}),a(U,{label:"更新时间"},{default:n(()=>{var $;return[k(q(($=d.value)==null?void 0:$.updateTime),1)]}),_:1}),a(U,{label:"创建用户"},{default:n(()=>{var $;return[k(q(($=d.value)==null?void 0:$.authorNickname),1)]}),_:1}),a(U,{label:"标签"},{default:n(()=>[a(_,null,{default:n(()=>{var $;return[(x(!0),X(ee,null,fe(($=d.value)==null?void 0:$.tags,re=>(x(),N(A,{key:re.id,variant:"dashed",onClick:()=>B(re)},{default:n(()=>[k(q(re.name),1)]),_:2},1032,["onClick"]))),128))]}),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),mt=Y(Lo,[["__scopeId","data-v-17657340"]]),Po=te({__name:"ManageJudge",setup(e){const{globalProperties:t}=se(),o=g(""),s=g(!1),l=g(!1),i=async()=>{try{const m=await Cn();if(m.code!==0){K(t,m.code);return}pe(t,"重判成功"),await F.push({name:"judge-list"})}catch(m){console.error(m),K(t,"重判失败")}},v=async()=>{if(o.value===""){K(t,"请输入问题Id");return}s.value=!0;try{const m=await Sn(o.value);if(m.code!==0){K(t,m.code);return}pe(t,"重判成功"),await F.push({name:"judge-list",query:{problem_id:o.value}})}catch(m){console.error(m),K(t,"重判失败")}finally{s.value=!1}},I=async()=>{l.value=!0;try{const m=await In();if(m.code!==0){K(t,m.code);return}pe(t,"重判成功"),await F.push({name:"judge-list"})}catch(m){console.error(m),K(t,"重判失败")}finally{l.value=!1}};return(m,p)=>{const d=O,u=ce,b=ke,C=_e;return x(),X(ee,null,[a(u,{class:"yj-manage-card",title:"重判最近提交"},{default:n(()=>[a(d,{onClick:i},{default:n(()=>p[1]||(p[1]=[k("重判")])),_:1})]),_:1}),a(u,{class:"yj-manage-card",title:"重判问题"},{default:n(()=>[a(C,null,{default:n(()=>[a(b,{modelValue:o.value,"onUpdate:modelValue":p[0]||(p[0]=V=>o.value=V),placeholder:"输入问题Id"},null,8,["modelValue"]),a(d,{onClick:v,loading:s.value},{default:n(()=>p[2]||(p[2]=[k("重判")])),_:1},8,["loading"])]),_:1})]),_:1}),a(u,{class:"yj-manage-card",title:"重判所有"},{default:n(()=>[a(d,{onClick:I,theme:"danger",loading:l.value},{default:n(()=>p[3]||(p[3]=[k("重判")])),_:1},8,["loading"])]),_:1})],64)}}}),To=Y(Po,[["__scopeId","data-v-60a14d44"]]),xo={style:{margin:"10px"}},Vo={key:1},jo={style:{margin:"12px"}},$o={class:"dida-edit-container"},zo=te({__name:"ProblemEdit",setup(e){let t=ie();const{globalProperties:o}=se(),s=Ve(),l=g(""),i=g(!1);let v=null;const I=g(!1),m=g(null),p=g({title:"",timeLimit:0,memoryLimit:0,source:"",tags:[]}),d=g([]),u=g([]),b=Ce(()=>{const S=[],P=d.value;for(let R=0,y=P.length;R<y;R++)P[R].value&&S.push(P[R].value);return S}),C=(S,P)=>{const{trigger:R,index:y,item:T}=P;if(R==="clear"&&(d.value=[]),["tag-remove","backspace"].includes(R)&&d.value.splice(y,1),R==="enter"){for(let w=0;w<u.value.length;w++){const r=u.value[w];if(r.label===T){for(let c=0;c<d.value.length;c++)if(d.value[c].label===r.label)return;d.value.push(r);return}}const h={label:T,value:T};d.value.push(h),u.value=u.value.concat(h)}},V=(S,{current:P,type:R})=>{if(!P){d.value=R==="check"?u.value.slice(1):[];return}if(R==="check"){const y=u.value.find(T=>T.value===P);if(!y)return;d.value.push(y)}else d.value=d.value.filter(y=>y.value!==P)},L=()=>{F.push({name:"problem-detail",params:{problemId:l.value}})},z=()=>{F.push({name:"manage-problem-judge",params:{problemId:l.value}})},D=async()=>{if(v){I.value=!0,p.value.tags=[];for(let S=0;S<d.value.length;S++){const P=d.value[S];P&&P.label&&p.value.tags.push(P.label)}try{const S=await xn(l.value,p.value.title,p.value.timeLimit,p.value.memoryLimit,p.value.source,p.value.tags,v.getValue());if(I.value=!0,S.code!==0){K(o,S.code);return}S.data!=null&&(m.value.updateTime=new Date(S.data).toLocaleString()),xt(o,"保存成功")}finally{I.value=!1}}},B=async()=>{const S=await Et(l.value);if(S.code!==0){K(o,S.code),console.error("problem get failed",S.code),await F.push({name:"problem"});return}const P=S.data.problem;if(m.value=We(P,{}),p.value.title=P.title,p.value.timeLimit=P.time_limit,p.value.memoryLimit=P.memory_limit,p.value.source=P.source,p.value.tags=[],d.value=[],S.data.tags)for(let T=0;T<S.data.tags.length;T++){const h=S.data.tags[T];h&&h.name&&(p.value.tags.push(h.name),d.value.push({label:h.name,value:h.id}))}s.setTitle(P.title+" - "+s.getTitle);let R=P.description;const y={after:()=>{v==null||v.setValue(R)}};v=new ne("codeEditRef",y),i.value=!1};return oe(async()=>{if(Array.isArray(t.params.problemId)?l.value=t.params.problemId[0]:l.value=t.params.problemId,!l.value){me(o,"题目不存在"),await F.push({name:"problem"});return}i.value=!0,Mt(-1).then(async S=>{S.code===0?(S.data.list&&S.data.list.forEach(P=>{u.value.push({label:P.name,value:P.id})}),await B()):(K(o,S.code),console.error("problem tag get failed",S.code),await F.push({name:"problem"}))}).catch(async S=>{console.error(S),K(o,"获取数据异常"),await F.push({name:"problem"})})}),(S,P)=>{const R=ke,y=Te,T=fa,h=ga,w=_a,r=Pe,c=ce,f=be,_=O,j=_e,A=Me,E=Ee,U=he,G=ve;return x(),N(G,{loading:i.value},{default:n(()=>[a(U,null,{default:n(()=>[a(f,{span:8},{default:n(()=>[M("div",xo,[a(c,{class:"sh-card"},{default:n(()=>[a(r,{model:p.value},{default:n(()=>[a(y,{label:"标题"},{default:n(()=>[a(R,{modelValue:p.value.title,"onUpdate:modelValue":P[0]||(P[0]=H=>p.value.title=H),placeholder:"问题标题"},null,8,["modelValue"])]),_:1}),a(y,{label:"时间限制"},{default:n(()=>[a(T,{modelValue:p.value.timeLimit,"onUpdate:modelValue":P[1]||(P[1]=H=>p.value.timeLimit=H),theme:"normal",min:0},{suffix:n(()=>P[4]||(P[4]=[M("span",null,"ms",-1)])),_:1},8,["modelValue"])]),_:1}),a(y,{label:"内存限制"},{default:n(()=>[a(T,{modelValue:p.value.memoryLimit,"onUpdate:modelValue":P[2]||(P[2]=H=>p.value.memoryLimit=H),theme:"normal",min:0},{suffix:n(()=>P[5]||(P[5]=[M("span",null,"KB",-1)])),_:1},8,["modelValue"])]),_:1}),a(y,{label:"来源"},{default:n(()=>[a(R,{modelValue:p.value.source,"onUpdate:modelValue":P[3]||(P[3]=H=>p.value.source=H),placeholder:"请输入题目来源"},null,8,["modelValue"])]),_:1}),a(y,{label:"标签"},{default:n(()=>[a(w,{value:d.value,"allow-input":!0,placeholder:"请选择或输入","tag-input-props":{excessTagsDisplayType:"break-line"},"popup-props":{overlayInnerClassName:["narrow-scrollbar"],overlayInnerStyle:{maxHeight:"280px",overflowY:"auto",overscrollBehavior:"contain",padding:"6px"}},clearable:"",multiple:"",onTagChange:C},{panel:n(()=>[u.value.length?(x(),N(h,{key:0,value:b.value,options:u.value,onChange:V},null,8,["value","options"])):(x(),X("div",Vo,"暂无数据"))]),suffixIcon:n(()=>[a(ae(Bt))]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1})])]),_:1}),a(f,{span:4},{default:n(()=>[M("div",jo,[M("div",$o,[a(j,null,{default:n(()=>[a(_,{onClick:D,theme:"danger",loading:I.value},{default:n(()=>P[6]||(P[6]=[k("保存")])),_:1},8,["loading"]),a(_,{onClick:z,theme:"warning"},{default:n(()=>P[7]||(P[7]=[k("判题数据")])),_:1}),a(_,{onClick:L},{default:n(()=>P[8]||(P[8]=[k("查看")])),_:1})]),_:1})]),a(E,{layout:"vertical",bordered:!0},{default:n(()=>[a(A,{label:"创建时间"},{default:n(()=>{var H;return[k(q((H=m.value)==null?void 0:H.insertTime),1)]}),_:1}),a(A,{label:"更新时间"},{default:n(()=>{var H;return[k(q((H=m.value)==null?void 0:H.updateTime),1)]}),_:1}),a(A,{label:"判题方式"},{default:n(()=>{var H;return[k(q((H=m.value)==null?void 0:H.judgeType),1)]}),_:1}),a(A,{label:"上传用户"},{default:n(()=>{var H;return[k(q((H=m.value)==null?void 0:H.creatorNickname),1)]}),_:1})]),_:1})])]),_:1})]),_:1}),P[9]||(P[9]=M("div",{id:"codeEditRef",class:"dida-description-editor"},null,-1))]),_:1},8,["loading"])}}}),Do=Y(zo,[["__scopeId","data-v-b8d494d1"]]),Ro={style:{margin:"10px"}},Ao={style:{margin:"12px"}},Eo={class:"dida-edit-container"},Mo=te({__name:"ProblemJudge",setup(e){let t=ie();const{globalProperties:o}=se(),s=Ve(),l=g(""),i=g(!1),v=g(null);let I=null;const m=g(null),p=g(""),d=g(!1),u=g(!1),b=g([{title:"文件",colKey:"file"},{title:"大小",colKey:"size",width:150,cell:(r,c)=>c.row.size.toFixed(0)+" B"},{title:"最后修改时间",colKey:"lastModified",width:180,cell:(r,c)=>new Date(c.row.lastModified).toLocaleString()},{title:"操作",colKey:"action",width:100,cell:(r,c)=>a(O,{onClick:()=>B(c.row.file)},{default:()=>[k("下载")]})}]),C=g([]),V=Ce(()=>({border:"2px dashed #ccc",borderRadius:"6px",padding:"20px",textAlign:"center",cursor:"pointer",backgroundColor:d.value?"#f0f9ff":"#fff",transition:"background-color 0.2s ease"})),L=Ce(()=>p.value?`已选择：${p.value}`:d.value?"松开文件以上传":"拖拽文件到这里，或点击选择文件"),z=()=>{F.push({name:"problem-detail",params:{problemId:l.value}})},D=()=>{F.push({name:"manage-problem",params:{problemId:l.value}})},B=async r=>{const c=await Vn(l.value,r);if(c.code!==0){K(o,c.code);return}const f=document.createElement("a");f.href=c.data,f.target="_blank",f.click(),URL.revokeObjectURL(f.href)},S=async()=>{if(!I){me(o,"请选择压缩包");return}u.value=!0,jn(l.value,I).then(async r=>{r.code==0?(m.value.value=null,I=null,p.value="",i.value=!0,xt(o,"上传成功"),await w()):K(o,r.code)}).catch(r=>{console.log(r),o.$message.error({duration:3e3,content:"申请失败"})}).finally(()=>{u.value=!1})},P=()=>{var r;(r=m.value)==null||r.click()},R=r=>{const c=r.target.files[0];c&&(p.value=c.name,I=c)},y=r=>{d.value=!0},T=()=>{d.value=!1},h=r=>{r.preventDefault(),r.stopPropagation(),d.value=!1;const c=r.dataTransfer.files[0];if(c){p.value=c.name;const f=new DataTransfer;f.items.add(c),m.value.files=f.files,I=c}},w=async()=>{const r=await Pn(l.value);if(r.code!==0){K(o,r.code),await F.push({name:"problem"});return}const c=r.data.problem;v.value=We(c,{}),s.setTitle(c.title+" - "+s.getTitle),C.value=[],r.data.judges?r.data.judges.forEach(f=>{C.value.push({file:f.key,size:f.size,lastModified:f.last_modified})}):me(o,"评测数据不存在"),i.value=!1};return oe(async()=>{if(Array.isArray(t.params.problemId)?l.value=t.params.problemId[0]:l.value=t.params.problemId,!l.value){me(o,"题目不存在"),await F.push({name:"problem"});return}i.value=!0,await w()}),(r,c)=>{const f=xe,_=be,j=O,A=_e,E=Me,U=Ee,G=he,H=ve;return x(),N(H,{loading:i.value},{default:n(()=>[a(G,null,{default:n(()=>[a(_,{span:7},{default:n(()=>[M("div",Ro,[M("div",{id:"drop-zone",style:vt(V.value),onClick:P,onDragenter:Re(y,["prevent"]),onDragover:c[0]||(c[0]=Re(()=>{},["prevent"])),onDragleave:Re(T,["prevent"]),onDrop:h},[M("input",{ref_key:"fileInput",ref:m,type:"file",style:{display:"none"},onChange:R},null,544),k(" "+q(L.value),1)],36)]),a(f,{data:C.value,columns:b.value,"row-key":"id","vertical-align":"top",hover:!0},null,8,["data","columns"])]),_:1}),a(_,{span:5},{default:n(()=>[M("div",Ao,[M("div",Eo,[a(A,null,{default:n(()=>[a(j,{onClick:S,theme:"danger",loading:u.value},{default:n(()=>c[1]||(c[1]=[k("上传")])),_:1},8,["loading"]),a(j,{onClick:D,theme:"warning"},{default:n(()=>c[2]||(c[2]=[k("编辑")])),_:1}),a(j,{onClick:z},{default:n(()=>c[3]||(c[3]=[k("查看")])),_:1})]),_:1})]),a(U,{layout:"vertical",bordered:!0},{default:n(()=>[a(E,{label:"标题"},{default:n(()=>{var W;return[k(q((W=v.value)==null?void 0:W.title),1)]}),_:1}),a(E,{label:"创建时间"},{default:n(()=>{var W;return[k(q((W=v.value)==null?void 0:W.insertTime),1)]}),_:1}),a(E,{label:"更新时间"},{default:n(()=>{var W;return[k(q((W=v.value)==null?void 0:W.updateTime),1)]}),_:1}),a(E,{label:"判题方式"},{default:n(()=>{var W;return[k(q((W=v.value)==null?void 0:W.judgeType),1)]}),_:1}),a(E,{label:"评测数据"},{default:n(()=>{var W;return[k(q((W=v.value)==null?void 0:W.judgeMd5),1)]}),_:1}),a(E,{label:"上传用户"},{default:n(()=>{var W;return[k(q((W=v.value)==null?void 0:W.creatorNickname),1)]}),_:1})]),_:1})])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),qo=Y(Mo,[["__scopeId","data-v-17986e38"]]),Ht=[{name:"problem-list",tab:"problem",sidebar:"problem-list",path:"",title:"问题列表",icon:"cpu",component:Rn},{name:"problem-detail",tab:"problem",sidebar:"problem-list",path:":problemId+",title:"问题详情",icon:"cpu",component:ct},{name:"problem-recommend",tab:"problem",sidebar:"problem-recommend",path:"recommend/:problemId*",title:"问题推荐",icon:"cpu",component:Bn},{name:"judge-list",tab:"judge",sidebar:"judge-list",path:"",title:"评测列表",icon:"cpu",component:Yn},{name:"judge-detail",tab:"judge",sidebar:"judge-list",path:":judgeId+",title:"评测详情",icon:"cpu",component:to},{name:"contest-list",tab:"contest",sidebar:"contest-list",path:"",title:"比赛列表",icon:"cpu",component:De},{name:"contest-recent",tab:"contest",sidebar:"contest-recent",path:"recent",title:"近期比赛",icon:"cpu",component:De},{name:"contest-detail",tab:"contest-detail-tab",sidebar:"contest-detail",path:":contestId+",title:"比赛详情",icon:"cpu",component:uo},{name:"contest-problem-detail",tab:"contest-detail-tab",sidebar:"contest-problem-detail",path:":contestId+/problem/:problemIndex+",title:"问题详情",icon:"cpu",component:ct},{name:"contest-judge",tab:"contest-detail-tab",sidebar:"contest-judge",path:":contestId+/judge",title:"评测列表",icon:"cpu",component:De},{name:"contest-rank",tab:"contest-detail-tab",sidebar:"contest-rank",path:":contestId+/rank",title:"比赛排名",icon:"cpu",component:De},{name:"contest-statistics",tab:"contest-detail-tab",sidebar:"contest-statistics",path:":contestId+/statistics",title:"结果统计",icon:"cpu",component:De},{name:"contest-discuss",tab:"contest-detail-tab",sidebar:"contest-discuss",path:":contestId+/discuss",title:"比赛讨论",icon:"cpu",component:Ke},{name:"contest-discuss-detail",tab:"contest-detail-tab",sidebar:"contest-discuss",path:":contestId+/discuss/:discussId+",title:"讨论详情",icon:"cpu",component:mt},{name:"discuss-list",tab:"discuss",sidebar:"discuss-list",path:"",title:"讨论列表",icon:"cpu",component:Ke},{name:"discuss-list-problem",tab:"discuss",sidebar:"discuss-list-problem",path:"problem",title:"问题讨论",icon:"cpu",component:Ke},{name:"discuss-list-judge",tab:"discuss",sidebar:"discuss-list-judge",path:"judge",title:"评测讨论",icon:"cpu",component:Ke},{name:"discuss-detail",tab:"discuss",sidebar:"discuss-list",path:":discussId+",title:"讨论详情",icon:"cpu",component:mt},{name:"manage-problem",tab:"manage",sidebar:"manage-problem",disableSidebar:!0,path:"problem/:problemId+",title:"问题编辑",icon:"cpu",component:Do,auths:[Se.ManageProblem]},{name:"manage-problem-judge",tab:"manage",sidebar:"manage-problem-judge",disableSidebar:!0,path:"problem/:problemId+/judge",title:"评测数据",icon:"cpu",component:qo,auths:[Se.ManageProblem]},{name:"manage-judge",tab:"manage",path:"judge",sidebar:"manage-judge",title:"评测管理",icon:"cpu",auths:["i-manage-judge"],component:To}],pt=(e,t,o,s)=>{s.tab==o&&(s.disableSidebar&&t!=s.sidebar||s.sidebar==null||s.sidebar!=s.name||e.push({name:s.name,title:s.title,icon:s.icon,to:{name:s.name}}))},Uo=(e,t)=>{const o=[];return Ht.forEach(s=>{if(Vt(s)){const l=[];s.children.forEach(i=>{pt(l,e,t,i)}),l.length>0&&o.push({title:s.title,children:l})}else pt(o,e,t,s)}),o},ft=(e,t)=>{const o=Ka(t.tab),s={name:t.name,path:"/"+t.path,meta:{title:t.title+" - "+o.title,tab:t.tab,sidebar:t.sidebar,showSidebar:o.showSidebar,needLogin:o.needLogin||t.needLogin,tabAuths:o.auths,auths:t.auths},component:t.component};o.disablePath||(s.path=o.path+s.path),e.push(s)},Ho=e=>{Ht.forEach(t=>{Vt(t)?t.children.forEach(o=>{ft(e,o)}):ft(e,t)})},qe=[];Ga(qe);Ho(qe);qe.push({path:"/403",name:"403",component:jt});qe.push({path:"/:pathMatch(.*)*",name:"404",component:Tt});const F=Xt({history:Wt("/"),routes:qe});F.beforeEach((e,t,o)=>{if(e.name==null||!F.hasRoute(e.name)){o({name:"home"});return}const s=e.matched[e.matched.length-1].meta;if(s.redirect){o({name:s.redirect});return}if(s.needLogin){const i=ge();if(i.getToken==null||i.getToken==""){o({name:"login",query:{redirect_uri:e.fullPath}});return}}const l=s.tabAuths;if(l&&!ge().hasAllAuths(l)){o({name:"403",query:{target:e.fullPath}});return}o()});F.afterEach((e,t)=>{if(e.name===t.name)return;const o=Xe(),s=Ve();let l=null;if(e.matched.length>0&&(l=e.matched[e.matched.length-1].meta),l!=null&&l.title&&s.setTitle(l==null?void 0:l.title),l!=null&&l.showSidebar){o.setSidebarShow(!0);const i=Uo(l==null?void 0:l.sidebar,l==null?void 0:l.tab);o.setMenuList(i),o.setMenuActiveName(l==null?void 0:l.sidebar)}else o.setSidebarShow(!1)});ha.registerLanguage("verilog",ba);const Ot=Jt();Ot.use(Yt);const Ue=Zt(vn);Ue.use(Ot);Ue.use(F);Ue.use(va);Ue.use(Qt);Ue.mount("#app");ja().then(()=>{console.log("Text cache reinitialized")}).catch(e=>{console.error("Text cache reinitialization failed",e)});
