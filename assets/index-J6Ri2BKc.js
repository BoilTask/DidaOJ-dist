import{ct as _t,d as re,a as c,o as ce,cu as E,cv as U,cw as a,e as t,cx as R,cy as q,bE as V,cz as ya,aM as Ya,cA as Me,cB as le,cC as ee,F as ue,cD as xe,cE as Xa,cF as Za,cG as Ce,bS as me,cH as Qa,cI as el,cJ as tl,b as je,v as ft,cK as al,cL as Xe,j as Je,w as ze,a9 as at,bc as ll,bd as nl,cM as ol,cN as sl,cO as rl,br as il,cP as Lt,cQ as wa,cR as ka,cj as ul,cS as dl,cT as cl,cU as ml,bX as pl,cV as la,cW as Nt,cX as fl,bf as vl,aY as Sa,z as _l,cY as gl,cZ as bl,c_ as hl,c$ as Ut}from"./node_modules-Dx8v6ULF.js";import{L as $e,C as be,R as Te,a as De,A as xt,S as yl,b as wl,c as kl,d as Sl,e as Cl,f as nt,T as Qe,B as H,F as Re,g as Ee,I as Ke,D as ot,h as Ca,i as We,j as Ye,k as Pl,l as Fe,m as Se,n as gt,o as bt,P as Gt,O as Ht,p as Bt,q as Il,r as Pa,s as Tl,t as xl,u as Ia,v as Ta,w as Vt,x as Vl,y as Dl,z as $l,E as jl,G as Ll,H as Ul,J as Al,K as zl,M as Rl,N as xa,Q as Va,U as El,V as Kl,W as Ml,X as ql,Y as Fl,Z as Nl,_ as Ol,$ as Gl,a0 as Hl,a1 as Bl}from"./tdesign-vue-next-Bmw4s9tN.js";import{u as fe,S as _e,a as ke,b as N,G as He,H as ct,c as Ge,d as Jl,e as Da,f as Wl,g as Yl,h as Xl,E as Zl,M as Ql,R as en}from"./md-editor-v3-CCt5ehCx.js";import{e as na}from"./monaco-editor-ouHSYV7a.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const g of o)if(g.type==="childList")for(const h of g.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&r(h)}).observe(document,{childList:!0,subtree:!0});function n(o){const g={};return o.integrity&&(g.integrity=o.integrity),o.referrerPolicy&&(g.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?g.credentials="include":o.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function r(o){if(o.ep)return;o.ep=!0;const g=n(o);fetch(o.href,g)}})();var Ue=(e=>(e.ManageWeb="i-manage-web",e.ManageJudge="i-manage-judge",e.ManageProblem="i-manage-problem",e.ManageProblemDaily="i-manage-problem-daily",e.ManageContest="i-manage-contest",e.ManageCollection="i-manage-collection",e.ManageDiscuss="i-manage-discuss",e))(Ue||{});const tn={"r-admin":["i-manage-web","i-manage-judge","i-manage-problem","i-manage-problem-daily","i-manage-contest","i-manage-collection","i-manage-discuss"]};function an(e){if(e==null)return[];const l=[];for(const n of e){const r=tn[n];r!=null&&l.push(...r)}return[...new Set(l)]}function ln(e,l){if(e==null||l==null)return!1;const n=an(e);for(const r of l)if(!n.includes(r))return!1;return!0}const qe=_t("user",{state:()=>({token:"",userId:-1,username:"",nickname:"",roles:[]}),getters:{getToken(){return this.token},getUserId(){return this.userId},getUsername(){return this.username},getNickname(){return this.nickname}},actions:{clear(){this.$patch({token:"",userId:-1,username:"",nickname:"",roles:[]})},loadResponse(e){this.$patch({token:e.token,userId:e.id,username:e.username,nickname:e.nickname,roles:e.roles})},isLogin(){return this.token!=null&&this.token!=""},hasAuth(e){return this.hasAllAuths([e])},hasAllAuths(e){return e?ln(this.roles,e):!0}},persist:!0}),Ze=_t("webStyle",{state:()=>({title:""}),getters:{getTitle(){return this.title}},actions:{setTitle(e){this.title=e}}}),Dt=_t("sidebarStyle",{state:()=>({showSidebar:!1,forceHiddenSidebar:!1,menuActiveName:"",menuList:[]}),getters:{getMenuList(){return this.menuList}},actions:{setSidebarShow(e){this.showSidebar=e},setForceHiddenSidebar(e){this.forceHiddenSidebar=e},setMenuActiveName(e){this.menuActiveName=e},clearMenuList(){this.menuList=[]},setMenuList(e){this.menuList=e},addMenuList(e){this.menuList.push(e)}}}),nn={style:{"text-align":"right"}},on=re({__name:"Hitokoto",setup(e){const l=c(!1),n=c(""),r=c(""),o=c(""),g=async()=>{l.value=!0;try{const b=await(await fetch("https://v1.hitokoto.cn")).json();r.value=b.hitokoto,o.value=b.creator,n.value="—— "+b.from}catch(h){r.value="一言获取失败了，但至少您还可以访问本站。",o.value="BoilTask",n.value="DidaOJ",console.error("Error fetching Hitokoto:",h)}finally{l.value=!1}};return ce(()=>{g()}),(h,b)=>{const _=be,w=$e;return U(),E(w,{loading:l.value},{default:a(()=>[t(_,{title:"一言 © Hitokoto"},{actions:a(()=>[V(" @"+q(o.value),1)]),default:a(()=>[R("div",null,[R("span",null,q(r.value),1),R("p",nn,q(n.value),1)])]),_:1})]),_:1},8,["loading"])}}}),sn="https://oj-api.didapipa.com/",B=ya.create({baseURL:sn,timeout:6e4,withCredentials:!0,headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});B.interceptors.request.use(e=>{const n=qe().getToken;return n&&(e.headers["X-Token"]=n),e},e=>Promise.reject(e));B.interceptors.response.use(function(e){return e.data},function(e){return Promise.reject(e)});const $t=ya.create({timeout:6e4,withCredentials:!1,headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});$t.interceptors.response.use(function(e){return e.data},function(e){return Promise.reject(e)});function $a(){return $t({baseURL:"https://r2-oj.didapipa.com",url:"/system/notification.json?"+Date.now(),method:"get"})}function ja(){return $t({baseURL:"https://r2-oj.didapipa.com",url:"/system/announcement.json?"+Date.now(),method:"get"})}function rn(){return B({url:"/system/status",method:"get"})}function un(){return B({url:"/system/image/token",method:"get"})}function dn(e,l){return B({url:"/system/notification",method:"post",data:{theme:e,content:l}})}function cn(e,l){return B({url:"/system/announcement",method:"post",data:{title:e,content:l}})}var jt=(e=>(e[e.Unknown=-1]="Unknown",e[e.C=0]="C",e[e.Cpp=1]="Cpp",e[e.Java=2]="Java",e[e.Python=3]="Python",e[e.Pascal=4]="Pascal",e[e.Golang=5]="Golang",e[e.Lua=6]="Lua",e[e.TypeScript=7]="TypeScript",e[e.Max=8]="Max",e))(jt||{});function Jt(){const e=[-1,8];return Object.values(jt).filter(l=>typeof l=="number"&&!e.includes(l)).map(l=>({value:l,label:It(l)}))}function Ct(e){return e>-1&&e<8}function It(e){switch(e){case 0:return"C";case 1:return"C++";case 2:return"Java";case 3:return"Python";case 4:return"Pascal";case 5:return"Golang";case 6:return"Lua";case 7:return"TypeScript";default:return"未知"}}function Wt(e){switch(e){case 0:return"c";case 1:return"cpp";case 2:return"java";case 3:return"python";case 4:return"pascal";case 5:return"go";case 6:return"lua";case 7:return"typescript";default:return"text"}}var Be=(e=>(e[e.Init=0]="Init",e[e.Rejudge=1]="Rejudge",e[e.Submitting=2]="Submitting",e[e.Queuing=3]="Queuing",e[e.Compiling=4]="Compiling",e[e.Running=5]="Running",e[e.Accept=6]="Accept",e[e.PE=7]="PE",e[e.WA=8]="WA",e[e.TLE=9]="TLE",e[e.MLE=10]="MLE",e[e.OLE=11]="OLE",e[e.RE=12]="RE",e[e.CE=13]="CE",e[e.CLE=14]="CLE",e[e.JudgeFail=15]="JudgeFail",e[e.SubmitFail=16]="SubmitFail",e[e.Unknown=17]="Unknown",e[e.Max=18]="Max",e))(Be||{});const mn=e=>{switch(e){case 0:return"普通评测";case 1:return"特殊评测";default:return"未知"}},Tt=e=>{switch(e){case 0:return"等待处理";case 1:return"重新评测";case 2:return"提交中";case 3:return"队列中";case 4:return"编译中";case 5:return"运行中";case 6:return"通过";case 7:return"格式错误";case 8:return"答案错误";case 9:return"超时";case 10:return"内存超限";case 11:return"输出超限";case 12:return"运行错误";case 13:return"编译错误";case 14:return"编译超限";case 15:return"评测失败";case 16:return"提交失败";case 17:return"未知";default:return e}},oa=e=>{if(e!==void 0)switch(e){case 0:return"已经提交到系统，请耐心等待评测结果";case 1:return"管理员发起了重新评测，请耐心等待评测结果";case 2:return"判题机已经接受了本次提交，正在提交到远程判官中";case 3:return"判题机已经接受了本次提交，正在排队等待评测";case 4:return"判题机正在编译您的代码，部分语言会在此步检查是否符合语法";case 5:return"您的代码正在运行，请等待运行结果";case 6:return"您的代码通过了测试用例，恭喜您！";case 7:return"您的代码基本正确，但可能存在空格、空行等格式错误，请认真对比输出要求";case 8:return"您的答案与标准答案存在区别，请继续思考有无未考虑的情况";case 9:return"运行您的代码所用的时间超过了题目限制，请思考时间上更优的解法";case 10:return"运行您的代码所用的内存超过了题目限制，请思考空间上更优的解法";case 11:return"您程序的输出内容远远多于了题目要求（一般是数倍于正确输出），请检查相关逻辑";case 12:return"在运行您程序的过程中发生了异常，可能是除零、数组越界等问题，请检查相关逻辑";case 13:return"您的代码在编译阶段发生了错误，可能是语法错误或其他编译问题，请检查相关逻辑";case 14:return"在编译您代码的过程中，所占用的资源远远超过了要求，请检查相关逻辑";case 15:return"评测过程中发生了异常，一般是判题机或远程判官的问题，可尝试联系管理员处理";case 16:return"在将您的代码提交到远程判官的过程中发生了错误，一般是判题机或远程判官的问题，可联系管理员处理";case 17:return"您的代码状态未知，有可能是您不具有权限，或者该代码状态被隐藏"}return"暂时无提示信息"},La=e=>{switch(e){case 0:case 1:case 2:case 3:case 4:case 5:case 17:return"default";case 6:return"success";case 7:return"warning";default:return"danger"}};function Ua(){const e=[17,18];return Object.values(Be).filter(l=>typeof l=="number"&&!e.includes(l)).map(l=>({value:l,label:Tt(l)}))}function Pt(e){return e>=0&&e<17}function dt(e){switch(e){case 0:case 1:case 2:case 3:case 4:case 5:return!0;default:return!1}}function Aa(e){var n;const l={};if(l.id=e.id,l.problemId=e.problem_id,l.problemKey=e.problem_key,l.contestProblemIndex=e.contest_problem_index,l.status=e.status,e.score==null||dt(e.status)||!Pt(e.status)?l.score="-":l.score=(e.score/10).toString(),e.time?l.time=Math.ceil(e.time/1e6)+"ms":l.time="-",e.memory?l.memory=(e.memory/1024/1024).toFixed(2)+"MB":l.memory="-",l.language=e.language,l.codeLength=e.code_length,e.insert_time?l.insertTime=new Date(e.insert_time).toLocaleString():l.insertTime="-",l.inserter=e.inserter,l.inserterUsername=e.inserter_username,l.inserterNickname=e.inserter_nickname,l.code=e.code,l.compileMessage=e.compile_message,l.taskCurrent=e.task_current,l.taskTotal=e.task_total,l.task=[],e.task)for(let r=0;r<((n=e.task)==null?void 0:n.length);r++){const o=e.task[r],g={};g.taskId=o.task_id,g.status=o.status,o.time?g.time=Math.ceil(o.time/1e6)+"ms":g.time="-",o.memory?g.memory=(o.memory/1024/1024).toFixed(2)+"MB":g.memory="-",o.score?g.score=(o.score/10).toString():g.score="-",g.content=o.content,g.hint=o.hint,l.task.push(g)}return e.judger&&(l.judger=e.judger),e.judger_name?l.judgerName=e.judger_name:l.judgerName="-",e.judge_time&&(l.judgeTime=new Date(e.judge_time).toLocaleString()),l}function pn(e,l,n,r,o){return B({url:"/judge/approve",method:"post",data:{problem_id:e,contest_id:l,problem_index:n,language:r,code:o}})}function fn(e,l){let n={id:e};return l&&(n.contest_id=l),B({url:"/judge?"+new URLSearchParams(n).toString(),method:"get"})}function vn(e){return B({url:"/judge/code?id="+e,method:"get"})}function _n(e,l,n,r,o,g,h){let b={problem_key:l,username:n,language:String(r),status:String(o),page:String(g),page_size:String(h)};return e&&(b.contest_id=String(e)),B({url:`/judge/list?${new URLSearchParams(b).toString()}`,method:"get"})}function gn(){return B({url:"/judge/statics/recently",method:"get"})}function bn(){return B({url:"/judge/rejudge/recently",method:"post"})}function hn(e,l,n){const r={};return e!=null&&(r.problem_id=e),l!=null?r.language=l:r.language=jt.Unknown,n!=null?r.status=n:r.status=18,B({url:"/judge/rejudge/search",method:"post",data:r})}function yn(){return B({url:"/judge/rejudge/all",method:"post",timeout:0})}function wn(e){return B({url:"/judge/rejudge",method:"post",data:{id:Number(e)}})}var Ae=(e=>(e[e.None=0]="None",e[e.Attempt=1]="Attempt",e[e.Accept=2]="Accept",e))(Ae||{});function ht(e,l){const n={};if(n.id=e.id,n.key=e.key,n.inserter=e.inserter,n.title=e.title,n.tags=[],e.tags)for(const r of e.tags){const o=l[r];o&&n.tags.push(o)}if(n.private=e.private,n.accept=e.accept,n.attempt=e.attempt,e.description!=null&&(n.description=e.description),e.time_limit!=null&&e.time_limit>=0?n.timeLimit=e.time_limit.toString()+" ms":n.timeLimit="未知",e.memory_limit!=null&&e.memory_limit>=0?n.memoryLimit=(e.memory_limit/1024).toFixed(2)+" MB":n.memoryLimit="未知",e.judge_type!=null&&(n.judgeType=mn(e.judge_type)),e.insert_time!=null&&(n.insertTime=new Date(e.insert_time).toLocaleString()),e.modify_time!=null&&(n.modifyTime=new Date(e.modify_time).toLocaleString()),e.modifier_nickname!=null&&(n.inserterNickname=e.modifier_nickname),e.source!=null){const r=/\[([^\]]+)\]\(([^)]+)\)/,o=e.source.match(r);o?(n.source=o[1],n.sourceUrl=o[2]):(n.source=e.source,n.sourceUrl="")}return e.judge_md5!=null&&(n.judgeMd5=e.judge_md5),e.origin_oj!=null&&(n.originOj=e.origin_oj),e.origin_id!=null&&(n.originId=e.origin_id),e.origin_url!=null&&(n.originUrl=e.origin_url),n}function za(e,l){const n={};if(n.key=e.key,n.problemId=e.problem_id,n.title=e.title,n.tags=[],e.tags)for(const r of e.tags){const o=l[r];o&&n.tags.push(o)}return e.accept?n.accept=e.accept:n.accept=0,e.attempt?n.attempt=e.attempt:n.attempt=0,n.solution=e.solution,n.code=e.code,e.insert_time!=null&&(n.insertTime=new Date(e.insert_time).toLocaleString()),e.modify_time!=null&&(n.modifyTime=new Date(e.modify_time).toLocaleString()),e.inserter_nickname!=null&&(n.inserterNickname=e.inserter_nickname),e.modifier_nickname!=null&&(n.modifierNickname=e.modifier_nickname),n}function Ra(e,l,n){const r={};return e?r.key=e:(r.contest_id=l,r.problem_index=n),B({url:`/problem?${new URLSearchParams(r).toString()}`,method:"get"})}function Ea(e){return B({url:"/problem/tag/list?max_count="+e,method:"get"})}function kn(e){return B({url:"/problem/judge?key="+e,method:"get"})}function Sn(e,l,n,r,o,g){const h={};return e&&(h.oj=e),l&&(h.title=l),n&&(h.tag=n),r!==void 0&&(h.private=r?"1":"0"),o&&(h.page=o),g&&(h.page_size=g),B({url:`/problem/list?${new URLSearchParams(h).toString()}`,method:"get"})}function Cn(e){const l={};return e&&(l.problem_id=e),B({url:`/problem/recommend?${new URLSearchParams(l).toString()}`,method:"get"})}function Pn(e){return B({url:"/problem/daily?key="+e,method:"get"})}function In(e){return B({url:"/problem/daily/edit?key="+e,method:"get"})}function Tn(){return B({url:"/problem/daily/recently",method:"get"})}function xn(e,l,n,r,o){const g={};return e&&(g.start_date=e),l&&(g.end_date=l),n&&(g.problem_id=n),r&&(g.page=r),o&&(g.page_size=o),B({url:`/problem/daily/list?${new URLSearchParams(g).toString()}`,method:"get"})}function Ka(e){return B({url:"/problem/attempt/status",method:"get",params:{ids:e.join(",")}})}function Ma(e,l){return B({url:"/problem/crawl",method:"post",data:{oj:e,id:l}})}function Vn(e,l,n,r,o,g,h){return B({url:"/problem/create",method:"post",data:{title:e,time_limit:l,memory_limit:n,source:r,private:o,tags:g,description:h}})}function Dn(e,l,n,r,o,g,h,b){return B({url:"/problem/edit",method:"post",data:{id:e,title:l,time_limit:n,memory_limit:r,source:o,private:g,tags:h,description:b}})}function $n(e,l,n,r){return B({url:"/problem/daily/create",method:"post",data:{id:e,problem_id:l,solution:n,code:r}})}function jn(e,l,n,r){return B({url:"/problem/daily/edit",method:"post",data:{id:e,problem_id:l,solution:n,code:r}})}function Ln(e,l){return B({url:"/problem/judge/data/download?id="+e+"&key="+l,method:"get"})}function Un(e){return e||(e=0),B({url:"/problem/image/token?id="+e,method:"get"})}function An(e){return e||(e=""),B({url:"/problem/daily/image/token?id="+e,method:"get"})}function zn(e,l){const n=new FormData;return n.append("id",e),n.append("zip",l),B({url:"/problem/judge/data",method:"post",data:n,headers:{"Content-Type":"multipart/form-data"},timeout:1e3*60*5})}function Rn(e){return B({url:"/problem/parse/id",method:"post",data:{problems:e}})}function En(e){return B({url:"/problem/parse",method:"post",data:{problems:e}})}const Kn={class:"sh-main"},Mn={class:"dida-swiper-div"},qn=re({__name:"HomeView",setup(e){const{globalProperties:l}=fe();let n=-1;const r=c({theme:"info",content:""}),o=c({title:"",content:""}),g=c([]),h=c(!1),b=c(!1),_=c(!1),w=async()=>{r.value=await $a()},u=async()=>{try{const S=await ja();o.value.title=S.title,o.value.content=S.content}catch{_e(l,"加载公告失败"),o.value={title:"公告加载失败",content:"请刷新页面重新获取"}}},d=async()=>{const S=await gn();if(S.code!==0){_e(l,"加载OJ统计数据失败");return}let C=[];for(const m of S.data){const p=new Date(m.date),v=`${p.getMonth()+1}-${p.getDate()}`;C.push({Date:v,Type:"Unaccept",Count:m.attempt-m.accept}),C.push({Date:v,Type:"Accept",Count:m.accept})}const k={type:"bar",data:[{id:"barData",values:C}],xField:"Date",yField:"Count",seriesField:"Type",stack:!0,legends:{visible:!0},bar:{state:{hover:{stroke:"#000",lineWidth:1}}},height:300};new Xa(k,{dom:"ojStaticsDiv"}).renderSync()},L=async()=>{g.value=[];const S=await Tn();if(S.code!==0){_e(l,"加载每日问题数据失败");return}S.data.list&&S.data.list.length>0&&S.data.list.forEach(C=>{let k="default",s="未尝试";if(S.data.attempt_status){const p=S.data.attempt_status[C.problem_id];if(p)switch(p){case Ae.Accept:k="success",s="已解决";break;case Ae.Attempt:k="warning",s="待解决";break;default:k="default",s="未尝试"}}const m=`${C.title}`;g.value.push({key:C.key,title:m,problemId:C.problem_id,theme:k,tag:s})})};return ce(async()=>{_.value=!0,h.value=!0,b.value=!0,(async()=>(await w(),n=setInterval(()=>{w()},3e4),await u(),_.value=!1))(),(async()=>(await d(),h.value=!1))(),(async()=>(await L(),b.value=!1))()}),Ya(()=>{clearInterval(n)}),(S,C)=>{const k=xt,s=wl,m=yl,p=$e,v=Me("md-preview"),i=be,f=De,I=nt,$=Cl,P=Qe,y=Sl,j=kl,T=Te;return U(),E(p,{loading:_.value},{default:a(()=>[t(T,null,{default:a(()=>[t(f,{span:8},{default:a(()=>{var D;return[R("div",Kn,[r.value?(U(),E(k,{key:0,class:"dida-notification-div",theme:r.value.theme},{default:a(()=>[V(q(r.value.content),1)]),_:1},8,["theme"])):le("",!0),R("div",Mn,[t(m,{class:"dida-swiper"},{default:a(()=>[t(s,null,{default:a(()=>C[1]||(C[1]=[R("a",{href:"http://codeoj.cn",target:"_blank"},[R("img",{src:"https://cdn.codeoj.cn/image/banner.jpg",class:"swiper-img"})],-1)])),_:1}),t(s,null,{default:a(()=>C[2]||(C[2]=[R("img",{src:"https://cdn.codeoj.cn/image/banner.jpg",class:"swiper-img"},null,-1)])),_:1})]),_:1})]),t(p,{loading:h.value&&!_.value},{default:a(()=>C[3]||(C[3]=[R("div",{id:"ojStaticsDiv",style:{"min-height":"200px"}},null,-1)])),_:1},8,["loading"]),t(i,{title:(D=o.value)==null?void 0:D.title,style:{width:"calc(100% - 100px)",margin:"0 auto"}},{default:a(()=>{var x;return[t(v,{"model-value":(x=o.value)==null?void 0:x.content,previewTheme:"cyanosis"},null,8,["model-value"])]}),_:1},8,["title"])])]}),_:1}),t(f,{span:4},{default:a(()=>[t(i,{style:{margin:"10px"},bordered:!0},{default:a(()=>C[4]||(C[4]=[R("img",{src:"https://api.jysafe.cn/ip/",alt:"Welcome",style:{width:"100%"}},null,-1)])),_:1}),t(on,{style:{margin:"10px"}}),t(i,{style:{margin:"10px"},bordered:!0,title:"每日一题"},{actions:a(()=>[t(I,{onClick:C[0]||(C[0]=D=>S.$router.push({name:"problem-daily-list"}))},{default:a(()=>C[5]||(C[5]=[V("查看全部")])),_:1})]),default:a(()=>[t(p,{loading:b.value&&!_.value},{default:a(()=>[t(j,{split:!0,size:"small",style:{"min-height":"200px"}},{default:a(()=>[(U(!0),ee(ue,null,xe(g.value,D=>(U(),E(y,{key:D.key},{default:a(()=>[t($,{style:{width:"100px"}},{description:a(()=>[t(I,{onClick:x=>S.$router.push({name:"problem-daily-detail",params:{dailyId:D.key}})},{default:a(()=>[V(q(D.problemId),1)]),_:2},1032,["onClick"])]),_:2},1024),t($,{style:{width:"200px"}},{description:a(()=>[t(I,{onClick:x=>S.$router.push({name:"problem-daily-detail",params:{dailyId:D.key}})},{default:a(()=>[V(q(D.title),1)]),_:2},1032,["onClick"])]),_:2},1024),t($,{style:{width:"135px"},description:D.key},null,8,["description"]),t($,null,{description:a(()=>[t(P,{theme:D.theme},{default:a(()=>[V(q(D.tag),1)]),_:2},1032,["theme"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1},8,["loading"])]),_:1}),t(i,{style:{margin:"10px"},bordered:!0},{header:a(()=>C[6]||(C[6]=[R("b",null,"友情链接",-1)])),default:a(()=>[t(j,null,{default:a(()=>[t(y,null,{default:a(()=>[t(I,{href:"https://oi-wiki.org/",target:"_blank"},{default:a(()=>C[7]||(C[7]=[V("OI Wiki")])),_:1})]),_:1}),t(y,null,{default:a(()=>[t(I,{href:"https://boiltask.com",target:"_blank"},{default:a(()=>C[8]||(C[8]=[V("BoilTask Blog")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"])}}}),oe=(e,l)=>{const n=e.__vccOpts||e;for(const[r,o]of l)n[r]=o;return n},Fn=oe(qn,[["__scopeId","data-v-5a6e5964"]]),Nn={},On={style:{margin:"20px"}};function Gn(e,l){return U(),ee("div",On,l[0]||(l[0]=[Za('<header data-v-2f5a046e><h1 data-v-2f5a046e>算法设计高级课程方案</h1><p data-v-2f5a046e>分治策略 · 动态规划 · 贪心算法 · 回溯算法</p></header><div class="section" data-v-2f5a046e><h2 data-v-2f5a046e>一、课程核心知识点</h2><div class="two-columns" data-v-2f5a046e><div class="column" data-v-2f5a046e><h3 data-v-2f5a046e>1. 分治策略 (Divide and Conquer)</h3><p data-v-2f5a046e>分治算法是一种将问题分解为若干子问题，递归解决子问题，再合并子问题解得到原问题解的算法策略:cite[1]:cite[4]。</p><ul data-v-2f5a046e><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>基本思想</span>：将大问题分解为k个较小规模的相同子问题</li><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>关键特征</span>：子问题相互独立且与原问题形式相同</li><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>典型应用</span>：归并排序、快速排序、大整数乘法</li><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>复杂度分析</span>：主定理(Master Theorem)的应用</li></ul><h3 data-v-2f5a046e>2. 动态规划 (Dynamic Programming)</h3><p data-v-2f5a046e>动态规划通过保存子问题的解避免重复计算，适用于具有最优子结构和重叠子问题性质的问题:cite[1]:cite[6]。</p><ul data-v-2f5a046e><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>基本思想</span>：记忆化存储，自底向上求解</li><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>关键特征</span>：最优子结构、重叠子问题、无后效性</li><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>典型应用</span>：背包问题、最长公共子序列、最短路径</li><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>设计步骤</span>：定义状态、状态转移方程、边界条件</li></ul></div><div class="column" data-v-2f5a046e><h3 data-v-2f5a046e>3. 贪心算法 (Greedy Algorithm)</h3><p data-v-2f5a046e>贪心算法在每一步做出局部最优选择，希望最终得到全局最优解:cite[1]:cite[5]。</p><ul data-v-2f5a046e><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>基本思想</span>：当前状态下做出最好选择，不回溯</li><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>关键特征</span>：贪心选择性质、最优子结构</li><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>典型应用</span>：霍夫曼编码、最小生成树、任务调度</li><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>局限性</span>：不保证全局最优，需证明正确性</li></ul><h3 data-v-2f5a046e>4. 回溯算法 (Backtracking)</h3><p data-v-2f5a046e>回溯法通过深度优先搜索解空间树，通过剪枝避免无效搜索:cite[1]:cite[7]。</p><ul data-v-2f5a046e><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>基本思想</span>：系统搜索解空间，走不通就回溯</li><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>关键特征</span>：解空间树、约束函数、限界函数</li><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>典型应用</span>：八皇后问题、图着色、组合优化</li><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>优化技巧</span>：剪枝策略、启发式搜索</li></ul></div></div></div><div class="section" data-v-2f5a046e><h2 data-v-2f5a046e>二、专题化案例建设</h2><p data-v-2f5a046e>从各大竞赛平台选取真实案例，将算法理论应用于实际问题解决。</p><div class="case-study" data-v-2f5a046e><h3 data-v-2f5a046e>案例1：电商平台优惠券分配优化（阿里天池）</h3><p data-v-2f5a046e><strong data-v-2f5a046e>适用算法</strong>：动态规划、贪心算法</p><p data-v-2f5a046e><strong data-v-2f5a046e>问题描述</strong>：在预算限制下，如何分配优惠券以最大化平台GMV。</p><p data-v-2f5a046e><strong data-v-2f5a046e>教学要点</strong>：</p><ul data-v-2f5a046e><li data-v-2f5a046e>建立价值-成本模型</li><li data-v-2f5a046e>设计状态转移方程</li><li data-v-2f5a046e>比较贪心策略与动态规划效果</li></ul></div><div class="case-study" data-v-2f5a046e><h3 data-v-2f5a046e>案例2：医疗影像分割（Kaggle）</h3><p data-v-2f5a046e><strong data-v-2f5a046e>适用算法</strong>：分治策略</p><p data-v-2f5a046e><strong data-v-2f5a046e>问题描述</strong>：将大型医疗影像分割处理，提高分析效率。</p><p data-v-2f5a046e><strong data-v-2f5a046e>教学要点</strong>：</p><ul data-v-2f5a046e><li data-v-2f5a046e>图像分块处理策略</li><li data-v-2f5a046e>并行计算与结果合并</li><li data-v-2f5a046e>分治粒度对性能的影响</li></ul></div><div class="case-study" data-v-2f5a046e><h3 data-v-2f5a046e>案例3：网络路由优化（华为开发者大赛）</h3><p data-v-2f5a046e><strong data-v-2f5a046e>适用算法</strong>：回溯算法</p><p data-v-2f5a046e><strong data-v-2f5a046e>问题描述</strong>：在复杂网络拓扑中找到最优数据传输路径。</p><p data-v-2f5a046e><strong data-v-2f5a046e>教学要点</strong>：</p><ul data-v-2f5a046e><li data-v-2f5a046e>解空间树的构建</li><li data-v-2f5a046e>剪枝条件设计</li><li data-v-2f5a046e>回溯与分支限界的比较</li></ul></div><table data-v-2f5a046e><tr data-v-2f5a046e><th data-v-2f5a046e>竞赛平台</th><th data-v-2f5a046e>案例类型</th><th data-v-2f5a046e>适用算法</th><th data-v-2f5a046e>技能培养重点</th></tr><tr data-v-2f5a046e><td data-v-2f5a046e>百度AI Studio</td><td data-v-2f5a046e>自然语言处理</td><td data-v-2f5a046e>动态规划</td><td data-v-2f5a046e>序列对齐、编辑距离</td></tr><tr data-v-2f5a046e><td data-v-2f5a046e>阿里天池</td><td data-v-2f5a046e>推荐系统</td><td data-v-2f5a046e>贪心算法</td><td data-v-2f5a046e>实时决策、局部最优</td></tr><tr data-v-2f5a046e><td data-v-2f5a046e>Kaggle</td><td data-v-2f5a046e>数据挖掘</td><td data-v-2f5a046e>分治策略</td><td data-v-2f5a046e>大数据处理、并行计算</td></tr><tr data-v-2f5a046e><td data-v-2f5a046e>华为云大赛</td><td data-v-2f5a046e>网络优化</td><td data-v-2f5a046e>回溯算法</td><td data-v-2f5a046e>解空间探索、剪枝优化</td></tr></table></div><div class="section" data-v-2f5a046e><h2 data-v-2f5a046e>三、学术训练模块</h2><p data-v-2f5a046e>精选与课程知识点相关的经典学术论文，培养学生学术研究能力。</p><div class="paper-analysis" data-v-2f5a046e><h3 data-v-2f5a046e>论文1：动态规划在生物信息学中的应用</h3><p data-v-2f5a046e><strong data-v-2f5a046e>关联知识点</strong>：动态规划</p><p data-v-2f5a046e><strong data-v-2f5a046e>核心内容</strong>：Smith-Waterman算法在序列比对中的应用</p><p data-v-2f5a046e><strong data-v-2f5a046e>教学安排</strong>：</p><ol data-v-2f5a046e><li data-v-2f5a046e>论文精读：算法设计思想</li><li data-v-2f5a046e>复现实验：实现基础算法</li><li data-v-2f5a046e>性能分析：时间复杂度与空间复杂度</li><li data-v-2f5a046e>改进讨论：可能的优化方向</li></ol></div><div class="paper-analysis" data-v-2f5a046e><h3 data-v-2f5a046e>论文2：贪心算法的近似比证明</h3><p data-v-2f5a046e><strong data-v-2f5a046e>关联知识点</strong>：贪心算法</p><p data-v-2f5a046e><strong data-v-2f5a046e>核心内容</strong>：集合覆盖问题的贪心算法近似比分析</p><p data-v-2f5a046e><strong data-v-2f5a046e>教学安排</strong>：</p><ol data-v-2f5a046e><li data-v-2f5a046e>问题建模：形式化描述集合覆盖</li><li data-v-2f5a046e>算法设计：贪心策略实现</li><li data-v-2f5a046e>理论证明：近似比推导</li><li data-v-2f5a046e>实验验证：与最优解比较</li></ol></div><div class="paper-analysis" data-v-2f5a046e><h3 data-v-2f5a046e>论文3：分治算法的并行化实现</h3><p data-v-2f5a046e><strong data-v-2f5a046e>关联知识点</strong>：分治策略</p><p data-v-2f5a046e><strong data-v-2f5a046e>核心内容</strong>：MapReduce框架下的分治算法设计</p><p data-v-2f5a046e><strong data-v-2f5a046e>教学安排</strong>：</p><ol data-v-2f5a046e><li data-v-2f5a046e>算法分解：任务划分策略</li><li data-v-2f5a046e>并行实现：MapReduce编程</li><li data-v-2f5a046e>性能评估：加速比分析</li><li data-v-2f5a046e>应用讨论：大数据场景适用性</li></ol></div></div><div class="section" data-v-2f5a046e><h2 data-v-2f5a046e>四、分类培养方案</h2><p data-v-2f5a046e>针对专业型硕士和学术型硕士的不同培养目标，设计差异化教学内容。</p><div class="two-columns" data-v-2f5a046e><div class="column learning-path" data-v-2f5a046e><h3 data-v-2f5a046e>专业型硕士培养路径</h3><p data-v-2f5a046e><strong data-v-2f5a046e>培养目标</strong>：算法工程实现能力、实际问题解决能力</p><p data-v-2f5a046e><strong data-v-2f5a046e>教学重点</strong>：</p><ul data-v-2f5a046e><li data-v-2f5a046e>算法实现技巧与优化</li><li data-v-2f5a046e>工业界案例分析</li><li data-v-2f5a046e>性能调优与工程实践</li><li data-v-2f5a046e>团队协作开发</li></ul><p data-v-2f5a046e><strong data-v-2f5a046e>评估方式</strong>：</p><ol data-v-2f5a046e><li data-v-2f5a046e>竞赛项目实战</li><li data-v-2f5a046e>算法优化报告</li><li data-v-2f5a046e>系统性能评测</li></ol></div><div class="column learning-path" data-v-2f5a046e><h3 data-v-2f5a046e>学术型硕士培养路径</h3><p data-v-2f5a046e><strong data-v-2f5a046e>培养目标</strong>：算法理论研究能力、创新思维能力</p><p data-v-2f5a046e><strong data-v-2f5a046e>教学重点</strong>：</p><ul data-v-2f5a046e><li data-v-2f5a046e>算法正确性证明</li><li data-v-2f5a046e>复杂度分析理论</li><li data-v-2f5a046e>前沿论文研读</li><li data-v-2f5a046e>算法改进与创新</li></ul><p data-v-2f5a046e><strong data-v-2f5a046e>评估方式</strong>：</p><ol data-v-2f5a046e><li data-v-2f5a046e>学术论文阅读报告</li><li data-v-2f5a046e>理论证明作业</li><li data-v-2f5a046e>研究性课题论文</li></ol></div></div><table data-v-2f5a046e><tr data-v-2f5a046e><th data-v-2f5a046e>教学环节</th><th data-v-2f5a046e>专业型硕士</th><th data-v-2f5a046e>学术型硕士</th></tr><tr data-v-2f5a046e><td data-v-2f5a046e>案例教学</td><td data-v-2f5a046e>70%课时</td><td data-v-2f5a046e>40%课时</td></tr><tr data-v-2f5a046e><td data-v-2f5a046e>理论证明</td><td data-v-2f5a046e>20%课时</td><td data-v-2f5a046e>50%课时</td></tr><tr data-v-2f5a046e><td data-v-2f5a046e>论文研读</td><td data-v-2f5a046e>10%课时</td><td data-v-2f5a046e>40%课时</td></tr><tr data-v-2f5a046e><td data-v-2f5a046e>实践项目</td><td data-v-2f5a046e>必做</td><td data-v-2f5a046e>选做</td></tr><tr data-v-2f5a046e><td data-v-2f5a046e>研究论文</td><td data-v-2f5a046e>选做</td><td data-v-2f5a046e>必做</td></tr></table></div><div class="section" data-v-2f5a046e><h2 data-v-2f5a046e>五、课程评估与反馈</h2><p data-v-2f5a046e>建立多元化的课程评估体系，持续改进教学质量。</p><h3 data-v-2f5a046e>1. 学生评估方式</h3><ul data-v-2f5a046e><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>平时作业</span>：算法实现与理论证明(30%)</li><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>期中项目</span>：竞赛案例解决方案(20%)</li><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>期末考核</span>：综合设计与理论分析(30%)</li><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>课堂参与</span>：讨论与报告(20%)</li></ul><h3 data-v-2f5a046e>2. 教学反馈机制</h3><ul data-v-2f5a046e><li data-v-2f5a046e>每周在线问卷调查</li><li data-v-2f5a046e>每月师生座谈会</li><li data-v-2f5a046e>课程内容动态调整</li><li data-v-2f5a046e>竞赛成绩追踪分析</li></ul></div>',6)]))}const Hn=oe(Nn,[["render",Gn],["__scopeId","data-v-2f5a046e"]]),Bn={class:"sh-main"},Jn=re({__name:"View404",setup(e){let l=Ce(),n=c(l.fullPath);return(r,o)=>{const g=H;return U(),ee("div",Bn,[R("p",null,q(me(n)),1),o[2]||(o[2]=R("p",null,"该页面无效或已被迁移，请重新选择访问目标",-1)),t(g,{theme:"primary",onClick:o[0]||(o[0]=()=>r.$router.push("/"))},{default:a(()=>o[1]||(o[1]=[V("返回首页")])),_:1})])}}}),qa=oe(Jn,[["__scopeId","data-v-d4218944"]]);function Wn(e){const l={};return l.id=e.id,l.username=e.username,l.nickname=e.nickname,l.email=e.email,l.slogan=e.slogan,l.organization=e.organization,l.accept=e.accept,l.attempt=e.attempt,l.vjudgeId=e.vjudge_id,e.email&&(l.avatar=`https://www.gravatar.com/avatar/${Qa(e.email.toLowerCase().trim())}?d=identicon&s=100`),l}function Yn(e,l){return B({url:"/user/login",method:"post",data:{username:e,password:l}})}function Xn(){return B({url:"/user/login/refresh",method:"post"})}function Zn(e){const l={username:e};return B({url:`/user/info?${new URLSearchParams(l).toString()}`,method:"get"})}function Qn(e){const l="https://vjudge.net/user/solveDetail/"+encodeURIComponent(e);return $t({url:l,method:"get"})}function eo(e){return B({url:"/user/account/infos",method:"post",data:{users:e}})}function to(e){return B({url:"/user/parse",method:"post",data:{users:e}})}function ao(e,l){return B({url:"/user/register/email",method:"post",data:{token:e,email:l}})}function lo(e,l,n,r,o){return B({url:"/user/register",method:"post",data:{username:e,password:l,email:n,key:r,nickname:o}})}function no(e,l){return B({url:"/user/forget",method:"post",data:{token:e,username:l}})}function oo(e,l,n){return B({url:"/user/password/modify",method:"post",data:{username:e,password:l,key:n}})}const so={class:"dida-login-footer"},ro=re({__name:"LoginView",setup(e){const{globalProperties:l}=fe(),n=qe(),r=c(!1),o=c({username:"",password:""}),g=()=>{ke(l,"重置成功")},h=({validateResult:b,firstError:_})=>{r.value||(r.value=!0,Yn(o.value.username,o.value.password).then(w=>{if(w.code===0){n.loadResponse(w.data),ke(l,"登录成功");let u=l.$route.query.redirect_uri;u||(u="/user/"+w.data.username),l.$router.push({path:u})}else N(l,w.code)}).catch(w=>{console.error("Login error",w),_e(l,"登录失败")}).finally(()=>{r.value=!1}))};return ce(()=>{if(n.isLogin()){l.$router.push({path:"/user"});return}}),(b,_)=>{const w=Ke,u=Ee,d=H,L=Re,S=nt,C=be;return U(),E(C,{class:"yj-login-card",title:"欢迎使用DidaOJ~"},{default:a(()=>[t(L,{ref:"form",data:o.value,colon:!0,onReset:g,onSubmit:h,class:"yj-login-form","label-width":0},{default:a(()=>[t(u,{name:"username"},{default:a(()=>[t(w,{modelValue:o.value.username,"onUpdate:modelValue":_[0]||(_[0]=k=>o.value.username=k),clearable:"",autocomplete:"username",placeholder:"请输入用户名"},{"prefix-icon":a(()=>[t(me(el))]),_:1},8,["modelValue"])]),_:1}),t(u,{name:"password"},{default:a(()=>[t(w,{modelValue:o.value.password,"onUpdate:modelValue":_[1]||(_[1]=k=>o.value.password=k),type:"password",autocomplete:"current-password",clearable:"",placeholder:"请输入密码"},{"prefix-icon":a(()=>[t(me(tl))]),_:1},8,["modelValue"])]),_:1}),t(u,null,{default:a(()=>[t(d,{theme:"primary",type:"submit",block:"",loading:r.value},{default:a(()=>_[4]||(_[4]=[V("登录")])),_:1},8,["loading"])]),_:1})]),_:1},8,["data"]),R("div",so,[t(S,{onClick:_[2]||(_[2]=()=>{me(l).$router.push({name:"login-forget"})})},{default:a(()=>_[5]||(_[5]=[V("忘记密码 ")])),_:1}),t(S,{onClick:_[3]||(_[3]=()=>{me(l).$router.push({name:"register"})})},{default:a(()=>_[6]||(_[6]=[V("注册账户 ")])),_:1})])]),_:1})}}}),io=oe(ro,[["__scopeId","data-v-0466c42d"]]),uo={class:"dida-login-footer"},co=re({__name:"RegisterView",setup(e){const{globalProperties:l}=fe(),n=qe(),r=c(!1),o=c(!1),g=c(!1),h=c("发送验证码");let b=null,_=-1;const w=c(!1),u=c(null),d=c({username:"",password:"",confirmPassword:"",nickname:"",email:"",emailKey:""}),S=c({username:[{required:!0,message:"请填写用户名"},{min:4,message:"用户名至少4个字符"},{max:20,message:"用户名最多20个字符"},{pattern:/^[a-zA-Z0-9_]+$/,message:"用户名只能包含字母、数字和下划线"}],password:[{required:!0,message:"请填写密码"},{min:6,message:"密码至少6个字符"},{max:20,message:"密码最多20个字符"}],confirmPassword:[{required:!0,message:"请确认密码"},{validator:v=>new Promise(i=>{const f=setTimeout(()=>{i(d.value.password===v),clearTimeout(f)})}),message:"两次密码不一致"}],nickname:[{required:!0,message:"请填写昵称"},{min:1,message:"昵称至少1个字符"},{max:30,message:"昵称最多30个字符"}],email:[{required:!0,message:"请填写邮箱"},{pattern:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,message:"邮箱格式不正确"}],emailKey:[{required:!0,message:"请填写验证码"},{min:6,message:"请输入完整字符"},{max:6,message:"请输入完整字符"}]}),C=c(()=>t(H,{onClick:k,disabled:g.value,loading:o.value,style:"width:120px"},{default:()=>[h.value]})),k=async()=>{var I;if(!d.value.email){_e(l,"请输入邮箱");return}if(!d.value.email.match(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/)){_e(l,"邮箱格式不正确");return}if(g.value||o.value)return;w.value=!0,await ft();const v=document.getElementById("cf-confirm-div");v&&v.remove();const i=document.createElement("div");i.id="cf-confirm-div",i.setAttribute("data-theme","light"),(I=u.value)==null||I.appendChild(i);const f=window;f.turnstile.ready(function(){f.turnstile.render("#cf-confirm-div",{sitekey:"0x4AAAAAABeM4SYPu2Rn7PmI",callback:async function($){w.value=!1,await s($)},"before-interactive-callback":function(){console.log("before-interactive-callback")}})})},s=async v=>{if(!g.value){o.value=!0;try{const i=await ao(v,d.value.email);if(i.code!==0){N(l,i.code);return}ke(l,"发送验证码成功"),o.value=!1,g.value=!0,b=new Date,h.value="60秒后重发",_=setInterval(()=>{const I=Math.floor((new Date().getTime()-(b==null?void 0:b.getTime()))/1e3);I>60?(h.value="发送验证码",g.value=!1,clearInterval(_)):h.value=`${60-I}秒后重发`},1e3)}catch{_e(l,"发送验证码失败")}finally{o.value=!1}}},m=()=>{ke(l,"重置成功")},p=({validateResult:v,firstError:i,e:f})=>{if(!r.value){if(f.preventDefault(),v!==!0){_e(l,i);return}if(d.value.password!==d.value.confirmPassword){_e(l,"两次密码不一致");return}r.value=!0,lo(d.value.username,d.value.password,d.value.email,d.value.emailKey,d.value.nickname).then(I=>{I.code===0?(ke(l,"注册成功，可使用账号信息登录"),l.$router.push({name:"login"})):N(l,I.code)}).catch(I=>{console.error("Login error",I),_e(l,"登录失败")}).finally(()=>{r.value=!1})}};return ce(()=>{if(n.isLogin()){l.$router.push({path:"/user"});return}}),je(()=>{clearInterval(_)}),(v,i)=>{const f=Ke,I=Ee,$=Ca,P=H,y=Re,j=nt,T=be,D=ot;return U(),ee(ue,null,[t(T,{class:"yj-login-card",title:"欢迎使用DidaOJ~"},{default:a(()=>[t(y,{ref:"form",rules:S.value,data:d.value,colon:!0,onReset:m,onSubmit:p,class:"yj-login-form"},{default:a(()=>[t(I,{name:"username",label:"用户名"},{default:a(()=>[t(f,{modelValue:d.value.username,"onUpdate:modelValue":i[0]||(i[0]=x=>d.value.username=x),clearable:"",placeholder:"用于登录与查找"},null,8,["modelValue"])]),_:1}),t(I,{name:"password",label:"密码"},{default:a(()=>[t(f,{modelValue:d.value.password,"onUpdate:modelValue":i[1]||(i[1]=x=>d.value.password=x),type:"password",clearable:"",placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),t(I,{name:"confirmPassword",label:"确认密码"},{default:a(()=>[t(f,{modelValue:d.value.confirmPassword,"onUpdate:modelValue":i[2]||(i[2]=x=>d.value.confirmPassword=x),type:"password",clearable:"",placeholder:"请确认密码"},null,8,["modelValue"])]),_:1}),t(I,{name:"nickname",label:"昵称"},{default:a(()=>[t(f,{modelValue:d.value.nickname,"onUpdate:modelValue":i[3]||(i[3]=x=>d.value.nickname=x),clearable:"",placeholder:"用于优先在网站各处展示"},null,8,["modelValue"])]),_:1}),t(I,{name:"email",label:"邮箱"},{default:a(()=>[t(f,{modelValue:d.value.email,"onUpdate:modelValue":i[4]||(i[4]=x=>d.value.email=x),clearable:"",placeholder:"请填写常用邮箱"},null,8,["modelValue"])]),_:1}),t(I,{name:"emailKey",label:"验证码"},{default:a(()=>[t($,{append:C.value},{default:a(()=>[t(f,{modelValue:d.value.emailKey,"onUpdate:modelValue":i[5]||(i[5]=x=>d.value.emailKey=x),clearable:"",placeholder:"请输入验证码",style:{width:"140px"}},null,8,["modelValue"])]),_:1},8,["append"])]),_:1}),t(I,null,{default:a(()=>[t(P,{theme:"primary",type:"submit",block:"",loading:r.value},{default:a(()=>i[8]||(i[8]=[V("注册")])),_:1},8,["loading"])]),_:1})]),_:1},8,["rules","data"]),R("div",uo,[t(j,{onClick:i[6]||(i[6]=()=>{me(l).$router.push({name:"login"})})},{default:a(()=>i[9]||(i[9]=[V("返回登陆 ")])),_:1})])]),_:1}),t(D,{visible:w.value,"onUpdate:visible":i[7]||(i[7]=x=>w.value=x),header:"正在加载人机验证","close-btn":!1,footer:!1},{default:a(()=>[R("div",{ref_key:"dialogContainer",ref:u,class:"cf-confirm-container"},null,512)]),_:1},8,["visible"])],64)}}}),mo=oe(co,[["__scopeId","data-v-d25e7538"]]),po={key:0},fo={key:0,style:{margin:"10px"}},vo={key:1,style:{margin:"10px"}},_o={style:{margin:"12px"}},go=re({__name:"UserView",setup(e){let l=Ce();const{globalProperties:n}=fe(),r=Ze(),o=qe();let g="";const h=c(!1),b=c(null),_=c([]);let w=null;const u=c({}),d=c({}),L=s=>{if(o.getUsername===g)return"success";let m="default";if(!w)return m;const p=w[s];if(p)switch(p){case Ae.Accept:m="success";break;case Ae.Attempt:m="warning";break}return m},S=(s,m)=>{const p=`https://vjudge.net/problem/${s}-${m}`;window.open(p,"_blank")},C=async()=>{if(w={},!o.isLogin()||o.getUsername===g||_.value.length===0)return;const s=await Ka(_.value);s.code===0?w=s.data:N(n,s.code,s.data)},k=async s=>{h.value=!0;try{let m=await Zn(s);if(m.code!==0){h.value=!1,N(n,m.code),await X.push({name:"home"});return}b.value=Wn(m.data.user);const p=m.data.problems_ac;if(p.sort((v,i)=>v.length===i.length?v.localeCompare(i):v.length-i.length),_.value=p,r.setTitle(b.value.nickname+" - "+r.getTitle),b.value.vjudgeId){const v=await Qn(b.value.vjudgeId);u.value=v.acRecords;for(const i in u.value)u.value[i].sort((f,I)=>f.length===I.length?f.localeCompare(I):f.length-I.length);d.value=v.failRecords;for(const i in d.value)d.value[i].sort((f,I)=>f.length===I.length?f.localeCompare(I):f.length-I.length)}await C()}catch{_e(n,"获取用户信息失败"),await X.push({name:"home"})}finally{h.value=!1}};return al(async(s,m,p)=>{if(Array.isArray(s.params.username)?g=s.params.username[0]:g=s.params.username,!g){await X.push({name:"home"});return}await k(g),p()}),ce(async()=>{if(Array.isArray(l.params.username)?g=l.params.username[0]:g=l.params.username,!g){await X.push({name:"home"});return}await k(g)}),(s,m)=>{const p=H,v=be,i=nt,f=Ye,I=We,$=De,P=Pl,y=Te,j=$e;return U(),E(j,{loading:h.value},{default:a(()=>[t(y,{class:"dida-main-content"},{default:a(()=>[t($,{span:8},{default:a(()=>{var T;return[t(v,{style:{margin:"10px"},title:"AC题目"},{default:a(()=>[_.value.length===0?(U(),ee("p",po,m[0]||(m[0]=[R("span",null,"暂无AC题目",-1)]))):(U(!0),ee(ue,{key:1},xe(_.value,D=>(U(),E(p,{class:"dida-tag-button",key:D,size:"small",variant:"dashed",theme:L(D),onClick:()=>me(X).push({name:"problem-detail",params:{problemId:D}})},{default:a(()=>[V(q(D),1)]),_:2},1032,["theme","onClick"]))),128))]),_:1}),(T=b.value)!=null&&T.vjudgeId?(U(),E(v,{key:0,style:{margin:"10px"},title:"vjudge.net"},{actions:a(()=>{var D;return[t(i,{href:"https://vjudge.net/user/"+((D=b.value)==null?void 0:D.vjudgeId),target:"_blank"},{default:a(()=>{var x;return[V("@"+q((x=b.value)==null?void 0:x.vjudgeId),1)]}),_:1},8,["href"])]}),default:a(()=>[u.value&&Object.keys(u.value).length>0?(U(),ee("div",fo,[m[1]||(m[1]=R("div",{style:{margin:"5px"}},[R("span",null,"AC")],-1)),t(I,{layout:"vertical",bordered:!0},{default:a(()=>[(U(!0),ee(ue,null,xe(u.value,(D,x)=>(U(),E(f,{key:x,label:x},{default:a(()=>[(U(!0),ee(ue,null,xe(D,z=>(U(),E(p,{class:"dida-tag-button",key:z,variant:"dashed",size:"small",onClick:()=>S(x,z)},{default:a(()=>[V(q(z),1)]),_:2},1032,["onClick"]))),128))]),_:2},1032,["label"]))),128))]),_:1})])):le("",!0),d.value&&Object.keys(d.value).length>0?(U(),ee("div",vo,[m[2]||(m[2]=R("div",{style:{margin:"5px"}},[R("span",null,"Fail")],-1)),t(I,{layout:"vertical",bordered:!0},{default:a(()=>[(U(!0),ee(ue,null,xe(d.value,(D,x)=>(U(),E(f,{key:x,label:x},{default:a(()=>[(U(!0),ee(ue,null,xe(D,z=>(U(),E(p,{class:"dida-tag-button",key:z,variant:"dashed",size:"small",onClick:()=>S(x,z)},{default:a(()=>[V(q(z),1)]),_:2},1032,["onClick"]))),128))]),_:2},1032,["label"]))),128))]),_:1})])):le("",!0)]),_:1})):le("",!0)]}),_:1}),t($,{span:4},{default:a(()=>[R("div",_o,[t(I,{layout:"vertical",bordered:!0},{default:a(()=>[t(f,{label:"头像"},{default:a(()=>{var T;return[t(P,{shape:"round",size:"100px",image:(T=b.value)==null?void 0:T.avatar,"hide-on-load-failed":!1},null,8,["image"])]}),_:1}),t(f,{label:"昵称"},{default:a(()=>{var T;return[V(q((T=b.value)==null?void 0:T.nickname),1)]}),_:1}),t(f,{label:"Slogan"},{default:a(()=>{var T;return[V(q((T=b.value)==null?void 0:T.slogan),1)]}),_:1}),t(f,{label:"邮箱"},{default:a(()=>{var T;return[V(q((T=b.value)==null?void 0:T.email),1)]}),_:1}),t(f,{label:"组织"},{default:a(()=>{var T;return[V(q((T=b.value)==null?void 0:T.organization),1)]}),_:1}),t(f,{label:"通过数量"},{default:a(()=>{var T;return[V(q((T=b.value)==null?void 0:T.accept),1)]}),_:1}),t(f,{label:"提交数量"},{default:a(()=>{var T;return[V(q((T=b.value)==null?void 0:T.attempt),1)]}),_:1})]),_:1})])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),bo=oe(go,[["__scopeId","data-v-ad24a344"]]),Yt=[{name:"home",path:"/",title:"首页",showSidebar:!1,disableGenerateTab:!0,component:Fn},{name:"problem",path:"/problem",title:"题目",icon:"calculation",showSidebar:!0,redirect:"problem-list"},{name:"collection-detail-tab",title:"题集",path:"/collection",showSidebar:!0,disableGenerateTab:!0,redirect:"problem-collection-list"},{name:"judge",path:"/judge",title:"评测",icon:"code",showSidebar:!0,redirect:"judge-list"},{name:"contest",path:"/contest",title:"比赛",icon:"application",showSidebar:!0,redirect:"contest-list"},{name:"contest-detail-tab",title:"比赛",path:"/contest",showSidebar:!0,disableGenerateTab:!0,redirect:"contest-list"},{name:"discuss",title:"讨论",path:"/discuss",icon:"sonic",showSidebar:!0,redirect:"discuss-list"},{name:"discuss-detail-tab",title:"讨论",path:"/discuss",showSidebar:!0,disableGenerateTab:!0,redirect:"discuss-list"},{name:"rank",path:"/rank",title:"排名",icon:"chart-column",showSidebar:!0,redirect:"rank-ac-all"},{name:"study",path:"/study",title:"研习",icon:"book-open",showSidebar:!1,component:Hn},{name:"system",path:"/system",title:"系统",icon:"dashboard",showSidebar:!0,redirect:"system-status"},{name:"manage",path:"/manage",title:"管理",icon:"command",showSidebar:!0,redirect:"manage-web",auths:[Ue.ManageWeb]},{name:"login",path:"/login",title:"登陆",showSidebar:!1,disableGenerateTab:!0,component:io},{name:"register",path:"/register",title:"注册",showSidebar:!1,disableGenerateTab:!0,component:mo},{name:"user",path:"/user/:username+",title:"用户",showSidebar:!1,disableGenerateTab:!0,component:bo},{name:"404",path:"/404",title:"404",showSidebar:!1,disableGenerateTab:!0,component:qa}],ho=e=>Yt.find(l=>l.name==e),yo=e=>{const l=[];return Yt.forEach(n=>{!n.disableGenerateTab&&e.hasAllAuths(n.auths)&&l.push(n)}),l},wo=e=>{Yt.forEach(l=>{const n={name:l.name,path:l.path,meta:{title:l.title,tab:l.name,showSidebar:l.showSidebar,needLogin:l.needLogin,redirect:l.redirect,tabAuths:l.auths},component:l.component};e.push(n)})};function Fa(e){return e.children!==void 0}function ko(e){return e.children!==void 0}const Xt=async(e,l)=>{l&&await e.push({name:"user",params:{username:l}})},sa=e=>{const l=X.resolve({name:"problem-detail",params:{problemId:e}});window.open(l.href,"_blank")},Ot=async e=>{await X.push({name:"problem-detail",params:{problemKey:e}})},vt=async(e,l)=>{await X.push({name:"contest-problem-detail",params:{contestId:e,problemIndex:l}})},So={style:{margin:"10px"}},Co={key:0,class:"dida-operation-container"};function Po(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!at(e)}const Io=re({__name:"ProblemList",setup(e){const l=Ce(),n=Xe(),{globalProperties:r}=fe(),o=qe();let g=!1,h=null;const b=c(!1),_={};let w={};const u=c(!1),d=Je(()=>o.hasAuth(Ue.ManageProblem)),L=c([{title:"标识",colKey:"key",cell:(z,A)=>{let K=I(A.row.id);return t(H,{variant:"dashed",theme:K,onClick:()=>Ot(A.row.key)},{default:()=>[A.row.key]})}},{title:"标题",colKey:"title",cell:(z,A)=>t(H,{variant:"text",onClick:()=>Ot(A.row.key)},{default:()=>[A.row.title]})},{title:"标签",colKey:"tags",cell:(z,A)=>{const K=A.row.tags;if(!K||K.length===0)return"";let O=[];for(let Q=0;Q<K.length;Q++){const Z=K[Q];O.push(t(H,{key:Q,theme:"default",variant:"outline",size:"small",onClick:()=>j(Z)},{default:()=>[Z.name]}))}return t(Se,null,Po(O)?O:{default:()=>[O]})}},{title:"正确",colKey:"accept"},{title:"提交",colKey:"attempt"}]),S=c(!1);let C=1,k=50;const s=c({current:C,pageSize:k,defaultCurrent:C,defaultPageSize:k,total:0,pageSizeOptions:[50,100]}),m=c(),p=c(),v=[{label:"DidaOJ",value:"didaoj"},{label:"HDU",value:"hdu"},{label:"POJ",value:"poj"},{label:"NYOJ",value:"nyoj"}],i=c({oj:"",title:"",tag:"",private:!1}),f=c({oj:"",problem:""}),I=z=>{if(!z||!w)return"default";const A=w[z];if(!A)return"default";switch(A){case Ae.Accept:return"success";case Ae.Attempt:return"warning";default:return"default"}},$=async()=>{await n.push({query:{...l.query,oj:i.value.oj,title:i.value.title,tag:i.value.tag,private:i.value.private?"1":"0",page:1,page_size:s.value.defaultPageSize}})},P=async()=>{i.value.oj="",i.value.title="",i.value.tag="",i.value.private=!1,await n.push({query:{...l.query,oj:"",title:"",tag:"",private:"0",page:1,page_size:s.value.defaultPageSize}})},y=async()=>{try{u.value=!0;const z=await Ma(f.value.oj,f.value.problem);z.code===0?(ke(r,"搜索成功"),await n.push({name:"problem-detail",params:{problemId:z.data}})):N(r,z.code)}catch(z){console.error(z),N(r,He())}finally{u.value=!1}},j=z=>{z&&n.push({query:{...l.query,title:"",tag:z.name,page:1,page_size:s.value.defaultPageSize}})},T=()=>{n.push({name:"manage-problem-create"})},D=async(z,A)=>{S.value=!0;try{const{current:K,pageSize:O}=z,Q=await Sn(i.value.oj,i.value.title,i.value.tag,i.value.private,K,O);if(m.value=[],Q.code===0){const Z=Q.data.list;if(!Z||Z.length<=0){s.value={...s.value,total:0},w={},ke(r,"未找到记录");return}Z.forEach(se=>{var de;const J=ht(se,_);(de=m.value)==null||de.push(J)}),s.value={...s.value,total:Q.data.total_count},w=Q.data.problem_attempt_status}else A&&N(r,Q.code)}catch(K){console.error(K),N(r,He())}finally{S.value=!1}},x=async z=>{await n.push({query:{...l.query,page:z.current,page_size:z.pageSize}})};return ce(async()=>{g=!0,S.value=!0,p.value=[],Ea(-1).then(z=>{if(z.code===0){p.value=z.data.list,b.value=z.data.total_count>z.data.list.length;for(let A=0;A<z.data.list.length;A++){const K=z.data.list[A];_[K.id]=K}h=ze(()=>l.query,A=>{if(!g)return;i.value.oj=A.oj||"",i.value.title=A.title||"",i.value.tag=A.tag||"",i.value.private=A.private==="1";const K=parseInt(A.page)||s.value.defaultCurrent,O=parseInt(A.page_size)||s.value.defaultPageSize;C=K,k=O,s.value={...s.value,current:C,pageSize:k},D({current:C,pageSize:k},!0)},{immediate:!0})}else b.value=!0}).catch(z=>{console.error(z),b.value=!0})}),je(()=>{g=!1,h&&h()}),(z,A)=>{const K=Fe,O=be,Q=De,Z=H,se=Se,J=gt,de=Ee,he=Ke,Pe=bt,M=Re,Y=Te;return U(),E(Y,null,{default:a(()=>[t(Q,{span:9},{default:a(()=>[t(O,{style:{margin:"10px"}},{default:a(()=>[t(K,{data:m.value,columns:L.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:s.value,"table-layout":"auto",loading:S.value,onPageChange:x},null,8,["data","columns","pagination","loading"])]),_:1})]),_:1}),t(Q,{span:3},{default:a(()=>[R("div",So,[d.value?(U(),ee("div",Co,[t(se,null,{default:a(()=>[t(Z,{onClick:T},{default:a(()=>A[7]||(A[7]=[V("新建")])),_:1})]),_:1})])):le("",!0),t(O,{class:"sh-card"},{default:a(()=>[t(M,{model:i.value,onSubmit:$,onReset:P},{default:a(()=>[t(de,{label:"OJ"},{default:a(()=>[t(J,{modelValue:i.value.oj,"onUpdate:modelValue":A[0]||(A[0]=F=>i.value.oj=F),options:v,placeholder:"请选择OJ",clearable:""},null,8,["modelValue"])]),_:1}),t(de,{label:"标题"},{default:a(()=>[t(he,{modelValue:i.value.title,"onUpdate:modelValue":A[1]||(A[1]=F=>i.value.title=F),placeholder:"请输入关键词"},null,8,["modelValue"])]),_:1}),t(de,{label:"标签"},{default:a(()=>[t(he,{modelValue:i.value.tag,"onUpdate:modelValue":A[2]||(A[2]=F=>i.value.tag=F),placeholder:"暂不支持模糊查询"},null,8,["modelValue"])]),_:1}),d.value?(U(),E(de,{key:0,label:"私有"},{default:a(()=>[t(Pe,{modelValue:i.value.private,"onUpdate:modelValue":A[3]||(A[3]=F=>i.value.private=F)},null,8,["modelValue"])]),_:1})):le("",!0),t(de,null,{default:a(()=>[t(se,null,{default:a(()=>[t(Z,{theme:"primary",type:"submit"},{default:a(()=>A[8]||(A[8]=[V("搜索")])),_:1}),t(Z,{theme:"danger",type:"reset"},{default:a(()=>A[9]||(A[9]=[V("重置")])),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(O,{class:"sh-card"},{default:a(()=>[t(M,{model:f.value,onSubmit:y},{default:a(()=>[t(de,{label:"OJ"},{default:a(()=>[t(J,{modelValue:f.value.oj,"onUpdate:modelValue":A[4]||(A[4]=F=>f.value.oj=F),options:v,placeholder:"请选择OJ",clearable:""},null,8,["modelValue"])]),_:1}),t(de,{label:"题目"},{default:a(()=>[t(he,{modelValue:f.value.problem,"onUpdate:modelValue":A[5]||(A[5]=F=>f.value.problem=F),placeholder:"请输入原始题号"},null,8,["modelValue"])]),_:1}),t(de,null,{default:a(()=>[t(Z,{theme:"primary",type:"submit",loading:u.value},{default:a(()=>A[10]||(A[10]=[V("前往")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1}),t(O,{class:"sh-card sh-background-black"},{default:a(()=>[(U(!0),ee(ue,null,xe(p.value,F=>(U(),E(Z,{class:"sh-tag-button",theme:"default",variant:"outline",ghost:!0,onClick:()=>j(F)},{default:a(()=>[V(q(F.name),1)]),_:2},1032,["onClick"]))),256)),b.value?(U(),E(Z,{key:0,class:"sh-tag-button",theme:"default",variant:"outline",ghost:!0,onClick:A[6]||(A[6]=()=>z.$router.push("/problem/tags"))},{default:a(()=>A[11]||(A[11]=[V(" ... ")])),_:1})):le("",!0)]),_:1})])]),_:1})]),_:1})}}}),To=oe(Io,[["__scopeId","data-v-421a6904"]]);function tt(e){let l="";for(;e>0;)e--,l=String.fromCharCode(65+e%26)+l,e=Math.floor(e/26);return l}function Zt(e){const l={};if(l.id=e.id,l.title=e.title,l.startTime=new Date(e.start_time).toLocaleString(),l.endTime=new Date(e.end_time).toLocaleString(),l.private=e.private,l.inserter=e.inserter,l.inserterUsername=e.inserter_username,l.inserterNickname=e.inserter_nickname,l.insertTime=new Date(e.insert_time).toLocaleString(),l.modifier=e.modifier,l.modifierUsername=e.modifier_username,l.modifierNickname=e.modifier_nickname,l.modifyTime=new Date(e.modify_time).toLocaleString(),l.description=e.description,l.notification=e.notification,e.problems){l.problems=[],e.problems.sort((n,r)=>n.index-r.index);for(let n=0;n<e.problems.length;n++){const r=e.problems[n];let o={accept:0,attempt:0,inserter:"",id:"",private:!1,tags:[],title:""};o.index=r.index,o.id=tt(r.index),o.title=r.title,r.accept?o.accept=r.accept:o.accept=0,r.attempt?o.attempt=r.attempt:o.attempt=0,l.problems.push(o)}}return l}function xo(e){return B({url:"/contest?id="+e,method:"get"})}function Vo(e){return B({url:"/contest/edit?id="+e,method:"get"})}function Do(e){return B({url:"/contest/problem/list?id="+e,method:"get"})}function $o(e){return e||(e=0),B({url:"/contest/image/token?id="+e,method:"get"})}function jo(e,l){return B({url:"/contest/problem?id="+e+"&problem_index="+l,method:"get"})}function Lo(e,l,n,r){const o={};return e&&(o.title=e),l&&(o.username=l),n&&(o.page=String(n)),r&&(o.page_size=String(r)),B({url:`/contest/list?${new URLSearchParams(o).toString()}`,method:"get"})}function Uo(e){return B({url:"/contest/rank?id="+e,method:"get"})}function Ao(e){return B({url:"/contest/create",method:"post",data:e})}function zo(e){return B({url:"/contest/edit",method:"post",data:e})}function Ro(e,l){return B({url:"/contest/password",method:"post",data:{id:e,password:l}})}function Eo(e){return B({url:"/contest/dolos",method:"post",data:{id:e}})}const Ko={class:"sh-button"},Mo={style:{"margin-top":"16px"}},qo={__name:"SecretPanel",setup(e){const l=c(!1);return(n,r)=>{const o=H;return U(),ee("div",sl(rl(n.$attrs)),[R("div",Ko,[t(o,{onClick:r[0]||(r[0]=g=>l.value=!l.value)},{default:a(()=>[V(q(l.value?"收起":"展开"),1)]),_:1})]),ll(R("div",Mo,[ol(n.$slots,"default",{},void 0)],512),[[nl,l.value]])],16)}}},ra=oe(qo,[["__scopeId","data-v-83e9f414"]]),Fo={key:1,style:{"text-align":"center"}},No={key:1,style:{"text-align":"center"}},Oo={key:0,class:"dida-problems-container"},Go={style:{margin:"12px"}},Ho={key:1},Bo={class:"dida-operation-container"},Jo={key:0,class:"dida-operation-container"},Wo={class:"dida-code-submit-div"},Yo={class:"dida-code-editor-div"},Xo=re({__name:"ProblemDetail",setup(e){let l=Ce();const{globalProperties:n}=fe();let r=null;const o=Ze(),g=qe();let h=c(""),b="",_=0,w="",u=0,d=c(0);const L=c(!1),S=c(!1),C=c(!1),k=c(null);let s=null;const m=c(null),p=c(!1),v=c(!1),i={},f=c(""),I=c([]);I.value=Jt();const $=c([]),P=c(null),y=c(-1),j=c(-1),T=c(""),D=c("");let x=0;const z=Je(()=>g.hasAuth(Ue.ManageProblem)),A=Je(()=>g.hasAuth(Ue.ManageProblemDaily)),K=()=>{P.value&&clearInterval(P.value),P.value=setInterval(()=>{const te=y.value<=0,W=new Date(new Date().getTime()+x),ae=W.getHours()*60*60+W.getMinutes()*60+W.getSeconds(),ve=18*60*60;ae<ve?y.value=ve-ae:y.value=-1,j.value=24*60*60-ae,(!te&&y.value<=0||j.value<=0)&&pe()},1e3)},O=()=>{P.value&&(clearInterval(P.value),P.value=null)},Q=te=>{te&&X.push({name:"problem-list",query:{...l.query,title:"",tag:te.name}})},Z=async()=>{if(!w){_e(n,"每日问题标识无效");return}await X.push({name:"manage-problem-daily",params:{dailyId:w}})},se=async()=>{let te=b;if(!te)try{const W=await jo(u,d.value);W.code===0?te=W.data:N(n,W.code)}catch{_e(n,"获取题目ID失败，请稍后再试");return}await X.push({name:"manage-problem",params:{problemId:te}})},J=()=>{b?X.push({name:"judge-list",query:{problem_id:b}}):X.push({name:"contest-judge",params:{contestId:u},query:{problem_id:tt(d.value)}})},de=()=>{b?X.push({name:"discuss-list-problem",query:{problem_id:b}}):X.push({name:"contest-discuss",params:{contestId:u},query:{problem_id:tt(d.value)}})},he=()=>{X.push({name:"problem-recommend",params:{problemId:b}})},Pe=async()=>{var ae,ve;const te=(ae=k.value)==null?void 0:ae.originOj,W=(ve=k.value)==null?void 0:ve.originId;if(!(!te||!W))try{p.value=!0;const Ie=await Ma(te,W);Ie.code===0?(await F(),ke(n,"更新成功")):N(n,Ie.code)}catch{_e(n,"更新失败，请稍后再试")}finally{p.value=!1}},M=async()=>{const te=parseInt(f.value);if(!Ct(te)){_e(n,"请选择所编写的语言");return}const W=s==null?void 0:s.getValue();if(!W){_e(n,"请输入所需提交的代码");return}if(!b&&(!u||!d.value)){_e(n,"问题标识无效");return}v.value=!0;try{const ae=await pn(_,u,d.value,te,W);if(ae.code!==0){N(n,ae.code);return}ke(n,"提交成功，正在跳转到详情页面");const ve=ae.data.id;u?await X.push({name:"contest-judge-detail",params:{contestId:u,judgeId:ve}}):await X.push({name:"judge-detail",params:{judgeId:ve}})}finally{v.value=!1}},Y=te=>{if(!s)return;const W=s.getModel();W&&na.setModelLanguage(W,Wt(te))},F=async()=>{$.value=[];let te=await Ra(b,u,d.value);if(te.code!==0){C.value=!1,N(n,te.code),await X.push({name:"problem"});return}te.data.tags&&te.data.tags.forEach(W=>{i[W.id]=W}),k.value=ht(te.data.problem,i),_=k.value.id,o.setTitle(k.value.title+" - "+o.getTitle),u&&(te=await Do(u),te.code===0?(te.data.problems.sort((W,ae)=>W-ae),$.value=te.data.problems):N(n,te.code)),h.value=k.value.description,await ft(()=>{!s&&m.value&&(s=na.create(m.value,{value:"",language:"cpp",minimap:{enabled:!0},colorDecorators:!0,readOnly:!1,theme:"vs-dark"})),C.value=!1})},pe=async()=>{O(),S.value=!1;const te=await Pn(w);if(te.code!==0)return;S.value=!0;const W=te.data.problem_daily;b=W.problem_id,T.value=W.solution,D.value=W.code;const ae=new Date(te.data.time);x=ae.getTime()-new Date().getTime();const ve=new Date(ae.getTime()),Ie=ve.getFullYear(),G=String(ve.getMonth()+1).padStart(2,"0"),ie=String(ve.getDate()).padStart(2,"0"),we=`${Ie}-${G}-${ie}`;if(w===we){const ge=ae.getHours()*60*60+ae.getMinutes()*60+ae.getSeconds(),Ve=18*60*60;ge<Ve?y.value=Ve-ge:y.value=-1,j.value=24*60*60-ge}(y.value>=0||j.value>=0)&&K()};return ce(async()=>{r=ze(()=>l.params,async()=>{if(S.value=!1,Array.isArray(l.params.problemKey)?b=l.params.problemKey[0]:b=l.params.problemKey,Array.isArray(l.params.dailyId)?w=l.params.dailyId[0]:w=l.params.dailyId,Array.isArray(l.params.contestId)?u=Number(l.params.contestId[0]):u=Number(l.params.contestId),!b&&w&&(C.value=!0,await pe(),C.value=!1),!b)if(u){if(Array.isArray(l.params.problemIndex)?d.value=parseInt(l.params.problemIndex[0]):d.value=parseInt(l.params.problemIndex),!d.value){_e(n,"题目不存在"),await X.push({name:"contest-detail",params:{contestId:u}});return}}else _e(n,"题目不存在"),w?await X.push({name:"problem-daily-list"}):await X.push({name:"problem"});L.value=!!u,C.value=!0,await F()},{immediate:!0}),m.value&&new ResizeObserver(()=>{s&&s.layout()}).observe(m.value)}),je(()=>{r&&(r(),r=null),O()}),(te,W)=>{const ae=Me("md-preview"),ve=be,Ie=Gt,G=Se,ie=De,we=H,ge=Ye,Ve=nt,ye=We,Ne=Ht,lt=gt,st=Te,rt=$e;return U(),E(rt,{loading:C.value},{default:a(()=>[t(st,{class:"dida-main-content"},{default:a(()=>[t(ie,{span:8},{default:a(()=>[t(ve,{style:{margin:"10px"}},{default:a(()=>[t(ae,{"model-value":me(h),previewTheme:"cyanosis"},null,8,["model-value"])]),_:1}),S.value?(U(),E(ve,{key:0,style:{margin:"10px"},title:"题解"},{default:a(()=>[y.value<0?(U(),E(ra,{key:0},{default:a(()=>[t(ae,{"model-value":T.value,previewTheme:"cyanosis"},null,8,["model-value"])]),_:1})):(U(),ee("div",Fo,[R("div",null,[t(G,null,{default:a(()=>[W[2]||(W[2]=R("p",null,"距离解锁百分比",-1)),t(Ie,{theme:"circle",color:{from:"#0052D9",to:"#00A870"},percentage:100-y.value/(18*60*60)*100,status:"active"},{label:a(()=>[V(q((100-y.value/(18*60*60)*100).toFixed(3))+"% ",1)]),default:a(()=>[W[1]||(W[1]=V(" > "))]),_:1},8,["percentage"])]),_:1})])]))]),_:1})):le("",!0),S.value?(U(),E(ve,{key:1,style:{margin:"10px"},title:"示例代码"},{default:a(()=>[j.value<0?(U(),E(ra,{key:0},{default:a(()=>[t(ae,{"model-value":D.value,previewTheme:"cyanosis"},null,8,["model-value"])]),_:1})):(U(),ee("div",No,[R("div",null,[t(G,{style:{margin:"0 auto"}},{default:a(()=>[W[4]||(W[4]=R("p",null,"距离解锁百分比",-1)),t(Ie,{theme:"circle",color:{from:"#0052D9",to:"#00A870"},percentage:100-j.value/(24*60*60)*100,status:"active"},{label:a(()=>[V(q((100-j.value/(24*60*60)*100).toFixed(3))+"% ",1)]),default:a(()=>[W[3]||(W[3]=V(" > "))]),_:1},8,["percentage"])]),_:1})])]))]),_:1})):le("",!0)]),_:1}),t(ie,{span:4},{default:a(()=>{var ta;return[me(u)?(U(),ee("div",Oo,[t(G,{style:{"flex-wrap":"wrap"}},{default:a(()=>[(U(!0),ee(ue,null,xe($.value,(Oe,wt)=>(U(),E(we,{key:wt,theme:Oe==me(d)?"primary":"default",onClick:async()=>await me(vt)(me(u),Oe)},{default:a(()=>[V(q(me(tt)(Oe)),1)]),_:2},1032,["theme","onClick"]))),128))]),_:1})])):le("",!0),R("div",Go,[t(ye,{layout:"vertical",bordered:!0},{default:a(()=>{var Oe,wt;return[(Oe=k.value)!=null&&Oe.key?(U(),E(ge,{key:0,label:"标识"},{default:a(()=>{var ne;return[V(q((ne=k.value)==null?void 0:ne.key),1)]}),_:1})):le("",!0),t(ge,{label:"标题"},{default:a(()=>{var ne;return[V(q((ne=k.value)==null?void 0:ne.title),1)]}),_:1}),t(ge,{label:"时间限制"},{default:a(()=>{var ne;return[V(q((ne=k.value)==null?void 0:ne.timeLimit),1)]}),_:1}),t(ge,{label:"内存限制"},{default:a(()=>{var ne;return[V(q((ne=k.value)==null?void 0:ne.memoryLimit),1)]}),_:1}),t(ge,{label:"判题方式"},{default:a(()=>{var ne;return[V(q((ne=k.value)==null?void 0:ne.judgeType),1)]}),_:1}),L.value?le("",!0):(U(),E(ge,{key:1,label:"正确提交"},{default:a(()=>{var ne;return[V(q((ne=k.value)==null?void 0:ne.accept),1)]}),_:1})),L.value?le("",!0):(U(),E(ge,{key:2,label:"提交总数"},{default:a(()=>{var ne;return[V(q((ne=k.value)==null?void 0:ne.attempt),1)]}),_:1})),t(ge,{label:"创建时间"},{default:a(()=>{var ne;return[V(q((ne=k.value)==null?void 0:ne.insertTime),1)]}),_:1}),t(ge,{label:"编辑时间"},{default:a(()=>{var ne;return[V(q((ne=k.value)==null?void 0:ne.modifyTime),1)]}),_:1}),t(ge,{label:"上传用户"},{default:a(()=>{var ne;return[V(q((ne=k.value)==null?void 0:ne.inserterNickname),1)]}),_:1}),L.value?le("",!0):(U(),E(ge,{key:3,label:"题目来源"},{default:a(()=>{var ne,et,pt;return[(ne=k.value)!=null&&ne.sourceUrl?(U(),E(Ve,{key:0,href:(et=k.value)==null?void 0:et.sourceUrl,target:"_blank"},{default:a(()=>{var aa;return[V(q((aa=k.value)==null?void 0:aa.source),1)]}),_:1},8,["href"])):(U(),ee("span",Ho,q((pt=k.value)==null?void 0:pt.source),1))]}),_:1})),z.value?(U(),E(ge,{key:4,label:"是否私有"},{default:a(()=>{var ne;return[V(q((ne=k.value)!=null&&ne.private?"私有":"公开"),1)]}),_:1})):le("",!0),(wt=k.value)!=null&&wt.originUrl?(U(),E(ge,{key:5,label:"原题链接"},{default:a(()=>{var ne;return[t(Ve,{href:(ne=k.value)==null?void 0:ne.originUrl,target:"_blank"},{default:a(()=>{var et,pt;return[V(q((et=k.value)==null?void 0:et.originOj)+" - "+q((pt=k.value)==null?void 0:pt.originId),1)]}),_:1},8,["href"])]}),_:1})):le("",!0),me(b)?(U(),E(ge,{key:6,label:"标签"},{default:a(()=>{var ne;return[(U(!0),ee(ue,null,xe((ne=k.value)==null?void 0:ne.tags,et=>(U(),E(we,{class:"dida-tag-button",key:et.id,variant:"dashed",size:"small",onClick:()=>Q(et)},{default:a(()=>[V(q(et.name),1)]),_:2},1032,["onClick"]))),128))]}),_:1})):le("",!0)]}),_:1}),R("div",Bo,[t(G,null,{default:a(()=>[t(we,{onClick:J},{default:a(()=>W[5]||(W[5]=[V("提交记录")])),_:1}),t(we,{onClick:de},{default:a(()=>W[6]||(W[6]=[V("题目讨论")])),_:1}),me(b)?(U(),E(we,{key:0,onClick:he},{default:a(()=>W[7]||(W[7]=[V("题目推荐")])),_:1})):le("",!0)]),_:1})]),S.value&&A.value||z.value||(ta=k.value)!=null&&ta.originId?(U(),ee("div",Jo,[t(G,null,{default:a(()=>{var Oe;return[S.value&&A.value?(U(),E(we,{key:0,onClick:Z},{default:a(()=>W[8]||(W[8]=[V("每日一题")])),_:1})):le("",!0),z.value?(U(),E(we,{key:1,onClick:se},{default:a(()=>W[9]||(W[9]=[V("编辑")])),_:1})):le("",!0),(Oe=k.value)!=null&&Oe.originId?(U(),E(we,{key:2,onClick:Pe,loading:p.value},{default:a(()=>W[10]||(W[10]=[V("更新描述 ")])),_:1},8,["loading"])):le("",!0)]}),_:1})])):le("",!0),R("div",Wo,[t(G,null,{default:a(()=>[t(lt,{modelValue:f.value,"onUpdate:modelValue":W[0]||(W[0]=Oe=>f.value=Oe),label:"语言：",placeholder:"请选择提交语言","auto-width":"",clearable:"",onChange:Y},{default:a(()=>[(U(!0),ee(ue,null,xe(I.value,Oe=>(U(),E(Ne,{key:Oe.value,value:Oe.value,label:Oe.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"]),t(we,{onClick:M,loading:v.value},{default:a(()=>W[11]||(W[11]=[V("提交")])),_:1},8,["loading"])]),_:1}),R("div",Yo,[R("div",{ref_key:"codeEditRef",ref:m,class:"dida-code-editor"},null,512)])])])]}),_:1})]),_:1})]),_:1},8,["loading"])}}}),At=oe(Xo,[["__scopeId","data-v-6188db1a"]]),Zo={style:{margin:"10px"}},Qo={key:0,class:"dida-operation-container"};function es(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!at(e)}const ts=re({__name:"ProblemDailyList",setup(e){const l=Ce(),n=Xe(),{globalProperties:r}=fe(),o=qe();let g=!1,h=null,b={},_={};const w=Je(()=>o.hasAuth(Ue.ManageProblem)),u=c([{title:"日期",colKey:"key",cell:(y,j)=>t(H,{variant:"dashed",onClick:()=>m(j.row.key)},{default:()=>[j.row.key]})},{title:"ID",colKey:"problemId",cell:(y,j)=>{let T=p(j.row.problemId);return t(H,{variant:"dashed",theme:T,onClick:()=>m(j.row.key)},{default:()=>[j.row.problemId]})}},{title:"标题",colKey:"title",cell:(y,j)=>t(H,{variant:"text",onClick:()=>m(j.row.key)},{default:()=>[j.row.title]})},{title:"标签",colKey:"tags",cell:(y,j)=>{const T=j.row.tags;if(!T||T.length===0)return"";let D=[];for(let x=0;x<T.length;x++){const z=T[x];D.push(t(H,{key:x,theme:"default",variant:"outline",size:"small",onClick:()=>f(z)},{default:()=>[z.name]}))}return t(Se,null,es(D)?D:{default:()=>[D]})}},{title:"正确",colKey:"accept"},{title:"提交",colKey:"attempt"}]),d=c(!1);let L=1,S=50;const C=c({current:L,pageSize:S,defaultCurrent:L,defaultPageSize:S,total:0,pageSizeOptions:[50,100]}),k=c([]),s=c({date:[],problemId:""}),m=y=>{y&&n.push({name:"problem-daily-detail",params:{dailyId:y}})},p=y=>{if(!y||!_)return"default";const j=_[y];if(!j)return"default";switch(j){case Ae.Accept:return"success";case Ae.Attempt:return"warning";default:return"default"}},v=async()=>{let y="";s.value.date&&s.value.date.length>1&&(y=s.value.date[0]+"~"+s.value.date[1]),await n.push({query:{...l.query,date:y,problem_id:s.value.problemId,page:1,page_size:C.value.defaultPageSize}})},i=async()=>{s.value.date=[],s.value.problemId="",await n.push({query:{...l.query,date:"",problem_id:"",page:1,page_size:C.value.defaultPageSize}})},f=y=>{y&&n.push({name:"problem-list",query:{...l.query,title:"",tag:y.name,page:1,page_size:C.value.defaultPageSize}})},I=()=>{n.push({name:"manage-problem-daily-create"})},$=async(y,j)=>{d.value=!0;try{const{current:T,pageSize:D}=y;let x="";s.value.date[0]&&(x=s.value.date[0]);let z="";s.value.date[1]&&(z=s.value.date[1]);const A=await xn(x,z,s.value.problemId,T,D);if(k.value=[],A.code===0){const K=A.data.list;if(!K||K.length<=0){C.value={...C.value,total:0},_={},ke(r,"未找到记录");return}b={},A.data.tags&&A.data.tags.forEach(O=>{b[O.id]=O}),K.forEach(O=>{var Z;const Q=za(O,b);(Z=k.value)==null||Z.push(Q)}),C.value={...C.value,total:A.data.total_count},_=A.data.attempt_status}else j&&N(r,A.code)}catch(T){console.error(T),N(r,He())}finally{d.value=!1}},P=async y=>{await n.push({query:{...l.query,page:y.current,page_size:y.pageSize}})};return ce(async()=>{g=!0,d.value=!0,h=ze(()=>l.query,y=>{if(!g)return;if(s.value.date=[],y.date){const D=y.date.split("~");D.length===2&&(s.value.date=[D[0],D[1]])}s.value.problemId=y.problem_id||"";const j=parseInt(y.page)||C.value.defaultCurrent,T=parseInt(y.page_size)||C.value.defaultPageSize;L=j,S=T,C.value={...C.value,current:L,pageSize:S},$({current:L,pageSize:S},!0)},{immediate:!0})}),je(()=>{g=!1,h&&h()}),(y,j)=>{const T=Fe,D=be,x=De,z=H,A=Se,K=Bt,O=Ee,Q=Ke,Z=Re,se=Te;return U(),E(se,null,{default:a(()=>[t(x,{span:9},{default:a(()=>[t(D,{style:{margin:"10px"}},{default:a(()=>[t(T,{data:k.value,columns:u.value,"row-key":"key","vertical-align":"top",hover:!0,pagination:C.value,"table-layout":"auto",loading:d.value,onPageChange:P},null,8,["data","columns","pagination","loading"])]),_:1})]),_:1}),t(x,{span:3},{default:a(()=>[R("div",Zo,[w.value?(U(),ee("div",Qo,[t(A,null,{default:a(()=>[t(z,{onClick:I},{default:a(()=>j[2]||(j[2]=[V("新建")])),_:1})]),_:1})])):le("",!0),t(D,{class:"sh-card"},{default:a(()=>[t(Z,{model:s.value,onSubmit:v,onReset:i},{default:a(()=>[t(O,{label:"日期","label-align":"top"},{default:a(()=>[t(K,{modelValue:s.value.date,"onUpdate:modelValue":j[0]||(j[0]=J=>s.value.date=J),"allow-input":"",clearable:"",format:"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),t(O,{label:"问题","label-align":"top"},{default:a(()=>[t(Q,{modelValue:s.value.problemId,"onUpdate:modelValue":j[1]||(j[1]=J=>s.value.problemId=J),placeholder:"请输入问题标识",clearable:""},null,8,["modelValue"])]),_:1}),t(O,{"label-align":"top"},{default:a(()=>[t(A,null,{default:a(()=>[t(z,{theme:"primary",type:"submit"},{default:a(()=>j[3]||(j[3]=[V("搜索")])),_:1}),t(z,{theme:"danger",type:"reset"},{default:a(()=>j[4]||(j[4]=[V("重置")])),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(D,{class:"sh-card",header:"每日一题","header-bordered":!0},{default:a(()=>j[5]||(j[5]=[R("p",null,"由管理员团队精选的题目，每日0点更新。",-1),R("p",null,"当日下午6点提供题解，次日提供AC代码。",-1)])),_:1})])]),_:1})]),_:1})}}}),as=oe(ts,[["__scopeId","data-v-f1a7475d"]]),ls={style:{margin:"10px"}},ns={style:{margin:"12px"}},os={class:"dida-edit-container"},ss=re({__name:"ProblemDailyEdit",setup(e){let l=Ce();const{globalProperties:n}=fe();let r=null;const o=c(""),g=c(!1),h=c(!1),b=c(null),_=c({date:"",problemId:"",solution:"",code:""}),w=()=>{X.push({name:"problem-daily-detail",params:{dailyId:o.value}})};async function u(s,m){h.value=!0,await ct(s,m,n,()=>An(o.value)),h.value=!1}const d=async()=>{h.value=!0;try{const s=_.value.date,m=await $n(s,_.value.problemId,_.value.solution,_.value.code);if(h.value=!0,m.code!==0){N(n,m.code);return}await X.push({name:"manage-problem-daily",params:{dailyId:s}}),Ge(n,"创建成功")}finally{h.value=!1}},L=async()=>{h.value=!0;try{const s=await jn(o.value,_.value.problemId,_.value.solution,_.value.code);if(h.value=!0,s.code!==0){N(n,s.code);return}b.value&&(s.data.update_time!=null&&(b.value.modifyTime=new Date(s.data.modify_time).toLocaleString()),s.data.updater_nickname!=null&&(b.value.modifierNickname=s.data.updater_nickname)),s.data.solution!=null&&(_.value.solution=s.data.solution),s.data.code!=null&&(_.value.code=s.data.code),Ge(n,"保存成功")}finally{h.value=!1}},S=s=>{_.value.solution=s,g.value=!1},C=s=>{_.value.code=s,g.value=!1},k=async()=>{const s=await In(o.value);if(s.code!==0){N(n,s.code),console.error("problem get failed",s.code),await X.push({name:"problem-daily-list"});return}const m=s.data;b.value=za(m,{}),_.value.problemId=m.problem_id,S(m.solution),C(m.code)};return ce(async()=>{r=ze(()=>l.params,async()=>{Array.isArray(l.params.dailyId)?o.value=l.params.dailyId[0]:o.value=l.params.dailyId,o.value?(g.value=!0,_.value.date=o.value,await k()):(S("暂无题解"),C("暂无标程"))},{immediate:!0})}),je(()=>{r&&(r(),r=null)}),(s,m)=>{const p=xt,v=Il,i=Ee,f=Ke,I=Re,$=be,P=De,y=H,j=Se,T=Ye,D=We,x=Te,z=Me("md-editor-v3"),A=$e;return U(),E(A,{loading:g.value},{default:a(()=>[t(x,null,{default:a(()=>[t(P,{span:8},{default:a(()=>[R("div",ls,[t(p,{theme:"info"},{default:a(()=>m[4]||(m[4]=[V("可以提前配置将来日期的题目，对外仅展示到截止到当天的题目")])),_:1}),t($,{class:"sh-form-card"},{default:a(()=>[t(I,{model:_.value},{default:a(()=>[t(i,{label:"日期"},{default:a(()=>[t(v,{modelValue:_.value.date,"onUpdate:modelValue":m[0]||(m[0]=K=>_.value.date=K),disabled:o.value&&!0},null,8,["modelValue","disabled"])]),_:1}),t(i,{label:"问题标识"},{default:a(()=>[t(f,{modelValue:_.value.problemId,"onUpdate:modelValue":m[1]||(m[1]=K=>_.value.problemId=K),placeholder:"问题标题"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})])]),_:1}),t(P,{span:4},{default:a(()=>[R("div",ns,[R("div",os,[o.value?(U(),E(j,{key:0},{default:a(()=>[t(y,{onClick:L,theme:"danger",loading:h.value},{default:a(()=>m[5]||(m[5]=[V("保存")])),_:1},8,["loading"]),t(y,{onClick:w},{default:a(()=>m[6]||(m[6]=[V("查看")])),_:1})]),_:1})):(U(),E(j,{key:1},{default:a(()=>[t(y,{onClick:d,theme:"danger",loading:h.value},{default:a(()=>m[7]||(m[7]=[V("创建")])),_:1},8,["loading"])]),_:1}))]),o.value?(U(),E(D,{key:0,layout:"vertical",bordered:!0},{default:a(()=>[t(T,{label:"创建时间"},{default:a(()=>{var K;return[V(q((K=b.value)==null?void 0:K.insertTime),1)]}),_:1}),t(T,{label:"更新时间"},{default:a(()=>{var K;return[V(q((K=b.value)==null?void 0:K.modifyTime),1)]}),_:1}),t(T,{label:"创建用户"},{default:a(()=>{var K;return[V(q((K=b.value)==null?void 0:K.inserterNickname),1)]}),_:1}),t(T,{label:"更新用户"},{default:a(()=>{var K;return[V(q((K=b.value)==null?void 0:K.modifierNickname),1)]}),_:1})]),_:1})):le("",!0)])]),_:1})]),_:1}),R("div",null,[m[8]||(m[8]=R("p",{style:{"margin-left":"20px"}},"题解：",-1)),t(z,{id:"daily-solution-editor",modelValue:_.value.solution,"onUpdate:modelValue":m[2]||(m[2]=K=>_.value.solution=K),onSave:L,onOnUploadImg:u,previewTheme:"cyanosis"},null,8,["modelValue"]),t(A,{loading:h.value,attach:"#daily-solution-editor","z-index":1e5},null,8,["loading"])]),R("div",null,[m[9]||(m[9]=R("p",{style:{"margin-left":"20px"}},"标程：",-1)),t(z,{id:"daily-code-editor",modelValue:_.value.code,"onUpdate:modelValue":m[3]||(m[3]=K=>_.value.code=K),onSave:L,onOnUploadImg:u,previewTheme:"cyanosis"},null,8,["modelValue"]),t(A,{loading:h.value,attach:"#daily-code-editor","z-index":1e5},null,8,["loading"])])]),_:1},8,["loading"])}}}),ia=oe(ss,[["__scopeId","data-v-f6aee04b"]]),rs={style:{margin:"10px"}};function is(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!at(e)}const us=re({__name:"ProblemRecommend",setup(e){const l=Ce(),n=Xe(),{globalProperties:r}=fe();let o=null,g="",h={},b={};const _=c([{title:"ID",colKey:"id",cell:(k,s)=>{let m=L(s.row.id);return t(H,{variant:"dashed",theme:m,onClick:()=>d(s.row.id)},{default:()=>[s.row.id]})}},{title:"标题",colKey:"title",cell:(k,s)=>t(H,{variant:"text",onClick:()=>d(s.row.id)},{default:()=>[s.row.title]})},{title:"标签",colKey:"tags",cell:(k,s)=>{const m=s.row.tags;if(!m||m.length===0)return"";let p=[];for(let v=0;v<m.length;v++){const i=m[v];p.push(t(H,{key:v,theme:"default",variant:"outline",size:"small",onClick:()=>S(i)},{default:()=>[i.name]}))}return t(Se,null,is(p)?p:{default:()=>[p]})}},{title:"正确",colKey:"accept"},{title:"提交",colKey:"attempt"}]),w=c(!1),u=c(),d=k=>{k&&n.push({path:"/problem/"+k})},L=k=>{if(!k||!b)return"default";const s=b[k];if(!s)return"default";switch(s){case Ae.Accept:return"success";case Ae.Attempt:return"warning";default:return"default"}},S=k=>{k&&n.push({name:"problem-list",query:{tag:k.name}})},C=async k=>{w.value=!0;try{const s=await Cn(g);if(u.value=[],s.code===0){const m=s.data.list;if(!m||m.length<=0){ke(r,"暂无推荐题目");return}h={},s.data.tags&&s.data.tags.forEach(p=>{h[p.id]=p}),m.forEach(p=>{var i;const v=ht(p,h);(i=u.value)==null||i.push(v)})}else k&&N(r,s.code)}catch(s){console.error(s),N(r,He())}finally{w.value=!1}};return ce(async()=>{w.value=!0,o=ze(()=>l.query,k=>{Array.isArray(l.params.problemId)?g=l.params.problemId[0]:g=l.params.problemId,C(!0)},{immediate:!0})}),je(()=>{o&&o()}),(k,s)=>{const m=Fe,p=be,v=De,i=Te;return U(),E(i,null,{default:a(()=>[t(v,{span:9},{default:a(()=>[t(p,{style:{margin:"10px"}},{default:a(()=>[t(m,{data:u.value,columns:_.value,"row-key":"id","vertical-align":"top",hover:!0,"table-layout":"auto",loading:w.value},null,8,["data","columns","loading"])]),_:1})]),_:1}),t(v,{span:3},{default:a(()=>[R("div",rs,[t(p,{class:"sh-card",header:"题目推荐","header-bordered":!0},{default:a(()=>s[0]||(s[0]=[V(" 根据本站其他用户的提交记录推荐类似题目"),R("br",null,null,-1),V("依据推荐算法来计算，与本用户相似度最高的用户做的题，大概率被自己感兴趣。 ")])),_:1})])]),_:1})]),_:1})}}}),ds=oe(us,[["__scopeId","data-v-77972e8b"]]),cs={style:{margin:"10px"}},ms={key:1},ps={style:{margin:"12px"}},fs={class:"dida-edit-container"},vs={class:"dida-description-editor"},_s=re({__name:"ProblemEdit",setup(e){let l=Ce();const{globalProperties:n}=fe(),r=Ze();let o=0;const g=c(""),h=c(!1),b=c(!1),_=c(!1),w=c(null),u=c({title:"",timeLimit:0,memoryLimit:0,source:"",private:!0,tags:[],description:""}),d=c([]),L=c([]),S=Je(()=>{const $=[],P=d.value;for(let y=0,j=P.length;y<j;y++)P[y].value&&$.push(P[y].value);return $}),C=($,P)=>{const{trigger:y,index:j,item:T}=P;if(y==="clear"&&(d.value=[]),["tag-remove","backspace"].includes(y)&&d.value.splice(j,1),y==="enter"){for(let x=0;x<L.value.length;x++){const z=L.value[x];if(z.label===T){for(let A=0;A<d.value.length;A++)if(d.value[A].label===z.label)return;d.value.push(z);return}}const D={label:T,value:T};d.value.push(D),L.value=L.value.concat(D)}},k=($,{current:P,type:y})=>{if(!P){d.value=y==="check"?L.value.slice(1):[];return}if(y==="check"){const j=L.value.find(T=>T.value===P);if(!j)return;d.value.push(j)}else d.value=d.value.filter(j=>j.value!==P)},s=()=>{X.push({name:"problem-detail",params:{problemKey:g.value}})},m=()=>{X.push({name:"manage-problem-judge",params:{problemKey:g.value}})},p=async($,P)=>{_.value=!0,await ct($,P,n,()=>Un(o)),_.value=!1},v=async()=>{b.value=!0,u.value.tags=[];for(let $=0;$<d.value.length;$++){const P=d.value[$];P&&P.label&&u.value.tags.push(P.label)}try{const $=await Vn(u.value.title,u.value.timeLimit,u.value.memoryLimit,u.value.source,u.value.private,u.value.tags,u.value.description);if(b.value=!0,$.code!==0){N(n,$.code);return}$.data!=null&&await X.push({name:"problem-detail",params:{problemKey:$.data}}),Ge(n,"创建成功")}finally{b.value=!1}},i=async()=>{b.value=!0,u.value.tags=[];for(let $=0;$<d.value.length;$++){const P=d.value[$];P&&P.label&&u.value.tags.push(P.label)}try{const $=await Dn(o,u.value.title,u.value.timeLimit,u.value.memoryLimit,u.value.source,u.value.private,u.value.tags,u.value.description);if(b.value=!0,$.code!==0){N(n,$.code);return}w.value&&$.data.modify_time!=null&&(w.value.modifyTime=new Date($.data.modify_time).toLocaleString()),$.data.description!=null&&(u.value.description=$.data.description),Ge(n,"保存成功")}finally{b.value=!1}},f=$=>{u.value.description=$,h.value=!1},I=async()=>{const $=await Ra(g.value,void 0,void 0);if($.code!==0){N(n,$.code),console.error("problem get failed",$.code),await X.push({name:"problem"});return}const P=$.data.problem;if(o=P.id,w.value=ht(P,{}),u.value.title=P.title,u.value.timeLimit=P.time_limit,u.value.memoryLimit=P.memory_limit,u.value.source=P.source,u.value.private=P.private,u.value.tags=[],d.value=[],$.data.tags)for(let j=0;j<$.data.tags.length;j++){const T=$.data.tags[j];T&&T.name&&(u.value.tags.push(T.name),d.value.push({label:T.name,value:T.id}))}r.setTitle(P.title+" - "+r.getTitle);let y=P.description;f(y)};return ce(async()=>{Array.isArray(l.params.problemKey)?g.value=l.params.problemKey[0]:g.value=l.params.problemKey,g.value?(h.value=!0,Ea(-1).then(async $=>{$.code===0?($.data.list&&$.data.list.forEach(P=>{L.value.push({label:P.name,value:P.id})}),await I()):(N(n,$.code),console.error("problem tag get failed",$.code),await X.push({name:"problem"}))}).catch(async $=>{console.error($),N(n,"获取数据异常"),await X.push({name:"problem"})})):(u.value.timeLimit=1e3,u.value.memoryLimit=65536,f(""))}),($,P)=>{const y=Ke,j=Ee,T=Pa,D=bt,x=xl,z=Tl,A=Re,K=be,O=De,Q=H,Z=Se,se=Ye,J=We,de=Te,he=Me("md-editor-v3"),Pe=$e;return U(),E(Pe,{loading:h.value},{default:a(()=>[t(de,null,{default:a(()=>[t(O,{span:8},{default:a(()=>[R("div",cs,[t(K,{class:"sh-card"},{default:a(()=>[t(A,{model:u.value},{default:a(()=>[t(j,{label:"标题"},{default:a(()=>[t(y,{modelValue:u.value.title,"onUpdate:modelValue":P[0]||(P[0]=M=>u.value.title=M),placeholder:"问题标题"},null,8,["modelValue"])]),_:1}),t(j,{label:"时间限制"},{default:a(()=>[t(T,{modelValue:u.value.timeLimit,"onUpdate:modelValue":P[1]||(P[1]=M=>u.value.timeLimit=M),theme:"normal",min:0},{suffix:a(()=>P[6]||(P[6]=[R("span",null,"ms",-1)])),_:1},8,["modelValue"])]),_:1}),t(j,{label:"内存限制"},{default:a(()=>[t(T,{modelValue:u.value.memoryLimit,"onUpdate:modelValue":P[2]||(P[2]=M=>u.value.memoryLimit=M),theme:"normal",min:0},{suffix:a(()=>P[7]||(P[7]=[R("span",null,"KB",-1)])),_:1},8,["modelValue"])]),_:1}),t(j,{label:"来源"},{default:a(()=>[t(y,{modelValue:u.value.source,"onUpdate:modelValue":P[3]||(P[3]=M=>u.value.source=M),placeholder:"请输入题目来源"},null,8,["modelValue"])]),_:1}),t(j,{label:"私有"},{default:a(()=>[t(D,{modelValue:u.value.private,"onUpdate:modelValue":P[4]||(P[4]=M=>u.value.private=M)},null,8,["modelValue"])]),_:1}),t(j,{label:"标签"},{default:a(()=>[t(z,{value:d.value,"allow-input":!0,placeholder:"请选择或输入","tag-input-props":{excessTagsDisplayType:"break-line"},"popup-props":{overlayInnerClassName:["narrow-scrollbar"],overlayInnerStyle:{maxHeight:"280px",overflowY:"auto",overscrollBehavior:"contain",padding:"6px"}},clearable:"",multiple:"",onTagChange:C},{panel:a(()=>[L.value.length?(U(),E(x,{key:0,value:S.value,options:L.value,onChange:k},null,8,["value","options"])):(U(),ee("div",ms,"暂无数据"))]),suffixIcon:a(()=>[t(me(il))]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1})])]),_:1}),t(O,{span:4},{default:a(()=>[R("div",ps,[R("div",fs,[me(o)?(U(),E(Z,{key:0},{default:a(()=>[t(Q,{onClick:i,theme:"danger",loading:b.value},{default:a(()=>P[8]||(P[8]=[V("保存")])),_:1},8,["loading"]),t(Q,{onClick:m,theme:"warning"},{default:a(()=>P[9]||(P[9]=[V("判题数据")])),_:1}),t(Q,{onClick:s},{default:a(()=>P[10]||(P[10]=[V("查看")])),_:1})]),_:1})):(U(),E(Z,{key:1},{default:a(()=>[t(Q,{onClick:v,theme:"danger",loading:b.value},{default:a(()=>P[11]||(P[11]=[V("创建")])),_:1},8,["loading"])]),_:1}))]),me(o)?(U(),E(J,{key:0,layout:"vertical",bordered:!0},{default:a(()=>[t(se,{label:"创建时间"},{default:a(()=>{var M;return[V(q((M=w.value)==null?void 0:M.insertTime),1)]}),_:1}),t(se,{label:"编辑时间"},{default:a(()=>{var M;return[V(q((M=w.value)==null?void 0:M.modifyTime),1)]}),_:1}),t(se,{label:"判题方式"},{default:a(()=>{var M;return[V(q((M=w.value)==null?void 0:M.judgeType),1)]}),_:1}),t(se,{label:"上传用户"},{default:a(()=>{var M;return[V(q((M=w.value)==null?void 0:M.inserterNickname),1)]}),_:1})]),_:1})):le("",!0)])]),_:1})]),_:1}),R("div",vs,[P[12]||(P[12]=R("p",null,"题目描述",-1)),t(Pe,{loading:_.value||b.value},{default:a(()=>[t(he,{modelValue:u.value.description,"onUpdate:modelValue":P[5]||(P[5]=M=>u.value.description=M),onSave:i,onOnUploadImg:p,previewTheme:"cyanosis"},null,8,["modelValue"])]),_:1},8,["loading"])])]),_:1},8,["loading"])}}}),ua=oe(_s,[["__scopeId","data-v-0c8c3aee"]]),gs={style:{margin:"10px"}},bs={style:{margin:"12px"}},hs={class:"dida-edit-container"},ys=re({__name:"ProblemJudge",setup(e){let l=Ce();const{globalProperties:n}=fe(),r=Ze(),o=c("");let g=0;const h=c(!1),b=c(null);let _=null;const w=c(null),u=c(""),d=c(!1),L=c(!1),S=c([{title:"文件",colKey:"file"},{title:"大小",colKey:"size",width:150,cell:(T,D)=>{let x=D.row.size,z;return x>10*1024?x>1024*1024?z=(x/(1024*1024)).toFixed(3)+" MB":z=(x/1024).toFixed(3)+" KB":z=x+" B",z}},{title:"最后编辑时间",colKey:"lastModified",width:180,cell:(T,D)=>new Date(D.row.lastModified).toLocaleString()},{title:"操作",colKey:"action",width:100,cell:(T,D)=>t(H,{onClick:()=>v(D.row.file)},{default:()=>[V("下载")]})}]),C=c([]),k=Je(()=>({border:"2px dashed #ccc",borderRadius:"6px",padding:"20px",textAlign:"center",cursor:"pointer",backgroundColor:d.value?"#f0f9ff":"#fff",transition:"background-color 0.2s ease"})),s=Je(()=>u.value?`已选择：${u.value}`:d.value?"松开文件以上传":"拖拽判题数据压缩包到这里，或点击选择文件"),m=()=>{X.push({name:"problem-detail",params:{problemKey:o.value}})},p=()=>{X.push({name:"manage-problem",params:{problemKey:o.value}})},v=async T=>{const D=await Ln(g,T);if(D.code!==0){N(n,D.code);return}const x=document.createElement("a");x.href=D.data,x.target="_blank",x.click(),URL.revokeObjectURL(x.href)},i=async()=>{if(!_){_e(n,"请选择压缩包");return}L.value=!0,zn(g,_).then(async T=>{T.code==0?(w.value.value=null,_=null,u.value="",h.value=!0,Ge(n,"上传成功"),await j()):Jl(n,T.code,T.data)}).catch(T=>{console.log(T),n.$message.error({duration:3e3,content:"上传失败"})}).finally(()=>{L.value=!1})},f=()=>{var T;(T=w.value)==null||T.click()},I=T=>{const D=T.target.files[0];D&&(u.value=D.name,_=D)},$=T=>{d.value=!0},P=()=>{d.value=!1},y=T=>{T.preventDefault(),T.stopPropagation(),d.value=!1;const D=T.dataTransfer.files[0];if(D){u.value=D.name;const x=new DataTransfer;x.items.add(D),w.value.files=x.files,_=D}},j=async()=>{const T=await kn(o.value);if(T.code!==0){N(n,T.code),await X.push({name:"problem"});return}const D=T.data.problem;g=D.id,b.value=ht(D,{}),r.setTitle(D.title+" - "+r.getTitle),C.value=[],T.data.judges?(T.data.judges.forEach(x=>{C.value.push({file:x.key,size:x.size,lastModified:x.last_modified})}),C.value.sort((x,z)=>x.file.endsWith(".zip")&&!z.file.endsWith(".zip")?-1:!x.file.endsWith(".zip")&&z.file.endsWith(".zip")?1:x.file.endsWith(".yaml")&&!z.file.endsWith(".yaml")?-1:!x.file.endsWith(".yaml")&&z.file.endsWith(".yaml")?1:0)):_e(n,"评测数据不存在"),h.value=!1};return ce(async()=>{if(Array.isArray(l.params.problemKey)?o.value=l.params.problemKey[0]:o.value=l.params.problemKey,!o.value){_e(n,"题目不存在"),await X.push({name:"problem"});return}h.value=!0,await j()}),(T,D)=>{const x=Fe,z=De,A=H,K=Se,O=Ye,Q=We,Z=Te,se=$e;return U(),E(se,{loading:h.value},{default:a(()=>[t(Z,null,{default:a(()=>[t(z,{span:7},{default:a(()=>[R("div",gs,[R("div",{id:"drop-zone",style:wa(k.value),onClick:f,onDragenter:Lt($,["prevent"]),onDragover:D[0]||(D[0]=Lt(()=>{},["prevent"])),onDragleave:Lt(P,["prevent"]),onDrop:y},[R("input",{ref_key:"fileInput",ref:w,type:"file",style:{display:"none"},onChange:I},null,544),V(" "+q(s.value),1)],36)]),t(x,{data:C.value,columns:S.value,"row-key":"id","vertical-align":"top",hover:!0},null,8,["data","columns"])]),_:1}),t(z,{span:5},{default:a(()=>[R("div",bs,[R("div",hs,[t(K,null,{default:a(()=>[t(A,{onClick:i,theme:"danger",loading:L.value},{default:a(()=>D[1]||(D[1]=[V("上传")])),_:1},8,["loading"]),t(A,{onClick:p,theme:"warning"},{default:a(()=>D[2]||(D[2]=[V("编辑")])),_:1}),t(A,{onClick:m},{default:a(()=>D[3]||(D[3]=[V("查看")])),_:1})]),_:1})]),t(Q,{layout:"vertical",bordered:!0},{default:a(()=>[t(O,{label:"标题"},{default:a(()=>{var J;return[V(q((J=b.value)==null?void 0:J.title),1)]}),_:1}),t(O,{label:"创建时间"},{default:a(()=>{var J;return[V(q((J=b.value)==null?void 0:J.insertTime),1)]}),_:1}),t(O,{label:"编辑时间"},{default:a(()=>{var J;return[V(q((J=b.value)==null?void 0:J.modifyTime),1)]}),_:1}),t(O,{label:"判题方式"},{default:a(()=>{var J;return[V(q((J=b.value)==null?void 0:J.judgeType),1)]}),_:1}),t(O,{label:"评测数据"},{default:a(()=>{var J;return[V(q((J=b.value)==null?void 0:J.judgeMd5),1)]}),_:1}),t(O,{label:"上传用户"},{default:a(()=>{var J;return[V(q((J=b.value)==null?void 0:J.inserterNickname),1)]}),_:1})]),_:1})])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),ws=oe(ys,[["__scopeId","data-v-be774f38"]]);function Qt(e){const l={};return l.id=e.id,l.inserter=e.inserter,l.inserterUsername=e.inserter_username,l.inserterNickname=e.inserter_nickname,l.title=e.title,e.start_time?l.startTime=new Date(e.start_time).toLocaleString():l.startTime="无限制",e.end_time?l.endTime=new Date(e.end_time).toLocaleString():l.endTime="无限制",e.update_time?l.updateTime=new Date(e.update_time).toLocaleString():l.updateTime="",e.create_time?l.createTime=new Date(e.create_time).toLocaleString():l.createTime="",e.description?l.description=e.description:l.description="",l}function ks(e){return B({url:"/collection?id="+e,method:"get"})}function Ss(e){return B({url:"/collection/edit?id="+e,method:"get"})}function Cs(e,l){return B({url:"/collection/list?page="+e+"&page_size="+l,method:"get"})}function Ps(e){return B({url:"/collection/rank?id="+e,method:"get"})}function Is(e){return B({url:"/collection/create",method:"post",data:e})}function Ts(e){return B({url:"/collection/edit",method:"post",data:e})}function xs(e){return B({url:"/collection/join",method:"post",data:{id:e}})}function Vs(e){return B({url:"/collection/quit",method:"post",data:{id:e}})}const Ds={style:{margin:"10px"}},$s=re({__name:"CollectionList",setup(e){const l=Ce(),n=Xe(),{globalProperties:r}=fe();let o=null;c(!1),c(!1);const g=c([{title:"ID",colKey:"id",width:"100",cell:(m,p)=>t(H,{variant:"text",onClick:()=>L(p.row.id)},{default:()=>[p.row.id]})},{title:"标题",colKey:"title",cell:(m,p)=>t(H,{variant:"text",onClick:()=>L(p.row.id)},{default:()=>[p.row.title]})},{title:"负责人",colKey:"inserterNickname",width:"200"},{title:"开始时间",colKey:"startTime",width:"180"},{title:"结束时间",colKey:"endTime",width:"180"}]),h=c(!1);let b=1,_=50;const w=c({current:b,pageSize:_,defaultCurrent:b,defaultPageSize:_,total:0,pageSizeOptions:[50,100]}),u=c(),d=c({title:"",username:""});c({title:"",description:"",open_time:[]});const L=m=>{m&&n.push({path:"/collection/"+m})},S=async()=>{await n.push({query:{...l.query,title:d.value.title,username:d.value.username,page:1,page_size:w.value.defaultPageSize}})},C=async(m,p)=>{var v;h.value=!0;try{const{current:i,pageSize:f}=m,I=await Cs(i,f);if(u.value=[],I.code===0){const $=I.data.list;for(let P=0;P<$.length;P++){const y=$[P],j=Qt(y);(v=u.value)==null||v.push(j)}w.value={...w.value,total:I.data.total_count}}else p&&N(r,I.code)}catch(i){console.error(i),N(r,He())}finally{h.value=!1}},k=async m=>{await n.push({query:{...l.query,page:m.current,page_size:m.pageSize}})},s=async()=>{await n.push({name:"collection-create"})};return ce(async()=>{o=ze(()=>l.query,m=>{d.value.title=m.title||"",d.value.username=m.username||"";const p=parseInt(m.page)||w.value.defaultCurrent,v=parseInt(m.page_size)||w.value.defaultPageSize;b=p,_=v,w.value={...w.value,current:b,pageSize:_},C({current:b,pageSize:_},!0)},{immediate:!0})}),je(()=>{o&&o()}),(m,p)=>{const v=Fe,i=be,f=De,I=Ke,$=Ee,P=H,y=Re,j=Se,T=Te;return U(),E(T,null,{default:a(()=>[t(f,{span:9},{default:a(()=>[t(i,{style:{margin:"10px"}},{default:a(()=>[t(v,{data:u.value,columns:g.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:w.value,loading:h.value,onPageChange:k},null,8,["data","columns","pagination","loading"])]),_:1})]),_:1}),t(f,{span:3},{default:a(()=>[R("div",Ds,[t(i,{class:"sh-card"},{default:a(()=>[t(y,{model:d.value},{default:a(()=>[t($,{label:"标题"},{default:a(()=>[t(I,{modelValue:d.value.title,"onUpdate:modelValue":p[0]||(p[0]=D=>d.value.title=D),placeholder:"暂不支持模糊查询"},null,8,["modelValue"])]),_:1}),t($,{label:"负责人"},{default:a(()=>[t(I,{modelValue:d.value.username,"onUpdate:modelValue":p[1]||(p[1]=D=>d.value.username=D),placeholder:"仅支持输入完整用户名"},null,8,["modelValue"])]),_:1}),t($,null,{default:a(()=>[t(P,{theme:"primary",onClick:S},{default:a(()=>p[2]||(p[2]=[V("提交")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(i,{class:"sh-card"},{default:a(()=>[t(j,null,{default:a(()=>[t(P,{onClick:s},{default:a(()=>p[3]||(p[3]=[V("创建")])),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})}}}),js=oe($s,[["__scopeId","data-v-7974b460"]]),Ls={style:{margin:"20px"}},Us={class:"dida-operation-container"},As={style:{margin:"12px"}},zs=re({__name:"CollectionDetail",setup(e){let l=Ce();const{globalProperties:n}=fe(),r=Ze(),o=qe();let g=0;const h=c(!1),b=c(null),_=c(!1),w=c(!1);let u={};const d=Je(()=>o.hasAuth(Ue.ManageCollection)||b.value&&o.getUserId==b.value.ownerId),L=p=>{if(!p||!u)return"default";const v=u[p];if(!v)return"default";switch(v){case Ae.Accept:return"success";case Ae.Attempt:return"warning";default:return"default"}},S=c([{title:"问题标识",colKey:"id",cell:(p,v)=>{const i=L(v.row.id);return t(H,{variant:"dashed",theme:i,onClick:()=>sa(v.row.id)},{default:()=>[v.row.id]})}},{title:"标题",colKey:"title",cell:(p,v)=>t(H,{variant:"text",onClick:()=>sa(v.row.id)},{default:()=>[v.row.title]})},{title:"正确",colKey:"accept",cell:(p,v)=>v.row.accept?v.row.accept:0},{title:"提交",colKey:"attempt",cell:(p,v)=>v.row.attempt?v.row.attempt:0}]),C=c([]),k=async()=>{if(!o.isLogin()){await X.push({name:"login"});return}w.value=!0;try{const p=await xs(g);if(p.code!==0){N(n,p.code);return}_.value=!0,Ge(n,"加入成功")}finally{w.value=!1}},s=async()=>{if(!o.isLogin()){await X.push({name:"login"});return}w.value=!0;try{const p=await Vs(g);if(p.code!==0){N(n,p.code);return}_.value=!1,Ge(n,"退出成功")}finally{w.value=!1}},m=()=>{b.value&&X.push({name:"collection-edit",params:{collectionId:b.value.id}})};return ce(async()=>{if(Array.isArray(l.params.collectionId)?g=Number(l.params.collectionId[0]):g=Number(l.params.collectionId),!g){await X.push({name:"problem-collection-list"});return}_.value=!1,h.value=!0;const p=await ks(g);if(p.code!==0){h.value=!1,N(n,p.code),await X.push({name:"problem-collection-list"});return}_.value=p.data.joined,u=p.data.attempt_status||{},b.value=Qt(p.data.collection),C.value=p.data.problems,r.setTitle(b.value.title+" - "+r.getTitle),h.value=!1}),(p,v)=>{const i=Ta,f=Ia,I=Fe,$=be,P=De,y=H,j=Se,T=Ye,D=We,x=Me("md-preview"),z=Te,A=$e;return U(),E(A,{loading:h.value},{default:a(()=>[t(z,{class:"dida-main-content"},{default:a(()=>[t(P,{span:6},{default:a(()=>[R("div",Ls,[t(f,{"max-item-width":"300"},{default:a(()=>[t(i,{to:{name:"problem-collection-list"}},{default:a(()=>v[0]||(v[0]=[V("题目集合")])),_:1}),t(i,null,{default:a(()=>{var K;return[V(q((K=b.value)==null?void 0:K.title),1)]}),_:1})]),_:1})]),t($,{style:{margin:"10px"}},{default:a(()=>[t(I,{data:C.value,columns:S.value,"row-key":"id","vertical-align":"top","table-layout":"auto",hover:!0},null,8,["data","columns"])]),_:1})]),_:1}),t(P,{span:6},{default:a(()=>{var K;return[R("div",Us,[t(j,null,{default:a(()=>[_.value?(U(),E(y,{key:0,onClick:s,loading:w.value},{default:a(()=>v[1]||(v[1]=[V("退出")])),_:1},8,["loading"])):(U(),E(y,{key:1,onClick:k,loading:w.value},{default:a(()=>v[2]||(v[2]=[V("加入")])),_:1},8,["loading"])),d.value?(U(),E(y,{key:2,onClick:m},{default:a(()=>v[3]||(v[3]=[V("编辑")])),_:1})):le("",!0)]),_:1})]),R("div",As,[t(D,{layout:"vertical",bordered:!0},{default:a(()=>[t(T,{label:"创建者"},{default:a(()=>{var O;return[V(q((O=b.value)==null?void 0:O.ownerNickname),1)]}),_:1})]),_:1}),t(D,{layout:"vertical",bordered:!0},{default:a(()=>[t(T,{label:"开始时间"},{default:a(()=>{var O;return[V(q((O=b.value)==null?void 0:O.startTime),1)]}),_:1})]),_:1}),t(D,{layout:"vertical",bordered:!0},{default:a(()=>[t(T,{label:"结束时间"},{default:a(()=>{var O;return[V(q((O=b.value)==null?void 0:O.endTime),1)]}),_:1})]),_:1})]),(K=b.value)!=null&&K.description?(U(),E($,{key:0,style:{margin:"10px"}},{default:a(()=>{var O;return[t(x,{"model-value":(O=b.value)==null?void 0:O.description},null,8,["model-value"])]}),_:1})):le("",!0)]}),_:1})]),_:1})]),_:1},8,["loading"])}}}),Rs=oe(zs,[["__scopeId","data-v-c2a1787e"]]),Es=re({__name:"CollectionRank",setup(e){const l=Ce(),n=Xe(),{globalProperties:r}=fe();let o=null,g=0,h=0;const b=c([{title:"Rank",colKey:"rank",align:"center"},{title:"序号",colKey:"index",align:"center"},{title:"Username",colKey:"username",cell:(L,S)=>t(H,{variant:"text",onClick:()=>n.push({name:"user",params:{username:S.row.username}})},{default:()=>[S.row.username]})},{title:"昵称",colKey:"nickname",cell:(L,S)=>t(H,{variant:"text",onClick:()=>n.push({name:"user",params:{username:S.row.username}})},{default:()=>[S.row.nickname]})},{title:"Count",colKey:"count",cell:(L,S)=>t(H,{variant:"text",onClick:()=>n.push({name:"judge-list",query:{username:S.row.username,status:Be.Accept}})},{default:()=>[`${S.row.accept} / ${h}`]})},{title:"Progress",colKey:"progress",cell:(L,S)=>{let C=100;return h>0&&(C=Number((S.row.accept/h*100).toFixed(2))),t(Gt,{percentage:C},null)}}]),_=c(!1),w=c([]),u=({col:L,rowIndex:S})=>{let C=1;for(let k=S+1;k<w.value.length&&w.value[k].rank===w.value[S].rank;k++)C++;if(L.colKey==="rank")return{rowspan:C}},d=async L=>{_.value=!0;try{const S=await Ps(g);if(w.value=[],S.code===0){h=S.data.problem;const C=S.data.ranks,k=[];if(C){for(let p=0;p<C.length;p++){const v=C[p];let i={userId:v.inserter,username:v.inserter_username,nickname:v.inserter_nickname};i.accept=v.accept,k.push(i)}k.sort((p,v)=>p.accept!==v.accept?v.accept-p.accept:p.userId-v.userId);let s=0,m=-1;for(let p=0;p<k.length;p++)k[p].accept!==m&&(s=p+1,m=k[p].accept),k[p].index=p+1,k[p].rank=s}w.value=k}else L&&N(r,S.code)}catch(S){console.error(S),N(r,He())}finally{_.value=!1}};return ce(async()=>{o=ze(()=>l.query,async()=>{if(Array.isArray(l.params.collectionId)?g=Number(l.params.collectionId[0]):g=Number(l.params.collectionId),!g){await n.push({name:"problem-collection-list"});return}await d(!0)},{immediate:!0})}),je(()=>{o&&o()}),(L,S)=>{const C=Fe,k=be,s=Te;return U(),E(s,null,{default:a(()=>[t(k,{style:{margin:"10px"}},{default:a(()=>[R("div",null,[t(C,{data:w.value,columns:b.value,"row-key":"index","rowspan-and-colspan":u,"vertical-align":"middle",bordered:!0,hover:!0,loading:_.value},null,8,["data","columns","loading"])])]),_:1})]),_:1})}}});var Le=(e=>(e[e.Valid=0]="Valid",e[e.Duplicate=1]="Duplicate",e[e.Invalid=2]="Invalid",e))(Le||{});const Ks={class:"dida-form-border"},Ms={style:{"text-align":"right"}},qs=re({name:"ParseProblemList",__name:"ParseProblemList",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(e){const{globalProperties:l}=fe(),n=c(!1),r=c(!1),o=c(""),g=ka(e,"modelValue");let h=[];const b=c([]),_=c([{title:"有效性",colKey:"validType",cell:(S,C)=>{switch(C.row.valid){case Le.Valid:return t(Qe,{theme:"success"},{default:()=>[V("有效")]});case Le.Duplicate:return t(Qe,{theme:"warning"},{default:()=>[V("重复")]});case Le.Invalid:return t(Qe,{theme:"danger"},{default:()=>[V("无效")]});default:return null}}},{title:"问题标识",colKey:"key",cell:(S,C)=>{const k=`/problem/${C.row.key}`;return t(nt,{href:k,target:"_blank"},{default:()=>[C.row.key]})}},{title:"标题",colKey:"title"}]),w=async S=>{const C=Array.from(new Set(S)),k=await Rn(C.map(v=>v));if(k.code!==0){N(l,k.code),r.value=!1;return}const s=[],m=k.data.problems;let p=[];S.forEach(v=>{const i=m.find(f=>f.id===v);if(i){const f=s.find(I=>I.id===v);i.valid=f?Le.Duplicate:Le.Valid,s.push({id:i.id,key:i.key,title:i.title,valid:i.valid}),f||p.push(v)}else s.push({id:0,key:"-",title:"-",valid:Le.Invalid})}),b.value=s,h=p,g.value=p},u=async S=>{const C=Array.from(new Set(S)),k=await En(C);if(k.code!==0){N(l,k.code),r.value=!1;return}const s=[],m=k.data.problems;let p=[];S.forEach(v=>{const i=m.find(f=>f.key.toLowerCase()===v.toLowerCase());if(i){const f=s.find(I=>I.key.toLowerCase()===v.toLowerCase());i.valid=f?Le.Duplicate:Le.Valid,s.push({id:i.id,key:i.key,title:i.title,valid:i.valid}),f||p.push(i.id)}else s.push({id:0,key:v,title:"-",valid:Le.Invalid})}),b.value=s,h=p,g.value=p},d=async()=>{r.value=!0;const S=Da(o.value);await u(S),n.value=!1,r.value=!1},L=()=>{b.value?o.value=b.value.map(S=>S.id).join(`
`):o.value="",n.value=!0};return ze(g,async S=>{if(JSON.stringify(S)!==JSON.stringify(h)){if(!S){h=[];return}await w(S),g.value?h=g.value:h=[]}},{deep:!0,immediate:!0}),(S,C)=>{const k=H,s=Fe,m=Vt,p=ot;return U(),ee(ue,null,[R("div",Ks,[R("div",Ms,[t(k,{onClick:L},{default:a(()=>C[2]||(C[2]=[V("编辑")])),_:1})]),t(s,{data:b.value,columns:_.value,"row-key":"id","vertical-align":"top","table-layout":"auto",hover:!0},null,8,["data","columns"])]),t(p,{visible:n.value,"onUpdate:visible":C[1]||(C[1]=v=>n.value=v),onConfirm:d,header:"请输入问题标识","confirm-loading":r.value},{default:a(()=>[C[3]||(C[3]=R("div",{style:{"margin-bottom":"10px"}},[R("span",null,"多条请以空格、换行、英文逗号隔开")],-1)),t(m,{modelValue:o.value,"onUpdate:modelValue":C[0]||(C[0]=v=>o.value=v),autosize:{minRows:5}},null,8,["modelValue"])]),_:1},8,["visible","confirm-loading"])],64)}}}),Na=oe(qs,[["__scopeId","data-v-194e87f3"]]),Fs={class:"dida-form-border"},Ns={style:{"text-align":"right"}},Os=re({name:"ParseUserList",__name:"ParseUserList",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(e){const{globalProperties:l}=fe(),n=c(!1),r=c(!1),o=c(""),g=ka(e,"modelValue");let h=[];ze(g,async C=>{JSON.stringify(C)!==JSON.stringify(h)&&(h=C,await u(C))},{deep:!0});const b=c(),_=c([{title:"有效性",colKey:"validType",cell:(C,k)=>{switch(k.row.valid){case Le.Valid:return t(Qe,{theme:"success"},{default:()=>[V("有效")]});case Le.Duplicate:return t(Qe,{theme:"warning"},{default:()=>[V("重复")]});case Le.Invalid:return t(Qe,{theme:"danger"},{default:()=>[V("无效")]})}}},{title:"Username",colKey:"username"},{title:"昵称",colKey:"nickname"}]),w=(C,k)=>{if(C.code!==0){N(l,C.code),r.value=!1;return}const s=[],m=C.data.users;let p=[];k?k.forEach(v=>{let i=null;if(m&&(i=m.find(f=>f.username.toLowerCase()===v.toLowerCase())),i){const f=s.find($=>$.username.toLowerCase()===v.toLowerCase()),I=f?Le.Duplicate:Le.Valid;s.push({id:i.id,username:i.username,nickname:i.nickname,valid:I}),f||p.push(i.id)}else s.push({id:-1,username:v,nickname:"-",valid:Le.Invalid})}):m&&m.forEach(v=>{const i=s.find(I=>I.id===v.id),f=i?Le.Duplicate:Le.Valid;s.push({id:v.id,username:v.username,nickname:v.nickname,valid:f}),i||p.push(v.id)}),b.value=s,h=p,g.value=p},u=async C=>{const k=Array.from(new Set(C)),s=await eo(k);w(s)},d=async C=>{const k=Array.from(new Set(C)),s=await to(k);w(s,C)},L=async()=>{r.value=!0;const C=Da(o.value);await d(C),n.value=!1,r.value=!1},S=()=>{b.value?o.value=b.value.map(C=>C.username).join(`
`):o.value="",n.value=!0};return(C,k)=>{const s=H,m=Fe,p=Vt,v=ot;return U(),ee(ue,null,[R("div",Fs,[R("div",Ns,[t(s,{onClick:S},{default:a(()=>k[2]||(k[2]=[V("编辑")])),_:1})]),t(m,{data:b.value,columns:_.value,"row-key":"id","vertical-align":"top","table-layout":"auto",hover:!0},null,8,["data","columns"])]),t(v,{visible:n.value,"onUpdate:visible":k[1]||(k[1]=i=>n.value=i),onConfirm:L,header:"请输入用户Username","confirm-loading":r.value},{default:a(()=>[k[3]||(k[3]=R("div",{style:{"margin-bottom":"10px"}},[R("span",null,"多条请以空格、换行、英文逗号隔开")],-1)),t(p,{modelValue:o.value,"onUpdate:modelValue":k[0]||(k[0]=i=>o.value=i),autosize:{minRows:5}},null,8,["modelValue"])]),_:1},8,["visible","confirm-loading"])],64)}}}),Oa=oe(Os,[["__scopeId","data-v-d2170a86"]]),Gs={style:{margin:"10px"}},Hs={style:{margin:"12px"}},Bs={class:"dida-edit-container"},Js=re({__name:"CollectionEdit",setup(e){let l=Ce();const{globalProperties:n}=fe(),r=Ze(),o=c(""),g=c(!1),h=c(!1),b=c(!1),_=c(null),w=c({title:"",openTime:[],private:!0,problems:[],members:[],description:""}),u=c(""),d=c(""),L=c(!1),S=async()=>{L.value=!0,b.value=!1,L.value=!1},C=async()=>{h.value=!0;try{const v={title:w.value.title,problems:w.value.problems,members:w.value.members,private:w.value.private,description:w.value.description};w.value.openTime[0]&&(v.start_time=new Date(w.value.openTime[0])),w.value.openTime[1]&&(v.end_time=new Date(w.value.openTime[1]));const i=await Is(v);if(i.code!==0){N(n,i.code);return}i.data!=null&&await X.push({name:"collection-detail",params:{collectionId:i.data}}),Ge(n,"创建成功")}finally{h.value=!1}},k=async()=>{h.value=!0;try{const v={id:Number(o.value),title:w.value.title,private:w.value.private,problems:w.value.problems,members:w.value.members,description:w.value.description};w.value.openTime[0]&&(v.start_time=new Date(w.value.openTime[0])),w.value.openTime[1]&&(v.end_time=new Date(w.value.openTime[1]));const i=await Ts(v);if(i.code!==0){N(n,i.code);return}i.data!=null&&_.value&&(_.value.updateTime=new Date(i.data).toLocaleString()),Ge(n,"保存成功")}finally{h.value=!1}},s=v=>{w.value.description=v,g.value=!1};async function m(v,i){h.value=!0,_e(n,"本界面暂不支持上传图片"),h.value=!1}const p=async()=>{const v=await Ss(o.value);if(v.code!==0){N(n,v.code),console.error("collection get failed",v.code),await X.push({name:"problem-collection-list"});return}const i=v.data.collection;_.value=Qt(i),w.value.title=i.title,w.value.openTime=[],i.start_time?w.value.openTime.push(new Date(i.start_time)):w.value.openTime.push(""),i.end_time?w.value.openTime.push(new Date(i.end_time)):w.value.openTime.push(""),w.value.private=i.private,w.value.description=i.description,w.value.problems=i.problems,w.value.members=i.members,r.setTitle(i.title+" - "+r.getTitle);let f="";i.description&&(f=i.description),s(f)};return ce(async()=>{Array.isArray(l.params.collectionId)?o.value=l.params.collectionId[0]:o.value=l.params.collectionId,o.value?(g.value=!0,await p()):s("")}),(v,i)=>{const f=Ke,I=Ee,$=Bt,P=bt,y=Re,j=be,T=De,D=H,x=Se,z=Ye,A=We,K=Te,O=Me("md-editor-v3"),Q=$e,Z=Vt,se=ot;return U(),ee(ue,null,[t(Q,{loading:g.value},{default:a(()=>[t(K,null,{default:a(()=>[t(T,{span:8},{default:a(()=>[R("div",Gs,[t(j,{class:"sh-card"},{default:a(()=>[t(y,{model:w.value},{default:a(()=>[t(I,{label:"标题"},{default:a(()=>[t(f,{modelValue:w.value.title,"onUpdate:modelValue":i[0]||(i[0]=J=>w.value.title=J),placeholder:"题集标题"},null,8,["modelValue"])]),_:1}),t(I,{label:"开启时间"},{default:a(()=>[t($,{modelValue:w.value.openTime,"onUpdate:modelValue":i[1]||(i[1]=J=>w.value.openTime=J),"allow-input":"",clearable:"",format:"YYYY-MM-DD HH:mm:ss","default-time":["00:00:00","23:59:59"]},null,8,["modelValue"])]),_:1}),t(I,{label:"私有"},{default:a(()=>[t(P,{modelValue:w.value.private,"onUpdate:modelValue":i[2]||(i[2]=J=>w.value.private=J)},null,8,["modelValue"])]),_:1}),t(I,{label:"成员"},{default:a(()=>[t(Oa,{modelValue:w.value.members,"onUpdate:modelValue":i[3]||(i[3]=J=>w.value.members=J)},null,8,["modelValue"])]),_:1}),t(I,{label:"问题"},{default:a(()=>[t(Na,{modelValue:w.value.problems,"onUpdate:modelValue":i[4]||(i[4]=J=>w.value.problems=J)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})])]),_:1}),t(T,{span:4},{default:a(()=>[R("div",Hs,[R("div",Bs,[o.value?(U(),E(x,{key:0},{default:a(()=>[t(D,{onClick:k,theme:"danger",loading:h.value},{default:a(()=>i[8]||(i[8]=[V("保存")])),_:1},8,["loading"])]),_:1})):(U(),E(x,{key:1},{default:a(()=>[t(D,{onClick:C,theme:"danger",loading:h.value},{default:a(()=>i[9]||(i[9]=[V("创建")])),_:1},8,["loading"])]),_:1}))]),o.value?(U(),E(A,{key:0,layout:"vertical",bordered:!0},{default:a(()=>[t(z,{label:"创建时间"},{default:a(()=>{var J;return[V(q((J=_.value)==null?void 0:J.createTime),1)]}),_:1}),t(z,{label:"编辑时间"},{default:a(()=>{var J;return[V(q((J=_.value)==null?void 0:J.updateTime),1)]}),_:1}),t(z,{label:"创建用户"},{default:a(()=>{var J;return[V(q((J=_.value)==null?void 0:J.inserterNickname),1)]}),_:1})]),_:1})):le("",!0)])]),_:1})]),_:1}),t(O,{id:"collection-description-editor",modelValue:w.value.description,"onUpdate:modelValue":i[5]||(i[5]=J=>w.value.description=J),onSave:k,onOnUploadImg:m,previewTheme:"cyanosis",class:"dida-description-editor"},null,8,["modelValue"]),t(Q,{loading:h.value,attach:"#collection-description-editor","z-index":1e5},null,8,["loading"])]),_:1},8,["loading"]),t(se,{visible:b.value,"onUpdate:visible":i[7]||(i[7]=J=>b.value=J),onConfirm:S,header:u.value,"confirm-loading":L.value},{default:a(()=>[i[10]||(i[10]=R("div",{style:{"margin-bottom":"10px"}},[R("span",null,"多条请以空格、换行、英文逗号隔开")],-1)),t(Z,{modelValue:d.value,"onUpdate:modelValue":i[6]||(i[6]=J=>d.value=J),autosize:{minRows:5}},null,8,["modelValue"])]),_:1},8,["visible","header","confirm-loading"])],64)}}}),da=oe(Js,[["__scopeId","data-v-175825a1"]]);function ca(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!at(e)}const Ws=re({__name:"JudgeJobList",setup(e){const l=Ce(),n=Xe(),{globalProperties:r}=fe();let o=!1,g=null,h;const b=c(!1),_=c(null),w=c(!1);let u=-1;const d=c({problemKey:"",username:"",language:void 0,status:void 0}),L=c([{title:"ID",colKey:"id",cell:(D,x)=>{let z=null;return Pt(x.row.status)&&Ct(x.row.language)&&(z=()=>{I(x.row.id)}),t(H,{variant:"text",onClick:z},{default:()=>[x.row.id]})}},{title:"问题",colKey:"problemKey",cell:(D,x)=>{if(u){let z;return t(H,{variant:"text",onClick:()=>vt(u,x.row.contestProblemIndex)},ca(z=tt(x.row.contestProblemIndex))?z:{default:()=>[z]})}return t(H,{variant:"text",onClick:()=>f(x.row.problemKey)},{default:()=>[x.row.problemKey]})}},{title:"状态",colKey:"status",align:"center",cell:(D,x)=>{let z=null;Pt(x.row.status)&&Ct(x.row.language)&&(z=()=>{I(x.row.id)});const A=x.row.status,K=Tt(A);let O=!Pt(A);const Q=La(A);let Z=[];return dt(A)&&Z.push(t($e,{text:x.row.state,size:"small",class:"dida-status-loading"},null)),Z.push(t("span",null,[K])),t(H,{theme:Q,variant:"outline",onClick:z,disabled:O},ca(Z)?Z:{default:()=>[Z]})}},{title:"分数",colKey:"score"},{title:"时间",colKey:"time"},{title:"内存",colKey:"memory"},{title:"代码",colKey:"code",cell:(D,x)=>{let z=!Ct(x.row.language);return t(H,{theme:"default",onClick:()=>i(x.row),disabled:z},{default:()=>[It(x.row.language)+" / "+x.row.codeLength]})}},{title:"作者",colKey:"inserter",width:200,cell:(D,x)=>t(H,{variant:"text",onClick:()=>$(x.row.inserterUsername)},{default:()=>[x.row.inserterNickname]})},{title:"提交时间",colKey:"insertTime",width:180}]),S=c(!1);let C=1,k=50;const s=c({current:C,pageSize:k,defaultCurrent:C,defaultPageSize:k,total:500,pageSizeOptions:[50,100],showPageSize:!1,totalContent:(D,x)=>t("div",null,[t(Qe,null,{default:()=>[V("目前仅支持获取前10页数据")]})])}),m=c(),p=c([]);p.value=Jt();const v=c([]);v.value=Ua();const i=async D=>{w.value=!0,b.value=!0;try{_.value=D;const x=await vn(Number(_.value.id));if(x.code===0){const z=x.data,A=Wt(z.language);_.value.code=`\`\`\`${A}
${z.code}
\`\`\``}else N(r,x.code)}finally{w.value=!1}},f=D=>{D&&n.push({path:"/problem/"+D})},I=D=>{D&&(u>0?n.push({name:"contest-judge-detail",params:{contestId:u,judgeId:D}}):n.push({name:"judge-detail",params:{judgeId:D}}))},$=D=>{D&&n.push({path:"/user/"+D})},P=async()=>{await n.push({query:{...l.query,page:1,page_size:k,problem_id:d.value.problemKey,username:d.value.username,language:d.value.language,status:d.value.status}})},y=async()=>{d.value.problemKey="",d.value.username="",d.value.language=void 0,d.value.status=void 0,await n.push({query:{...l.query,page:1,page_size:k,problem_id:"",username:"",language:void 0,status:void 0}})},j=async(D,x)=>{x&&(S.value=!0);let z=!1;try{const{current:A,pageSize:K}=D,O=await _n(u,d.value.problemKey,d.value.username,d.value.language,d.value.status,A,K);if(m.value=[],O.code===0){if(!O.data.has_auth){ke(r,"您目前没有权限查看评测记录"),u?await n.push({name:"contest-detail",params:{contestId:u}}):await n.push({name:"judge-list"});return}O.data.list&&O.data.list.length>0?O.data.list.forEach(Z=>{var J;const se=Aa(Z);(J=m.value)==null||J.push(se),dt(Z.status)&&(z=!0)}):ke(r,"未找到记录")}else x&&N(r,O.code)}catch(A){console.error(A),x&&N(r,He())}finally{x&&(S.value=!1),z&&o&&(h=setTimeout(()=>{j({current:C,pageSize:k},!1)},5e3))}},T=async D=>{await n.push({query:{...l.query,page:D.current}})};return ce(async()=>{o=!0,g=ze(()=>l.query,D=>{Array.isArray(l.params.contestId)?u=Number(l.params.contestId[0]):u=Number(l.params.contestId),d.value.problemKey=D.problem_id||"",d.value.username=D.username||"",D.language!=null?d.value.language=Number(D.language):d.value.language=void 0,D.status!=null?d.value.status=Number(D.status):d.value.status=void 0;const x=parseInt(D.page)||s.value.defaultCurrent,z=parseInt(D.page_size)||s.value.defaultPageSize;C=x,k=z,s.value.pageSizeOptions.includes(k)||(k=s.value.defaultPageSize),s.value={...s.value,current:C,pageSize:k},j({current:C,pageSize:k},!0)},{immediate:!0})}),je(()=>{o=!1,g&&g(),clearTimeout(h)}),(D,x)=>{const z=Ke,A=Ee,K=Ht,O=gt,Q=H,Z=Se,se=Re,J=Fe,de=be,he=nt,Pe=Me("md-preview"),M=$e,Y=ot;return U(),ee(ue,null,[t(de,{style:{margin:"10px"}},{default:a(()=>[t(se,{layout:"inline",onSubmit:P,onReset:y},{default:a(()=>[t(A,{label:"题号"},{default:a(()=>[t(z,{modelValue:d.value.problemKey,"onUpdate:modelValue":x[0]||(x[0]=F=>d.value.problemKey=F),placeholder:"请输入完整题号"},null,8,["modelValue"])]),_:1}),t(A,{label:"用户"},{default:a(()=>[t(z,{modelValue:d.value.username,"onUpdate:modelValue":x[1]||(x[1]=F=>d.value.username=F),placeholder:"仅支持输入完整用户名"},null,8,["modelValue"])]),_:1}),t(A,{label:"语言"},{default:a(()=>[t(O,{modelValue:d.value.language,"onUpdate:modelValue":x[2]||(x[2]=F=>d.value.language=F),placeholder:"请选择提交语言","auto-width":"",clearable:""},{default:a(()=>[(U(!0),ee(ue,null,xe(p.value,F=>(U(),E(K,{key:F.value,value:F.value,label:F.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(A,{label:"状态"},{default:a(()=>[t(O,{modelValue:d.value.status,"onUpdate:modelValue":x[3]||(x[3]=F=>d.value.status=F),placeholder:"请选择评测状态","auto-width":"",clearable:""},{default:a(()=>[(U(!0),ee(ue,null,xe(v.value,F=>(U(),E(K,{key:F.value,value:F.value,label:F.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(A,null,{default:a(()=>[t(Z,null,{default:a(()=>[t(Q,{theme:"primary",type:"submit"},{default:a(()=>x[7]||(x[7]=[V("搜索")])),_:1}),t(Q,{theme:"default",variant:"base",type:"reset"},{default:a(()=>x[8]||(x[8]=[V("重置")])),_:1})]),_:1})]),_:1})]),_:1}),t(J,{data:m.value,columns:L.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:s.value,loading:S.value,onPageChange:T,"table-layout":"auto"},null,8,["data","columns","pagination","loading"])]),_:1}),t(Y,{visible:b.value,"onUpdate:visible":x[5]||(x[5]=F=>b.value=F),width:"800px","cancel-btn":null,"close-btn":!1,onConfirm:x[6]||(x[6]=F=>b.value=!1)},{header:a(()=>[t(he,{onClick:x[4]||(x[4]=()=>{var F;I((F=_.value)==null?void 0:F.id)})},{default:a(()=>{var F,pe,te;return[V(q(((F=_.value)==null?void 0:F.id)+" - "+me(It)((pe=_.value)!=null&&pe.language?(te=_.value)==null?void 0:te.language:me(jt).Unknown)),1)]}),_:1})]),default:a(()=>[t(M,{loading:w.value},{default:a(()=>{var F;return[t(Pe,{"model-value":(F=_.value)==null?void 0:F.code,"code-foldable":!1,style:{"min-height":"100px"}},null,8,["model-value"])]}),_:1},8,["loading"])]),_:1},8,["visible"])],64)}}}),ma=oe(Ws,[["__scopeId","data-v-2f2ccbac"]]),Ys={class:"dida-code-container"},Xs={style:{margin:"20px"}},Zs={key:2,class:"dida-edit-container"};function zt(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!at(e)}const Qs=re({__name:"JudgeJobDetail",setup(e){const l=Ce(),n=Xe(),r=qe(),{globalProperties:o}=fe();let g=!1,h,b=0,_=0;const w=c(""),u=c(null),d=c(""),L=c(0),S=c(null),C=c({from:"#5a96ff",to:"#00A870"}),k=c([{title:"ID",colKey:"id"},{title:"问题",colKey:"problemKey",cell:(y,j)=>{if(_){let T;return t(H,{variant:"text",onClick:()=>vt(_,j.row.contestProblemIndex)},zt(T=tt(j.row.contestProblemIndex))?T:{default:()=>[T]})}return t(H,{variant:"text",onClick:()=>f(j.row.problemKey)},{default:()=>[j.row.problemKey]})}},{title:"状态",colKey:"status",align:"center",cell:(y,j)=>{const T=j.row.status,D=Tt(T),x=La(T);let z=[];return dt(T)&&z.push(t($e,{text:j.row.state,size:"small",class:"dida-status-loading"},null)),z.push(t("span",null,[D])),t(H,{theme:x,variant:"outline"},zt(z)?z:{default:()=>[z]})}},{title:"分数",colKey:"score"},{title:"时间",colKey:"time"},{title:"内存",colKey:"memory"},{title:"代码",colKey:"language",cell:(y,j)=>t("span",null,[It(j.row.language)+" / "+j.row.codeLength])},{title:"作者",colKey:"inserter",width:200,cell:(y,j)=>t(H,{variant:"text",onClick:()=>I(j.row.inserterUsername)},{default:()=>[j.row.inserterNickname]})},{title:"提交时间",colKey:"insertTime",width:180}]),s=c(!1),m=c(!1),p=c(),v=Je(()=>r.hasAuth(Ue.ManageJudge)),i=async()=>{if(!m.value){m.value=!0;try{const y=await wn(b);y.code===0?await P(!0):N(o,y.code)}catch(y){console.error(y),N(o,He())}finally{m.value=!1}}},f=y=>{y&&n.push({path:"/problem/"+y})},I=y=>{y&&n.push({path:"/user/"+y})},$=y=>{const j=y.status,T=Tt(j);let D;switch(j){case Be.Init:case Be.Rejudge:case Be.Compiling:case Be.Running:D="default";break;case Be.Accept:D="success";break;case Be.PE:D="warning";break;default:D="danger";break}return t(Se,null,{default:()=>[t(H,{theme:"default",variant:"outline"},{default:()=>[y.taskId]}),t(H,{theme:D,variant:"outline"},zt(T)?T:{default:()=>[T]}),t("span",null,[V("分数："),y.score]),t("span",null,[V("用时："),y.time]),t("span",null,[V("内存："),y.memory])]})},P=async y=>{var T;y&&(s.value=!0);let j=!1;try{const D=await fn(b,_);if(p.value=[],D.code===0){const x=D.data,z=Aa(x);if((T=p.value)==null||T.push(z),w.value=z.judgerName,C.value.to="#00A870",dt(x.status)?(S.value="active",z.taskTotal>0?(L.value=Number((z.taskCurrent/z.taskTotal*100).toFixed(2)),z.taskCurrent>=z.taskTotal&&(L.value=99)):L.value=0):(L.value=100,x.status===Be.Accept?S.value="success":x.status===Be.PE?(C.value.to="#F57C20",S.value="warning"):(C.value.to="#F56C6C",S.value="error")),x.code){const A=Wt(x.language);d.value=`\`\`\`${A}
${x.code}
\`\`\``}u.value=z,dt(x.status)&&(j=!0)}else y&&N(o,D.code),_?await n.push({name:"contest-judge",params:{contestId:_}}):await n.push({name:"judge-list"})}catch(D){console.error(D),y&&N(o,He())}finally{y&&(s.value=!1),j&&g&&(h=setTimeout(()=>{P(!1)},5e3))}};return ce(async()=>{if(g=!0,Array.isArray(l.params.judgeId)?b=Number(l.params.judgeId[0]):b=Number(l.params.judgeId),Array.isArray(l.params.contestId)?_=Number(l.params.contestId[0]):_=Number(l.params.contestId),!b){await n.push({name:"judge"});return}await P(!0)}),je(()=>{g=!1,clearTimeout(h)}),(y,j)=>{var de,he,Pe;const T=Gt,D=Fe,x=be,z=Me("md-preview"),A=De,K=Ye,O=We,Q=Te,Z=Vl,se=Dl,J=H;return U(),ee(ue,null,[t(T,{color:C.value,status:S.value,class:"dida-job-progress",percentage:L.value},null,8,["color","status","percentage"]),t(x,{style:{margin:"10px"}},{default:a(()=>[t(D,{data:p.value,columns:k.value,"row-key":"id","vertical-align":"top",hover:!0,loading:s.value},null,8,["data","columns","loading"])]),_:1}),t(Q,null,{default:a(()=>[t(A,{span:8},{default:a(()=>[R("div",Ys,[t(z,{"model-value":d.value,class:"dida-code-div"},null,8,["model-value"])])]),_:1}),t(A,{span:4},{default:a(()=>[R("div",Xs,[t(O,{layout:"vertical",bordered:!0},{default:a(()=>[t(K,{label:"判题机"},{default:a(()=>[V(q(w.value),1)]),_:1}),t(K,{label:"判题时间"},{default:a(()=>{var M;return[V(q((M=u.value)==null?void 0:M.judgeTime),1)]}),_:1})]),_:1}),t(x,{class:"dida-card-tips"},{default:a(()=>{var M;return[V(q(s.value?"数据正在加载，请等待":me(oa)((M=u.value)==null?void 0:M.status)),1)]}),_:1})])]),_:1})]),_:1}),(de=u.value)!=null&&de.compileMessage?(U(),E(x,{key:0,class:"compile-message"},{default:a(()=>{var M;return[V(q((M=u.value)==null?void 0:M.compileMessage),1)]}),_:1})):le("",!0),(he=u.value)!=null&&he.task&&((Pe=u.value)==null?void 0:Pe.task.length)>0?(U(),E(se,{key:1,class:"task-panel"},{default:a(()=>{var M;return[(U(!0),ee(ue,null,xe((M=u.value)==null?void 0:M.task,(Y,F)=>(U(),E(Z,{key:Y.taskId,header:()=>$(Y)},{default:a(()=>[t(x,null,{default:a(()=>[V(q(me(oa)(Y.status)),1)]),_:2},1024),Y.content?(U(),E(x,{key:0,class:"dida-card-tips"},{default:a(()=>[t(z,{"model-value":Y.content},null,8,["model-value"])]),_:2},1024)):le("",!0),Y.hint?(U(),E(x,{key:1,class:"dida-card-tips"},{default:a(()=>[t(z,{"model-value":Y.hint},null,8,["model-value"])]),_:2},1024)):le("",!0)]),_:2},1032,["header"]))),128))]}),_:1})):le("",!0),v.value?(U(),ee("div",Zs,[t(J,{onClick:i,loading:m.value},{default:a(()=>j[0]||(j[0]=[V("重新评测")])),_:1},8,["loading"])])):le("",!0)],64)}}}),pa=oe(Qs,[["__scopeId","data-v-22eabe14"]]),er={style:{margin:"10px"}},tr=re({__name:"ContestList",setup(e){const l=Ce(),n=Xe(),{globalProperties:r}=fe();let o=null;const g=c([{title:"ID",colKey:"id",cell:(p,v)=>t(H,{variant:"text",onClick:()=>L(v.row.id)},{default:()=>[v.row.id]})},{title:"标题",colKey:"title",cell:(p,v)=>t(H,{variant:"text",onClick:()=>L(v.row.id)},{default:()=>[v.row.title]})},{title:"负责人",colKey:"ownerNickname",cell:(p,v)=>t(H,{variant:"text",onClick:()=>Xt(n,v.row.ownerUsername)},{default:()=>[v.row.ownerNickname]})},{title:"权限",colKey:"private",cell:(p,v)=>v.row.private?"私有":"公开"},{title:"开始时间",colKey:"startTime"},{title:"结束时间",colKey:"endTime"}]),h=c(!1);let b=1,_=50;const w=c({current:b,pageSize:_,defaultCurrent:b,defaultPageSize:_,total:0,pageSizeOptions:[50,100]}),u=c(),d=c({title:"",username:""}),L=p=>{p&&n.push({path:"/contest/"+p})},S=async()=>{await n.push({query:{...l.query,title:d.value.title,username:d.value.username,page:1,page_size:w.value.defaultPageSize}})},C=async()=>{d.value.title="",d.value.username="",await n.push({query:{...l.query,title:"",username:"",page:1,page_size:w.value.defaultPageSize}})},k=async(p,v)=>{var i;h.value=!0;try{const{current:f,pageSize:I}=p,$=await Lo(d.value.title,d.value.username,f,I);if(u.value=[],$.code===0){const P=$.data.list;for(let y=0;y<P.length;y++){const j=P[y],T=Zt(j);(i=u.value)==null||i.push(T)}w.value={...w.value,total:$.data.total_count}}else v&&N(r,$.code)}catch(f){console.error(f),N(r,He())}finally{h.value=!1}},s=async p=>{await n.push({query:{...l.query,page:p.current,page_size:p.pageSize}})},m=()=>{n.push({name:"contest-create"})};return ce(async()=>{o=ze(()=>l.query,p=>{d.value.title=p.title||"",d.value.username=p.username||"";const v=parseInt(p.page)||w.value.defaultCurrent,i=parseInt(p.page_size)||w.value.defaultPageSize;b=v,_=i,w.value={...w.value,current:b,pageSize:_},k({current:b,pageSize:_},!0)},{immediate:!0})}),je(()=>{o&&o()}),(p,v)=>{const i=Fe,f=be,I=De,$=Ke,P=Ee,y=H,j=Se,T=Re,D=Te;return U(),E(D,null,{default:a(()=>[t(I,{span:9},{default:a(()=>[t(f,{style:{margin:"10px"}},{default:a(()=>[t(i,{data:u.value,columns:g.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:w.value,loading:h.value,"table-layout":"auto",onPageChange:s,style:{"white-space":"nowrap"}},null,8,["data","columns","pagination","loading"])]),_:1})]),_:1}),t(I,{span:3},{default:a(()=>[R("div",er,[t(f,{class:"sh-card"},{default:a(()=>[t(T,{model:d.value,onSubmit:S,onReset:C},{default:a(()=>[t(P,{label:"标题"},{default:a(()=>[t($,{modelValue:d.value.title,"onUpdate:modelValue":v[0]||(v[0]=x=>d.value.title=x),placeholder:"暂不支持模糊查询"},null,8,["modelValue"])]),_:1}),t(P,{label:"负责人"},{default:a(()=>[t($,{modelValue:d.value.username,"onUpdate:modelValue":v[1]||(v[1]=x=>d.value.username=x),placeholder:"仅支持输入完整用户名"},null,8,["modelValue"])]),_:1}),t(P,null,{default:a(()=>[t(j,null,{default:a(()=>[t(y,{theme:"primary",type:"submit"},{default:a(()=>v[2]||(v[2]=[V("提交")])),_:1}),t(y,{theme:"danger",type:"reset"},{default:a(()=>v[3]||(v[3]=[V("重置")])),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(f,{class:"sh-card"},{default:a(()=>[t(j,null,{default:a(()=>[t(y,{onClick:m},{default:a(()=>v[4]||(v[4]=[V("创建")])),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})}}}),fa=oe(tr,[["__scopeId","data-v-d94af270"]]);function Rt(e){return e*1<10?`0${e}`:e}const ar={name:"CountDown",emits:["on-end"],props:{format:{type:Function},target:{type:[Date,Number],required:!0},interval:{type:Number,default:1e3}},data(){return{lastTime:0,targetTime:0,timer:null}},computed:{result(){const{format:e=this.defaultFormat}=this;return e(this.lastTime)}},methods:{initTargetTime(){try{this.targetTime=Object.prototype.toString.call(this.target)==="[object Date]"?this.target.getTime():new Date(this.target).getTime()}catch(e){throw new Error("invalid target prop",e)}},updateTime(){const e=Date.now(),l=this.targetTime-e;this.lastTime=l>0?l:0},tick(){if(this.updateTime(),this.lastTime<=0){clearTimeout(this.timer),this.timer=null,this.$emit("on-end");return}this.timer=setTimeout(()=>{this.tick()},this.interval)},stop(){this.timer&&(clearTimeout(this.timer),this.timer=null)},defaultFormat(e){const r=Math.floor(e/36e5),o=Math.floor(e%36e5/6e4),g=Math.floor(e%6e4/1e3);return`${Rt(r)}:${Rt(o)}:${Rt(g)}`}},watch:{target(){this.stop(),this.initTargetTime(),this.tick()}},created(){this.initTargetTime(),this.updateTime()},mounted(){this.tick()},beforeUnmount(){this.stop()}};function lr(e,l,n,r,o,g){return U(),ee("span",null,q(g.result),1)}const nr=oe(ar,[["render",lr]]),or={style:{margin:"20px"}},sr={style:{margin:"10px"}},rr={key:0,class:"dida-countdown-div"},ir={style:{"text-align":"center","align-content":"center",padding:"20px",height:"500px"}},ur={style:{"text-align":"center",width:"100%"}},dr={class:"dida-operation-container"},cr={style:{margin:"12px"}},mr=re({__name:"ContestDetail",setup(e){let l=Ce();const{globalProperties:n}=fe(),r=Ze(),o=qe(),g=c(!1);let h=0;const b=c(!1),_=c(null),w=c(!1),u=c(!1),d=c(""),L=c(null),S=Je(()=>o.hasAuth(Ue.ManageContest)||_.value&&(o==null?void 0:o.getUserId)===_.value.inserter),C=P=>{if(!P||!m)return"default";const y=m[P];if(!y)return"default";switch(y){case Ae.Accept:return"success";case Ae.Attempt:return"warning";default:return"default"}},k=c([{title:"问题标识",colKey:"index",cell:(P,y)=>{const j=C(y.row.index);return t(H,{variant:"dashed",theme:j,onClick:async()=>await vt(h,y.row.index)},{default:()=>[y.row.id]})}},{title:"标题",colKey:"title",cell:(P,y)=>t(H,{variant:"text",onClick:async()=>await vt(h,y.row.index)},{default:()=>[y.row.title]})},{title:"正确",colKey:"accept"},{title:"提交",colKey:"attempt"}]),s=c([]);let m={},p=c(!1);const v=async()=>{await $()},i=()=>{X.push({name:"contest-edit",params:{contestId:h}})},f=async()=>{g.value=!0;try{const P=await Eo(h);if(P.code!==0){N(n,P.code);return}const y=P.data;ke(n,"查重报告已生成，请前往查看"),window.open(y,"_blank")}finally{g.value=!1}},I=async()=>{if(!o.isLogin()){await X.push({name:"login"});return}if(!d.value){_e(n,"请输入密码");return}p.value=!0;try{const P=await Ro(h,d.value);if(P.code!==0){N(n,P.code);return}ke(n,"申请访问成功"),await $()}catch(P){console.error("Error submitting contest password:",P),N(n,"提交密码失败，请稍后再试")}finally{p.value=!1}},$=async()=>{b.value=!0;const P=await xo(h);if(P.code!==0){b.value=!1,N(n,P.code),await X.push({name:"contest"});return}w.value=P.data.has_auth,u.value=P.data.need_password,L.value=null;const y=new Date(P.data.now);if(y<new Date(P.data.contest.start_time)){const j=new Date().getTime()-y.getTime();L.value=new Date(new Date(P.data.contest.start_time).getTime()+j)}_.value=Zt(P.data.contest),s.value=_.value.problems,m=P.data.attempt_status||{},r.setTitle(_.value.title+" - "+r.getTitle),b.value=!1};return ce(async()=>{if(Array.isArray(l.params.contestId)?h=Number(l.params.contestId[0]):h=Number(l.params.contestId),!h){await X.push({name:"contest"});return}await $()}),(P,y)=>{const j=xt,T=Fe,D=be,x=Ke,z=Ee,A=H,K=Re,O=De,Q=Se,Z=Ye,se=We,J=Me("md-preview"),de=Te,he=$e;return U(),E(he,{loading:b.value},{default:a(()=>[t(de,{class:"dida-main-content"},{default:a(()=>[t(O,{span:6},{default:a(()=>{var Pe,M,Y;return[R("div",or,[R("h1",null,q((Pe=_.value)==null?void 0:Pe.title),1),(M=_.value)!=null&&M.notification?(U(),E(j,{key:0,theme:"info",message:(Y=_.value)==null?void 0:Y.notification},null,8,["message"])):le("",!0)]),R("div",sr,[w.value?(U(),E(D,{key:0},{default:a(()=>[L.value?(U(),ee("div",rr,[y[1]||(y[1]=R("p",{class:"dida-countdown-head"},"比赛开启倒计时",-1)),t(nr,{class:"dida-countdown-content",target:L.value,onOnEnd:v},null,8,["target"])])):(U(),E(T,{key:1,data:s.value,columns:k.value,"row-key":"id","table-layout":"auto","vertical-align":"top",hover:!0},null,8,["data","columns"]))]),_:1})):(U(),E(D,{key:1},{default:a(()=>[R("div",ir,[t(j,{theme:"warning",message:"您没有查看本比赛的权限"}),u.value?(U(),E(K,{key:0,style:{margin:"20px auto 0",width:"200px"},onSubmit:I,"label-width":"0"},{default:a(()=>[t(z,null,{default:a(()=>[t(x,{placeholder:"请输入密码",value:d.value,"onUpdate:value":y[0]||(y[0]=F=>d.value=F),style:{width:"300px"},type:"password",autocomplete:"new-password"},null,8,["value"])]),_:1}),t(z,null,{default:a(()=>[R("div",ur,[t(A,{theme:"primary",type:"submit",loading:me(p)},{default:a(()=>y[2]||(y[2]=[V("提交")])),_:1},8,["loading"])])]),_:1})]),_:1})):le("",!0)])]),_:1}))])]}),_:1}),t(O,{span:6},{default:a(()=>{var Pe;return[R("div",dr,[t(Q,null,{default:a(()=>[S.value?(U(),E(A,{key:0,onClick:f,loading:g.value},{default:a(()=>y[3]||(y[3]=[V("查重")])),_:1},8,["loading"])):le("",!0),S.value?(U(),E(A,{key:1,onClick:i},{default:a(()=>y[4]||(y[4]=[V("编辑")])),_:1})):le("",!0)]),_:1})]),R("div",cr,[t(se,{layout:"vertical",bordered:!0},{default:a(()=>[t(Z,{label:"创建时间"},{default:a(()=>{var M;return[V(q((M=_.value)==null?void 0:M.insertTime),1)]}),_:1})]),_:1}),t(se,{layout:"vertical",bordered:!0},{default:a(()=>[t(Z,{label:"编辑时间"},{default:a(()=>{var M;return[V(q((M=_.value)==null?void 0:M.modifyTime),1)]}),_:1})]),_:1}),t(se,{layout:"vertical",bordered:!0},{default:a(()=>[t(Z,{label:"开始时间"},{default:a(()=>{var M;return[V(q((M=_.value)==null?void 0:M.startTime),1)]}),_:1})]),_:1}),t(se,{layout:"vertical",bordered:!0},{default:a(()=>[t(Z,{label:"结束时间"},{default:a(()=>{var M;return[V(q((M=_.value)==null?void 0:M.endTime),1)]}),_:1})]),_:1})]),(Pe=_.value)!=null&&Pe.description?(U(),E(D,{key:0,style:{margin:"12px"}},{default:a(()=>{var M;return[t(J,{"model-value":(M=_.value)==null?void 0:M.description,class:"dida-content-description"},null,8,["model-value"])]}),_:1})):le("",!0)]}),_:1})]),_:1})]),_:1},8,["loading"])}}}),pr=oe(mr,[["__scopeId","data-v-dec87736"]]);function Ga(e){return e?Math.floor(e/1e9):0}function ut(e){if(e<=0)return"0 秒 ";let l="";const n=Math.floor(e/3600);n>0&&(l+=`${n} 小时 `);const r=Math.floor(e%3600/60);return(r>0||n>0)&&(n>0&&r<10&&(l+="0"),l+=`${r} 分钟 `),e=e%60,(e>0||r>0||n>0)&&((n>0||r>0)&&e<10&&(l+="0"),l+=`${e.toFixed(0)} 秒`),l}const fr=_t("contest",{state:()=>({starMembers:{}}),actions:{clear(){this.$patch({starMembers:{}})},addStarMember(e,l){this.starMembers[e]||(this.starMembers[e]={}),this.starMembers[e][l]=!0},removeStarMember(e,l){this.starMembers[e]&&(delete this.starMembers[e][l],Object.keys(this.starMembers[e]).length===0&&delete this.starMembers[e])},isStarMember(e,l){var n;return!!((n=this.starMembers[e])!=null&&n[l])}},persist:!0}),vr={style:{margin:"10px 10px 40px"}},_r={style:{"text-align":"right","margin-bottom":"10px"}},gr={class:"table-scroll-wrapper"};function va(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!at(e)}const br=re({__name:"ContestRank",setup(e){const l=Ce(),n=Xe(),r=fr(),{globalProperties:o}=fe();let g=!1,h=null,b=0,_=null,w=null,u=0;const d=c(0),L=c(0),S=c(!1),C=c(!0),k=c(!0);let s=null,m=null,p=1,v=50;const i=c({current:p,pageSize:v,defaultCurrent:1,defaultPageSize:50,total:0,pageSizeOptions:[50,100,1e3]}),f=Y=>r&&r.isStarMember(b,Y),I=async Y=>{i.value={...i.value,current:Y.current,pageSize:Y.pageSize},await n.push({query:{...l.query,page:Y.current,page_size:Y.pageSize}})},$=Y=>{if(Y==null)return"-";const F=Math.floor(Y/3600).toString().padStart(2,"0"),pe=Math.floor(Y%3600/60).toString().padStart(2,"0"),te=(Y%60).toFixed(0).toString().padStart(2,"0");return`${F}:${pe}:${te}`},P=c({});let y={userId:0,ac:-1};const j=[{title:"Rank",colKey:"rank",align:"center",fixed:"left"},{title:"昵称",colKey:"nickname",fixed:"left",attrs:Y=>{let F={};return f(Y.row.userId)&&(F={backgroundColor:"rgba(255,165,30,0.5)"}),{style:F}},cell:(Y,F)=>{const pe=Wl(F.row.nickname,18);let te=null;return f(F.row.userId)?te=t(H,{shape:"circle",variant:"text",class:"rank-unstar-button",onClick:()=>{r.removeStarMember(b,F.row.userId),he()}},{icon:()=>t(ul,null,null)}):te=t(H,{shape:"circle",variant:"text",class:"rank-star-button",onClick:()=>{r.addStarMember(b,F.row.userId),he()}},{icon:()=>t(dl,null,null)}),t("div",{class:"rank-nickname-cell"},[t(Se,null,{default:()=>[t(jl,{content:F.row.nickname},{default:()=>[t(H,{variant:"text",onClick:()=>n.push({name:"user",params:{username:F.row.username}})},va(pe)?pe:{default:()=>[pe]})]}),te]})])}},{title:"Solved",colKey:"solved",align:"center",fixed:"left",cell:(Y,F)=>t(H,{variant:"text",onClick:()=>n.push({name:"contest-judge",params:{contestId:b},query:{username:F.row.username,status:Be.Accept}})},{default:()=>[F.row.solved]})},{title:"Penalty",colKey:"penalty",align:"center",fixed:"left",cell:(Y,F)=>$(F.row.penalty)}],T=c([]),D=c(!1);let x=[],z=[];const A=c([]);let K=[];const O=({col:Y,rowIndex:F})=>{if(Y.colKey==="rank"){let pe=i.value.current;i.value.current>Math.ceil(A.value.length/i.value.pageSize)&&(pe=Math.ceil(A.value.length/i.value.pageSize));let te=i.value.pageSize*(pe-1),W=1;for(let ae=F+1;te+ae<A.value.length&&A.value[te+ae].rank===A.value[te+F].rank;ae++)W++;return{rowspan:W}}},Q=(Y,{value:F})=>ut(F),Z=()=>{s&&clearInterval(s),s=setInterval(()=>{g&&M(!1)},3e4),m&&clearInterval(m),m=setInterval(()=>{if(!g||!_)return;d.value=(new Date().getTime()-_.getTime())/1e3;const Y=Math.min(d.value,L.value);d.value=Math.min(d.value,Y),he()},1e3)},se=()=>{s&&(clearInterval(s),s=null),m&&(clearInterval(m),m=null)},J=async Y=>{k.value=Y,Y?(await M(!1),Z()):se()},de=()=>{he(),i.value={...i.value,current:1}},he=()=>{A.value=[];let Y=[];if(y={},!_)return;for(let G=0;G<x.length;G++){const ie=x[G];let we={userId:ie.inserter,username:ie.inserter_username,nickname:ie.inserter_nickname},ge=0,Ve=0;ie.problems.forEach(ye=>{let Ne=-1,lt=ye.lock||0;if(ye.attempt=ye.attempt||0,ye.ac){let rt=0;if(_&&(rt=_.getTime()),Ne=(new Date(ye.ac).getTime()-rt)/1e3,Ne>d.value)return;ge++,Ve+=Ne,Ve+=ye.attempt*20*60,y[ye.index]===void 0?y[ye.index]={userId:ie.inserter,ac:Ne}:y[ye.index].ac>Ne&&(y[ye.index].userId=ie.inserter,y[ye.index].ac=Ne)}if(lt>0&&u>0){const rt=L.value-u;d.value<rt&&(lt=0)}const st=ye.index;we[`problem_${st}`]={acDuration:Ne,attempt:ye.attempt||0,lock:lt}}),we.solved=ge,we.penalty=Ve,Y.push(we)}Y.sort((G,ie)=>G.solved!==ie.solved?ie.solved-G.solved:G.penalty!==ie.penalty?G.penalty-ie.penalty:G.userId-ie.userId);const F=z;let pe=0,te=0,W=-1,ae=-1;for(let G=0;G<Y.length;G++)F&&F.includes(Y[G].userId)?Y[G].rank="*":(te++,(Y[G].solved!==W||Y[G].penalty!==ae)&&(pe=te,W=Y[G].solved,ae=Y[G].penalty),Y[G].rank=String(pe));S.value&&(Y=Y.filter(G=>f(G.userId)));const ve=document.querySelectorAll("tbody tr"),Ie={};K.forEach((G,ie)=>{const we=ve[ie];we&&(Ie[G.userId]=we.getBoundingClientRect())}),i.value={...i.value,total:Y.length},A.value=Y;for(let G=0;G<A.value.length;G++)A.value[G].index=G+1;if(K=[...A.value],C.value){const G={},ie=document.querySelectorAll("table tbody tr");A.value.forEach((we,ge)=>{const Ve=ie[ge];Ve&&(G[we.userId]=Ve.getBoundingClientRect())}),requestAnimationFrame(()=>{const we=document.querySelectorAll("table tbody tr");A.value.forEach((ge,Ve)=>{const ye=we[Ve],Ne=Ie[ge.userId],lt=G[ge.userId];if(Ne&&lt){const st=Ne.top-lt.top;st!==0&&(ye.style.transition="none",ye.style.transform=`translateY(${st}px)`)}}),requestAnimationFrame(()=>{document.querySelectorAll("table tbody tr").forEach(Ve=>{Ve.style.transition="transform 300ms ease",Ve.style.transform=""})})})}},Pe=Y=>{if(J(!1),!_)return;d.value=Y;const F=Math.min(L.value,(new Date().getTime()-(_==null?void 0:_.getTime()))/1e3);d.value=Math.min(d.value,F),he()},M=async Y=>{Y&&(D.value=!0);try{const F=await Uo(b);if(T.value=[...j],x=[],z=[],A.value=[],i.value={...i.value,total:0},F.code===0){if(!F.data.has_auth){ke(o,"您目前没有权限查看比赛排名"),await n.push({name:"contest-detail",params:{contestId:b}});return}F.data.contest.problems.sort((W,ae)=>W-ae),F.data.contest.problems.forEach((W,ae)=>{T.value.push({colKey:`problem_${W}`,align:"center",title:()=>{let ve;return t(H,{variant:"text",onClick:()=>n.push({name:"contest-problem-detail",params:{contestId:b,problemIndex:W}})},va(ve=tt(W))?ve:{default:()=>[ve]})},cell:(ve,Ie)=>{const G=Ie.row[`problem_${W}`];if(!G)return"";let ie="";return G.acDuration>=0&&(ie=$(G.acDuration)),G.attempt>0&&(ie&&(ie+=" "),ie+=`(-${G.attempt})`),G.lock>0&&(ie&&(ie+=" "),ie+=`(+${G.lock})`),t("span",null,[ie])},attrs:ve=>{const Ie=ve.row[`problem_${W}`];if(!Ie)return{};if(Ie.acDuration>=0){const G=y[W];if(G!==void 0){const ie=ve.row.userId;if(G.userId===ie)return{style:{backgroundColor:"rgba(65,155,5,0.5)"}}}return{style:{backgroundColor:"rgba(130,255,30,0.5)"}}}return Ie.lock>0?{style:{backgroundColor:"rgb(255,180,50,0.5)"}}:Ie.attempt>0?{style:{backgroundColor:"rgba(255,120,120,0.5)"}}:{}}})});const pe=F.data.contest;if(_=new Date(pe.start_time),w=new Date(pe.end_time),x=F.data.ranks,z=F.data.v_members||[],L.value=Math.floor((w.getTime()-_.getTime())/1e3),P.value={0:"0",[Math.floor(L.value/2)]:ut(Math.floor(L.value/2)),[L.value]:ut(L.value)},u=Ga(pe.lock_rank_duration||0),F.data.is_locked&&u>0){const W=Math.max(0,L.value-u);P.value[W]=t("span",{style:"color: #0052d9"},[V("锁榜("),ut(W),V(")")])}d.value=Math.floor((new Date().getTime()-_.getTime())/1e3);const te=Math.min(d.value,L.value);d.value=Math.min(d.value,te),k.value=!0,Z(),he()}else Y&&N(o,F.code)}catch(F){console.error(F),Y&&N(o,He())}finally{Y&&(D.value=!1)}};return ce(async()=>{g=!0,h=ze(()=>l.query,async Y=>{if(Array.isArray(l.params.contestId)?b=Number(l.params.contestId[0]):b=Number(l.params.contestId),!b){await n.push({name:"contest"});return}const F=parseInt(Y.page)||i.value.defaultCurrent,pe=parseInt(Y.page_size)||i.value.defaultPageSize;p=F,v=pe,i.value={...i.value,current:p,pageSize:v},await M(!0)},{immediate:!0})}),je(()=>{g=!1,h&&h(),se()}),(Y,F)=>{const pe=bt,te=Se,W=$l,ae=Fe,ve=be,Ie=Te;return U(),E(Ie,null,{default:a(()=>[t(ve,{style:{margin:"10px",width:"100%"}},{default:a(()=>[R("div",vr,[V(" 榜单时间 "+q(me(ut)(d.value))+" ",1),R("div",_r,[t(te,null,{default:a(()=>[t(pe,{size:"large",modelValue:S.value,"onUpdate:modelValue":F[0]||(F[0]=G=>S.value=G),onChange:de},{label:a(G=>[V(q(G.value?"仅展示收藏":"未过滤收藏"),1)]),_:1},8,["modelValue"]),t(pe,{size:"large",modelValue:C.value,"onUpdate:modelValue":F[1]||(F[1]=G=>C.value=G)},{label:a(G=>[V(q(G.value?"开启动画":"关闭动画"),1)]),_:1},8,["modelValue"]),t(pe,{size:"large",modelValue:k.value,"onUpdate:modelValue":F[2]||(F[2]=G=>k.value=G),onChange:J},{label:a(G=>[V(q(G.value?"自动刷新":"关闭刷新"),1)]),_:1},8,["modelValue"])]),_:1})]),t(W,{modelValue:d.value,"onUpdate:modelValue":F[3]||(F[3]=G=>d.value=G),marks:P.value,max:L.value,label:Q,"tooltip-props":{placement:"top"},onChangeEnd:Pe},null,8,["modelValue","marks","max"])]),R("div",gr,[t(ae,{data:A.value,columns:T.value,"row-key":"index","vertical-align":"middle",bordered:!0,hover:!0,"table-layout":"auto","rowspan-and-colspan":O,loading:D.value,class:"dida-contest-rank-table",pagination:i.value,onPageChange:I},null,8,["data","columns","loading","pagination"])])]),_:1})]),_:1})}}}),hr=oe(br,[["__scopeId","data-v-8d1f31d5"]]),yr={style:{margin:"10px"}},wr={style:{margin:"12px"}},kr={class:"dida-edit-container"},Sr={class:"dida-description-editor"},Cr=re({__name:"ContestEdit",setup(e){let l=Ce();const{globalProperties:n}=fe(),r=Ze(),o=c(0),g=c(!1),h=c(!1),b=c("1"),_=c(!1),w=c(null),u=c({title:"",openTime:[],private:!0,password:"",problems:[],members:[],description:"",notification:"",lockRankDuration:0,alwaysLock:!0,submitAnytime:!1}),d=c(""),L=c(""),S=c(!1),C=async()=>{S.value=!0,_.value=!1,S.value=!1},k=async(i,f)=>{h.value=!0,await ct(i,f,n,()=>$o(o.value)),h.value=!1},s=async()=>{h.value=!0;try{const i={title:u.value.title,description:u.value.description,notification:u.value.notification,lock_rank_duration:u.value.lockRankDuration,always_lock:u.value.alwaysLock,problems:u.value.problems,members:u.value.members,private:u.value.private,password:u.value.password,submit_anytime:u.value.submitAnytime};u.value.openTime[0]&&(i.start_time=new Date(u.value.openTime[0])),u.value.openTime[1]&&(i.end_time=new Date(u.value.openTime[1]));const f=await Ao(i);if(h.value=!0,f.code!==0){N(n,f.code);return}f.data!=null&&await X.push({name:"contest-detail",params:{contestId:f.data}}),Ge(n,"创建成功")}finally{h.value=!1}},m=async()=>{h.value=!0;try{const i={id:Number(o.value),title:u.value.title,notification:u.value.notification,lock_rank_duration:u.value.lockRankDuration,always_lock:u.value.alwaysLock,problems:u.value.problems,members:u.value.members,private:u.value.private,password:u.value.password,submit_anytime:u.value.submitAnytime,description:u.value.description};u.value.openTime[0]&&(i.start_time=new Date(u.value.openTime[0])),u.value.openTime[1]&&(i.end_time=new Date(u.value.openTime[1]));const f=await zo(i);if(h.value=!0,f.code!==0){N(n,f.code);return}w.value&&(f.data.description!=null&&(u.value.description=f.data.description),f.data.update_time!=null&&(w.value.modifyTime=new Date(f.data.update_time).toLocaleString())),Ge(n,"保存成功")}finally{h.value=!1}},p=i=>{u.value.description=i,g.value=!1},v=async()=>{const i=await Vo(o.value);if(i.code!==0){N(n,i.code),console.error("contest get failed",i.code),await X.push({name:"contest-list"});return}const f=i.data.contest;w.value=Zt(f),u.value.title=f.title,u.value.openTime=[],f.start_time?u.value.openTime.push(new Date(f.start_time)):u.value.openTime.push(""),f.end_time?u.value.openTime.push(new Date(f.end_time)):u.value.openTime.push(""),u.value.private=f.private,u.value.password=f.password||"",u.value.description=f.description||"",u.value.notification=f.notification||"",u.value.problems=f.problems,u.value.members=i.data.members,f.lock_rank_duration?u.value.lockRankDuration=Ga(f.lock_rank_duration):u.value.lockRankDuration=0,u.value.alwaysLock=f.always_lock,u.value.submitAnytime=f.submit_anytime,r.setTitle(f.title+" - "+r.getTitle);let I="";f.description&&(I=f.description),p(I)};return ce(async()=>{Array.isArray(l.params.contestId)?o.value=Number(l.params.contestId[0]):o.value=Number(l.params.contestId),o.value?(g.value=!0,await v()):p("")}),(i,f)=>{const I=Ke,$=Ee,P=Bt,y=bt,j=Pa,T=Re,D=Ul,x=Ll,z=be,A=De,K=H,O=Se,Q=Ye,Z=We,se=Te,J=Me("md-editor-v3"),de=$e,he=Vt,Pe=ot;return U(),ee(ue,null,[t(de,{loading:g.value},{default:a(()=>[t(se,null,{default:a(()=>[t(A,{span:8},{default:a(()=>[R("div",yr,[t(z,{class:"sh-card"},{default:a(()=>[t(x,{modelValue:b.value,"onUpdate:modelValue":f[10]||(f[10]=M=>b.value=M)},{default:a(()=>[t(D,{value:"1",label:"基础信息",style:{padding:"10px"}},{default:a(()=>[t(T,{model:u.value,"label-width":"150px"},{default:a(()=>[t($,{label:"标题"},{default:a(()=>[t(I,{modelValue:u.value.title,"onUpdate:modelValue":f[0]||(f[0]=M=>u.value.title=M),placeholder:"比赛标题"},null,8,["modelValue"])]),_:1}),t($,{label:"通知"},{default:a(()=>[t(I,{modelValue:u.value.notification,"onUpdate:modelValue":f[1]||(f[1]=M=>u.value.notification=M),placeholder:"会更为醒目地提醒"},null,8,["modelValue"])]),_:1}),t($,{label:"开启时间"},{default:a(()=>[t(P,{modelValue:u.value.openTime,"onUpdate:modelValue":f[2]||(f[2]=M=>u.value.openTime=M),"allow-input":"",clearable:"",format:"YYYY-MM-DD HH:mm:ss","default-time":["00:00:00","23:59:59"]},null,8,["modelValue"])]),_:1}),t($,{label:"提交限制"},{default:a(()=>[t(y,{modelValue:u.value.submitAnytime,"onUpdate:modelValue":f[3]||(f[3]=M=>u.value.submitAnytime=M)},{label:a(M=>[V(q(M.value?"结束仍能提交":"仅比赛期间提交"),1)]),_:1},8,["modelValue"])]),_:1}),t($,{label:"锁榜时长"},{default:a(()=>[t(j,{modelValue:u.value.lockRankDuration,"onUpdate:modelValue":f[4]||(f[4]=M=>u.value.lockRankDuration=M),min:0,format:me(ut),"auto-width":""},null,8,["modelValue","format"])]),_:1}),t($,{label:"自动解锁"},{default:a(()=>[t(y,{modelValue:u.value.alwaysLock,"onUpdate:modelValue":f[5]||(f[5]=M=>u.value.alwaysLock=M)},{label:a(M=>[V(q(M.value?"结束后仍锁榜":"结束后解锁"),1)]),_:1},8,["modelValue"])]),_:1}),t($,{label:"私有"},{default:a(()=>[t(y,{modelValue:u.value.private,"onUpdate:modelValue":f[6]||(f[6]=M=>u.value.private=M)},null,8,["modelValue"])]),_:1}),u.value.private?(U(),E($,{key:0,label:"密码"},{default:a(()=>[t(I,{modelValue:u.value.password,"onUpdate:modelValue":f[7]||(f[7]=M=>u.value.password=M),type:"password",autocomplete:"current-password",placeholder:"请输入访问密码，留空代表关闭密码访问"},null,8,["modelValue"])]),_:1})):le("",!0)]),_:1},8,["model"])]),_:1}),t(D,{value:"2",label:"问题",style:{padding:"10px"}},{default:a(()=>[t(Na,{modelValue:u.value.problems,"onUpdate:modelValue":f[8]||(f[8]=M=>u.value.problems=M)},null,8,["modelValue"])]),_:1}),u.value.private?(U(),E(D,{key:0,value:"3",label:"成员",style:{padding:"10px"}},{default:a(()=>[t(Oa,{modelValue:u.value.members,"onUpdate:modelValue":f[9]||(f[9]=M=>u.value.members=M)},null,8,["modelValue"])]),_:1})):le("",!0)]),_:1},8,["modelValue"])]),_:1})])]),_:1}),t(A,{span:4},{default:a(()=>[R("div",wr,[R("div",kr,[o.value?(U(),E(O,{key:0},{default:a(()=>[t(K,{onClick:m,theme:"danger",loading:h.value},{default:a(()=>f[14]||(f[14]=[V("保存")])),_:1},8,["loading"])]),_:1})):(U(),E(O,{key:1},{default:a(()=>[t(K,{onClick:s,theme:"danger",loading:h.value},{default:a(()=>f[15]||(f[15]=[V("创建")])),_:1},8,["loading"])]),_:1}))]),o.value?(U(),E(Z,{key:0,layout:"vertical",bordered:!0},{default:a(()=>[t(Q,{label:"创建时间"},{default:a(()=>{var M;return[V(q((M=w.value)==null?void 0:M.insertTime),1)]}),_:1}),t(Q,{label:"编辑时间"},{default:a(()=>{var M;return[V(q((M=w.value)==null?void 0:M.modifyTime),1)]}),_:1}),t(Q,{label:"创建用户"},{default:a(()=>{var M;return[V(q((M=w.value)==null?void 0:M.inserterNickname),1)]}),_:1}),t(Q,{label:"编辑用户"},{default:a(()=>{var M;return[V(q((M=w.value)==null?void 0:M.modifierNickname),1)]}),_:1})]),_:1})):le("",!0)])]),_:1})]),_:1}),R("div",Sr,[f[16]||(f[16]=R("p",null,"公告",-1)),t(J,{id:"contest-description-editor",modelValue:u.value.description,"onUpdate:modelValue":f[11]||(f[11]=M=>u.value.description=M),onSave:m,onOnUploadImg:k,previewTheme:"cyanosis"},null,8,["modelValue"]),t(de,{loading:h.value,attach:"#contest-description-editor","z-index":1e5},null,8,["loading"])])]),_:1},8,["loading"]),t(Pe,{visible:_.value,"onUpdate:visible":f[13]||(f[13]=M=>_.value=M),onConfirm:C,header:d.value,"confirm-loading":S.value},{default:a(()=>[f[17]||(f[17]=R("div",{style:{"margin-bottom":"10px"}},[R("span",null,"多条请换行隔开")],-1)),t(he,{modelValue:L.value,"onUpdate:modelValue":f[12]||(f[12]=M=>L.value=M),autosize:{minRows:5}},null,8,["modelValue"])]),_:1},8,["visible","header","confirm-loading"])],64)}}}),_a=oe(Cr,[["__scopeId","data-v-cd3d0d0c"]]);function ea(e){const l={};return l.id=e.id,l.inserter=e.inserter,l.inserterUsername=e.inserter_username,l.inserterNickname=e.inserter_nickname,l.title=e.title,l.content=e.content,e.insert_time&&(l.insertTime=new Date(e.insert_time).toLocaleString()),e.modify_time&&(l.modifyTime=new Date(e.modify_time).toLocaleString()),e.update_time&&(l.updateTime=new Date(e.update_time).toLocaleString()),l.problemId=e.problem_id,l.problemKey=e.problem_key,l.problemTitle=e.problem_title,l.contestId=e.contest_id,l.contestTitle=e.contest_title,l.contestProblemIndex=e.contest_problem_index,l}function Pr(e){const l={};return l.id=e.id,l.inserter=e.inserter,l.inserterUsername=e.inserter_username,l.inserterNickname=e.inserter_nickname,l.content="",e.content&&(l.content=e.content),e.insert_time&&(l.insertTime=new Date(e.insert_time).toLocaleString()),e.modify_time&&(l.modifyTime=new Date(e.modify_time).toLocaleString()),e.update_time&&(l.updateTime=new Date(e.update_time).toLocaleString()),l}function Ir(e){return B({url:"/discuss?id="+e,method:"get"})}function Tr(e){return B({url:"/discuss/edit?id="+e,method:"get"})}function xr(e,l,n,r,o,g,h){const b={};return e?b.only_problem="1":b.only_problem="0",l&&(b.contest_id=l),n&&(b.problem_id=n),r&&(b.title=r),o&&(b.username=o),g&&(b.page=g),h&&(b.page_size=h),B({url:`/discuss/list?${new URLSearchParams(b).toString()}`,method:"get"})}function Vr(e){return e||(e=0),B({url:"/discuss/image/token?id="+e,method:"get"})}function Dr(e,l){return e||(e=0),l||(l=0),B({url:"/discuss/comment/image/token?id="+e+"&comment_id="+l,method:"get"})}function $r(e,l,n){return B({url:"/discuss/comment/list?id="+e+"&page="+l+"&page_size="+n,method:"get"})}function jr(e){return B({url:"/discuss/create",method:"post",data:e})}function Lr(e){return B({url:"/discuss/edit",method:"post",data:e})}function Ur(e){return B({url:"/discuss/comment/create",method:"post",data:e})}function Ar(e){return B({url:"/discuss/comment/edit",method:"post",data:e})}const zr={style:{margin:"10px"}};function Rr(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!at(e)}const Er=re({__name:"DiscussList",setup(e){const l=Ce(),n=Xe(),{globalProperties:r}=fe();let o=!1,g=null,h=-1,b=c(!1);const _=c([]),w=[],u=[{title:"标题",colKey:"title",cell:($,P)=>t(H,{variant:"text",onClick:()=>p(P.row.id)},{default:()=>[P.row.title]})},{title:"创建人",colKey:"inserterNickname",width:"200",cell:($,P)=>t(H,{variant:"text",onClick:async()=>await Xt(n,P.row.inserterUsername)},{default:()=>[P.row.inserterNickname]})},{title:"创建时间",colKey:"insertTime",width:"180"},{title:"更新时间",colKey:"updateTime",width:"180"}],d=c(!1);let L=1,S=50;const C=c({current:L,pageSize:S,defaultCurrent:L,defaultPageSize:S,total:0,pageSizeOptions:[50,100]}),k=c(),s=c({problemId:"",title:"",username:""}),m=($,P)=>{n.push({name:"contest-problem-detail",params:{contestId:$,problemIndex:P}})},p=$=>{if($){if(h){n.push({name:"contest-discuss-detail",params:{contestId:h,discussId:$}});return}n.push({name:"discuss-detail",params:{discussId:$}})}},v=async()=>{await n.push({query:{...l.query,problem_id:s.value.problemId,title:s.value.title,username:s.value.username,page:1,page_size:C.value.defaultPageSize}})},i=async($,P)=>{var y;d.value=!0;try{const{current:j,pageSize:T}=$,D=await xr(b.value,h,s.value.problemId,s.value.title,s.value.username,j,T);if(k.value=[],D.code===0){if(!D.data.has_auth){ke(r,"您目前没有权限查看讨论列表"),h?await n.push({name:"contest-detail",params:{contestId:h}}):await n.push({name:"discuss-list"});return}if(D.data.list){const x=D.data.list;for(let z=0;z<x.length;z++){const A=x[z],K=await ea(A);(y=k.value)==null||y.push(K)}}C.value={...C.value,total:D.data.total_count}}else P&&N(r,D.code)}catch(j){console.error(j),N(r,He())}finally{d.value=!1}},f=async $=>{await n.push({query:{...l.query,page:$.current,page_size:$.pageSize}})},I=async()=>{await n.push({name:"discuss-create"})};return ce(async()=>{o=!0,g=ze(()=>l.query,$=>{if(!o)return;b.value=l.name==="discuss-list-problem",Array.isArray(l.params.contestId)?h=Number(l.params.contestId[0]):h=Number(l.params.contestId),_.value=w,h?_.value=_.value.concat([{title:"问题标识",colKey:"contestProblemIndex",width:"100",cell:(j,T)=>{let D;return T.row.contestProblemIndex?t(H,{variant:"text",onClick:()=>m(h,T.row.contestProblemIndex)},Rr(D=tt(T.row.contestProblemIndex))?D:{default:()=>[D]}):""}}]):_.value=_.value.concat([{title:"问题标识",colKey:"problemKey",width:"100",cell:(j,T)=>T.row.problemKey?t(H,{variant:"text",onClick:()=>Ot(T.row.problemKey)},{default:()=>[T.row.problemKey]}):""}]),_.value=_.value.concat(u),s.value.problemId=$.problem_id||"",s.value.title=$.title||"",s.value.username=$.username||"";const P=parseInt($.page)||C.value.defaultCurrent,y=parseInt($.page_size)||C.value.defaultPageSize;L=P,S=y,C.value={...C.value,current:L,pageSize:S},i({current:L,pageSize:S},!0)},{immediate:!0})}),je(()=>{o=!1,g&&g()}),($,P)=>{const y=Fe,j=be,T=De,D=Ke,x=Ee,z=H,A=Re,K=Se,O=Te;return U(),E(O,null,{default:a(()=>[t(T,{span:9},{default:a(()=>[t(j,{style:{margin:"10px"}},{default:a(()=>[t(y,{data:k.value,columns:_.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:C.value,loading:d.value,"table-layout":"auto",onPageChange:f},null,8,["data","columns","pagination","loading"])]),_:1})]),_:1}),t(T,{span:3},{default:a(()=>[R("div",zr,[t(j,{class:"sh-card"},{default:a(()=>[t(A,{model:s.value},{default:a(()=>[t(x,{label:"问题标识"},{default:a(()=>[t(D,{modelValue:s.value.problemId,"onUpdate:modelValue":P[0]||(P[0]=Q=>s.value.problemId=Q),placeholder:"请输入完整问题标识"},null,8,["modelValue"])]),_:1}),t(x,{label:"标题"},{default:a(()=>[t(D,{modelValue:s.value.title,"onUpdate:modelValue":P[1]||(P[1]=Q=>s.value.title=Q),placeholder:"暂不支持模糊查询"},null,8,["modelValue"])]),_:1}),t(x,{label:"创建人"},{default:a(()=>[t(D,{modelValue:s.value.username,"onUpdate:modelValue":P[2]||(P[2]=Q=>s.value.username=Q),placeholder:"仅支持输入完整用户名"},null,8,["modelValue"])]),_:1}),t(x,null,{default:a(()=>[t(z,{theme:"primary",onClick:v},{default:a(()=>P[3]||(P[3]=[V("提交")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(j,{class:"sh-card"},{default:a(()=>[t(K,null,{default:a(()=>[t(z,{onClick:I},{default:a(()=>P[4]||(P[4]=[V("创建")])),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})}}}),Et=oe(Er,[["__scopeId","data-v-626923dc"]]),Kr={key:0,style:{margin:"20px"}},Mr={class:"dida-operation-container"},qr={class:"dida-operation-container"},Fr={style:{margin:"10px"}},Nr={style:{margin:"10px"}},Or={style:{margin:"10px"},class:"dida-operation-container"},Gr={style:{margin:"12px"}},Hr={key:0,class:"dida-edit-container"},Br=re({__name:"DiscussDetail",props:{discussId:{}},setup(e){const l=e;let n=Ce();const{globalProperties:r}=fe();let o=!1,g=null;const h=Ze(),b=qe();let _=c("");const w=c(0),u=c(!1),d=c(null),L=c(!1),S=c(!1),C=c(0),k=c("");let s=1,m=20;const p=c({current:1,pageSize:20,total:0,defaultPageSize:m,defaultCurrent:s,pageSizeOptions:[20,50]}),v=c([]),i=Je(()=>b.hasAuth(Ue.ManageDiscuss)),f=Je(()=>b.hasAuth(Ue.ManageDiscuss)||d.value&&b.getUserId==d.value.inserter),I=()=>{X.push({name:"discuss-edit",params:{discussId:w.value}})},$=()=>t("div",{class:"t-pagination__total"},[`共 ${p.value.total} 条回复`]),P=(z,A)=>{C.value=z,k.value=A;const K=document.getElementById("discuss-comment-editor");K&&K.scrollIntoView({behavior:"smooth"})},y=()=>{C.value=0,k.value="";const z=document.getElementById("discuss-comment-editor");z&&z.scrollIntoView({behavior:"smooth"})},j=async()=>{S.value=!0;try{let z;if(C.value){const A={id:C.value,discuss_id:w.value,content:k.value};if(z=await Ar(A),z.code!==0){N(r,z.code);return}Ge(r,"编辑成功"),C.value=0,k.value="",s===1?await D({current:1,pageSize:m},!0):await X.push({query:{current:1}});const K=document.getElementById("comment-divider");K&&K.scrollIntoView({behavior:"smooth"})}else{const A={discuss_id:w.value,content:k.value};if(z=await Ur(A),z.code!==0){N(r,z.code);return}Ge(r,"编辑成功"),C.value=0,k.value="",s===1?await D({current:1,pageSize:m},!0):await X.push({query:{current:1}});const K=document.getElementById("comment-divider");K&&K.scrollIntoView({behavior:"smooth"})}}finally{S.value=!1}},T=async(z,A)=>{S.value=!0,await ct(z,A,r,()=>Dr(w.value,C.value)),S.value=!1},D=async(z,A)=>{var K;L.value=!0;try{const{current:O,pageSize:Q}=z,Z=await $r(w.value,O,Q);if(v.value=[],Z.code===0){const se=Z.data.list;if(se)for(let J=0;J<se.length;J++){const de=se[J],he=Pr(de);(K=v.value)==null||K.push(he)}p.value={...p.value,total:Z.data.total_count}}else A&&N(r,Z.code)}catch(O){console.error(O),N(r,He())}finally{L.value=!1}},x=async z=>{await X.push({query:{...n.query,page:z.current,page_size:z.pageSize}})};return ce(async()=>{if(o=!0,w.value=Number(l.discussId),w.value||(Array.isArray(n.params.discussId)?w.value=Number(n.params.discussId[0]):w.value=Number(n.params.discussId)),!w.value){_e(r,"讨论不存在"),await X.push({name:"discuss"});return}u.value=!0;const z=await Ir(w.value);if(z.code!==0){u.value=!1,N(r,z.code),await X.push({name:"discuss"});return}d.value=ea(z.data.discuss),h.setTitle(d.value.title+" - "+h.getTitle),_.value=d.value.content,u.value=!1,g=ze(()=>n.query,A=>{if(!o)return;const K=parseInt(A.page)||p.value.defaultCurrent,O=parseInt(A.page_size)||p.value.defaultPageSize;s=K,m=O,p.value={...p.value,current:s,pageSize:m},D({current:s,pageSize:m},!0)},{immediate:!0})}),je(()=>{o=!1,g&&g()}),(z,A)=>{const K=Ta,O=Ia,Q=Me("md-preview"),Z=be,se=Al,J=Se,de=H,he=zl,Pe=Qe,M=Me("md-editor-v3"),Y=$e,F=De,pe=Ye,te=We,W=Te;return U(),E(Y,{loading:u.value},{default:a(()=>[t(W,{class:"dida-main-content"},{default:a(()=>[t(F,{span:8},{default:a(()=>{var ae,ve,Ie;return[(ae=d.value)!=null&&ae.problemTitle||(ve=d.value)!=null&&ve.contestTitle?(U(),ee("div",Kr,[t(O,{"max-item-width":"300"},{default:a(()=>{var G,ie,we,ge,Ve;return[(G=d.value)!=null&&G.contestTitle?(U(),ee(ue,{key:0},[t(K,{to:{name:"contest-detail",params:{contestId:(ie=d.value)==null?void 0:ie.contestId}}},{default:a(()=>{var ye;return[V(q((ye=d.value)==null?void 0:ye.contestTitle),1)]}),_:1},8,["to"]),(we=d.value)!=null&&we.contestProblemIndex?(U(),E(K,{key:0,to:{name:"contest-problem-detail",params:{problemIndex:(ge=d.value)==null?void 0:ge.contestProblemIndex}}},{default:a(()=>{var ye,Ne;return[V(q(me(tt)((ye=d.value)==null?void 0:ye.contestProblemIndex))+" - "+q((Ne=d.value)==null?void 0:Ne.problemTitle),1)]}),_:1},8,["to"])):le("",!0)],64)):(U(),ee(ue,{key:1},[t(K,{to:{name:"discuss-list-problem"}},{default:a(()=>A[4]||(A[4]=[V(" 题目讨论")])),_:1}),t(K,{to:{name:"problem-detail",params:{problemId:(Ve=d.value)==null?void 0:Ve.problemId}}},{default:a(()=>{var ye;return[V(q((ye=d.value)==null?void 0:ye.problemTitle),1)]}),_:1},8,["to"])],64))]}),_:1})])):le("",!0),t(Z,{style:{margin:"10px"},header:(Ie=d.value)==null?void 0:Ie.title,"header-bordered":!0},{default:a(()=>[t(Q,{"model-value":me(_),previewTheme:"cyanosis"},null,8,["model-value"])]),_:1},8,["header"]),t(se,{id:"comment-divider"},{default:a(()=>A[5]||(A[5]=[V("评论区")])),_:1}),(U(!0),ee(ue,null,xe(v.value,(G,ie)=>(U(),E(Z,{key:ie,style:{margin:"10px"},"header-bordered":""},{header:a(()=>[R("div",Mr,[t(J,null,{default:a(()=>[R("span",null,q(G.inserterNickname),1),R("span",null,q(G.insertTime),1)]),_:2},1024)]),R("div",qr,[t(J,null,{default:a(()=>[i.value||me(b).getUserId===G.inserter?(U(),E(de,{key:0,onClick:()=>{P(G.id,G.content)}},{default:a(()=>A[6]||(A[6]=[V(" 编辑 ")])),_:2},1032,["onClick"])):le("",!0)]),_:2},1024)])]),default:a(()=>[t(Q,{"model-value":G.content,previewTheme:"cyanosis"},null,8,["model-value"])]),_:2},1024))),128)),R("div",Fr,[t(he,{modelValue:p.value.current,"onUpdate:modelValue":A[0]||(A[0]=G=>p.value.current=G),"page-size":p.value.pageSize,"onUpdate:pageSize":A[1]||(A[1]=G=>p.value.pageSize=G),total:p.value.total,"page-size-options":p.value.pageSizeOptions,"show-page-size":!1,"total-content":$,onChange:x},null,8,["modelValue","page-size","total","page-size-options"])]),t(se),R("div",Nr,[R("div",Or,[t(Pe,{style:{margin:"10px"}},{default:a(()=>[V(q(C.value?"编辑回复":"发表回复"),1)]),_:1}),t(J,null,{default:a(()=>[t(de,{theme:"danger",onClick:y},{default:a(()=>A[7]||(A[7]=[V("清除")])),_:1}),t(de,{theme:"primary",onClick:j,loading:S.value},{default:a(()=>A[8]||(A[8]=[V("提交")])),_:1},8,["loading"])]),_:1})]),t(M,{id:"discuss-comment-editor",modelValue:k.value,"onUpdate:modelValue":A[2]||(A[2]=G=>k.value=G),previewTheme:"cyanosis",onSave:j,onOnUploadImg:T},null,8,["modelValue"]),t(Y,{loading:S.value,attach:"#discuss-comment-editor","z-index":1e5},null,8,["loading"])])]}),_:1}),t(F,{span:4},{default:a(()=>[R("div",Gr,[f.value?(U(),ee("div",Hr,[t(de,{onClick:I},{default:a(()=>A[9]||(A[9]=[V("编辑")])),_:1})])):le("",!0),t(te,{layout:"vertical",bordered:!0},{default:a(()=>[t(pe,{label:"创建时间"},{default:a(()=>{var ae;return[V(q((ae=d.value)==null?void 0:ae.insertTime),1)]}),_:1}),t(pe,{label:"编辑时间"},{default:a(()=>{var ae;return[V(q((ae=d.value)==null?void 0:ae.modifyTime),1)]}),_:1}),t(pe,{label:"更新时间"},{default:a(()=>{var ae;return[V(q((ae=d.value)==null?void 0:ae.updateTime),1)]}),_:1}),t(pe,{label:"创建用户"},{default:a(()=>[t(de,{variant:"text",onClick:A[3]||(A[3]=async()=>{var ae;return await me(Xt)(me(X),(ae=d.value)==null?void 0:ae.inserterUsername)})},{default:a(()=>{var ae;return[V(q((ae=d.value)==null?void 0:ae.inserterNickname),1)]}),_:1})]),_:1}),t(pe,{label:"标签"})]),_:1})])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),Kt=oe(Br,[["__scopeId","data-v-6e73f8ab"]]),Jr={style:{margin:"10px"}},Wr={style:{margin:"12px"}},Yr={class:"dida-edit-container"},Xr={class:"dida-description-editor"},Zr=re({__name:"DiscussEdit",setup(e){let l=Ce();const{globalProperties:n}=fe();let r=null;const o=c(0),g=c(!1),h=c(!1),b=c(null),_=c({title:"",problemKey:"",content:""}),w=()=>{X.push({name:"discuss-detail",params:{discussId:o.value}})};async function u(k,s){h.value=!0,await ct(k,s,n,()=>Vr(o.value)),h.value=!1}const d=async()=>{h.value=!0;try{const k={title:_.value.title,content:_.value.content,problem_key:_.value.problemKey},s=await jr(k);if(h.value=!0,s.code!==0){N(n,s.code);return}const m=s.data;await X.push({name:"discuss-detail",params:{discussId:m}}),Ge(n,"创建成功")}finally{h.value=!1}},L=async()=>{h.value=!0;try{const k={id:o.value,title:_.value.title,content:_.value.content,problem_key:_.value.problemKey},s=await Lr(k);if(h.value=!0,s.code!==0){N(n,s.code);return}b.value&&s.data.modify_time!=null&&(b.value.modifyTime=new Date(s.data.modify_time).toLocaleString()),s.data.content!=null&&(_.value.content=s.data.content),Ge(n,"保存成功")}finally{h.value=!1}},S=async()=>{o.value?await L():await d()},C=async()=>{const k=await Tr(o.value);if(k.code!==0){N(n,k.code),await X.push({name:"discuss"});return}const s=k.data.discuss;b.value=ea(s),_.value.title=s.title,_.value.content=s.content,_.value.problemKey=s.problem_key,g.value=!1};return ce(async()=>{r=ze(()=>l.params,async()=>{Array.isArray(l.params.discussId)?o.value=Number(l.params.discussId[0]):o.value=Number(l.params.discussId),o.value?(g.value=!0,await C()):(_.value.title="",_.value.problemKey="",_.value.content="")},{immediate:!0})}),je(()=>{r&&(r(),r=null)}),(k,s)=>{const m=Ke,p=Ee,v=Re,i=be,f=De,I=H,$=Se,P=Ye,y=We,j=Te,T=Me("md-editor-v3"),D=$e;return U(),E(D,{loading:g.value},{default:a(()=>[t(j,null,{default:a(()=>[t(f,{span:8},{default:a(()=>[R("div",Jr,[t(i,{class:"sh-form-card"},{default:a(()=>[t(v,{model:_.value},{default:a(()=>[t(p,{label:"标题"},{default:a(()=>[t(m,{modelValue:_.value.title,"onUpdate:modelValue":s[0]||(s[0]=x=>_.value.title=x),placeholder:"讨论标题"},null,8,["modelValue"])]),_:1}),t(p,{label:"关联题目"},{default:a(()=>[t(m,{modelValue:_.value.problemKey,"onUpdate:modelValue":s[1]||(s[1]=x=>_.value.problemKey=x),placeholder:"讨论题目"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})])]),_:1}),t(f,{span:4},{default:a(()=>[R("div",Wr,[R("div",Yr,[o.value?(U(),E($,{key:0},{default:a(()=>[t(I,{onClick:L,theme:"danger",loading:h.value},{default:a(()=>s[3]||(s[3]=[V("保存")])),_:1},8,["loading"]),t(I,{onClick:w},{default:a(()=>s[4]||(s[4]=[V("查看")])),_:1})]),_:1})):(U(),E($,{key:1},{default:a(()=>[t(I,{onClick:d,theme:"danger",loading:h.value},{default:a(()=>s[5]||(s[5]=[V("创建")])),_:1},8,["loading"])]),_:1}))]),o.value?(U(),E(y,{key:0,layout:"vertical",bordered:!0},{default:a(()=>[t(P,{label:"创建时间"},{default:a(()=>{var x;return[V(q((x=b.value)==null?void 0:x.insertTime),1)]}),_:1}),t(P,{label:"更新时间"},{default:a(()=>{var x;return[V(q((x=b.value)==null?void 0:x.modifyTime),1)]}),_:1}),t(P,{label:"创建用户"},{default:a(()=>{var x;return[V(q((x=b.value)==null?void 0:x.authorNickname),1)]}),_:1})]),_:1})):le("",!0)])]),_:1})]),_:1}),R("div",Xr,[t(T,{id:"discuss-editor",modelValue:_.value.content,"onUpdate:modelValue":s[2]||(s[2]=x=>_.value.content=x),onSave:S,onOnUploadImg:u,previewTheme:"cyanosis"},null,8,["modelValue"]),t(D,{loading:h.value,attach:"#discuss-editor","z-index":1e5},null,8,["loading"])])]),_:1},8,["loading"])}}}),ga=oe(Zr,[["__scopeId","data-v-7aa40f02"]]);function Qr(e,l){return B({url:"/rank/ac/all?page="+e+"&page_size="+l,method:"get"})}function ei(e,l){return B({url:"/rank/ac/problem?page="+e+"&page_size="+l,method:"get"})}function ti(e,l){return B({url:"/rank/ac/problem/today?page="+e+"&page_size="+l,method:"get"})}function ai(e,l){return B({url:"/rank/ac/problem/day7?page="+e+"&page_size="+l,method:"get"})}function li(e,l){return B({url:"/rank/ac/problem/day30?page="+e+"&page_size="+l,method:"get"})}function ni(e,l){return B({url:"/rank/ac/problem/year?page="+e+"&page_size="+l,method:"get"})}const oi={style:{margin:"10px"}};function Mt(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!at(e)}const si=re({__name:"RankUser",props:{type:{}},setup(e){const l=Ce(),n=Xe(),{globalProperties:r}=fe();let o=null;const g=e,h=c(""),b=c(""),_={all:{header:"统计所有用户在本站的提交记录",content:"优先以AC记录数量排序，如果相同则提交所用次数较少的优先，如果仍相同，注册较早的用户靠前"},problem:{header:"统计所有用户在本站的提交记录",content:"以题目记录数量排序，如果相同，注册较早的用户靠前"},"problem-today":{header:"统计所有用户今日在本站的提交记录",content:"以今日题目记录数量排序，如果相同，注册较早的用户靠前"},"problem-day7":{header:"统计所有用户最近7日在本站的提交记录",content:"以7日题目记录数量排序（从7日前的0点开始计算），如果相同，注册较早的用户靠前"},"problem-day30":{header:"统计所有用户最近30日在本站的提交记录",content:"以30日题目记录数量排序（从30日前的0点开始计算），如果相同，注册较早的用户靠前"},"problem-year":{header:"统计所有用户最近1年在本站的提交记录",content:"以最近1年题目记录数量排序（从365日前的0点开始计算），如果相同，注册较早的用户靠前"}},w=c([]),u=[{title:"序号",colKey:"index"},{title:"用户名",colKey:"username",cell:($,P)=>t(H,{variant:"dashed",onClick:()=>p(P.row.username)},{default:()=>[P.row.username]})},{title:"昵称",colKey:"nickname"},{title:"Slogan",colKey:"slogan"}],d=[{title:"题目数量",colKey:"problem_count",cell:($,P)=>{let y=0;return P.row.problem_count&&(y=P.row.problem_count),t(H,{variant:"dashed",onClick:()=>v(P.row.username)},Mt(y)?y:{default:()=>[y]})}}],L=[{title:"正确",colKey:"accept",cell:($,P)=>{let y=0;return P.row.accept&&(y=P.row.accept),t(H,{variant:"dashed",onClick:()=>v(P.row.username)},Mt(y)?y:{default:()=>[y]})}},{title:"提交",colKey:"attempt",cell:($,P)=>{let y=0;return P.row.attempt&&(y=P.row.attempt),t(H,{variant:"dashed",onClick:()=>i(P.row.username)},Mt(y)?y:{default:()=>[y]})}}],S=c(!1);let C=1,k=50;const s=c({current:C,pageSize:k,defaultCurrent:C,defaultPageSize:k,total:0,pageSizeOptions:[50]}),m=c(),p=$=>{n.push({name:"user",params:{username:$}})},v=$=>{n.push({name:"judge-list",query:{username:$,status:Be.Accept}})},i=$=>{n.push({name:"judge-list",query:{username:$}})},f=async($,P)=>{S.value=!0;try{m.value=[];const{current:y,pageSize:j}=$;let T=null;switch(g.type){case"problem":T=await ei(y,j);break;case"problem-today":T=await ti(y,j);break;case"problem-day7":T=await ai(y,j);break;case"problem-day30":T=await li(y,j);break;case"problem-year":T=await ni(y,j);break;default:T=await Qr(y,j);break}if(T.code===0){const D=T.data.list;if(!D||D.length<=0){s.value={...s.value,total:0},ke(r,"未找到记录");return}m.value=[];const x=s.value.pageSize*(s.value.current-1);let z=1;D.forEach(A=>{var O;const K=A;K.index=x+z++,(O=m.value)==null||O.push(K)}),s.value={...s.value,total:T.data.total_count}}else P&&N(r,T.code)}catch(y){console.error(y),N(r,He())}finally{S.value=!1}},I=async $=>{await n.push({query:{...l.query,page:$.current,page_size:$.pageSize}})};return ce(async()=>{S.value=!0,o=ze(()=>l.query,$=>{switch(g.type&&_[g.type]?(h.value=_[g.type].header,b.value=_[g.type].content):(h.value=_.all.header,b.value=_.all.content),g.type){case"all":w.value=u.concat(L);break;default:w.value=u.concat(d);break}const P=parseInt($.page)||s.value.defaultCurrent,y=parseInt($.page_size)||s.value.defaultPageSize;C=P,k=y,s.value={...s.value,current:C,pageSize:k},f({current:C,pageSize:k},!0)},{immediate:!0})}),je(()=>{o&&o()}),($,P)=>{const y=Fe,j=be,T=De,D=Te;return U(),E(D,null,{default:a(()=>[t(T,{span:9},{default:a(()=>[t(j,{style:{margin:"10px"}},{default:a(()=>[t(y,{data:m.value,columns:w.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:s.value,loading:S.value,"table-layout":"auto",onPageChange:I},null,8,["data","columns","pagination","loading"])]),_:1})]),_:1}),t(T,{span:3},{default:a(()=>[R("div",oi,[t(j,{class:"sh-card",header:h.value,"header-bordered":!0},{default:a(()=>[V(q(b.value),1)]),_:1},8,["header"])])]),_:1})]),_:1})}}}),it=oe(si,[["__scopeId","data-v-13682529"]]),ri={style:{display:"flex","align-items":"center"}},ii={style:{color:"#409eff","margin-right":"20px"}},ui={class:"dida-login-footer"},di=re({__name:"UserForget",setup(e){const{globalProperties:l}=fe(),n=qe(),r=c(!1),o=c(!1),g=c(!1),h=c("发送验证码");let b=null,_=-1;const w=c(!1),u=c(null),d=c(""),L=c({username:"",emailKey:"",password:"",confirmPassword:""}),C=c({username:[{required:!0,message:"请填写用户名"},{min:4,message:"用户名至少4个字符"},{max:20,message:"用户名最多20个字符"},{pattern:/^[a-zA-Z0-9_]+$/,message:"用户名只能包含字母、数字和下划线"}],password:[{required:!0,message:"请填写密码"},{min:6,message:"密码至少6个字符"},{max:20,message:"密码最多20个字符"}],confirmPassword:[{required:!0,message:"请确认密码"},{validator:f=>new Promise(I=>{const $=setTimeout(()=>{I(L.value.password===f),clearTimeout($)})}),message:"两次密码不一致"}],emailKey:[{required:!0,message:"请填写验证码"},{min:6,message:"请输入完整字符"},{max:6,message:"请输入完整字符"}]}),k=()=>{ke(l,"重置成功")},s=async f=>{if(!g.value){r.value=!0,o.value=!0;try{const I=await no(f,L.value.username);I.code===0?(ke(l,"验证码发送成功"),d.value=I.data,o.value=!1,g.value=!0,b=new Date,h.value="60秒后重发",_=setInterval(()=>{const P=Math.floor((new Date().getTime()-(b==null?void 0:b.getTime()))/1e3);P>60?(h.value="发送验证码",g.value=!1,clearInterval(_)):h.value=`${60-P}秒后重发`},1e3)):N(l,I.code)}catch(I){console.error("Send email key error",I),_e(l,"发送验证码失败")}finally{r.value=!1}}},m=async()=>{var P;if(w.value=!0,g.value||o.value)return;await ft();const f=document.getElementById("cf-confirm-div");f&&f.remove();const I=document.createElement("div");I.id="cf-confirm-div",I.setAttribute("data-theme","light"),(P=u.value)==null||P.appendChild(I);const $=window;$.turnstile.ready(function(){$.turnstile.render("#cf-confirm-div",{sitekey:"0x4AAAAAABeM4SYPu2Rn7PmI",callback:async function(y){w.value=!1,await s(y)},"before-interactive-callback":function(){console.log("before-interactive-callback")}})})},p=c(()=>t(H,{onClick:m,disabled:g.value,loading:o.value,style:"width:120px"},{default:()=>[h.value]})),v=async()=>{r.value=!0;try{const f=await oo(L.value.username,L.value.password,L.value.emailKey);f.code===0?(ke(l,"密码修改成功"),l.$router.push({name:"login"})):N(l,f.code)}catch(f){console.error("Modify password error",f),_e(l,"修改密码失败")}finally{r.value=!1}},i=async({validateResult:f,firstError:I,e:$})=>{if(!r.value){if($.preventDefault(),f!==!0){_e(l,I);return}d.value?await v():await m()}};return ce(()=>{if(n.isLogin()){l.$router.push({path:"/user"});return}}),je(()=>{}),(f,I)=>{const $=xt,P=Ke,y=Ee,j=Ca,T=H,D=Re,x=nt,z=be,A=ot;return U(),ee(ue,null,[t(z,{class:"yj-login-card",title:"欢迎使用DidaOJ~"},{default:a(()=>[t($,{"max-line":1},{default:a(()=>I[6]||(I[6]=[R("span",null,"如果您未绑定邮箱或忘记用户名，可联系管理员寻求帮助",-1),R("span",null,"管理员邮箱：BoilTask@qq.com",-1)])),_:1}),t($,{style:{"margin-top":"10px"}},{default:a(()=>I[7]||(I[7]=[R("p",null,"支持原acm.hpu.edu.cn、CodeOJ的用户直接登录",-1),R("p",null,"原DMOJ、hpuoj.com的用户，请先重置密码",-1),R("p",null,"可尝试学号/昵称等作为用户名登录，成功后有机会合并账户或修改用户名",-1)])),_:1}),t(D,{ref:"form",rules:C.value,data:L.value,colon:!0,onReset:k,onSubmit:i,class:"yj-login-form"},{default:a(()=>[t(y,{name:"username",label:"用户名"},{default:a(()=>[t(P,{modelValue:L.value.username,"onUpdate:modelValue":I[0]||(I[0]=K=>L.value.username=K),clearable:"",placeholder:"请输入完整用户名"},null,8,["modelValue"])]),_:1}),d.value?(U(),ee(ue,{key:0},[t(y,{name:"email",label:"发送邮箱"},{default:a(()=>[t(j,{append:p.value},{default:a(()=>[R("div",ri,[R("span",ii,q(d.value),1)])]),_:1},8,["append"])]),_:1}),t(y,{name:"emailKey",label:"验证码"},{default:a(()=>[t(P,{modelValue:L.value.emailKey,"onUpdate:modelValue":I[1]||(I[1]=K=>L.value.emailKey=K),clearable:"",placeholder:"请输入收到的验证码"},null,8,["modelValue"])]),_:1}),t(y,{name:"password",label:"新密码"},{default:a(()=>[t(P,{modelValue:L.value.password,"onUpdate:modelValue":I[2]||(I[2]=K=>L.value.password=K),type:"password",clearable:"",placeholder:"新密码"},null,8,["modelValue"])]),_:1}),t(y,{name:"confirmPassword",label:"确认密码"},{default:a(()=>[t(P,{modelValue:L.value.confirmPassword,"onUpdate:modelValue":I[3]||(I[3]=K=>L.value.confirmPassword=K),type:"password",clearable:"",placeholder:"请重复输入密码"},null,8,["modelValue"])]),_:1})],64)):le("",!0),d.value?(U(),E(y,{key:1},{default:a(()=>[t(T,{theme:"primary",type:"submit",block:"",loading:r.value},{default:a(()=>I[8]||(I[8]=[V("修改密码")])),_:1},8,["loading"])]),_:1})):(U(),E(y,{key:2},{default:a(()=>[t(T,{theme:"primary",type:"submit",block:"",loading:r.value},{default:a(()=>I[9]||(I[9]=[V("重置密码")])),_:1},8,["loading"])]),_:1}))]),_:1},8,["rules","data"]),R("div",ui,[t(x,{onClick:I[4]||(I[4]=()=>{me(l).$router.push({name:"login"})})},{default:a(()=>I[10]||(I[10]=[V("返回登陆 ")])),_:1})])]),_:1}),t(A,{visible:w.value,"onUpdate:visible":I[5]||(I[5]=K=>w.value=K),header:"正在加载人机验证","close-btn":!1,footer:!1},{default:a(()=>[R("div",{ref_key:"dialogContainer",ref:u,class:"cf-confirm-container"},null,512)]),_:1},8,["visible"])],64)}}}),ci=oe(di,[["__scopeId","data-v-e960b193"]]),mi={class:"judger-status-panel"},pi={style:{"text-align":"center","margin-bottom":"20px"}},fi={class:"judger-status-panel"};function vi(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!at(e)}const _i=re({__name:"SystemStatus",setup(e){const{globalProperties:l}=fe(),n=c([]),r=c([]),o=c(!1),g=c(0),h=c(0),b=c(null),_=c(0),w=c(0),u=c(0);let d=-1,L;const S=s=>{let m="失效",p="danger";const v=new Date,i=new Date(s.modifyTime);return v.getTime()-i.getTime()>3e4?(m="离线",p="default"):s.cpuUsage>90?(m="CPU过高",p="warning"):s.memPercent>90?(m="内存过高",p="warning"):(m="在线",p="success"),t(Se,null,{default:()=>[t("span",null,[s.key,V(" - "),s.name]),t("span",null,[s.modifyTime]),t(Qe,{theme:p,size:"small"},vi(m)?m:{default:()=>[m]})]})},C=async()=>{const s={};for(let y=0;y<n.value.length;y++){const j=n.value[y];s[j.key]={...j}}const m={};for(let y=0;y<r.value.length;y++){const j=r.value[y];m[j.key]={...j}}const p=[],v=[],i=await rn();if(i.code!==0){N(l,i.code);return}const f=i.data.web,I={key:"didaoj"};f.name?I.name=f.name:I.name="-",f.modify_time?I.modifyTime=new Date(f.modify_time).toLocaleString():I.modifyTime="-",f.cpu_usage?I.cpuUsage=Number(f.cpu_usage):I.cpuUsage=0,f.mem_usage?I.memUsage=f.mem_usage/(1024*1024*1024):I.memUsage=0,f.mem_total?I.memTotal=f.mem_total/(1024*1024*1024):I.memTotal=0,I.memTotal>0?I.memPercent=Math.round(I.memUsage/I.memTotal*1e4)/100:I.memPercent=0,I.avgMessage=f.avg_message;const $=s[I.key];$?(I.cpuUsageFrom=$.cpuUsage,I.memPercentFrom=$.memPercent,I.memUsageFrom=$.memUsage,I.memTotalFrom=$.memTotal):(I.cpuUsageFrom=0,I.memPercentFrom=0,I.memUsageFrom=0,I.memTotalFrom=0),p.push(I),n.value=p;const P=i.data.judger;for(let y=0;y<P.length;y++){const j=P[y],T={key:j.key,name:j.name};j.name?T.name=j.name:T.name="-",j.modify_time?T.modifyTime=new Date(j.modify_time).toLocaleString():T.modifyTime="-",j.max_job?T.maxJob=Number(j.max_job):T.maxJob=0,j.cpu_usage?T.cpuUsage=Number(j.cpu_usage):T.cpuUsage=0,j.mem_usage?T.memUsage=j.mem_usage/(1024*1024*1024):T.memUsage=0,j.mem_total?T.memTotal=j.mem_total/(1024*1024*1024):T.memTotal=0,T.memTotal>0?T.memPercent=Math.round(T.memUsage/T.memTotal*1e4)/100:T.memPercent=0,T.avgMessage=j.avg_message,m[j.key]?(T.maxJobFrom=m[j.key].maxJob,T.cpuUsageFrom=m[j.key].cpuUsage,T.memPercentFrom=m[j.key].memPercent,T.memUsageFrom=m[j.key].memUsage,T.memTotalFrom=m[j.key].memTotal):(T.maxJobFrom=0,T.cpuUsageFrom=0,T.memPercentFrom=0,T.memUsageFrom=0,T.memTotalFrom=0),v.push(T)}r.value=v,g.value=h.value,h.value=i.data.judge_job,u.value=w.value,h.value>0?(b.value?w.value=(h.value-_.value)/((new Date().getTime()-b.value.getTime())/1e3)*60:(b.value=new Date,_.value=h.value,w.value=0,u.value=0),clearTimeout(d),d=-1):d<0&&(d=setTimeout(()=>{b.value=null,_.value=0},1e4))},k=async()=>{await C(),o.value=!1};return ce(async()=>{r.value=[],n.value=[],o.value=!0,await k(),clearInterval(L),L=setInterval(()=>{k()},5e3)}),je(()=>{clearInterval(L)}),(s,m)=>{const p=Rl,v=Se,i=be,f=$e;return U(),E(f,{loading:o.value},{default:a(()=>[t(i,{title:"接口状态",class:"judger-status"},{default:a(()=>[R("div",mi,[(U(!0),ee(ue,null,xe(n.value,I=>(U(),E(i,{key:I.key,header:()=>S(I),class:"judge-status-judger"},{footer:a(()=>[R("span",null," 负载信息："+q(I.avgMessage),1)]),default:a(()=>[t(v,{class:"judge-status-judger"},{default:a(()=>[t(p,{title:"CPU使用率",value:I.cpuUsage,animation:{valueFrom:I.cpuUsageFrom,duration:2e3},"animation-start":!0,unit:"%",decimalPlaces:2},null,8,["value","animation"]),t(p,{title:"内存使用率",value:I.memPercent,animation:{valueFrom:I.memPercentFrom,duration:2e3},"animation-start":!0,unit:"%",decimalPlaces:2},null,8,["value","animation"]),t(p,{title:"内存使用量",animation:{valueFrom:I.memUsageFrom,duration:2e3},"animation-start":!0,value:I.memUsage,unit:"GB",decimalPlaces:2},null,8,["animation","value"]),t(p,{title:"内存总量",value:I.memTotal,animation:{valueFrom:I.memTotalFrom,duration:2e3},"animation-start":!0,unit:"GB",decimalPlaces:2},null,8,["value","animation"])]),_:2},1024)]),_:2},1032,["header"]))),128))])]),_:1}),t(i,{title:"判题机状态",class:"judger-status"},{default:a(()=>[R("div",pi,[t(v,null,{default:a(()=>[t(p,{title:"未完成的评测数量",value:h.value,animation:{valueFrom:g.value,duration:4e3},"animation-start":!0},null,8,["value","animation"]),b.value?(U(),E(p,{key:0,title:"评测数量趋势",value:w.value,animation:{valueFrom:u.value,duration:4e3},"animation-start":!0,decimalPlaces:2,unit:"/分钟"},null,8,["value","animation"])):(U(),E(p,{key:1,title:"评测数量趋势",format:()=>"样本较少"}))]),_:1})]),R("div",fi,[(U(!0),ee(ue,null,xe(r.value,I=>(U(),E(i,{key:I.key,header:()=>S(I),class:"judge-status-judger"},{footer:a(()=>[R("span",null," 负载信息："+q(I.avgMessage),1)]),default:a(()=>[t(v,{class:"judge-status-judger"},{default:a(()=>[t(p,{title:"并发",value:I.maxJob,animation:{valueFrom:I.maxJob,duration:2e3},"animation-start":!0},null,8,["value","animation"]),t(p,{title:"CPU使用率",value:I.cpuUsage,animation:{valueFrom:I.cpuUsageFrom,duration:2e3},"animation-start":!0,unit:"%",decimalPlaces:2},null,8,["value","animation"]),t(p,{title:"内存使用率",value:I.memPercent,animation:{valueFrom:I.memPercentFrom,duration:2e3},"animation-start":!0,unit:"%",decimalPlaces:2},null,8,["value","animation"]),t(p,{title:"内存使用量",animation:{valueFrom:I.memUsageFrom,duration:2e3},"animation-start":!0,value:I.memUsage,unit:"GB",decimalPlaces:2},null,8,["animation","value"]),t(p,{title:"内存总量",value:I.memTotal,animation:{valueFrom:I.memTotalFrom,duration:2e3},"animation-start":!0,unit:"GB",decimalPlaces:2},null,8,["value","animation"])]),_:2},1024)]),_:2},1032,["header"]))),128))])]),_:1})]),_:1},8,["loading"])}}}),gi=oe(_i,[["__scopeId","data-v-c39fd93f"]]),bi=re({__name:"ManageJudge",setup(e){const{globalProperties:l}=fe(),n=c(!1),r=c(!1),o=c({problemId:"",language:void 0,status:void 0}),g=c(!1),h=c([]);h.value=Jt();const b=c([]);b.value=Ua();const _=async()=>{n.value=!0;try{const d=await bn();if(d.code!==0){N(l,d.code);return}ke(l,"重判成功"),await X.push({name:"judge-list"})}catch(d){console.error(d),N(l,"重判失败")}finally{n.value=!1}},w=async()=>{if(!o.value.problemId&&!o.value.language&&!o.value.status){N(l,"请输入问题标识");return}g.value=!0;try{const d=await hn(o.value.problemId,o.value.language,o.value.status);if(d.code!==0){N(l,d.code);return}ke(l,"重判成功"),await X.push({name:"judge-list",query:{problem_id:o.value.problemId,language:o.value.language}})}catch(d){console.error(d),N(l,"重判失败")}finally{g.value=!1}},u=async()=>{r.value=!0;try{const d=await yn();if(d.code!==0){N(l,d.code);return}ke(l,"重判成功"),await X.push({name:"judge-list"})}catch(d){console.error(d),N(l,"重判失败")}finally{r.value=!1}};return(d,L)=>{const S=H,C=be,k=Ke,s=Ee,m=Ht,p=gt,v=Se,i=Re;return U(),ee(ue,null,[t(C,{class:"yj-manage-card",title:"重判最近提交"},{default:a(()=>[t(S,{onClick:_,loading:n.value},{default:a(()=>L[3]||(L[3]=[V("重判")])),_:1},8,["loading"])]),_:1}),t(C,{class:"yj-manage-card",title:"重判指定记录"},{default:a(()=>[t(i,{layout:"inline",onSubmit:w},{default:a(()=>[t(s,{label:"题号"},{default:a(()=>[t(k,{modelValue:o.value.problemId,"onUpdate:modelValue":L[0]||(L[0]=f=>o.value.problemId=f),placeholder:"请输入完整题号"},null,8,["modelValue"])]),_:1}),t(s,{label:"语言"},{default:a(()=>[t(p,{modelValue:o.value.language,"onUpdate:modelValue":L[1]||(L[1]=f=>o.value.language=f),placeholder:"请选择提交语言","auto-width":"",clearable:""},{default:a(()=>[(U(!0),ee(ue,null,xe(h.value,f=>(U(),E(m,{key:f.value,value:f.value,label:f.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(s,{label:"状态"},{default:a(()=>[t(p,{modelValue:o.value.status,"onUpdate:modelValue":L[2]||(L[2]=f=>o.value.status=f),placeholder:"请选择评测状态","auto-width":"",clearable:""},{default:a(()=>[(U(!0),ee(ue,null,xe(b.value,f=>(U(),E(m,{key:f.value,value:f.value,label:f.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(s,null,{default:a(()=>[t(v,null,{default:a(()=>[t(S,{theme:"primary",type:"submit",loading:g.value},{default:a(()=>L[4]||(L[4]=[V("重判")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1}),t(C,{class:"yj-manage-card",title:"重判所有"},{default:a(()=>[t(S,{onClick:u,theme:"danger",loading:r.value},{default:a(()=>L[5]||(L[5]=[V("重判")])),_:1},8,["loading"])]),_:1})],64)}}}),hi=oe(bi,[["__scopeId","data-v-8d9329ef"]]),yi=re({__name:"ManageWeb",setup(e){const{globalProperties:l}=fe(),n=c({theme:"",content:""}),r=c({title:"",content:""}),o=c(!1),g=c(!1),h=c(!1);async function b(L,S){h.value=!0,await ct(L,S,l,un),h.value=!1}const _=async()=>{g.value=!0;try{const L=await dn(n.value.theme,n.value.content);if(L.code!==0){N(l,L.code);return}ke(l,"保存成功")}catch(L){console.error(L),N(l,"保存失败")}finally{g.value=!1}},w=async()=>{h.value=!0;try{const L=r.value.content,S=await cn(r.value.title,L);if(S.code!==0){N(l,S.code);return}r.value.content=S.data.content,ke(l,"保存成功")}catch(L){console.error(L),_e(l,"保存失败")}finally{h.value=!1}},u=async()=>{n.value=await $a()},d=async()=>{try{r.value=await ja()}catch{_e(l,"加载公告失败"),r.value={title:"",content:""}}};return ce(async()=>{o.value=!0;try{await u(),await d()}catch{_e(l,"加载数据失败")}o.value=!1}),(L,S)=>{const C=gt,k=Ee,s=Ke,m=H,p=Se,v=Re,i=be,f=Me("md-editor-v3"),I=$e;return U(),E(I,{loading:o.value},{default:a(()=>[t(i,{class:"yj-manage-card",title:"站点通知"},{default:a(()=>[t(v,{onSubmit:_},{default:a(()=>[t(k,{label:"主题"},{default:a(()=>[t(C,{modelValue:n.value.theme,"onUpdate:modelValue":S[0]||(S[0]=$=>n.value.theme=$),options:[{label:"success",value:"success"},{label:"info",value:"info"},{label:"warning",value:"warning"},{label:"error",value:"error"}],placeholder:"请选择主题"},null,8,["modelValue"])]),_:1}),t(k,{label:"内容"},{default:a(()=>[t(s,{modelValue:n.value.content,"onUpdate:modelValue":S[1]||(S[1]=$=>n.value.content=$),placeholder:"请输入描述"},null,8,["modelValue"])]),_:1}),t(k,null,{default:a(()=>[t(p,null,{default:a(()=>[t(m,{theme:"primary",type:"submit",loading:g.value},{default:a(()=>S[4]||(S[4]=[V("保存")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1}),t(i,{class:"yj-manage-card",title:"首页公告"},{actions:a(()=>[t(m,{theme:"primary",loading:h.value,onClick:w},{default:a(()=>S[5]||(S[5]=[V("保存")])),_:1},8,["loading"])]),default:a(()=>[t(v,{onSubmit:w},{default:a(()=>[t(k,{label:"标题"},{default:a(()=>[t(s,{modelValue:r.value.title,"onUpdate:modelValue":S[2]||(S[2]=$=>r.value.title=$),placeholder:"请输入描述"},null,8,["modelValue"])]),_:1})]),_:1}),t(I,{loading:h.value},{default:a(()=>[t(f,{modelValue:r.value.content,"onUpdate:modelValue":S[3]||(S[3]=$=>r.value.content=$),onSave:w,onOnUploadImg:b,previewTheme:"cyanosis",class:"dida-description-editor"},null,8,["modelValue"])]),_:1},8,["loading"])]),_:1})]),_:1},8,["loading"])}}}),wi=oe(yi,[["__scopeId","data-v-8c162eb5"]]),Ha=[{name:"problem-list",tab:"problem",sidebar:"problem-list",path:"",title:"问题列表",icon:"list",component:To},{name:"problem-detail",tab:"problem",sidebar:"problem-list",path:":problemKey+",title:"问题详情",icon:"list",component:At},{name:"problem-daily-list",tab:"problem",sidebar:"problem-daily-list",path:"daily",title:"每日一题",icon:"list",component:as},{name:"problem-daily-detail",tab:"problem",sidebar:"problem-daily-list",path:"daily/:dailyId+",title:"问题详情",icon:"list",component:At},{name:"problem-recommend",tab:"problem",sidebar:"problem-recommend",path:"recommend/:problemKey*",title:"问题推荐",icon:"cpu",needLogin:!0,component:ds},{name:"problem-collection-list",tab:"problem",sidebar:"problem-collection-list",path:"collection",title:"题目集合",icon:"list",disableTabPath:!0,component:js},{name:"collection-detail",tab:"collection-detail-tab",sidebar:"collection-detail",path:":collectionId+",title:"题集详情",icon:"cpu",component:Rs},{name:"collection-rank",tab:"collection-detail-tab",sidebar:"collection-rank",path:":collectionId+/rank",title:"题集排名",icon:"list",component:Es},{name:"collection-edit",tab:"collection-detail-tab",sidebar:"collection-edit",disableSidebar:!0,needLogin:!0,path:":collectionId+/edit",title:"题集编辑",icon:"list",component:da},{name:"collection-create",tab:"collection-detail-tab",sidebar:"collection-create",needLogin:!0,disableSidebar:!0,path:"create",title:"新建题集",icon:"list",component:da},{name:"judge-list",tab:"judge",sidebar:"judge-list",path:"",title:"评测列表",icon:"list",component:ma},{name:"judge-detail",tab:"judge",sidebar:"judge-list",path:":judgeId+",title:"评测详情",icon:"cpu",component:pa},{name:"contest-list",tab:"contest",sidebar:"contest-list",path:"",title:"比赛列表",icon:"list",component:fa},{name:"contest-recent",tab:"contest",sidebar:"contest-recent",path:"recent",title:"近期比赛",icon:"list",component:fa},{name:"contest-create",tab:"contest",sidebar:"contest-create",disableSidebar:!0,needLogin:!0,path:"create",title:"新建比赛",icon:"list",component:_a},{name:"contest-edit",tab:"contest-detail-tab",sidebar:"contest-edit",disableSidebar:!0,needLogin:!0,path:":contestId+/edit",title:"比赛编辑",icon:"list",component:_a},{name:"contest-detail",tab:"contest-detail-tab",sidebar:"contest-detail",path:":contestId+",title:"比赛详情",icon:"cpu",component:pr},{name:"contest-problem-detail",tab:"contest-detail-tab",sidebar:"contest-problem-detail",path:":contestId+/problem/:problemIndex+",title:"问题详情",icon:"cpu",disableSidebar:!0,component:At},{name:"contest-judge",tab:"contest-detail-tab",sidebar:"contest-judge",path:":contestId+/judge",title:"评测列表",icon:"list",component:ma},{name:"contest-judge-detail",tab:"contest-detail-tab",sidebar:"contest-judge-detail",path:":contestId+/judge/:judgeId+",title:"评测详情",icon:"cpu",component:pa,disableSidebar:!0},{name:"contest-rank",tab:"contest-detail-tab",sidebar:"contest-rank",path:":contestId+/rank",title:"比赛排名",icon:"list",component:hr},{name:"contest-discuss",tab:"contest-detail-tab",sidebar:"contest-discuss",path:":contestId+/discuss",title:"比赛讨论",icon:"list",component:Et},{name:"contest-discuss-detail",tab:"contest-detail-tab",sidebar:"contest-discuss",path:":contestId+/discuss/:discussId+",title:"讨论详情",icon:"list",component:Kt},{name:"discuss-list",tab:"discuss",sidebar:"discuss-list",path:"",title:"讨论列表",icon:"list",component:Et},{name:"discuss-create",tab:"discuss",sidebar:"discuss-create",disableSidebar:!0,needLogin:!0,path:"create",title:"新建讨论",icon:"list",component:ga},{name:"discuss-edit",tab:"discuss-detail-tab",sidebar:"discuss-edit",disableSidebar:!0,needLogin:!0,path:":discussId+/edit",title:"编辑讨论",icon:"list",component:ga},{name:"discuss-list-problem",tab:"discuss",sidebar:"discuss-list-problem",path:"problem",title:"题目讨论",icon:"list",component:Et},{name:"discuss-detail",tab:"discuss",sidebar:"discuss-list",path:":discussId+",title:"讨论详情",icon:"list",component:Kt},{name:"rank-ac-all",tab:"rank",sidebar:"rank-ac-all",path:"ac",title:"AC排名",icon:"base-station",props:{type:"all"},component:it},{name:"rank-ac-problem",tab:"rank",sidebar:"rank-ac-problem",path:"ac/problem",title:"题量排名",icon:"base-station",props:{type:"problem"},component:it},{name:"rank-ac-problem-today",tab:"rank",sidebar:"rank-ac-problem-today",path:"ac/problem/today",title:"今日题量",icon:"base-station",props:{type:"problem-today"},component:it},{name:"rank-ac-problem-day7",tab:"rank",sidebar:"rank-ac-problem-day7",path:"ac/problem/day7",title:"7日题量",icon:"base-station",props:{type:"problem-day7"},component:it},{name:"rank-ac-problem-day30",tab:"rank",sidebar:"rank-ac-problem-day30",path:"ac/problem/day30",title:"30日题量",icon:"base-station",props:{type:"problem-day30"},component:it},{name:"rank-ac-problem-year",tab:"rank",sidebar:"rank-ac-problem-year",path:"ac/problem/year",title:"1年题量",icon:"base-station",props:{type:"problem-year"},component:it},{name:"system-status",tab:"system",sidebar:"system-status",path:"",title:"运行状态",icon:"base-station",component:gi},{name:"system-about",tab:"system",sidebar:"system-about",path:"about",title:"关于",icon:"base-station",props:{discussId:"93"},component:Kt},{name:"manage-problem-create",tab:"manage",sidebar:"manage-problem-create",disableSidebar:!0,path:"problem",title:"新建问题",icon:"list",component:ua,auths:[Ue.ManageProblem]},{name:"manage-problem",tab:"manage",sidebar:"manage-problem",disableSidebar:!0,path:"problem/:problemKey+",title:"问题编辑",icon:"list",component:ua,auths:[Ue.ManageProblem]},{name:"manage-problem-daily-create",tab:"manage",sidebar:"manage-problem-daily-create",disableSidebar:!0,path:"problem/daily",title:"新建每日一题",icon:"list",component:ia,auths:[Ue.ManageProblemDaily]},{name:"manage-problem-daily",tab:"manage",sidebar:"manage-problem-daily",disableSidebar:!0,path:"problem/daily/:dailyId+",title:"编辑每日一题",icon:"list",component:ia,auths:[Ue.ManageProblemDaily]},{name:"manage-problem-judge",tab:"manage",sidebar:"manage-problem-judge",disableSidebar:!0,path:"problem/:problemKey+/judge",title:"评测数据",icon:"list",component:ws,auths:[Ue.ManageProblem]},{name:"manage-web",tab:"manage",path:"web",sidebar:"manage-web",title:"站点管理",icon:"list",auths:[Ue.ManageWeb],component:wi},{name:"manage-judge",tab:"manage",path:"judge",sidebar:"manage-judge",title:"评测管理",icon:"list",auths:["i-manage-judge"],component:hi},{name:"login-forget",tab:"login",path:"forget",title:"忘记密码",component:ci}],ba=(e,l,n,r)=>{r.tab==n&&(r.disableSidebar&&l!=r.sidebar||r.sidebar==null||r.sidebar!=r.name||e.push({name:r.name,title:r.title,icon:r.icon,to:{name:r.name}}))},ki=(e,l)=>{const n=[];return Ha.forEach(r=>{if(Fa(r)){const o=[];r.children.forEach(g=>{ba(o,e,l,g)}),o.length>0&&n.push({title:r.title,children:o})}else ba(n,e,l,r)}),n},ha=(e,l)=>{const n=ho(l.tab),r={name:l.name,path:"/"+l.path,meta:{title:l.title+" - "+n.title,tab:l.tab,sidebar:l.sidebar,showSidebar:n.showSidebar,needLogin:n.needLogin||l.needLogin,tabAuths:n.auths,auths:l.auths},props:l.props,component:l.component};!n.disablePath&&!l.disableTabPath&&(r.path=n.path+r.path),e.push(r)},Si=e=>{Ha.forEach(l=>{Fa(l)?l.children.forEach(n=>{ha(e,n)}):ha(e,l)})},Ci={class:"sh-main"},Pi=re({__name:"View403",setup(e){let l=Ce();const n=c("");return ce(()=>{l.query.target?n.value=l.query.target:n.value=l.fullPath}),(r,o)=>{const g=H;return U(),ee("div",Ci,[R("p",null,q(n.value),1),o[2]||(o[2]=R("p",null,"该页面无访问权限，请更换访问目标或重新登陆后再试",-1)),t(g,{theme:"primary",onClick:o[0]||(o[0]=()=>r.$router.push("/"))},{default:a(()=>o[1]||(o[1]=[V("返回首页")])),_:1})])}}}),Ba=oe(Pi,[["__scopeId","data-v-777362b3"]]),yt=[];wo(yt);Si(yt);yt.push({path:"/403",name:"403",component:Ba});yt.push({path:"/:pathMatch(.*)*",name:"404",component:qa});const X=cl({history:ml("/"),routes:yt});X.beforeEach((e,l,n)=>{if(e.name==null||!X.hasRoute(e.name)){n({name:"home"});return}const r=e.matched[e.matched.length-1].meta;if(r.redirect){n({name:r.redirect});return}if(r.needLogin){const g=qe();if(g.getToken==null||g.getToken==""){n({name:"login",query:{redirect_uri:e.fullPath}});return}}const o=r.tabAuths;if(o&&!qe().hasAllAuths(o)){n({name:"403",query:{target:e.fullPath}});return}n()});X.afterEach((e,l)=>{if(e.name===l.name)return;const n=Dt(),r=Ze();let o=null;if(e.matched.length>0&&(o=e.matched[e.matched.length-1].meta),o!=null&&o.title&&r.setTitle(o==null?void 0:o.title),o!=null&&o.showSidebar){n.setSidebarShow(!0);const g=ki(o==null?void 0:o.sidebar,o==null?void 0:o.tab);n.setMenuList(g),n.setMenuActiveName(o==null?void 0:o.sidebar)}else n.setSidebarShow(!1);window.scrollTo(0,0)});const Ja=_t("login",{state:()=>({Loaded:!1}),getters:{isLoaded(){return this.Loaded}}}),Ii=re({__name:"HeaderContent",setup(e){const l=Ja(),n=qe(),{globalProperties:r}=fe(),o=c(l.isLoaded),g=c(!1),h=c(n.getUsername),b=c(n.getNickname),_=c(),w=()=>{_.value=yo(n)};l.$subscribe((L,S)=>{o.value=S.Loaded}),n.$subscribe((L,S)=>{h.value=S.username,b.value=S.nickname,g.value=S.token!="",w()});const u=()=>{r.$router.currentRoute.value.name!=="login"&&r.$router.push({name:"login",query:{redirect_uri:r.$router.currentRoute.value.fullPath}})},d=()=>{n.clear(),r.$message.success({duration:3e3,content:"注销成功"}),r.$router.push({path:"/login",query:{redirect_uri:r.$router.currentRoute.value.fullPath}})};return ce(()=>{w()}),(L,S)=>{const C=Me("router-link"),k=Va,s=xa,m=El,p=Kl;return U(),E(p,{modelValue:L.$route.meta.tab,"onUpdate:modelValue":S[0]||(S[0]=v=>L.$route.meta.tab=v),class:"sh-menu","expand-type":"popup"},{logo:a(()=>[t(C,{to:"/",class:"sh-logo"},{default:a(()=>S[1]||(S[1]=[V("DidaOJ")])),_:1})]),operations:a(()=>[o.value&&g.value?(U(),E(m,{key:0,title:b.value},{icon:a(()=>[t(k,{name:"user"})]),default:a(()=>[t(s,{value:"user",to:{path:"/user/"+h.value}},{default:a(()=>S[2]||(S[2]=[V("个人空间")])),_:1},8,["to"]),t(s,{value:"user_logout",onClick:d},{default:a(()=>S[3]||(S[3]=[V(" 注销")])),_:1})]),_:1},8,["title"])):o.value?(U(),E(s,{key:2,value:"login",onClick:u},{icon:a(()=>[t(k,{name:"login"})]),default:a(()=>[S[5]||(S[5]=V(" 登录 "))]),_:1})):(U(),E(s,{key:1,value:"login"},{icon:a(()=>[t(k,{name:"login"})]),default:a(()=>[S[4]||(S[4]=V(" ... "))]),_:1}))]),default:a(()=>[(U(!0),ee(ue,null,xe(_.value,v=>(U(),E(s,{key:v.name,value:v.name,to:{name:v.name}},{icon:a(()=>[v.icon?(U(),E(k,{key:0,name:v.icon},null,8,["name"])):le("",!0)]),default:a(()=>[V(" "+q(v.title),1)]),_:2},1032,["value","to"]))),128))]),_:1},8,["modelValue"])}}}),Ti=oe(Ii,[["__scopeId","data-v-95e7494b"]]),xi={id:"menu-container"},Vi=re({__name:"SidebarContent",setup(e){const l=Dt(),n=c(!1),r=c(null),o=c(l.menuActiveName),g=c(l.menuList),h=c([]),b=c(!1),_=()=>{o.value=l.menuActiveName;const u=JSON.stringify(g.value),d=JSON.stringify(l.menuList);u!==d&&(h.value.push([...l.menuList]),w())},w=async()=>{if(h.value.length>0&&!b.value){for(b.value=!0;h.value.length>1;)h.value.shift();const u=h.value.shift();n.value=u.length<=0,g.value=[],await ft(),r.value&&r.value.updateActiveName(),await new Promise(L=>setTimeout(L,300)),g.value=u,await ft(),r.value&&r.value.updateActiveName();const d=300;await new Promise(L=>setTimeout(L,d)),b.value=!1,await w()}};return l.$subscribe((u,d)=>{_()}),ce(()=>{_()}),(u,d)=>{const L=Va,S=xa,C=ql,k=Ml,s=$e;return U(),ee(ue,null,[R("div",xi,[t(k,{modelValue:o.value,"onUpdate:modelValue":d[0]||(d[0]=m=>o.value=m),theme:"light",class:"sh-menu-container"},{default:a(()=>[t(pl,{name:"move-left"},{default:a(()=>[(U(!0),ee(ue,null,xe(g.value,(m,p)=>(U(),ee(ue,{key:p},[me(ko)(m)?(U(),E(C,{key:0,title:m.title},{default:a(()=>[(U(!0),ee(ue,null,xe(m.children,(v,i)=>(U(),E(S,{key:v.name,value:v.name,to:v.to},la({default:a(()=>[V(" "+q(v.title),1)]),_:2},[v.icon?{name:"icon",fn:a(()=>[t(L,{name:v.icon,class:Nt(v.iconClass)},null,8,["name","class"])]),key:"0"}:void 0]),1032,["value","to"]))),128))]),_:2},1032,["title"])):(U(),E(S,{key:m.name,value:m.name,to:m.to},la({default:a(()=>[V(" "+q(m.title),1)]),_:2},[m.icon?{name:"icon",fn:a(()=>[t(L,{name:m.icon,class:Nt(m.iconClass)},null,8,["name","class"])]),key:"0"}:void 0]),1032,["value","to"]))],64))),128))]),_:1})]),_:1},8,["modelValue"])]),t(s,{size:"small",loading:n.value,"show-overlay":!0,attach:"#menu-container",class:"sh-sidebar-loading",style:{"align-items":"flex-start","padding-top":"100px"}},null,8,["loading"])],64)}}}),Di=oe(Vi,[["__scopeId","data-v-96e2d89f"]]),$i={};function ji(e,l){return null}const Li=oe($i,[["render",ji]]),Ui={class:"footer"},Ai={class:"footer-left"},zi={class:"foot-time"},Ri={class:"footer-center"},Ei={href:"https://beiancx.miit.gov.cn/",target:"_blank"},Ki={class:"footer-right"},Mi={class:"foot-text"},qi={href:"https://github.com/hpu-developer/DiDaOJ-web",target:"_blank"},Fi={class:"foot-text"},Ni={href:"https://github.com/hpu-developer/DiDaOJ-go",target:"_blank"},Oi=re({__name:"FooterContent",setup(e){const l=c("");function n(){l.value=new Date().toLocaleString()}return ce(()=>{n(),setInterval(()=>{n()},1e3)}),(r,o)=>{const g=H;return U(),ee("div",Ui,[R("div",Ai,[R("p",zi,q(l.value),1)]),R("div",Ri,[R("a",Ei,[t(g,{theme:"default",variant:"outline",ghost:!0},{default:a(()=>o[0]||(o[0]=[V("豫ICP备15024677号-4")])),_:1})])]),R("div",Ki,[R("p",Mi,[R("a",qi,[t(g,{theme:"default",variant:"outline",ghost:!0},{default:a(()=>o[1]||(o[1]=[V("@didaoj-web")])),_:1})])]),R("p",Fi,[R("a",Ni,[t(g,{theme:"default",variant:"outline",ghost:!0},{default:a(()=>o[2]||(o[2]=[V("@didaoj-go")])),_:1})])])])])}}}),Gi=oe(Oi,[["__scopeId","data-v-44f2e4e7"]]),kt=20,qt=100,Ft=50,Hi=re({__name:"ForceHiddenSidebarButton",setup(e){let l=Dt();const n=c({x:window.innerWidth-qt-kt,y:window.innerHeight-Ft-kt}),r=c(window.innerWidth),o=c(window.innerHeight);let g=!1,h={x:0,y:0};const b=m=>{g=!0;const p=m.clientX??m.touches[0].clientX,v=m.clientY??m.touches[0].clientY;h={x:p-n.value.x,y:v-n.value.y},document.addEventListener("mousemove",_),document.addEventListener("touchmove",_),document.addEventListener("mouseup",w),document.addEventListener("touchend",w)},_=m=>{if(!g)return;const p=m.clientX??m.touches[0].clientX,v=m.clientY??m.touches[0].clientY;let i=p-h.x,f=v-h.y;i=Math.max(0,Math.min(i,r.value-qt)),f=Math.max(0,Math.min(f,o.value-Ft)),n.value={x:i,y:f}},w=()=>{g=!1,document.removeEventListener("mousemove",_),document.removeEventListener("touchmove",_),document.removeEventListener("mouseup",w),document.removeEventListener("touchend",w)},u=()=>{r.value=window.innerWidth,o.value=window.innerHeight,n.value={x:Math.min(n.value.x,r.value-qt-kt),y:Math.min(n.value.y,o.value-Ft-kt)}};let d=c(l.forceHiddenSidebar),L=c(l.forceHiddenSidebar);const S=()=>{d.value=!d.value,l.setForceHiddenSidebar(d.value)},C=()=>{L.value||(L.value=!0,l.setForceHiddenSidebar(d.value))},k=()=>{L.value&&(L.value=!1,l.setForceHiddenSidebar(!1))},s=m=>{m>=800?k():C()};return s(r.value),ze(r,m=>{s(m)}),ce(()=>{window.addEventListener("resize",u)}),je(()=>{window.removeEventListener("resize",u)}),(m,p)=>{const v=H;return me(L)?(U(),E(v,{key:0,class:"draggable-button",style:wa({top:`${n.value.y}px`,left:`${n.value.x}px`}),onMousedown:b,onTouchstart:b,variant:"dashed",theme:"primary",onClick:S},{default:a(()=>[V(q(me(d)?"显示":"隐藏"),1)]),_:1},8,["style"])):le("",!0)}}}),Bi=oe(Hi,[["__scopeId","data-v-1aee5506"]]),St="DidaOJ",Ji=re({__name:"App",setup(e){const{globalProperties:l}=fe(),n=Ja(),r=qe(),o=Ze(),g=Dt();n.$patch({Loaded:!1});const h=r.getToken,b=c(!1),_=c(!1);o.title&&o.title.length>0?document.title=o.title+" - "+St:document.title=St,o.$subscribe((S,C)=>{C.title&&C.title.length>0?document.title=C.title+" - "+St:document.title=St}),g.$subscribe((S,C)=>{b.value=C.showSidebar,_.value=b.value&&!C.forceHiddenSidebar});const w=Ce(),u=Je(()=>{const S=w.meta.auths;return S?!r.hasAllAuths(S):!1});function d(){l.$message.warning({duration:3e3,content:"登陆状态失效"}),n.$patch({Loaded:!0}),r.clear()}const L=async()=>{const S=document.querySelectorAll("oj-problem");if(S.length===0)return;let C={};S.forEach(m=>{const p=m.getAttribute("id"),v=document.createElement("span");v.setAttribute("style","padding:5px"),m.replaceWith(v);const i=c("default");C[p]||(C[p]=[]),C[p].push(i);let f=p;p&&!p.includes("-")&&(f="DidaOJ-"+p),Sa({render:()=>_l(H,{innerHTML:f,onClick:()=>{window.open(`/problem/${p}`,"_blank")},size:"small",variant:"outline",theme:i.value})}).mount(v)});const k=[];for(const m in C)k.push(m);const s=await Ka(k);if(s.code===0)for(const m in C){const p=C[m];if(!p)continue;let v="primary";const i=s.data[m];if(i)switch(i){case Ae.Accept:v="success";break;case Ae.Attempt:v="warning";break}for(const f of p)f.value=v}};return ce(()=>{document.addEventListener("DOMContentLoaded",()=>{new MutationObserver(()=>{Yl(()=>{L()},1e3)()}).observe(document.body,{childList:!0,subtree:!0}),fl.autoSpacingPage()}),h?Xn().then(S=>{S.code==0?(r.loadResponse(S.data),n.$patch({Loaded:!0})):(N(l,S.code),n.$patch({Loaded:!0}),r.clear())}).catch(S=>{console.log(S),d()}):n.$patch({Loaded:!0})}),(S,C)=>{const k=Fl,s=Ol,m=Me("RouterView"),p=Gl,v=Nl,i=Hl;return U(),ee(ue,null,[t(v,{class:"sh-app-layout"},{default:a(()=>[t(k,{class:"sh-header"},{default:a(()=>[t(Ti)]),_:1}),t(v,null,{default:a(()=>[t(vl,{name:"slide"},{default:a(()=>[_.value?(U(),E(s,{key:0,class:"sh-sidebar"},{default:a(()=>[t(Di)]),_:1})):le("",!0)]),_:1}),t(v,{class:Nt(["sh-main-layout",{expanded:!_.value}])},{default:a(()=>[t(Li),t(p,{class:"sh-main-content"},{default:a(()=>[u.value?(U(),E(Ba,{key:0})):(U(),E(m,{key:1}))]),_:1}),t(Gi)]),_:1},8,["class"])]),_:1})]),_:1}),b.value?(U(),E(Bi,{key:0})):le("",!0),t(i,{container:"body",offset:["24px","80px"],size:"small"})],64)}}}),Wi=oe(Ji,[["__scopeId","data-v-66c2cfa5"]]);function Yi(e,l={}){const n=/\{\{%\s*(\w+)\s+([^%]+?)\s*%\}\}/g,r=l.renderers||{},o=e.renderer.rules.text??function(g,h){return g[h].content};e.renderer.rules.text=function(g,h,b,_,w){const d=g[h].content;return n.test(d)?d.replace(n,(S,C,k)=>{const s=r[C];if(typeof s=="function"){const m=k.trim().split(/\s+/);return s(m)}else return`<span class="shortcode-${C}">${C}: ${k.trim()}</span>`}):o(g,h,b,_,w)}}function Xi(e,l){const n=/\{\{%\s*(\w+)\s*%\}\}([\s\S]*?)\{\{%\s*\/\1\s*%\}\}/g;e.core.ruler.push("shortcode_color",r=>{for(const o of r.tokens){if(o.type!=="inline")continue;let g=o.content,h=!1;g=g.replace(n,(b,_,w)=>{var d;const u=(d=l.renderers)==null?void 0:d[_];return u?(h=!0,u([],w.trim())):b}),h&&(o.type="html_inline",o.tag="",o.attrs=null,o.content=g,o.children=[])}})}Xl({markdownItConfig(e){e.use(Ut,"align-left",{render(l,n){return l[n].nesting===1?`<div class="sh-align-left">
`:`</div>
`}}),e.use(Ut,"align-center",{render(l,n){return l[n].nesting===1?`<div class="sh-align-center">
`:`</div>
`}}),e.use(Ut,"align-right",{render(l,n){return l[n].nesting===1?`<div class="sh-align-right">
`:`</div>
`}}),e.use(Yi,{renderers:{problem:([l])=>`<oj-problem id="${l}">${l}</oj-problem>`}}),e.use(Xi,{renderers:{red:(l,n)=>`<span class="dida-font-red">${n}</span>`,green:(l,n)=>`<span class="dida-font-green">${n}</span>`,blue:(l,n)=>`<span class="dida-font-blue">${n}</span>`}})},markdownItPlugins(e){return[...e,{type:"linkAttr",plugin:hl,options:{matcher(l){return!l.startsWith("#")},attrs:{target:"_blank"}}}]}});const Wa=gl();Wa.use(bl);const mt=Sa(Wi);mt.use(Wa);mt.use(X);mt.use(Bl);mt.use(Zl);mt.use(Ql);mt.mount("#app");en().then(()=>{console.log("Text cache reinitialized")}).catch(e=>{console.error("Text cache reinitialization failed",e)});
