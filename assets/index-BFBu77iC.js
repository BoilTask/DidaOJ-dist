import{ct as _t,d as se,a as m,o as ce,cu as R,cv as j,cw as a,e as t,cx as K,cy as E,bE as x,cz as ha,aM as Ya,cA as Me,cB as le,cC as ee,F as ue,cD as xe,cE as Xa,cF as Za,cG as Ce,bS as me,cH as Qa,cI as el,cJ as tl,b as je,v as ft,cK as al,cL as Xe,j as Je,w as ze,a9 as at,bc as ll,bd as nl,cM as ol,cN as sl,cO as rl,br as il,cP as Lt,cQ as wa,cR as ka,cj as ul,cS as dl,cT as cl,cU as ml,bX as pl,cV as la,cW as Nt,cX as fl,bf as vl,aY as Sa,z as _l,cY as gl,cZ as bl,c_ as yl,c$ as hl,d0 as wl,d1 as kl,d2 as Sl,d3 as Cl,d4 as Pl,d5 as Ut}from"./node_modules-eCQzwwEp.js";import{L as $e,C as be,R as Te,a as De,A as xt,S as Il,b as Tl,c as xl,d as Vl,e as Dl,f as nt,T as Qe,B,F as Ke,g as Re,I as Ee,D as ot,h as Ca,i as We,j as Ye,k as $l,l as Fe,m as Se,n as gt,o as bt,P as Gt,O as Ht,p as Bt,q as jl,r as Pa,s as Ll,t as Ul,u as Ia,v as Ta,w as Vt,x as Al,y as zl,z as Kl,E as Rl,G as El,H as Ml,J as ql,K as Fl,M as Nl,N as xa,Q as Va,U as Ol,V as Gl,W as Hl,X as Bl,Y as Jl,Z as Wl,_ as Yl,$ as Xl,a0 as Zl,a1 as Ql}from"./tdesign-vue-next-DQAVhhjW.js";import{u as fe,S as ve,a as ke,b as G,G as He,H as ct,c as Ge,d as en,e as Da,f as tn,g as an,h as ln,E as nn,M as on,R as sn}from"./md-editor-v3-CHztMczZ.js";import{e as na}from"./monaco-editor-ouHSYV7a.js";import{H as rn}from"./highlight.js-D9SJWP4w.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const y of o)if(y.type==="childList")for(const w of y.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&s(w)}).observe(document,{childList:!0,subtree:!0});function n(o){const y={};return o.integrity&&(y.integrity=o.integrity),o.referrerPolicy&&(y.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?y.credentials="include":o.crossOrigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function s(o){if(o.ep)return;o.ep=!0;const y=n(o);fetch(o.href,y)}})();var Ue=(e=>(e.ManageWeb="i-manage-web",e.ManageJudge="i-manage-judge",e.ManageProblem="i-manage-problem",e.ManageProblemDaily="i-manage-problem-daily",e.ManageContest="i-manage-contest",e.ManageCollection="i-manage-collection",e.ManageDiscuss="i-manage-discuss",e))(Ue||{});const un={"r-admin":["i-manage-web","i-manage-judge","i-manage-problem","i-manage-problem-daily","i-manage-contest","i-manage-collection","i-manage-discuss"]};function dn(e){if(e==null)return[];const l=[];for(const n of e){const s=un[n];s!=null&&l.push(...s)}return[...new Set(l)]}function cn(e,l){if(e==null||l==null)return!1;const n=dn(e);for(const s of l)if(!n.includes(s))return!1;return!0}const qe=_t("user",{state:()=>({token:"",userId:-1,username:"",nickname:"",roles:[]}),getters:{getToken(){return this.token},getUserId(){return this.userId},getUsername(){return this.username},getNickname(){return this.nickname}},actions:{clear(){this.$patch({token:"",userId:-1,username:"",nickname:"",roles:[]})},loadResponse(e){this.$patch({token:e.token,userId:e.id,username:e.username,nickname:e.nickname,roles:e.roles})},isLogin(){return this.token!=null&&this.token!=""},hasAuth(e){return this.hasAllAuths([e])},hasAllAuths(e){return e?cn(this.roles,e):!0}},persist:!0}),Ze=_t("webStyle",{state:()=>({title:""}),getters:{getTitle(){return this.title}},actions:{setTitle(e){this.title=e}}}),Dt=_t("sidebarStyle",{state:()=>({showSidebar:!1,forceHiddenSidebar:!1,menuActiveName:"",menuList:[]}),getters:{getMenuList(){return this.menuList}},actions:{setSidebarShow(e){this.showSidebar=e},setForceHiddenSidebar(e){this.forceHiddenSidebar=e},setMenuActiveName(e){this.menuActiveName=e},clearMenuList(){this.menuList=[]},setMenuList(e){this.menuList=e},addMenuList(e){this.menuList.push(e)}}}),mn={style:{"text-align":"right"}},pn=se({__name:"Hitokoto",setup(e){const l=m(!1),n=m(""),s=m(""),o=m(""),y=async()=>{l.value=!0;try{const h=await(await fetch("https://v1.hitokoto.cn")).json();s.value=h.hitokoto,o.value=h.creator,n.value="—— "+h.from}catch(w){s.value="一言获取失败了，但至少您还可以访问本站。",o.value="BoilTask",n.value="DidaOJ",console.error("Error fetching Hitokoto:",w)}finally{l.value=!1}};return ce(()=>{y()}),(w,h)=>{const _=be,S=$e;return j(),R(S,{loading:l.value},{default:a(()=>[t(_,{title:"一言 © Hitokoto"},{actions:a(()=>[x(" @"+E(o.value),1)]),default:a(()=>[K("div",null,[K("span",null,E(s.value),1),K("p",mn,E(n.value),1)])]),_:1})]),_:1},8,["loading"])}}}),fn="https://oj-api.didapipa.com/",W=ha.create({baseURL:fn,timeout:6e4,withCredentials:!0,headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});W.interceptors.request.use(e=>{const n=qe().getToken;return n&&(e.headers["X-Token"]=n),e},e=>Promise.reject(e));W.interceptors.response.use(function(e){return e.data},function(e){return Promise.reject(e)});const $t=ha.create({timeout:6e4,withCredentials:!1,headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});$t.interceptors.response.use(function(e){return e.data},function(e){return Promise.reject(e)});function $a(){return $t({baseURL:"https://r2-oj.didapipa.com",url:"/system/notification.json?"+Date.now(),method:"get"})}function ja(){return $t({baseURL:"https://r2-oj.didapipa.com",url:"/system/announcement.json?"+Date.now(),method:"get"})}function vn(){return W({url:"/system/status",method:"get"})}function _n(){return W({url:"/system/image/token",method:"get"})}function gn(e,l){return W({url:"/system/notification",method:"post",data:{theme:e,content:l}})}function bn(e,l){return W({url:"/system/announcement",method:"post",data:{title:e,content:l}})}var jt=(e=>(e[e.Unknown=-1]="Unknown",e[e.C=0]="C",e[e.Cpp=1]="Cpp",e[e.Java=2]="Java",e[e.Python=3]="Python",e[e.Pascal=4]="Pascal",e[e.Golang=5]="Golang",e[e.Lua=6]="Lua",e[e.TypeScript=7]="TypeScript",e[e.Max=8]="Max",e))(jt||{});function Jt(){const e=[-1,8];return Object.values(jt).filter(l=>typeof l=="number"&&!e.includes(l)).map(l=>({value:l,label:It(l)}))}function Ct(e){return e>-1&&e<8}function It(e){switch(e){case 0:return"C";case 1:return"C++";case 2:return"Java";case 3:return"Python";case 4:return"Pascal";case 5:return"Golang";case 6:return"Lua";case 7:return"TypeScript";default:return"未知"}}function Wt(e){switch(e){case 0:return"c";case 1:return"cpp";case 2:return"java";case 3:return"python";case 4:return"pascal";case 5:return"go";case 6:return"lua";case 7:return"typescript";default:return"text"}}var Be=(e=>(e[e.Init=0]="Init",e[e.Rejudge=1]="Rejudge",e[e.Submitting=2]="Submitting",e[e.Queuing=3]="Queuing",e[e.Compiling=4]="Compiling",e[e.Running=5]="Running",e[e.Accept=6]="Accept",e[e.PE=7]="PE",e[e.WA=8]="WA",e[e.TLE=9]="TLE",e[e.MLE=10]="MLE",e[e.OLE=11]="OLE",e[e.RE=12]="RE",e[e.CE=13]="CE",e[e.CLE=14]="CLE",e[e.JudgeFail=15]="JudgeFail",e[e.SubmitFail=16]="SubmitFail",e[e.Unknown=17]="Unknown",e[e.Max=18]="Max",e))(Be||{});const yn=e=>{switch(e){case 0:return"普通评测";case 1:return"特殊评测";default:return"未知"}},Tt=e=>{switch(e){case 0:return"等待处理";case 1:return"重新评测";case 2:return"提交中";case 3:return"队列中";case 4:return"编译中";case 5:return"运行中";case 6:return"通过";case 7:return"格式错误";case 8:return"答案错误";case 9:return"超时";case 10:return"内存超限";case 11:return"输出超限";case 12:return"运行错误";case 13:return"编译错误";case 14:return"编译超限";case 15:return"评测失败";case 16:return"提交失败";case 17:return"未知";default:return e}},oa=e=>{if(e!==void 0)switch(e){case 0:return"已经提交到系统，请耐心等待评测结果";case 1:return"管理员发起了重新评测，请耐心等待评测结果";case 2:return"判题机已经接受了本次提交，正在提交到远程判官中";case 3:return"判题机已经接受了本次提交，正在排队等待评测";case 4:return"判题机正在编译您的代码，部分语言会在此步检查是否符合语法";case 5:return"您的代码正在运行，请等待运行结果";case 6:return"您的代码通过了测试用例，恭喜您！";case 7:return"您的代码基本正确，但可能存在空格、空行等格式错误，请认真对比输出要求";case 8:return"您的答案与标准答案存在区别，请继续思考有无未考虑的情况";case 9:return"运行您的代码所用的时间超过了题目限制，请思考时间上更优的解法";case 10:return"运行您的代码所用的内存超过了题目限制，请思考空间上更优的解法";case 11:return"您程序的输出内容远远多于了题目要求（一般是数倍于正确输出），请检查相关逻辑";case 12:return"在运行您程序的过程中发生了异常，可能是除零、数组越界等问题，请检查相关逻辑";case 13:return"您的代码在编译阶段发生了错误，可能是语法错误或其他编译问题，请检查相关逻辑";case 14:return"在编译您代码的过程中，所占用的资源远远超过了要求，请检查相关逻辑";case 15:return"评测过程中发生了异常，一般是判题机或远程判官的问题，可尝试联系管理员处理";case 16:return"在将您的代码提交到远程判官的过程中发生了错误，一般是判题机或远程判官的问题，可联系管理员处理";case 17:return"您的代码状态未知，有可能是您不具有权限，或者该代码状态被隐藏"}return"暂时无提示信息"},La=e=>{switch(e){case 0:case 1:case 2:case 3:case 4:case 5:case 17:return"default";case 6:return"success";case 7:return"warning";default:return"danger"}};function Ua(){const e=[17,18];return Object.values(Be).filter(l=>typeof l=="number"&&!e.includes(l)).map(l=>({value:l,label:Tt(l)}))}function Pt(e){return e>=0&&e<17}function dt(e){switch(e){case 0:case 1:case 2:case 3:case 4:case 5:return!0;default:return!1}}function Aa(e){var n;const l={};if(l.id=e.id,l.problemId=e.problem_id,l.problemKey=e.problem_key,l.contestProblemIndex=e.contest_problem_index,l.status=e.status,e.score==null||dt(e.status)||!Pt(e.status)?l.score="-":l.score=(e.score/10).toString(),e.time?l.time=Math.ceil(e.time/1e6)+"ms":l.time="-",e.memory?l.memory=(e.memory/1024/1024).toFixed(2)+"MB":l.memory="-",l.language=e.language,l.codeLength=e.code_length,e.insert_time?l.insertTime=new Date(e.insert_time).toLocaleString():l.insertTime="-",l.inserter=e.inserter,l.inserterUsername=e.inserter_username,l.inserterNickname=e.inserter_nickname,l.code=e.code,l.compileMessage=e.compile_message,l.taskCurrent=e.task_current,l.taskTotal=e.task_total,l.task=[],e.task)for(let s=0;s<((n=e.task)==null?void 0:n.length);s++){const o=e.task[s],y={};y.taskId=o.task_id,y.status=o.status,o.time?y.time=Math.ceil(o.time/1e6)+"ms":y.time="-",o.memory?y.memory=(o.memory/1024/1024).toFixed(2)+"MB":y.memory="-",o.score?y.score=(o.score/10).toString():y.score="-",y.content=o.content,y.hint=o.hint,l.task.push(y)}return e.judger&&(l.judger=e.judger),e.judger_name?l.judgerName=e.judger_name:l.judgerName="-",e.judge_time&&(l.judgeTime=new Date(e.judge_time).toLocaleString()),l}function hn(e,l,n,s,o){return W({url:"/judge/approve",method:"post",data:{problem_id:e,contest_id:l,problem_index:n,language:s,code:o}})}function wn(e,l){let n={id:e};return l&&(n.contest_id=l),W({url:"/judge?"+new URLSearchParams(n).toString(),method:"get"})}function kn(e){return W({url:"/judge/code?id="+e,method:"get"})}function Sn(e,l,n,s,o,y,w){let h={problem_key:l,username:n,language:String(s),status:String(o),page:String(y),page_size:String(w)};return e&&(h.contest_id=String(e)),W({url:`/judge/list?${new URLSearchParams(h).toString()}`,method:"get"})}function Cn(){return W({url:"/judge/statics/recently",method:"get"})}function Pn(){return W({url:"/judge/rejudge/recently",method:"post"})}function In(e,l,n){const s={};return e!=null&&(s.problem_key=e),l!=null?s.language=l:s.language=jt.Unknown,n!=null?s.status=n:s.status=18,W({url:"/judge/rejudge/search",method:"post",data:s})}function Tn(){return W({url:"/judge/rejudge/all",method:"post",timeout:0})}function xn(e){return W({url:"/judge/rejudge",method:"post",data:{id:Number(e)}})}var Ae=(e=>(e[e.None=0]="None",e[e.Attempt=1]="Attempt",e[e.Accept=2]="Accept",e))(Ae||{});function yt(e,l){const n={};if(n.id=e.id,n.key=e.key,n.inserter=e.inserter,n.title=e.title,n.tags=[],e.tags)for(const s of e.tags){const o=l[s];o&&n.tags.push(o)}if(n.private=e.private,e.accept?n.accept=e.accept:n.accept=0,e.attempt?n.attempt=e.attempt:n.attempt=0,e.description!=null&&(n.description=e.description),e.time_limit!=null&&e.time_limit>=0?n.timeLimit=e.time_limit.toString()+" ms":n.timeLimit="未知",e.memory_limit!=null&&e.memory_limit>=0?n.memoryLimit=(e.memory_limit/1024).toFixed(2)+" MB":n.memoryLimit="未知",e.judge_type!=null&&(n.judgeType=yn(e.judge_type)),e.insert_time!=null&&(n.insertTime=new Date(e.insert_time).toLocaleString()),e.modify_time!=null&&(n.modifyTime=new Date(e.modify_time).toLocaleString()),e.modifier_nickname!=null&&(n.inserterNickname=e.modifier_nickname),e.source!=null){const s=/\[([^\]]+)\]\(([^)]+)\)/,o=e.source.match(s);o?(n.source=o[1],n.sourceUrl=o[2]):(n.source=e.source,n.sourceUrl="")}return e.judge_md5!=null&&(n.judgeMd5=e.judge_md5),e.origin_oj!=null&&(n.originOj=e.origin_oj),e.origin_id!=null&&(n.originId=e.origin_id),e.origin_url!=null&&(n.originUrl=e.origin_url),n}function za(e,l){const n={};if(n.key=e.key,n.problemId=e.problem_id,n.problemKey=e.problem_key,n.title=e.title,n.tags=[],e.tags)for(const s of e.tags){const o=l[s];o&&n.tags.push(o)}return e.accept?n.accept=e.accept:n.accept=0,e.attempt?n.attempt=e.attempt:n.attempt=0,n.solution=e.solution,n.code=e.code,e.insert_time!=null&&(n.insertTime=new Date(e.insert_time).toLocaleString()),e.modify_time!=null&&(n.modifyTime=new Date(e.modify_time).toLocaleString()),e.inserter_nickname!=null&&(n.inserterNickname=e.inserter_nickname),e.modifier_nickname!=null&&(n.modifierNickname=e.modifier_nickname),n}function Ka(e,l,n){const s={};return e?s.key=e:(s.contest_id=l,s.problem_index=n),W({url:`/problem?${new URLSearchParams(s).toString()}`,method:"get"})}function Ra(e){return W({url:"/problem/tag/list?max_count="+e,method:"get"})}function Vn(e){return W({url:"/problem/judge?key="+e,method:"get"})}function Dn(e,l,n,s,o,y){const w={};return e&&(w.oj=e),l&&(w.title=l),n&&(w.tag=n),s!==void 0&&(w.private=s?"1":"0"),o&&(w.page=o),y&&(w.page_size=y),W({url:`/problem/list?${new URLSearchParams(w).toString()}`,method:"get"})}function $n(e){const l={};return e&&(l.problem_id=e),W({url:`/problem/recommend?${new URLSearchParams(l).toString()}`,method:"get"})}function jn(e){return W({url:"/problem/daily?key="+e,method:"get"})}function Ln(e){return W({url:"/problem/daily/edit?key="+e,method:"get"})}function Un(){return W({url:"/problem/daily/recently",method:"get"})}function An(e,l,n,s,o){const y={};return e&&(y.start_date=e),l&&(y.end_date=l),n&&(y.problem_key=n),s&&(y.page=s),o&&(y.page_size=o),W({url:`/problem/daily/list?${new URLSearchParams(y).toString()}`,method:"get"})}function Ea(e){return W({url:"/problem/attempt/status",method:"get",params:{ids:e.join(",")}})}function Ma(e,l){return W({url:"/problem/crawl",method:"post",data:{oj:e,key:l}})}function zn(e,l,n,s,o,y,w){return W({url:"/problem/create",method:"post",data:{title:e,time_limit:l,memory_limit:n,source:s,private:o,tags:y,description:w}})}function Kn(e,l,n,s,o,y,w,h){return W({url:"/problem/edit",method:"post",data:{id:e,title:l,time_limit:n,memory_limit:s,source:o,private:y,tags:w,description:h}})}function Rn(e,l,n,s){return W({url:"/problem/daily/create",method:"post",data:{id:e,problem_key:l,solution:n,code:s}})}function En(e,l,n,s){return W({url:"/problem/daily/edit",method:"post",data:{id:e,problem_key:l,solution:n,code:s}})}function Mn(e,l){return W({url:"/problem/judge/data/download?id="+e+"&key="+l,method:"get"})}function qn(e){return e||(e=0),W({url:"/problem/image/token?id="+e,method:"get"})}function Fn(e){return e||(e=""),W({url:"/problem/daily/image/token?id="+e,method:"get"})}function Nn(e,l){const n=new FormData;return n.append("id",String(e)),n.append("zip",l),W({url:"/problem/judge/data",method:"post",data:n,headers:{"Content-Type":"multipart/form-data"},timeout:1e3*60*5})}function On(e){return W({url:"/problem/parse/id",method:"post",data:{problems:e}})}function Gn(e){return W({url:"/problem/parse",method:"post",data:{problems:e}})}const Hn={class:"sh-main"},Bn={class:"dida-swiper-div"},Jn=se({__name:"HomeView",setup(e){const{globalProperties:l}=fe();let n=-1;const s=m({theme:"info",content:""}),o=m({title:"",content:""}),y=m([]),w=m(!1),h=m(!1),_=m(!1),S=async()=>{s.value=await $a()},d=async()=>{try{const C=await ja();o.value.title=C.title,o.value.content=C.content}catch{ve(l,"加载公告失败"),o.value={title:"公告加载失败",content:"请刷新页面重新获取"}}},c=async()=>{const C=await Cn();if(C.code!==0){ve(l,"加载OJ统计数据失败");return}let P=[];for(const b of C.data){const i=new Date(b.date),f=`${i.getMonth()+1}-${i.getDate()}`;P.push({Date:f,Type:"Unaccept",Count:b.attempt-b.accept}),P.push({Date:f,Type:"Accept",Count:b.accept})}const k={type:"bar",data:[{id:"barData",values:P}],xField:"Date",yField:"Count",seriesField:"Type",stack:!0,legends:{visible:!0},bar:{state:{hover:{stroke:"#000",lineWidth:1}}},height:300};new Xa(k,{dom:"ojStaticsDiv"}).renderSync()},$=async()=>{y.value=[];const C=await Un();if(C.code!==0){ve(l,"加载每日问题数据失败");return}C.data.list&&C.data.list.length>0&&C.data.list.forEach(P=>{let k="default",u="未尝试";if(C.data.attempt_status){const i=C.data.attempt_status[P.problem_id];if(i)switch(i){case Ae.Accept:k="success",u="已解决";break;case Ae.Attempt:k="warning",u="待解决";break;default:k="default",u="未尝试"}}const b=`${P.title}`;y.value.push({key:P.key,title:b,problemId:P.problem_id,theme:k,tag:u})})};return ce(async()=>{_.value=!0,w.value=!0,h.value=!0,(async()=>(await S(),n=setInterval(()=>{S()},3e4),await d(),_.value=!1))(),(async()=>(await c(),w.value=!1))(),(async()=>(await $(),h.value=!1))()}),Ya(()=>{clearInterval(n)}),(C,P)=>{const k=xt,u=Tl,b=Il,i=$e,f=Me("md-preview"),r=be,v=De,z=nt,D=Dl,V=Qe,p=Vl,A=xl,I=Te;return j(),R(i,{loading:_.value},{default:a(()=>[t(I,null,{default:a(()=>[t(v,{span:8},{default:a(()=>{var g;return[K("div",Hn,[s.value?(j(),R(k,{key:0,class:"dida-notification-div",theme:s.value.theme},{default:a(()=>[x(E(s.value.content),1)]),_:1},8,["theme"])):le("",!0),K("div",Bn,[t(b,{class:"dida-swiper"},{default:a(()=>[t(u,null,{default:a(()=>P[1]||(P[1]=[K("a",{href:"http://codeoj.cn",target:"_blank"},[K("img",{src:"https://cdn.codeoj.cn/image/banner.jpg",class:"swiper-img"})],-1)])),_:1}),t(u,null,{default:a(()=>P[2]||(P[2]=[K("img",{src:"https://cdn.codeoj.cn/image/banner.jpg",class:"swiper-img"},null,-1)])),_:1})]),_:1})]),t(i,{loading:w.value&&!_.value},{default:a(()=>P[3]||(P[3]=[K("div",{id:"ojStaticsDiv",style:{"min-height":"200px"}},null,-1)])),_:1},8,["loading"]),t(r,{title:(g=o.value)==null?void 0:g.title,style:{width:"calc(100% - 100px)",margin:"0 auto"}},{default:a(()=>{var T;return[t(f,{"model-value":(T=o.value)==null?void 0:T.content,previewTheme:"cyanosis"},null,8,["model-value"])]}),_:1},8,["title"])])]}),_:1}),t(v,{span:4},{default:a(()=>[t(r,{style:{margin:"10px"},bordered:!0},{default:a(()=>P[4]||(P[4]=[K("img",{src:"https://api.jysafe.cn/ip/",alt:"Welcome",style:{width:"100%"}},null,-1)])),_:1}),t(pn,{style:{margin:"10px"}}),t(r,{style:{margin:"10px"},bordered:!0,title:"每日一题"},{actions:a(()=>[t(z,{onClick:P[0]||(P[0]=g=>C.$router.push({name:"problem-daily-list"}))},{default:a(()=>P[5]||(P[5]=[x("查看全部")])),_:1})]),default:a(()=>[t(i,{loading:h.value&&!_.value},{default:a(()=>[t(A,{split:!0,size:"small",style:{"min-height":"200px"}},{default:a(()=>[(j(!0),ee(ue,null,xe(y.value,g=>(j(),R(p,{key:g.key},{default:a(()=>[t(D,{style:{width:"100px"}},{description:a(()=>[t(z,{onClick:T=>C.$router.push({name:"problem-daily-detail",params:{dailyId:g.key}})},{default:a(()=>[x(E(g.problemId),1)]),_:2},1032,["onClick"])]),_:2},1024),t(D,{style:{width:"200px"}},{description:a(()=>[t(z,{onClick:T=>C.$router.push({name:"problem-daily-detail",params:{dailyId:g.key}})},{default:a(()=>[x(E(g.title),1)]),_:2},1032,["onClick"])]),_:2},1024),t(D,{style:{width:"135px"},description:g.key},null,8,["description"]),t(D,null,{description:a(()=>[t(V,{theme:g.theme},{default:a(()=>[x(E(g.tag),1)]),_:2},1032,["theme"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1},8,["loading"])]),_:1}),t(r,{style:{margin:"10px"},bordered:!0},{header:a(()=>P[6]||(P[6]=[K("b",null,"友情链接",-1)])),default:a(()=>[t(A,null,{default:a(()=>[t(p,null,{default:a(()=>[t(z,{href:"https://oi-wiki.org/",target:"_blank"},{default:a(()=>P[7]||(P[7]=[x("OI Wiki")])),_:1})]),_:1}),t(p,null,{default:a(()=>[t(z,{href:"https://boiltask.com",target:"_blank"},{default:a(()=>P[8]||(P[8]=[x("BoilTask Blog")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"])}}}),oe=(e,l)=>{const n=e.__vccOpts||e;for(const[s,o]of l)n[s]=o;return n},Wn=oe(Jn,[["__scopeId","data-v-5a6e5964"]]),Yn={},Xn={style:{margin:"20px"}};function Zn(e,l){return j(),ee("div",Xn,l[0]||(l[0]=[Za('<header data-v-2f5a046e><h1 data-v-2f5a046e>算法设计高级课程方案</h1><p data-v-2f5a046e>分治策略 · 动态规划 · 贪心算法 · 回溯算法</p></header><div class="section" data-v-2f5a046e><h2 data-v-2f5a046e>一、课程核心知识点</h2><div class="two-columns" data-v-2f5a046e><div class="column" data-v-2f5a046e><h3 data-v-2f5a046e>1. 分治策略 (Divide and Conquer)</h3><p data-v-2f5a046e>分治算法是一种将问题分解为若干子问题，递归解决子问题，再合并子问题解得到原问题解的算法策略:cite[1]:cite[4]。</p><ul data-v-2f5a046e><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>基本思想</span>：将大问题分解为k个较小规模的相同子问题</li><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>关键特征</span>：子问题相互独立且与原问题形式相同</li><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>典型应用</span>：归并排序、快速排序、大整数乘法</li><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>复杂度分析</span>：主定理(Master Theorem)的应用</li></ul><h3 data-v-2f5a046e>2. 动态规划 (Dynamic Programming)</h3><p data-v-2f5a046e>动态规划通过保存子问题的解避免重复计算，适用于具有最优子结构和重叠子问题性质的问题:cite[1]:cite[6]。</p><ul data-v-2f5a046e><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>基本思想</span>：记忆化存储，自底向上求解</li><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>关键特征</span>：最优子结构、重叠子问题、无后效性</li><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>典型应用</span>：背包问题、最长公共子序列、最短路径</li><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>设计步骤</span>：定义状态、状态转移方程、边界条件</li></ul></div><div class="column" data-v-2f5a046e><h3 data-v-2f5a046e>3. 贪心算法 (Greedy Algorithm)</h3><p data-v-2f5a046e>贪心算法在每一步做出局部最优选择，希望最终得到全局最优解:cite[1]:cite[5]。</p><ul data-v-2f5a046e><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>基本思想</span>：当前状态下做出最好选择，不回溯</li><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>关键特征</span>：贪心选择性质、最优子结构</li><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>典型应用</span>：霍夫曼编码、最小生成树、任务调度</li><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>局限性</span>：不保证全局最优，需证明正确性</li></ul><h3 data-v-2f5a046e>4. 回溯算法 (Backtracking)</h3><p data-v-2f5a046e>回溯法通过深度优先搜索解空间树，通过剪枝避免无效搜索:cite[1]:cite[7]。</p><ul data-v-2f5a046e><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>基本思想</span>：系统搜索解空间，走不通就回溯</li><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>关键特征</span>：解空间树、约束函数、限界函数</li><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>典型应用</span>：八皇后问题、图着色、组合优化</li><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>优化技巧</span>：剪枝策略、启发式搜索</li></ul></div></div></div><div class="section" data-v-2f5a046e><h2 data-v-2f5a046e>二、专题化案例建设</h2><p data-v-2f5a046e>从各大竞赛平台选取真实案例，将算法理论应用于实际问题解决。</p><div class="case-study" data-v-2f5a046e><h3 data-v-2f5a046e>案例1：电商平台优惠券分配优化（阿里天池）</h3><p data-v-2f5a046e><strong data-v-2f5a046e>适用算法</strong>：动态规划、贪心算法</p><p data-v-2f5a046e><strong data-v-2f5a046e>问题描述</strong>：在预算限制下，如何分配优惠券以最大化平台GMV。</p><p data-v-2f5a046e><strong data-v-2f5a046e>教学要点</strong>：</p><ul data-v-2f5a046e><li data-v-2f5a046e>建立价值-成本模型</li><li data-v-2f5a046e>设计状态转移方程</li><li data-v-2f5a046e>比较贪心策略与动态规划效果</li></ul></div><div class="case-study" data-v-2f5a046e><h3 data-v-2f5a046e>案例2：医疗影像分割（Kaggle）</h3><p data-v-2f5a046e><strong data-v-2f5a046e>适用算法</strong>：分治策略</p><p data-v-2f5a046e><strong data-v-2f5a046e>问题描述</strong>：将大型医疗影像分割处理，提高分析效率。</p><p data-v-2f5a046e><strong data-v-2f5a046e>教学要点</strong>：</p><ul data-v-2f5a046e><li data-v-2f5a046e>图像分块处理策略</li><li data-v-2f5a046e>并行计算与结果合并</li><li data-v-2f5a046e>分治粒度对性能的影响</li></ul></div><div class="case-study" data-v-2f5a046e><h3 data-v-2f5a046e>案例3：网络路由优化（华为开发者大赛）</h3><p data-v-2f5a046e><strong data-v-2f5a046e>适用算法</strong>：回溯算法</p><p data-v-2f5a046e><strong data-v-2f5a046e>问题描述</strong>：在复杂网络拓扑中找到最优数据传输路径。</p><p data-v-2f5a046e><strong data-v-2f5a046e>教学要点</strong>：</p><ul data-v-2f5a046e><li data-v-2f5a046e>解空间树的构建</li><li data-v-2f5a046e>剪枝条件设计</li><li data-v-2f5a046e>回溯与分支限界的比较</li></ul></div><table data-v-2f5a046e><tr data-v-2f5a046e><th data-v-2f5a046e>竞赛平台</th><th data-v-2f5a046e>案例类型</th><th data-v-2f5a046e>适用算法</th><th data-v-2f5a046e>技能培养重点</th></tr><tr data-v-2f5a046e><td data-v-2f5a046e>百度AI Studio</td><td data-v-2f5a046e>自然语言处理</td><td data-v-2f5a046e>动态规划</td><td data-v-2f5a046e>序列对齐、编辑距离</td></tr><tr data-v-2f5a046e><td data-v-2f5a046e>阿里天池</td><td data-v-2f5a046e>推荐系统</td><td data-v-2f5a046e>贪心算法</td><td data-v-2f5a046e>实时决策、局部最优</td></tr><tr data-v-2f5a046e><td data-v-2f5a046e>Kaggle</td><td data-v-2f5a046e>数据挖掘</td><td data-v-2f5a046e>分治策略</td><td data-v-2f5a046e>大数据处理、并行计算</td></tr><tr data-v-2f5a046e><td data-v-2f5a046e>华为云大赛</td><td data-v-2f5a046e>网络优化</td><td data-v-2f5a046e>回溯算法</td><td data-v-2f5a046e>解空间探索、剪枝优化</td></tr></table></div><div class="section" data-v-2f5a046e><h2 data-v-2f5a046e>三、学术训练模块</h2><p data-v-2f5a046e>精选与课程知识点相关的经典学术论文，培养学生学术研究能力。</p><div class="paper-analysis" data-v-2f5a046e><h3 data-v-2f5a046e>论文1：动态规划在生物信息学中的应用</h3><p data-v-2f5a046e><strong data-v-2f5a046e>关联知识点</strong>：动态规划</p><p data-v-2f5a046e><strong data-v-2f5a046e>核心内容</strong>：Smith-Waterman算法在序列比对中的应用</p><p data-v-2f5a046e><strong data-v-2f5a046e>教学安排</strong>：</p><ol data-v-2f5a046e><li data-v-2f5a046e>论文精读：算法设计思想</li><li data-v-2f5a046e>复现实验：实现基础算法</li><li data-v-2f5a046e>性能分析：时间复杂度与空间复杂度</li><li data-v-2f5a046e>改进讨论：可能的优化方向</li></ol></div><div class="paper-analysis" data-v-2f5a046e><h3 data-v-2f5a046e>论文2：贪心算法的近似比证明</h3><p data-v-2f5a046e><strong data-v-2f5a046e>关联知识点</strong>：贪心算法</p><p data-v-2f5a046e><strong data-v-2f5a046e>核心内容</strong>：集合覆盖问题的贪心算法近似比分析</p><p data-v-2f5a046e><strong data-v-2f5a046e>教学安排</strong>：</p><ol data-v-2f5a046e><li data-v-2f5a046e>问题建模：形式化描述集合覆盖</li><li data-v-2f5a046e>算法设计：贪心策略实现</li><li data-v-2f5a046e>理论证明：近似比推导</li><li data-v-2f5a046e>实验验证：与最优解比较</li></ol></div><div class="paper-analysis" data-v-2f5a046e><h3 data-v-2f5a046e>论文3：分治算法的并行化实现</h3><p data-v-2f5a046e><strong data-v-2f5a046e>关联知识点</strong>：分治策略</p><p data-v-2f5a046e><strong data-v-2f5a046e>核心内容</strong>：MapReduce框架下的分治算法设计</p><p data-v-2f5a046e><strong data-v-2f5a046e>教学安排</strong>：</p><ol data-v-2f5a046e><li data-v-2f5a046e>算法分解：任务划分策略</li><li data-v-2f5a046e>并行实现：MapReduce编程</li><li data-v-2f5a046e>性能评估：加速比分析</li><li data-v-2f5a046e>应用讨论：大数据场景适用性</li></ol></div></div><div class="section" data-v-2f5a046e><h2 data-v-2f5a046e>四、分类培养方案</h2><p data-v-2f5a046e>针对专业型硕士和学术型硕士的不同培养目标，设计差异化教学内容。</p><div class="two-columns" data-v-2f5a046e><div class="column learning-path" data-v-2f5a046e><h3 data-v-2f5a046e>专业型硕士培养路径</h3><p data-v-2f5a046e><strong data-v-2f5a046e>培养目标</strong>：算法工程实现能力、实际问题解决能力</p><p data-v-2f5a046e><strong data-v-2f5a046e>教学重点</strong>：</p><ul data-v-2f5a046e><li data-v-2f5a046e>算法实现技巧与优化</li><li data-v-2f5a046e>工业界案例分析</li><li data-v-2f5a046e>性能调优与工程实践</li><li data-v-2f5a046e>团队协作开发</li></ul><p data-v-2f5a046e><strong data-v-2f5a046e>评估方式</strong>：</p><ol data-v-2f5a046e><li data-v-2f5a046e>竞赛项目实战</li><li data-v-2f5a046e>算法优化报告</li><li data-v-2f5a046e>系统性能评测</li></ol></div><div class="column learning-path" data-v-2f5a046e><h3 data-v-2f5a046e>学术型硕士培养路径</h3><p data-v-2f5a046e><strong data-v-2f5a046e>培养目标</strong>：算法理论研究能力、创新思维能力</p><p data-v-2f5a046e><strong data-v-2f5a046e>教学重点</strong>：</p><ul data-v-2f5a046e><li data-v-2f5a046e>算法正确性证明</li><li data-v-2f5a046e>复杂度分析理论</li><li data-v-2f5a046e>前沿论文研读</li><li data-v-2f5a046e>算法改进与创新</li></ul><p data-v-2f5a046e><strong data-v-2f5a046e>评估方式</strong>：</p><ol data-v-2f5a046e><li data-v-2f5a046e>学术论文阅读报告</li><li data-v-2f5a046e>理论证明作业</li><li data-v-2f5a046e>研究性课题论文</li></ol></div></div><table data-v-2f5a046e><tr data-v-2f5a046e><th data-v-2f5a046e>教学环节</th><th data-v-2f5a046e>专业型硕士</th><th data-v-2f5a046e>学术型硕士</th></tr><tr data-v-2f5a046e><td data-v-2f5a046e>案例教学</td><td data-v-2f5a046e>70%课时</td><td data-v-2f5a046e>40%课时</td></tr><tr data-v-2f5a046e><td data-v-2f5a046e>理论证明</td><td data-v-2f5a046e>20%课时</td><td data-v-2f5a046e>50%课时</td></tr><tr data-v-2f5a046e><td data-v-2f5a046e>论文研读</td><td data-v-2f5a046e>10%课时</td><td data-v-2f5a046e>40%课时</td></tr><tr data-v-2f5a046e><td data-v-2f5a046e>实践项目</td><td data-v-2f5a046e>必做</td><td data-v-2f5a046e>选做</td></tr><tr data-v-2f5a046e><td data-v-2f5a046e>研究论文</td><td data-v-2f5a046e>选做</td><td data-v-2f5a046e>必做</td></tr></table></div><div class="section" data-v-2f5a046e><h2 data-v-2f5a046e>五、课程评估与反馈</h2><p data-v-2f5a046e>建立多元化的课程评估体系，持续改进教学质量。</p><h3 data-v-2f5a046e>1. 学生评估方式</h3><ul data-v-2f5a046e><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>平时作业</span>：算法实现与理论证明(30%)</li><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>期中项目</span>：竞赛案例解决方案(20%)</li><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>期末考核</span>：综合设计与理论分析(30%)</li><li data-v-2f5a046e><span class="highlight" data-v-2f5a046e>课堂参与</span>：讨论与报告(20%)</li></ul><h3 data-v-2f5a046e>2. 教学反馈机制</h3><ul data-v-2f5a046e><li data-v-2f5a046e>每周在线问卷调查</li><li data-v-2f5a046e>每月师生座谈会</li><li data-v-2f5a046e>课程内容动态调整</li><li data-v-2f5a046e>竞赛成绩追踪分析</li></ul></div>',6)]))}const Qn=oe(Yn,[["render",Zn],["__scopeId","data-v-2f5a046e"]]),eo={class:"sh-main"},to=se({__name:"View404",setup(e){let l=Ce(),n=m(l.fullPath);return(s,o)=>{const y=B;return j(),ee("div",eo,[K("p",null,E(me(n)),1),o[2]||(o[2]=K("p",null,"该页面无效或已被迁移，请重新选择访问目标",-1)),t(y,{theme:"primary",onClick:o[0]||(o[0]=()=>s.$router.push("/"))},{default:a(()=>o[1]||(o[1]=[x("返回首页")])),_:1})])}}}),qa=oe(to,[["__scopeId","data-v-d4218944"]]);function ao(e){const l={};return l.id=e.id,l.username=e.username,l.nickname=e.nickname,l.email=e.email,l.slogan=e.slogan,l.organization=e.organization,l.accept=e.accept,l.attempt=e.attempt,l.vjudgeId=e.vjudge_id,e.email&&(l.avatar=`https://www.gravatar.com/avatar/${Qa(e.email.toLowerCase().trim())}?d=identicon&s=100`),l}function lo(e,l){return W({url:"/user/login",method:"post",data:{username:e,password:l}})}function no(){return W({url:"/user/login/refresh",method:"post"})}function oo(e){const l={username:e};return W({url:`/user/info?${new URLSearchParams(l).toString()}`,method:"get"})}function so(e){const l="https://vjudge.net/user/solveDetail/"+encodeURIComponent(e);return $t({url:l,method:"get"})}function ro(e){return W({url:"/user/account/infos",method:"post",data:{users:e}})}function io(e){return W({url:"/user/parse",method:"post",data:{users:e}})}function uo(e,l){return W({url:"/user/register/email",method:"post",data:{token:e,email:l}})}function co(e,l,n,s,o){return W({url:"/user/register",method:"post",data:{username:e,password:l,email:n,key:s,nickname:o}})}function mo(e,l){return W({url:"/user/forget",method:"post",data:{token:e,username:l}})}function po(e,l,n){return W({url:"/user/password/modify",method:"post",data:{username:e,password:l,key:n}})}const fo={class:"dida-login-footer"},vo=se({__name:"LoginView",setup(e){const{globalProperties:l}=fe(),n=qe(),s=m(!1),o=m({username:"",password:""}),y=()=>{ke(l,"重置成功")},w=({validateResult:h,firstError:_})=>{s.value||(s.value=!0,lo(o.value.username,o.value.password).then(S=>{if(S.code===0){n.loadResponse(S.data),ke(l,"登录成功");let d=l.$route.query.redirect_uri;d||(d="/user/"+S.data.username),l.$router.push({path:d})}else G(l,S.code)}).catch(S=>{console.error("Login error",S),ve(l,"登录失败")}).finally(()=>{s.value=!1}))};return ce(()=>{if(n.isLogin()){l.$router.push({path:"/user"});return}}),(h,_)=>{const S=Ee,d=Re,c=B,$=Ke,C=nt,P=be;return j(),R(P,{class:"yj-login-card",title:"欢迎使用DidaOJ~"},{default:a(()=>[t($,{ref:"form",data:o.value,colon:!0,onReset:y,onSubmit:w,class:"yj-login-form","label-width":0},{default:a(()=>[t(d,{name:"username"},{default:a(()=>[t(S,{modelValue:o.value.username,"onUpdate:modelValue":_[0]||(_[0]=k=>o.value.username=k),clearable:"",autocomplete:"username",placeholder:"请输入用户名"},{"prefix-icon":a(()=>[t(me(el))]),_:1},8,["modelValue"])]),_:1}),t(d,{name:"password"},{default:a(()=>[t(S,{modelValue:o.value.password,"onUpdate:modelValue":_[1]||(_[1]=k=>o.value.password=k),type:"password",autocomplete:"current-password",clearable:"",placeholder:"请输入密码"},{"prefix-icon":a(()=>[t(me(tl))]),_:1},8,["modelValue"])]),_:1}),t(d,null,{default:a(()=>[t(c,{theme:"primary",type:"submit",block:"",loading:s.value},{default:a(()=>_[4]||(_[4]=[x("登录")])),_:1},8,["loading"])]),_:1})]),_:1},8,["data"]),K("div",fo,[t(C,{onClick:_[2]||(_[2]=()=>{me(l).$router.push({name:"login-forget"})})},{default:a(()=>_[5]||(_[5]=[x("忘记密码 ")])),_:1}),t(C,{onClick:_[3]||(_[3]=()=>{me(l).$router.push({name:"register"})})},{default:a(()=>_[6]||(_[6]=[x("注册账户 ")])),_:1})])]),_:1})}}}),_o=oe(vo,[["__scopeId","data-v-0466c42d"]]),go={class:"dida-login-footer"},bo=se({__name:"RegisterView",setup(e){const{globalProperties:l}=fe(),n=qe(),s=m(!1),o=m(!1),y=m(!1),w=m("发送验证码");let h=null,_=-1;const S=m(!1),d=m(null),c=m({username:"",password:"",confirmPassword:"",nickname:"",email:"",emailKey:""}),C=m({username:[{required:!0,message:"请填写用户名"},{min:4,message:"用户名至少4个字符"},{max:20,message:"用户名最多20个字符"},{pattern:/^[a-zA-Z0-9_]+$/,message:"用户名只能包含字母、数字和下划线"}],password:[{required:!0,message:"请填写密码"},{min:6,message:"密码至少6个字符"},{max:20,message:"密码最多20个字符"}],confirmPassword:[{required:!0,message:"请确认密码"},{validator:f=>new Promise(r=>{const v=setTimeout(()=>{r(c.value.password===f),clearTimeout(v)})}),message:"两次密码不一致"}],nickname:[{required:!0,message:"请填写昵称"},{min:1,message:"昵称至少1个字符"},{max:30,message:"昵称最多30个字符"}],email:[{required:!0,message:"请填写邮箱"},{pattern:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,message:"邮箱格式不正确"}],emailKey:[{required:!0,message:"请填写验证码"},{min:6,message:"请输入完整字符"},{max:6,message:"请输入完整字符"}]}),P=m(()=>t(B,{onClick:k,disabled:y.value,loading:o.value,style:"width:120px"},{default:()=>[w.value]})),k=async()=>{var z;if(!c.value.email){ve(l,"请输入邮箱");return}if(!c.value.email.match(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/)){ve(l,"邮箱格式不正确");return}if(y.value||o.value)return;S.value=!0,await ft();const f=document.getElementById("cf-confirm-div");f&&f.remove();const r=document.createElement("div");r.id="cf-confirm-div",r.setAttribute("data-theme","light"),(z=d.value)==null||z.appendChild(r);const v=window;v.turnstile.ready(function(){v.turnstile.render("#cf-confirm-div",{sitekey:"0x4AAAAAABeM4SYPu2Rn7PmI",callback:async function(D){S.value=!1,await u(D)},"before-interactive-callback":function(){console.log("before-interactive-callback")}})})},u=async f=>{if(!y.value){o.value=!0;try{const r=await uo(f,c.value.email);if(r.code!==0){G(l,r.code);return}ke(l,"发送验证码成功"),o.value=!1,y.value=!0,h=new Date,w.value="60秒后重发",_=setInterval(()=>{const z=Math.floor((new Date().getTime()-(h==null?void 0:h.getTime()))/1e3);z>60?(w.value="发送验证码",y.value=!1,clearInterval(_)):w.value=`${60-z}秒后重发`},1e3)}catch{ve(l,"发送验证码失败")}finally{o.value=!1}}},b=()=>{ke(l,"重置成功")},i=({validateResult:f,firstError:r,e:v})=>{if(!s.value){if(v.preventDefault(),f!==!0){ve(l,r);return}if(c.value.password!==c.value.confirmPassword){ve(l,"两次密码不一致");return}s.value=!0,co(c.value.username,c.value.password,c.value.email,c.value.emailKey,c.value.nickname).then(z=>{z.code===0?(ke(l,"注册成功，可使用账号信息登录"),l.$router.push({name:"login"})):G(l,z.code)}).catch(z=>{console.error("Login error",z),ve(l,"登录失败")}).finally(()=>{s.value=!1})}};return ce(()=>{if(n.isLogin()){l.$router.push({path:"/user"});return}}),je(()=>{clearInterval(_)}),(f,r)=>{const v=Ee,z=Re,D=Ca,V=B,p=Ke,A=nt,I=be,g=ot;return j(),ee(ue,null,[t(I,{class:"yj-login-card",title:"欢迎使用DidaOJ~"},{default:a(()=>[t(p,{ref:"form",rules:C.value,data:c.value,colon:!0,onReset:b,onSubmit:i,class:"yj-login-form"},{default:a(()=>[t(z,{name:"username",label:"用户名"},{default:a(()=>[t(v,{modelValue:c.value.username,"onUpdate:modelValue":r[0]||(r[0]=T=>c.value.username=T),clearable:"",placeholder:"用于登录与查找"},null,8,["modelValue"])]),_:1}),t(z,{name:"password",label:"密码"},{default:a(()=>[t(v,{modelValue:c.value.password,"onUpdate:modelValue":r[1]||(r[1]=T=>c.value.password=T),type:"password",clearable:"",placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),t(z,{name:"confirmPassword",label:"确认密码"},{default:a(()=>[t(v,{modelValue:c.value.confirmPassword,"onUpdate:modelValue":r[2]||(r[2]=T=>c.value.confirmPassword=T),type:"password",clearable:"",placeholder:"请确认密码"},null,8,["modelValue"])]),_:1}),t(z,{name:"nickname",label:"昵称"},{default:a(()=>[t(v,{modelValue:c.value.nickname,"onUpdate:modelValue":r[3]||(r[3]=T=>c.value.nickname=T),clearable:"",placeholder:"用于优先在网站各处展示"},null,8,["modelValue"])]),_:1}),t(z,{name:"email",label:"邮箱"},{default:a(()=>[t(v,{modelValue:c.value.email,"onUpdate:modelValue":r[4]||(r[4]=T=>c.value.email=T),clearable:"",placeholder:"请填写常用邮箱"},null,8,["modelValue"])]),_:1}),t(z,{name:"emailKey",label:"验证码"},{default:a(()=>[t(D,{append:P.value},{default:a(()=>[t(v,{modelValue:c.value.emailKey,"onUpdate:modelValue":r[5]||(r[5]=T=>c.value.emailKey=T),clearable:"",placeholder:"请输入验证码",style:{width:"140px"}},null,8,["modelValue"])]),_:1},8,["append"])]),_:1}),t(z,null,{default:a(()=>[t(V,{theme:"primary",type:"submit",block:"",loading:s.value},{default:a(()=>r[8]||(r[8]=[x("注册")])),_:1},8,["loading"])]),_:1})]),_:1},8,["rules","data"]),K("div",go,[t(A,{onClick:r[6]||(r[6]=()=>{me(l).$router.push({name:"login"})})},{default:a(()=>r[9]||(r[9]=[x("返回登陆 ")])),_:1})])]),_:1}),t(g,{visible:S.value,"onUpdate:visible":r[7]||(r[7]=T=>S.value=T),header:"正在加载人机验证","close-btn":!1,footer:!1},{default:a(()=>[K("div",{ref_key:"dialogContainer",ref:d,class:"cf-confirm-container"},null,512)]),_:1},8,["visible"])],64)}}}),yo=oe(bo,[["__scopeId","data-v-d25e7538"]]),ho={key:0},wo={key:0,style:{margin:"10px"}},ko={key:1,style:{margin:"10px"}},So={style:{margin:"12px"}},Co=se({__name:"UserView",setup(e){let l=Ce();const{globalProperties:n}=fe(),s=Ze(),o=qe();let y="";const w=m(!1),h=m(null),_=m([]);let S=null;const d=m({}),c=m({}),$=u=>{if(o.getUsername===y)return"success";let b="default";if(!S)return b;const i=S[u];if(i)switch(i){case Ae.Accept:b="success";break;case Ae.Attempt:b="warning";break}return b},C=(u,b)=>{const i=`https://vjudge.net/problem/${u}-${b}`;window.open(i,"_blank")},P=async()=>{if(S={},!o.isLogin()||o.getUsername===y||_.value.length===0)return;const u=await Ea(_.value);u.code===0?S=u.data:G(n,u.code,u.data)},k=async u=>{w.value=!0;try{let b=await oo(u);if(b.code!==0){w.value=!1,G(n,b.code),await X.push({name:"home"});return}h.value=ao(b.data.user);const i=b.data.problems_ac;if(i.sort((f,r)=>f.length===r.length?f.localeCompare(r):f.length-r.length),_.value=i,s.setTitle(h.value.nickname+" - "+s.getTitle),h.value.vjudgeId){const f=await so(h.value.vjudgeId);d.value=f.acRecords;for(const r in d.value)d.value[r].sort((v,z)=>v.length===z.length?v.localeCompare(z):v.length-z.length);c.value=f.failRecords;for(const r in c.value)c.value[r].sort((v,z)=>v.length===z.length?v.localeCompare(z):v.length-z.length)}await P()}catch{ve(n,"获取用户信息失败"),await X.push({name:"home"})}finally{w.value=!1}};return al(async(u,b,i)=>{if(Array.isArray(u.params.username)?y=u.params.username[0]:y=u.params.username,!y){await X.push({name:"home"});return}await k(y),i()}),ce(async()=>{if(Array.isArray(l.params.username)?y=l.params.username[0]:y=l.params.username,!y){await X.push({name:"home"});return}await k(y)}),(u,b)=>{const i=B,f=be,r=nt,v=Ye,z=We,D=De,V=$l,p=Te,A=$e;return j(),R(A,{loading:w.value},{default:a(()=>[t(p,{class:"dida-main-content"},{default:a(()=>[t(D,{span:8},{default:a(()=>{var I;return[t(f,{style:{margin:"10px"},title:"AC题目"},{default:a(()=>[_.value.length===0?(j(),ee("p",ho,b[0]||(b[0]=[K("span",null,"暂无AC题目",-1)]))):(j(!0),ee(ue,{key:1},xe(_.value,g=>(j(),R(i,{class:"dida-tag-button",key:g,size:"small",variant:"dashed",theme:$(g),onClick:()=>me(X).push({name:"problem-detail",params:{problemId:g}})},{default:a(()=>[x(E(g),1)]),_:2},1032,["theme","onClick"]))),128))]),_:1}),(I=h.value)!=null&&I.vjudgeId?(j(),R(f,{key:0,style:{margin:"10px"},title:"vjudge.net"},{actions:a(()=>{var g;return[t(r,{href:"https://vjudge.net/user/"+((g=h.value)==null?void 0:g.vjudgeId),target:"_blank"},{default:a(()=>{var T;return[x("@"+E((T=h.value)==null?void 0:T.vjudgeId),1)]}),_:1},8,["href"])]}),default:a(()=>[d.value&&Object.keys(d.value).length>0?(j(),ee("div",wo,[b[1]||(b[1]=K("div",{style:{margin:"5px"}},[K("span",null,"AC")],-1)),t(z,{layout:"vertical",bordered:!0},{default:a(()=>[(j(!0),ee(ue,null,xe(d.value,(g,T)=>(j(),R(v,{key:T,label:T},{default:a(()=>[(j(!0),ee(ue,null,xe(g,U=>(j(),R(i,{class:"dida-tag-button",key:U,variant:"dashed",size:"small",onClick:()=>C(T,U)},{default:a(()=>[x(E(U),1)]),_:2},1032,["onClick"]))),128))]),_:2},1032,["label"]))),128))]),_:1})])):le("",!0),c.value&&Object.keys(c.value).length>0?(j(),ee("div",ko,[b[2]||(b[2]=K("div",{style:{margin:"5px"}},[K("span",null,"Fail")],-1)),t(z,{layout:"vertical",bordered:!0},{default:a(()=>[(j(!0),ee(ue,null,xe(c.value,(g,T)=>(j(),R(v,{key:T,label:T},{default:a(()=>[(j(!0),ee(ue,null,xe(g,U=>(j(),R(i,{class:"dida-tag-button",key:U,variant:"dashed",size:"small",onClick:()=>C(T,U)},{default:a(()=>[x(E(U),1)]),_:2},1032,["onClick"]))),128))]),_:2},1032,["label"]))),128))]),_:1})])):le("",!0)]),_:1})):le("",!0)]}),_:1}),t(D,{span:4},{default:a(()=>[K("div",So,[t(z,{layout:"vertical",bordered:!0},{default:a(()=>[t(v,{label:"头像"},{default:a(()=>{var I;return[t(V,{shape:"round",size:"100px",image:(I=h.value)==null?void 0:I.avatar,"hide-on-load-failed":!1},null,8,["image"])]}),_:1}),t(v,{label:"昵称"},{default:a(()=>{var I;return[x(E((I=h.value)==null?void 0:I.nickname),1)]}),_:1}),t(v,{label:"Slogan"},{default:a(()=>{var I;return[x(E((I=h.value)==null?void 0:I.slogan),1)]}),_:1}),t(v,{label:"邮箱"},{default:a(()=>{var I;return[x(E((I=h.value)==null?void 0:I.email),1)]}),_:1}),t(v,{label:"组织"},{default:a(()=>{var I;return[x(E((I=h.value)==null?void 0:I.organization),1)]}),_:1}),t(v,{label:"通过数量"},{default:a(()=>{var I;return[x(E((I=h.value)==null?void 0:I.accept),1)]}),_:1}),t(v,{label:"提交数量"},{default:a(()=>{var I;return[x(E((I=h.value)==null?void 0:I.attempt),1)]}),_:1})]),_:1})])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),Po=oe(Co,[["__scopeId","data-v-ad24a344"]]),Yt=[{name:"home",path:"/",title:"首页",showSidebar:!1,disableGenerateTab:!0,component:Wn},{name:"problem",path:"/problem",title:"题目",icon:"calculation",showSidebar:!0,redirect:"problem-list"},{name:"collection-detail-tab",title:"题集",path:"/collection",showSidebar:!0,disableGenerateTab:!0,redirect:"problem-collection-list"},{name:"judge",path:"/judge",title:"评测",icon:"code",showSidebar:!0,redirect:"judge-list"},{name:"contest",path:"/contest",title:"比赛",icon:"application",showSidebar:!0,redirect:"contest-list"},{name:"contest-detail-tab",title:"比赛",path:"/contest",showSidebar:!0,disableGenerateTab:!0,redirect:"contest-list"},{name:"discuss",title:"讨论",path:"/discuss",icon:"sonic",showSidebar:!0,redirect:"discuss-list"},{name:"discuss-detail-tab",title:"讨论",path:"/discuss",showSidebar:!0,disableGenerateTab:!0,redirect:"discuss-list"},{name:"rank",path:"/rank",title:"排名",icon:"chart-column",showSidebar:!0,redirect:"rank-ac-all"},{name:"study",path:"/study",title:"研习",icon:"book-open",showSidebar:!1,component:Qn},{name:"system",path:"/system",title:"系统",icon:"dashboard",showSidebar:!0,redirect:"system-status"},{name:"manage",path:"/manage",title:"管理",icon:"command",showSidebar:!0,redirect:"manage-web",auths:[Ue.ManageWeb]},{name:"login",path:"/login",title:"登陆",showSidebar:!1,disableGenerateTab:!0,component:_o},{name:"register",path:"/register",title:"注册",showSidebar:!1,disableGenerateTab:!0,component:yo},{name:"user",path:"/user/:username+",title:"用户",showSidebar:!1,disableGenerateTab:!0,component:Po},{name:"404",path:"/404",title:"404",showSidebar:!1,disableGenerateTab:!0,component:qa}],Io=e=>Yt.find(l=>l.name==e),To=e=>{const l=[];return Yt.forEach(n=>{!n.disableGenerateTab&&e.hasAllAuths(n.auths)&&l.push(n)}),l},xo=e=>{Yt.forEach(l=>{const n={name:l.name,path:l.path,meta:{title:l.title,tab:l.name,showSidebar:l.showSidebar,needLogin:l.needLogin,redirect:l.redirect,tabAuths:l.auths},component:l.component};e.push(n)})};function Fa(e){return e.children!==void 0}function Vo(e){return e.children!==void 0}const Xt=async(e,l)=>{l&&await e.push({name:"user",params:{username:l}})},sa=e=>{const l=X.resolve({name:"problem-detail",params:{problemId:e}});window.open(l.href,"_blank")},Ot=async e=>{await X.push({name:"problem-detail",params:{problemKey:e}})},vt=async(e,l)=>{await X.push({name:"contest-problem-detail",params:{contestId:e,problemIndex:l}})},Do={style:{margin:"10px"}},$o={key:0,class:"dida-operation-container"};function jo(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!at(e)}const Lo=se({__name:"ProblemList",setup(e){const l=Ce(),n=Xe(),{globalProperties:s}=fe(),o=qe();let y=!1,w=null;const h=m(!1),_={};let S={};const d=m(!1),c=Je(()=>o.hasAuth(Ue.ManageProblem)),$=m([{title:"标识",colKey:"key",cell:(U,L)=>{let F=z(L.row.id);return t(B,{variant:"dashed",theme:F,onClick:()=>Ot(L.row.key)},{default:()=>[L.row.key]})}},{title:"标题",colKey:"title",cell:(U,L)=>t(B,{variant:"text",onClick:()=>Ot(L.row.key)},{default:()=>[L.row.title]})},{title:"标签",colKey:"tags",cell:(U,L)=>{const F=L.row.tags;if(!F||F.length===0)return"";let M=[];for(let te=0;te<F.length;te++){const Z=F[te];M.push(t(B,{key:te,theme:"default",variant:"outline",size:"small",onClick:()=>A(Z)},{default:()=>[Z.name]}))}return t(Se,null,jo(M)?M:{default:()=>[M]})}},{title:"正确",colKey:"accept"},{title:"提交",colKey:"attempt"}]),C=m(!1);let P=1,k=50;const u=m({current:P,pageSize:k,defaultCurrent:P,defaultPageSize:k,total:0,pageSizeOptions:[50,100]}),b=m(),i=m(),f=[{label:"DidaOJ",value:"didaoj"},{label:"HDU",value:"hdu"},{label:"POJ",value:"poj"},{label:"NYOJ",value:"nyoj"}],r=m({oj:"",title:"",tag:"",private:!1}),v=m({oj:"",problem:""}),z=U=>{if(!U||!S)return"default";const L=S[U];if(!L)return"default";switch(L){case Ae.Accept:return"success";case Ae.Attempt:return"warning";default:return"default"}},D=async()=>{await n.push({query:{...l.query,oj:r.value.oj,title:r.value.title,tag:r.value.tag,private:r.value.private?"1":"0",page:1,page_size:u.value.defaultPageSize}})},V=async()=>{r.value.oj="",r.value.title="",r.value.tag="",r.value.private=!1,await n.push({query:{...l.query,oj:"",title:"",tag:"",private:"0",page:1,page_size:u.value.defaultPageSize}})},p=async()=>{try{d.value=!0;const U=await Ma(v.value.oj,v.value.problem);U.code===0?(ke(s,"搜索成功"),await n.push({name:"problem-detail",params:{problemKey:U.data}})):G(s,U.code)}catch(U){console.error(U),G(s,He())}finally{d.value=!1}},A=U=>{U&&n.push({query:{...l.query,title:"",tag:U.name,page:1,page_size:u.value.defaultPageSize}})},I=()=>{n.push({name:"manage-problem-create"})},g=async(U,L)=>{C.value=!0;try{const{current:F,pageSize:M}=U,te=await Dn(r.value.oj,r.value.title,r.value.tag,r.value.private,F,M);if(b.value=[],te.code===0){const Z=te.data.list;if(!Z||Z.length<=0){u.value={...u.value,total:0},S={},ke(s,"未找到记录");return}Z.forEach(re=>{var de;const J=yt(re,_);(de=b.value)==null||de.push(J)}),u.value={...u.value,total:te.data.total_count},S=te.data.problem_attempt_status}else L&&G(s,te.code)}catch(F){console.error(F),G(s,He())}finally{C.value=!1}},T=async U=>{await n.push({query:{...l.query,page:U.current,page_size:U.pageSize}})};return ce(async()=>{y=!0,C.value=!0,i.value=[],Ra(-1).then(U=>{if(U.code===0){i.value=U.data.list,h.value=U.data.total_count>U.data.list.length;for(let L=0;L<U.data.list.length;L++){const F=U.data.list[L];_[F.id]=F}w=ze(()=>l.query,L=>{if(!y)return;r.value.oj=L.oj||"",r.value.title=L.title||"",r.value.tag=L.tag||"",r.value.private=L.private==="1";const F=parseInt(L.page)||u.value.defaultCurrent,M=parseInt(L.page_size)||u.value.defaultPageSize;P=F,k=M,u.value={...u.value,current:P,pageSize:k},g({current:P,pageSize:k},!0)},{immediate:!0})}else h.value=!0}).catch(U=>{console.error(U),h.value=!0})}),je(()=>{y=!1,w&&w()}),(U,L)=>{const F=Fe,M=be,te=De,Z=B,re=Se,J=gt,de=Re,ye=Ee,Ie=bt,O=Ke,N=Te;return j(),R(N,null,{default:a(()=>[t(te,{span:9},{default:a(()=>[t(M,{style:{margin:"10px"}},{default:a(()=>[t(F,{data:b.value,columns:$.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:u.value,"table-layout":"auto",loading:C.value,onPageChange:T},null,8,["data","columns","pagination","loading"])]),_:1})]),_:1}),t(te,{span:3},{default:a(()=>[K("div",Do,[c.value?(j(),ee("div",$o,[t(re,null,{default:a(()=>[t(Z,{onClick:I},{default:a(()=>L[7]||(L[7]=[x("新建")])),_:1})]),_:1})])):le("",!0),t(M,{class:"sh-card"},{default:a(()=>[t(O,{model:r.value,onSubmit:D,onReset:V},{default:a(()=>[t(de,{label:"OJ"},{default:a(()=>[t(J,{modelValue:r.value.oj,"onUpdate:modelValue":L[0]||(L[0]=q=>r.value.oj=q),options:f,placeholder:"请选择OJ",clearable:""},null,8,["modelValue"])]),_:1}),t(de,{label:"标题"},{default:a(()=>[t(ye,{modelValue:r.value.title,"onUpdate:modelValue":L[1]||(L[1]=q=>r.value.title=q),placeholder:"请输入关键词"},null,8,["modelValue"])]),_:1}),t(de,{label:"标签"},{default:a(()=>[t(ye,{modelValue:r.value.tag,"onUpdate:modelValue":L[2]||(L[2]=q=>r.value.tag=q),placeholder:"暂不支持模糊查询"},null,8,["modelValue"])]),_:1}),c.value?(j(),R(de,{key:0,label:"私有"},{default:a(()=>[t(Ie,{modelValue:r.value.private,"onUpdate:modelValue":L[3]||(L[3]=q=>r.value.private=q)},null,8,["modelValue"])]),_:1})):le("",!0),t(de,null,{default:a(()=>[t(re,null,{default:a(()=>[t(Z,{theme:"primary",type:"submit"},{default:a(()=>L[8]||(L[8]=[x("搜索")])),_:1}),t(Z,{theme:"danger",type:"reset"},{default:a(()=>L[9]||(L[9]=[x("重置")])),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(M,{class:"sh-card"},{default:a(()=>[t(O,{model:v.value,onSubmit:p},{default:a(()=>[t(de,{label:"OJ"},{default:a(()=>[t(J,{modelValue:v.value.oj,"onUpdate:modelValue":L[4]||(L[4]=q=>v.value.oj=q),options:f,placeholder:"请选择OJ",clearable:""},null,8,["modelValue"])]),_:1}),t(de,{label:"题目"},{default:a(()=>[t(ye,{modelValue:v.value.problem,"onUpdate:modelValue":L[5]||(L[5]=q=>v.value.problem=q),placeholder:"请输入原始题号"},null,8,["modelValue"])]),_:1}),t(de,null,{default:a(()=>[t(Z,{theme:"primary",type:"submit",loading:d.value},{default:a(()=>L[10]||(L[10]=[x("前往")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1}),i.value&&i.value.length>0?(j(),R(M,{key:1,class:"sh-card sh-background-black"},{default:a(()=>[(j(!0),ee(ue,null,xe(i.value,q=>(j(),R(Z,{class:"sh-tag-button",theme:"default",variant:"outline",ghost:!0,onClick:()=>A(q)},{default:a(()=>[x(E(q.name),1)]),_:2},1032,["onClick"]))),256)),h.value?(j(),R(Z,{key:0,class:"sh-tag-button",theme:"default",variant:"outline",ghost:!0,onClick:L[6]||(L[6]=()=>U.$router.push("/problem/tags"))},{default:a(()=>L[11]||(L[11]=[x(" ... ")])),_:1})):le("",!0)]),_:1})):le("",!0)])]),_:1})]),_:1})}}}),Uo=oe(Lo,[["__scopeId","data-v-2927598f"]]);function tt(e){let l="";for(;e>0;)e--,l=String.fromCharCode(65+e%26)+l,e=Math.floor(e/26);return l}function Zt(e){const l={};if(l.id=e.id,l.title=e.title,l.startTime=new Date(e.start_time).toLocaleString(),l.endTime=new Date(e.end_time).toLocaleString(),l.private=e.private,l.inserter=e.inserter,l.inserterUsername=e.inserter_username,l.inserterNickname=e.inserter_nickname,l.insertTime=new Date(e.insert_time).toLocaleString(),l.modifier=e.modifier,l.modifierUsername=e.modifier_username,l.modifierNickname=e.modifier_nickname,l.modifyTime=new Date(e.modify_time).toLocaleString(),l.description=e.description,l.notification=e.notification,e.problems){l.problems=[],e.problems.sort((n,s)=>n.index-s.index);for(let n=0;n<e.problems.length;n++){const s=e.problems[n];let o={accept:0,attempt:0,inserter:"",id:"",private:!1,tags:[],title:""};o.index=s.index,o.id=tt(s.index),o.title=s.title,s.accept?o.accept=s.accept:o.accept=0,s.attempt?o.attempt=s.attempt:o.attempt=0,l.problems.push(o)}}return l}function Ao(e){return W({url:"/contest?id="+e,method:"get"})}function zo(e){return W({url:"/contest/edit?id="+e,method:"get"})}function Ko(e){return W({url:"/contest/problem/list?id="+e,method:"get"})}function Ro(e){return e||(e=0),W({url:"/contest/image/token?id="+e,method:"get"})}function Eo(e,l){return W({url:"/contest/problem?id="+e+"&problem_index="+l,method:"get"})}function Mo(e,l,n,s){const o={};return e&&(o.title=e),l&&(o.username=l),n&&(o.page=String(n)),s&&(o.page_size=String(s)),W({url:`/contest/list?${new URLSearchParams(o).toString()}`,method:"get"})}function qo(e){return W({url:"/contest/rank?id="+e,method:"get"})}function Fo(e){return W({url:"/contest/create",method:"post",data:e})}function No(e){return W({url:"/contest/edit",method:"post",data:e})}function Oo(e,l){return W({url:"/contest/password",method:"post",data:{id:e,password:l}})}function Go(e){return W({url:"/contest/dolos",method:"post",data:{id:e}})}const Ho={class:"sh-button"},Bo={style:{"margin-top":"16px"}},Jo={__name:"SecretPanel",setup(e){const l=m(!1);return(n,s)=>{const o=B;return j(),ee("div",sl(rl(n.$attrs)),[K("div",Ho,[t(o,{onClick:s[0]||(s[0]=y=>l.value=!l.value)},{default:a(()=>[x(E(l.value?"收起":"展开"),1)]),_:1})]),ll(K("div",Bo,[ol(n.$slots,"default",{},void 0)],512),[[nl,l.value]])],16)}}},ra=oe(Jo,[["__scopeId","data-v-83e9f414"]]),Wo={key:1,style:{"text-align":"center"}},Yo={key:1,style:{"text-align":"center"}},Xo={key:0,class:"dida-problems-container"},Zo={style:{margin:"12px"}},Qo={key:1},es={class:"dida-operation-container"},ts={key:0,class:"dida-operation-container"},as={class:"dida-code-submit-div"},ls={class:"dida-code-editor-div"},ns=se({__name:"ProblemDetail",setup(e){let l=Ce();const{globalProperties:n}=fe();let s=null;const o=Ze(),y=qe();let w=m(""),h="",_=0,S="",d=0,c=m(0);const $=m(!1),C=m(!1),P=m(!1),k=m(null);let u=null;const b=m(null),i=m(!1),f=m(!1),r={},v=m(""),z=m([]);z.value=Jt();const D=m([]),V=m(null),p=m(-1),A=m(-1),I=m(""),g=m("");let T=0;const U=Je(()=>y.hasAuth(Ue.ManageProblem)),L=Je(()=>y.hasAuth(Ue.ManageProblemDaily)),F=()=>{V.value&&clearInterval(V.value),V.value=setInterval(()=>{const Q=p.value<=0,Y=new Date(new Date().getTime()+T),ae=Y.getHours()*60*60+Y.getMinutes()*60+Y.getSeconds(),_e=18*60*60;ae<_e?p.value=_e-ae:p.value=-1,A.value=24*60*60-ae,(!Q&&p.value<=0||A.value<=0)&&pe()},1e3)},M=()=>{V.value&&(clearInterval(V.value),V.value=null)},te=Q=>{Q&&X.push({name:"problem-list",query:{...l.query,title:"",tag:Q.name}})},Z=async()=>{if(!S){ve(n,"每日问题标识无效");return}await X.push({name:"manage-problem-daily",params:{dailyId:S}})},re=async()=>{let Q=h;if(!Q)try{const Y=await Eo(d,c.value);Y.code===0?Q=Y.data:G(n,Y.code)}catch{ve(n,"获取题目ID失败，请稍后再试");return}await X.push({name:"manage-problem",params:{problemKey:Q}})},J=()=>{h?X.push({name:"judge-list",query:{problem_id:h}}):X.push({name:"contest-judge",params:{contestId:d},query:{problem_id:tt(c.value)}})},de=()=>{h?X.push({name:"discuss-list-problem",query:{problem_id:h}}):X.push({name:"contest-discuss",params:{contestId:d},query:{problem_id:tt(c.value)}})},ye=()=>{X.push({name:"problem-recommend",params:{problemId:h}})},Ie=async()=>{var ae,_e;const Q=(ae=k.value)==null?void 0:ae.originOj,Y=(_e=k.value)==null?void 0:_e.originId;if(!(!Q||!Y))try{i.value=!0;const Pe=await Ma(Q,Y);Pe.code===0?(await q(),ke(n,"更新成功")):G(n,Pe.code)}catch{ve(n,"更新失败，请稍后再试")}finally{i.value=!1}},O=async()=>{const Q=parseInt(v.value);if(!Ct(Q)){ve(n,"请选择所编写的语言");return}const Y=u==null?void 0:u.getValue();if(!Y){ve(n,"请输入所需提交的代码");return}if(!h&&(!d||!c.value)){ve(n,"问题标识无效");return}f.value=!0;try{const ae=await hn(_,d,c.value,Q,Y);if(ae.code!==0){G(n,ae.code);return}ke(n,"提交成功，正在跳转到详情页面");const _e=ae.data.id;d?await X.push({name:"contest-judge-detail",params:{contestId:d,judgeId:_e}}):await X.push({name:"judge-detail",params:{judgeId:_e}})}finally{f.value=!1}},N=Q=>{if(!u)return;const Y=u.getModel();Y&&na.setModelLanguage(Y,Wt(Q))},q=async()=>{D.value=[];let Q=await Ka(h,d,c.value);if(Q.code!==0){P.value=!1,G(n,Q.code),await X.push({name:"problem"});return}Q.data.tags&&Q.data.tags.forEach(Y=>{r[Y.id]=Y}),Q.data.problem.tags=Q.data.tags.map(Y=>Y.id),k.value=yt(Q.data.problem,r),_=k.value.id,h=k.value.key,o.setTitle(k.value.title+" - "+o.getTitle),d&&(Q=await Ko(d),Q.code===0?(Q.data.problems.sort((Y,ae)=>Y-ae),D.value=Q.data.problems):G(n,Q.code)),w.value=k.value.description,await ft(()=>{!u&&b.value&&(u=na.create(b.value,{value:"",language:"cpp",minimap:{enabled:!0},colorDecorators:!0,readOnly:!1,theme:"vs-dark"})),P.value=!1})},pe=async()=>{M(),C.value=!1;const Q=await jn(S);if(Q.code!==0)return;C.value=!0;const Y=Q.data.problem_daily;h=Y.problem_key,I.value=Y.solution,g.value=Y.code;const ae=new Date(Q.data.time);T=ae.getTime()-new Date().getTime();const _e=new Date(ae.getTime()),Pe=_e.getFullYear(),H=String(_e.getMonth()+1).padStart(2,"0"),ie=String(_e.getDate()).padStart(2,"0"),we=`${Pe}-${H}-${ie}`;if(S===we){const ge=ae.getHours()*60*60+ae.getMinutes()*60+ae.getSeconds(),Ve=18*60*60;ge<Ve?p.value=Ve-ge:p.value=-1,A.value=24*60*60-ge}(p.value>=0||A.value>=0)&&F()};return ce(async()=>{s=ze(()=>l.params,async()=>{if(C.value=!1,Array.isArray(l.params.problemKey)?h=l.params.problemKey[0]:h=l.params.problemKey,Array.isArray(l.params.dailyId)?S=l.params.dailyId[0]:S=l.params.dailyId,Array.isArray(l.params.contestId)?d=Number(l.params.contestId[0]):d=Number(l.params.contestId),!h&&S&&(P.value=!0,await pe(),P.value=!1),!h)if(d){if(Array.isArray(l.params.problemIndex)?c.value=parseInt(l.params.problemIndex[0]):c.value=parseInt(l.params.problemIndex),!c.value){ve(n,"题目不存在"),await X.push({name:"contest-detail",params:{contestId:d}});return}}else ve(n,"题目不存在"),S?await X.push({name:"problem-daily-list"}):await X.push({name:"problem"});$.value=!!d,P.value=!0,await q()},{immediate:!0}),b.value&&new ResizeObserver(()=>{u&&u.layout()}).observe(b.value)}),je(()=>{s&&(s(),s=null),M()}),(Q,Y)=>{const ae=Me("md-preview"),_e=be,Pe=Gt,H=Se,ie=De,we=B,ge=Ye,Ve=nt,he=We,Ne=Ht,lt=gt,st=Te,rt=$e;return j(),R(rt,{loading:P.value},{default:a(()=>[t(st,{class:"dida-main-content"},{default:a(()=>[t(ie,{span:8},{default:a(()=>[t(_e,{style:{margin:"10px"}},{default:a(()=>[t(ae,{"model-value":me(w),previewTheme:"cyanosis"},null,8,["model-value"])]),_:1}),C.value?(j(),R(_e,{key:0,style:{margin:"10px"},title:"题解"},{default:a(()=>[p.value<0?(j(),R(ra,{key:0},{default:a(()=>[t(ae,{"model-value":I.value,previewTheme:"cyanosis"},null,8,["model-value"])]),_:1})):(j(),ee("div",Wo,[K("div",null,[t(H,null,{default:a(()=>[Y[2]||(Y[2]=K("p",null,"距离解锁百分比",-1)),t(Pe,{theme:"circle",color:{from:"#0052D9",to:"#00A870"},percentage:100-p.value/(18*60*60)*100,status:"active"},{label:a(()=>[x(E((100-p.value/(18*60*60)*100).toFixed(3))+"% ",1)]),default:a(()=>[Y[1]||(Y[1]=x(" > "))]),_:1},8,["percentage"])]),_:1})])]))]),_:1})):le("",!0),C.value?(j(),R(_e,{key:1,style:{margin:"10px"},title:"示例代码"},{default:a(()=>[A.value<0?(j(),R(ra,{key:0},{default:a(()=>[t(ae,{"model-value":g.value,previewTheme:"cyanosis"},null,8,["model-value"])]),_:1})):(j(),ee("div",Yo,[K("div",null,[t(H,{style:{margin:"0 auto"}},{default:a(()=>[Y[4]||(Y[4]=K("p",null,"距离解锁百分比",-1)),t(Pe,{theme:"circle",color:{from:"#0052D9",to:"#00A870"},percentage:100-A.value/(24*60*60)*100,status:"active"},{label:a(()=>[x(E((100-A.value/(24*60*60)*100).toFixed(3))+"% ",1)]),default:a(()=>[Y[3]||(Y[3]=x(" > "))]),_:1},8,["percentage"])]),_:1})])]))]),_:1})):le("",!0)]),_:1}),t(ie,{span:4},{default:a(()=>{var ta;return[me(d)?(j(),ee("div",Xo,[t(H,{style:{"flex-wrap":"wrap"}},{default:a(()=>[(j(!0),ee(ue,null,xe(D.value,(Oe,wt)=>(j(),R(we,{key:wt,theme:Oe==me(c)?"primary":"default",onClick:async()=>await me(vt)(me(d),Oe)},{default:a(()=>[x(E(me(tt)(Oe)),1)]),_:2},1032,["theme","onClick"]))),128))]),_:1})])):le("",!0),K("div",Zo,[t(he,{layout:"vertical",bordered:!0},{default:a(()=>{var Oe,wt;return[(Oe=k.value)!=null&&Oe.key?(j(),R(ge,{key:0,label:"标识"},{default:a(()=>{var ne;return[x(E((ne=k.value)==null?void 0:ne.key),1)]}),_:1})):le("",!0),t(ge,{label:"标题"},{default:a(()=>{var ne;return[x(E((ne=k.value)==null?void 0:ne.title),1)]}),_:1}),t(ge,{label:"时间限制"},{default:a(()=>{var ne;return[x(E((ne=k.value)==null?void 0:ne.timeLimit),1)]}),_:1}),t(ge,{label:"内存限制"},{default:a(()=>{var ne;return[x(E((ne=k.value)==null?void 0:ne.memoryLimit),1)]}),_:1}),t(ge,{label:"判题方式"},{default:a(()=>{var ne;return[x(E((ne=k.value)==null?void 0:ne.judgeType),1)]}),_:1}),$.value?le("",!0):(j(),R(ge,{key:1,label:"正确提交"},{default:a(()=>{var ne;return[x(E((ne=k.value)==null?void 0:ne.accept),1)]}),_:1})),$.value?le("",!0):(j(),R(ge,{key:2,label:"提交总数"},{default:a(()=>{var ne;return[x(E((ne=k.value)==null?void 0:ne.attempt),1)]}),_:1})),t(ge,{label:"创建时间"},{default:a(()=>{var ne;return[x(E((ne=k.value)==null?void 0:ne.insertTime),1)]}),_:1}),t(ge,{label:"编辑时间"},{default:a(()=>{var ne;return[x(E((ne=k.value)==null?void 0:ne.modifyTime),1)]}),_:1}),t(ge,{label:"上传用户"},{default:a(()=>{var ne;return[x(E((ne=k.value)==null?void 0:ne.inserterNickname),1)]}),_:1}),$.value?le("",!0):(j(),R(ge,{key:3,label:"题目来源"},{default:a(()=>{var ne,et,pt;return[(ne=k.value)!=null&&ne.sourceUrl?(j(),R(Ve,{key:0,href:(et=k.value)==null?void 0:et.sourceUrl,target:"_blank"},{default:a(()=>{var aa;return[x(E((aa=k.value)==null?void 0:aa.source),1)]}),_:1},8,["href"])):(j(),ee("span",Qo,E((pt=k.value)==null?void 0:pt.source),1))]}),_:1})),U.value?(j(),R(ge,{key:4,label:"是否私有"},{default:a(()=>{var ne;return[x(E((ne=k.value)!=null&&ne.private?"私有":"公开"),1)]}),_:1})):le("",!0),(wt=k.value)!=null&&wt.originUrl?(j(),R(ge,{key:5,label:"原题链接"},{default:a(()=>{var ne;return[t(Ve,{href:(ne=k.value)==null?void 0:ne.originUrl,target:"_blank"},{default:a(()=>{var et,pt;return[x(E((et=k.value)==null?void 0:et.originOj)+" - "+E((pt=k.value)==null?void 0:pt.originId),1)]}),_:1},8,["href"])]}),_:1})):le("",!0),me(h)?(j(),R(ge,{key:6,label:"标签"},{default:a(()=>{var ne;return[(j(!0),ee(ue,null,xe((ne=k.value)==null?void 0:ne.tags,et=>(j(),R(we,{class:"dida-tag-button",key:et.id,variant:"dashed",size:"small",onClick:()=>te(et)},{default:a(()=>[x(E(et.name),1)]),_:2},1032,["onClick"]))),128))]}),_:1})):le("",!0)]}),_:1}),K("div",es,[t(H,null,{default:a(()=>[t(we,{onClick:J},{default:a(()=>Y[5]||(Y[5]=[x("提交记录")])),_:1}),t(we,{onClick:de},{default:a(()=>Y[6]||(Y[6]=[x("题目讨论")])),_:1}),me(h)?(j(),R(we,{key:0,onClick:ye},{default:a(()=>Y[7]||(Y[7]=[x("题目推荐")])),_:1})):le("",!0)]),_:1})]),C.value&&L.value||U.value||(ta=k.value)!=null&&ta.originId?(j(),ee("div",ts,[t(H,null,{default:a(()=>{var Oe;return[C.value&&L.value?(j(),R(we,{key:0,onClick:Z},{default:a(()=>Y[8]||(Y[8]=[x("每日一题")])),_:1})):le("",!0),U.value?(j(),R(we,{key:1,onClick:re},{default:a(()=>Y[9]||(Y[9]=[x("编辑")])),_:1})):le("",!0),(Oe=k.value)!=null&&Oe.originId?(j(),R(we,{key:2,onClick:Ie,loading:i.value},{default:a(()=>Y[10]||(Y[10]=[x("更新描述 ")])),_:1},8,["loading"])):le("",!0)]}),_:1})])):le("",!0),K("div",as,[t(H,null,{default:a(()=>[t(lt,{modelValue:v.value,"onUpdate:modelValue":Y[0]||(Y[0]=Oe=>v.value=Oe),label:"语言：",placeholder:"请选择提交语言","auto-width":"",clearable:"",onChange:N},{default:a(()=>[(j(!0),ee(ue,null,xe(z.value,Oe=>(j(),R(Ne,{key:Oe.value,value:Oe.value,label:Oe.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"]),t(we,{onClick:O,loading:f.value},{default:a(()=>Y[11]||(Y[11]=[x("提交")])),_:1},8,["loading"])]),_:1}),K("div",ls,[K("div",{ref_key:"codeEditRef",ref:b,class:"dida-code-editor"},null,512)])])])]}),_:1})]),_:1})]),_:1},8,["loading"])}}}),At=oe(ns,[["__scopeId","data-v-4a4ee46d"]]),os={style:{margin:"10px"}},ss={key:0,class:"dida-operation-container"};function rs(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!at(e)}const is=se({__name:"ProblemDailyList",setup(e){const l=Ce(),n=Xe(),{globalProperties:s}=fe(),o=qe();let y=!1,w=null,h={},_={};const S=Je(()=>o.hasAuth(Ue.ManageProblem)),d=m([{title:"日期",colKey:"key",cell:(p,A)=>t(B,{variant:"dashed",onClick:()=>b(A.row.key)},{default:()=>[A.row.key]})},{title:"问题标识",colKey:"problemKey",cell:(p,A)=>{let I=i(A.row.problemId);return t(B,{variant:"dashed",theme:I,onClick:()=>b(A.row.key)},{default:()=>[A.row.problemKey]})}},{title:"标题",colKey:"title",cell:(p,A)=>t(B,{variant:"text",onClick:()=>b(A.row.key)},{default:()=>[A.row.title]})},{title:"标签",colKey:"tags",cell:(p,A)=>{const I=A.row.tags;if(!I||I.length===0)return"";let g=[];for(let T=0;T<I.length;T++){const U=I[T];g.push(t(B,{key:T,theme:"default",variant:"outline",size:"small",onClick:()=>v(U)},{default:()=>[U.name]}))}return t(Se,null,rs(g)?g:{default:()=>[g]})}},{title:"正确",colKey:"accept"},{title:"提交",colKey:"attempt"}]),c=m(!1);let $=1,C=50;const P=m({current:$,pageSize:C,defaultCurrent:$,defaultPageSize:C,total:0,pageSizeOptions:[50,100]}),k=m([]),u=m({date:[],problemKey:""}),b=p=>{p&&n.push({name:"problem-daily-detail",params:{dailyId:p}})},i=p=>{if(!p||!_)return"default";const A=_[p];if(!A)return"default";switch(A){case Ae.Accept:return"success";case Ae.Attempt:return"warning";default:return"default"}},f=async()=>{let p="";u.value.date&&u.value.date.length>1&&(p=u.value.date[0]+"~"+u.value.date[1]),await n.push({query:{...l.query,date:p,problem_key:u.value.problemKey,page:1,page_size:P.value.defaultPageSize}})},r=async()=>{u.value.date=[],u.value.problemKey="",await n.push({query:{...l.query,date:"",problem_key:"",page:1,page_size:P.value.defaultPageSize}})},v=p=>{p&&n.push({name:"problem-list",query:{...l.query,title:"",tag:p.name,page:1,page_size:P.value.defaultPageSize}})},z=()=>{n.push({name:"manage-problem-daily-create"})},D=async(p,A)=>{c.value=!0;try{const{current:I,pageSize:g}=p;let T="";u.value.date[0]&&(T=u.value.date[0]);let U="";u.value.date[1]&&(U=u.value.date[1]);const L=await An(T,U,u.value.problemKey,I,g);if(k.value=[],L.code===0){let F=[];if(L.data&&(F=L.data.list),!F||F.length<=0){P.value={...P.value,total:0},_={},ke(s,"未找到记录");return}h={},L.data.tags&&L.data.tags.forEach(M=>{h[M.id]=M}),F.forEach(M=>{var Z;const te=za(M,h);(Z=k.value)==null||Z.push(te)}),P.value={...P.value,total:L.data.total_count},_=L.data.attempt_status}else A&&G(s,L.code)}catch(I){console.error(I),G(s,He())}finally{c.value=!1}},V=async p=>{await n.push({query:{...l.query,page:p.current,page_size:p.pageSize}})};return ce(async()=>{y=!0,c.value=!0,w=ze(()=>l.query,p=>{if(!y)return;if(u.value.date=[],p.date){const g=p.date.split("~");g.length===2&&(u.value.date=[g[0],g[1]])}u.value.problemKey=p.problem_key||"";const A=parseInt(p.page)||P.value.defaultCurrent,I=parseInt(p.page_size)||P.value.defaultPageSize;$=A,C=I,P.value={...P.value,current:$,pageSize:C},D({current:$,pageSize:C},!0)},{immediate:!0})}),je(()=>{y=!1,w&&w()}),(p,A)=>{const I=Fe,g=be,T=De,U=B,L=Se,F=Bt,M=Re,te=Ee,Z=Ke,re=Te;return j(),R(re,null,{default:a(()=>[t(T,{span:9},{default:a(()=>[t(g,{style:{margin:"10px"}},{default:a(()=>[t(I,{data:k.value,columns:d.value,"row-key":"key","vertical-align":"top",hover:!0,pagination:P.value,"table-layout":"auto",loading:c.value,onPageChange:V},null,8,["data","columns","pagination","loading"])]),_:1})]),_:1}),t(T,{span:3},{default:a(()=>[K("div",os,[S.value?(j(),ee("div",ss,[t(L,null,{default:a(()=>[t(U,{onClick:z},{default:a(()=>A[2]||(A[2]=[x("新建")])),_:1})]),_:1})])):le("",!0),t(g,{class:"sh-card"},{default:a(()=>[t(Z,{model:u.value,onSubmit:f,onReset:r},{default:a(()=>[t(M,{label:"日期","label-align":"top"},{default:a(()=>[t(F,{modelValue:u.value.date,"onUpdate:modelValue":A[0]||(A[0]=J=>u.value.date=J),"allow-input":"",clearable:"",format:"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),t(M,{label:"问题","label-align":"top"},{default:a(()=>[t(te,{modelValue:u.value.problemKey,"onUpdate:modelValue":A[1]||(A[1]=J=>u.value.problemKey=J),placeholder:"请输入问题标识",clearable:""},null,8,["modelValue"])]),_:1}),t(M,{"label-align":"top"},{default:a(()=>[t(L,null,{default:a(()=>[t(U,{theme:"primary",type:"submit"},{default:a(()=>A[3]||(A[3]=[x("搜索")])),_:1}),t(U,{theme:"danger",type:"reset"},{default:a(()=>A[4]||(A[4]=[x("重置")])),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(g,{class:"sh-card",header:"每日一题","header-bordered":!0},{default:a(()=>A[5]||(A[5]=[K("p",null,"由管理员团队精选的题目，每日0点更新。",-1),K("p",null,"当日下午6点提供题解，次日提供AC代码。",-1)])),_:1})])]),_:1})]),_:1})}}}),us=oe(is,[["__scopeId","data-v-06d29751"]]),ds={style:{margin:"10px"}},cs={style:{margin:"12px"}},ms={class:"dida-edit-container"},ps=se({__name:"ProblemDailyEdit",setup(e){let l=Ce();const{globalProperties:n}=fe();let s=null;const o=m(""),y=m(!1),w=m(!1),h=m(null),_=m({date:"",problemKey:"",solution:"",code:""}),S=()=>{X.push({name:"problem-daily-detail",params:{dailyId:o.value}})};async function d(b,i){w.value=!0,await ct(b,i,n,()=>Fn(o.value)),w.value=!1}const c=async()=>{w.value=!0;try{const b=_.value.date,i=await Rn(b,_.value.problemKey,_.value.solution,_.value.code);if(w.value=!0,i.code!==0){G(n,i.code);return}await X.push({name:"manage-problem-daily",params:{dailyId:b}}),Ge(n,"创建成功")}finally{w.value=!1}},$=async()=>{w.value=!0;try{const b=await En(o.value,_.value.problemKey,_.value.solution,_.value.code);if(w.value=!0,b.code!==0){G(n,b.code);return}h.value&&(b.data.update_time!=null&&(h.value.modifyTime=new Date(b.data.modify_time).toLocaleString()),b.data.updater_nickname!=null&&(h.value.modifierNickname=b.data.updater_nickname)),b.data.solution!=null&&(_.value.solution=b.data.solution),b.data.code!=null&&(_.value.code=b.data.code),Ge(n,"保存成功")}finally{w.value=!1}},C=async()=>{o.value?await $():await c()},P=b=>{_.value.solution=b,y.value=!1},k=b=>{_.value.code=b,y.value=!1},u=async()=>{const b=await Ln(o.value);if(b.code!==0){G(n,b.code),console.error("problem get failed",b.code),await X.push({name:"problem-daily-list"});return}const i=b.data;h.value=za(i,{}),_.value.problemKey=i.problem_key,P(i.solution),k(i.code)};return ce(async()=>{s=ze(()=>l.params,async()=>{Array.isArray(l.params.dailyId)?o.value=l.params.dailyId[0]:o.value=l.params.dailyId,o.value?(y.value=!0,_.value.date=o.value,await u()):(P("暂无题解"),k("暂无标程"))},{immediate:!0})}),je(()=>{s&&(s(),s=null)}),(b,i)=>{const f=xt,r=jl,v=Re,z=Ee,D=Ke,V=be,p=De,A=B,I=Se,g=Ye,T=We,U=Te,L=Me("md-editor-v3"),F=$e;return j(),R(F,{loading:y.value},{default:a(()=>[t(U,null,{default:a(()=>[t(p,{span:8},{default:a(()=>[K("div",ds,[t(f,{theme:"info"},{default:a(()=>i[4]||(i[4]=[x("可以提前配置将来日期的题目，对外仅展示到截止到当天的题目")])),_:1}),t(V,{class:"sh-form-card"},{default:a(()=>[t(D,{model:_.value},{default:a(()=>[t(v,{label:"日期"},{default:a(()=>[t(r,{modelValue:_.value.date,"onUpdate:modelValue":i[0]||(i[0]=M=>_.value.date=M),disabled:o.value&&!0},null,8,["modelValue","disabled"])]),_:1}),t(v,{label:"问题标识"},{default:a(()=>[t(z,{modelValue:_.value.problemKey,"onUpdate:modelValue":i[1]||(i[1]=M=>_.value.problemKey=M),placeholder:"问题标题"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})])]),_:1}),t(p,{span:4},{default:a(()=>[K("div",cs,[K("div",ms,[o.value?(j(),R(I,{key:0},{default:a(()=>[t(A,{onClick:$,theme:"danger",loading:w.value},{default:a(()=>i[5]||(i[5]=[x("保存")])),_:1},8,["loading"]),t(A,{onClick:S},{default:a(()=>i[6]||(i[6]=[x("查看")])),_:1})]),_:1})):(j(),R(I,{key:1},{default:a(()=>[t(A,{onClick:c,theme:"danger",loading:w.value},{default:a(()=>i[7]||(i[7]=[x("创建")])),_:1},8,["loading"])]),_:1}))]),o.value?(j(),R(T,{key:0,layout:"vertical",bordered:!0},{default:a(()=>[t(g,{label:"创建时间"},{default:a(()=>{var M;return[x(E((M=h.value)==null?void 0:M.insertTime),1)]}),_:1}),t(g,{label:"更新时间"},{default:a(()=>{var M;return[x(E((M=h.value)==null?void 0:M.modifyTime),1)]}),_:1}),t(g,{label:"创建用户"},{default:a(()=>{var M;return[x(E((M=h.value)==null?void 0:M.inserterNickname),1)]}),_:1}),t(g,{label:"更新用户"},{default:a(()=>{var M;return[x(E((M=h.value)==null?void 0:M.modifierNickname),1)]}),_:1})]),_:1})):le("",!0)])]),_:1})]),_:1}),K("div",null,[i[8]||(i[8]=K("p",{style:{"margin-left":"20px"}},"题解：",-1)),t(L,{id:"daily-solution-editor",modelValue:_.value.solution,"onUpdate:modelValue":i[2]||(i[2]=M=>_.value.solution=M),onSave:C,onOnUploadImg:d,previewTheme:"cyanosis"},null,8,["modelValue"]),t(F,{loading:w.value,attach:"#daily-solution-editor","z-index":1e5},null,8,["loading"])]),K("div",null,[i[9]||(i[9]=K("p",{style:{"margin-left":"20px"}},"标程：",-1)),t(L,{id:"daily-code-editor",modelValue:_.value.code,"onUpdate:modelValue":i[3]||(i[3]=M=>_.value.code=M),onSave:C,onOnUploadImg:d,previewTheme:"cyanosis"},null,8,["modelValue"]),t(F,{loading:w.value,attach:"#daily-code-editor","z-index":1e5},null,8,["loading"])])]),_:1},8,["loading"])}}}),ia=oe(ps,[["__scopeId","data-v-0cb52a06"]]),fs={style:{margin:"10px"}};function vs(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!at(e)}const _s=se({__name:"ProblemRecommend",setup(e){const l=Ce(),n=Xe(),{globalProperties:s}=fe();let o=null,y="",w={},h={};const _=m([{title:"ID",colKey:"id",cell:(k,u)=>{let b=$(u.row.id);return t(B,{variant:"dashed",theme:b,onClick:()=>c(u.row.id)},{default:()=>[u.row.id]})}},{title:"标题",colKey:"title",cell:(k,u)=>t(B,{variant:"text",onClick:()=>c(u.row.id)},{default:()=>[u.row.title]})},{title:"标签",colKey:"tags",cell:(k,u)=>{const b=u.row.tags;if(!b||b.length===0)return"";let i=[];for(let f=0;f<b.length;f++){const r=b[f];i.push(t(B,{key:f,theme:"default",variant:"outline",size:"small",onClick:()=>C(r)},{default:()=>[r.name]}))}return t(Se,null,vs(i)?i:{default:()=>[i]})}},{title:"正确",colKey:"accept"},{title:"提交",colKey:"attempt"}]),S=m(!1),d=m(),c=k=>{k&&n.push({path:"/problem/"+k})},$=k=>{if(!k||!h)return"default";const u=h[k];if(!u)return"default";switch(u){case Ae.Accept:return"success";case Ae.Attempt:return"warning";default:return"default"}},C=k=>{k&&n.push({name:"problem-list",query:{tag:k.name}})},P=async k=>{S.value=!0;try{const u=await $n(y);if(d.value=[],u.code===0){const b=u.data.list;if(!b||b.length<=0){ke(s,"暂无推荐题目");return}w={},u.data.tags&&u.data.tags.forEach(i=>{w[i.id]=i}),b.forEach(i=>{var r;const f=yt(i,w);(r=d.value)==null||r.push(f)})}else k&&G(s,u.code)}catch(u){console.error(u),G(s,He())}finally{S.value=!1}};return ce(async()=>{S.value=!0,o=ze(()=>l.query,k=>{Array.isArray(l.params.problemId)?y=l.params.problemId[0]:y=l.params.problemId,P(!0)},{immediate:!0})}),je(()=>{o&&o()}),(k,u)=>{const b=Fe,i=be,f=De,r=Te;return j(),R(r,null,{default:a(()=>[t(f,{span:9},{default:a(()=>[t(i,{style:{margin:"10px"}},{default:a(()=>[t(b,{data:d.value,columns:_.value,"row-key":"id","vertical-align":"top",hover:!0,"table-layout":"auto",loading:S.value},null,8,["data","columns","loading"])]),_:1})]),_:1}),t(f,{span:3},{default:a(()=>[K("div",fs,[t(i,{class:"sh-card",header:"题目推荐","header-bordered":!0},{default:a(()=>u[0]||(u[0]=[x(" 根据本站其他用户的提交记录推荐类似题目"),K("br",null,null,-1),x("依据推荐算法来计算，与本用户相似度最高的用户做的题，大概率被自己感兴趣。 ")])),_:1})])]),_:1})]),_:1})}}}),gs=oe(_s,[["__scopeId","data-v-77972e8b"]]),bs={style:{margin:"10px"}},ys={key:1},hs={style:{margin:"12px"}},ws={class:"dida-edit-container"},ks={class:"dida-description-editor"},Ss=se({__name:"ProblemEdit",setup(e){let l=Ce();const{globalProperties:n}=fe(),s=Ze();let o=0;const y=m(""),w=m(!1),h=m(!1),_=m(!1),S=m(null),d=m({title:"",timeLimit:0,memoryLimit:0,source:"",private:!0,tags:[],description:""}),c=m([]),$=m([]),C=Je(()=>{const V=[],p=c.value;for(let A=0,I=p.length;A<I;A++)p[A].value&&V.push(p[A].value);return V}),P=(V,p)=>{const{trigger:A,index:I,item:g}=p;if(A==="clear"&&(c.value=[]),["tag-remove","backspace"].includes(A)&&c.value.splice(I,1),A==="enter"){for(let U=0;U<$.value.length;U++){const L=$.value[U];if(L.label===g){for(let F=0;F<c.value.length;F++)if(c.value[F].label===L.label)return;c.value.push(L);return}}const T={label:g,value:g};c.value.push(T),$.value=$.value.concat(T)}},k=(V,{current:p,type:A})=>{if(!p){c.value=A==="check"?$.value.slice(1):[];return}if(A==="check"){const I=$.value.find(g=>g.value===p);if(!I)return;c.value.push(I)}else c.value=c.value.filter(I=>I.value!==p)},u=()=>{X.push({name:"problem-detail",params:{problemKey:y.value}})},b=()=>{X.push({name:"manage-problem-judge",params:{problemKey:y.value}})},i=async(V,p)=>{_.value=!0,await ct(V,p,n,()=>qn(o)),_.value=!1},f=async()=>{h.value=!0,d.value.tags=[];for(let V=0;V<c.value.length;V++){const p=c.value[V];p&&p.label&&d.value.tags.push(p.label)}try{const V=await zn(d.value.title,d.value.timeLimit,d.value.memoryLimit,d.value.source,d.value.private,d.value.tags,d.value.description);if(h.value=!0,V.code!==0){G(n,V.code);return}V.data!=null&&await X.push({name:"problem-detail",params:{problemKey:V.data}}),Ge(n,"创建成功")}finally{h.value=!1}},r=async()=>{h.value=!0,d.value.tags=[];for(let V=0;V<c.value.length;V++){const p=c.value[V];p&&p.label&&d.value.tags.push(p.label)}try{const V=await Kn(o,d.value.title,d.value.timeLimit,d.value.memoryLimit,d.value.source,d.value.private,d.value.tags,d.value.description);if(h.value=!0,V.code!==0){G(n,V.code);return}S.value&&V.data.modify_time!=null&&(S.value.modifyTime=new Date(V.data.modify_time).toLocaleString()),V.data.description!=null&&(d.value.description=V.data.description),Ge(n,"保存成功")}finally{h.value=!1}},v=async()=>{o?await r():await f()},z=V=>{d.value.description=V,w.value=!1},D=async()=>{const V=await Ka(y.value,void 0,void 0);if(V.code!==0){G(n,V.code),console.error("problem get failed",V.code),await X.push({name:"problem"});return}const p=V.data.problem;if(o=p.id,S.value=yt(p,{}),d.value.title=p.title,d.value.timeLimit=p.time_limit,d.value.memoryLimit=p.memory_limit,d.value.source=p.source,d.value.private=p.private,d.value.tags=[],c.value=[],V.data.tags)for(let I=0;I<V.data.tags.length;I++){const g=V.data.tags[I];g&&g.name&&(d.value.tags.push(g.name),c.value.push({label:g.name,value:g.id}))}s.setTitle(p.title+" - "+s.getTitle);let A=p.description;z(A)};return ce(async()=>{Array.isArray(l.params.problemKey)?y.value=l.params.problemKey[0]:y.value=l.params.problemKey,y.value?(w.value=!0,Ra(-1).then(async V=>{V.code===0?(V.data.list&&V.data.list.forEach(p=>{$.value.push({label:p.name,value:p.id})}),await D()):(G(n,V.code),console.error("problem tag get failed",V.code),await X.push({name:"problem"}))}).catch(async V=>{console.error(V),G(n,"获取数据异常"),await X.push({name:"problem"})})):(d.value.timeLimit=1e3,d.value.memoryLimit=65536,z(""))}),(V,p)=>{const A=Ee,I=Re,g=Pa,T=bt,U=Ul,L=Ll,F=Ke,M=be,te=De,Z=B,re=Se,J=Ye,de=We,ye=Te,Ie=Me("md-editor-v3"),O=$e;return j(),R(O,{loading:w.value},{default:a(()=>[t(ye,null,{default:a(()=>[t(te,{span:8},{default:a(()=>[K("div",bs,[t(M,{class:"sh-card"},{default:a(()=>[t(F,{model:d.value},{default:a(()=>[t(I,{label:"标题"},{default:a(()=>[t(A,{modelValue:d.value.title,"onUpdate:modelValue":p[0]||(p[0]=N=>d.value.title=N),placeholder:"问题标题"},null,8,["modelValue"])]),_:1}),t(I,{label:"时间限制"},{default:a(()=>[t(g,{modelValue:d.value.timeLimit,"onUpdate:modelValue":p[1]||(p[1]=N=>d.value.timeLimit=N),theme:"normal",min:0},{suffix:a(()=>p[6]||(p[6]=[K("span",null,"ms",-1)])),_:1},8,["modelValue"])]),_:1}),t(I,{label:"内存限制"},{default:a(()=>[t(g,{modelValue:d.value.memoryLimit,"onUpdate:modelValue":p[2]||(p[2]=N=>d.value.memoryLimit=N),theme:"normal",min:0},{suffix:a(()=>p[7]||(p[7]=[K("span",null,"KB",-1)])),_:1},8,["modelValue"])]),_:1}),t(I,{label:"来源"},{default:a(()=>[t(A,{modelValue:d.value.source,"onUpdate:modelValue":p[3]||(p[3]=N=>d.value.source=N),placeholder:"请输入题目来源"},null,8,["modelValue"])]),_:1}),t(I,{label:"私有"},{default:a(()=>[t(T,{modelValue:d.value.private,"onUpdate:modelValue":p[4]||(p[4]=N=>d.value.private=N)},null,8,["modelValue"])]),_:1}),t(I,{label:"标签"},{default:a(()=>[t(L,{value:c.value,"allow-input":!0,placeholder:"请选择或输入","tag-input-props":{excessTagsDisplayType:"break-line"},"popup-props":{overlayInnerClassName:["narrow-scrollbar"],overlayInnerStyle:{maxHeight:"280px",overflowY:"auto",overscrollBehavior:"contain",padding:"6px"}},clearable:"",multiple:"",onTagChange:P},{panel:a(()=>[$.value.length?(j(),R(U,{key:0,value:C.value,options:$.value,onChange:k},null,8,["value","options"])):(j(),ee("div",ys,"暂无数据"))]),suffixIcon:a(()=>[t(me(il))]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1})])]),_:1}),t(te,{span:4},{default:a(()=>[K("div",hs,[K("div",ws,[me(o)?(j(),R(re,{key:0},{default:a(()=>[t(Z,{onClick:r,theme:"danger",loading:h.value},{default:a(()=>p[8]||(p[8]=[x("保存")])),_:1},8,["loading"]),t(Z,{onClick:b,theme:"warning"},{default:a(()=>p[9]||(p[9]=[x("判题数据")])),_:1}),t(Z,{onClick:u},{default:a(()=>p[10]||(p[10]=[x("查看")])),_:1})]),_:1})):(j(),R(re,{key:1},{default:a(()=>[t(Z,{onClick:f,theme:"danger",loading:h.value},{default:a(()=>p[11]||(p[11]=[x("创建")])),_:1},8,["loading"])]),_:1}))]),me(o)?(j(),R(de,{key:0,layout:"vertical",bordered:!0},{default:a(()=>[t(J,{label:"创建时间"},{default:a(()=>{var N;return[x(E((N=S.value)==null?void 0:N.insertTime),1)]}),_:1}),t(J,{label:"编辑时间"},{default:a(()=>{var N;return[x(E((N=S.value)==null?void 0:N.modifyTime),1)]}),_:1}),t(J,{label:"判题方式"},{default:a(()=>{var N;return[x(E((N=S.value)==null?void 0:N.judgeType),1)]}),_:1}),t(J,{label:"上传用户"},{default:a(()=>{var N;return[x(E((N=S.value)==null?void 0:N.inserterNickname),1)]}),_:1})]),_:1})):le("",!0)])]),_:1})]),_:1}),K("div",ks,[p[12]||(p[12]=K("p",null,"题目描述",-1)),t(O,{loading:_.value||h.value},{default:a(()=>[t(Ie,{modelValue:d.value.description,"onUpdate:modelValue":p[5]||(p[5]=N=>d.value.description=N),onSave:v,onOnUploadImg:i,previewTheme:"cyanosis"},null,8,["modelValue"])]),_:1},8,["loading"])])]),_:1},8,["loading"])}}}),ua=oe(Ss,[["__scopeId","data-v-3c11a94e"]]),Cs={style:{margin:"10px"}},Ps={style:{margin:"12px"}},Is={class:"dida-edit-container"},Ts=se({__name:"ProblemJudge",setup(e){let l=Ce();const{globalProperties:n}=fe(),s=Ze(),o=m("");let y=0;const w=m(!1),h=m(null);let _=null;const S=m(null),d=m(""),c=m(!1),$=m(!1),C=m([{title:"文件",colKey:"file"},{title:"大小",colKey:"size",width:150,cell:(I,g)=>{let T=g.row.size,U;return T>10*1024?T>1024*1024?U=(T/(1024*1024)).toFixed(3)+" MB":U=(T/1024).toFixed(3)+" KB":U=T+" B",U}},{title:"最后编辑时间",colKey:"lastModified",width:180,cell:(I,g)=>new Date(g.row.lastModified).toLocaleString()},{title:"操作",colKey:"action",width:100,cell:(I,g)=>t(B,{onClick:()=>f(g.row.file)},{default:()=>[x("下载")]})}]),P=m([]),k=Je(()=>({border:"2px dashed #ccc",borderRadius:"6px",padding:"20px",textAlign:"center",cursor:"pointer",backgroundColor:c.value?"#f0f9ff":"#fff",transition:"background-color 0.2s ease"})),u=Je(()=>d.value?`已选择：${d.value}`:c.value?"松开文件以上传":"拖拽判题数据压缩包到这里，或点击选择文件"),b=()=>{X.push({name:"problem-detail",params:{problemKey:o.value}})},i=()=>{X.push({name:"manage-problem",params:{problemKey:o.value}})},f=async I=>{const g=await Mn(y,I);if(g.code!==0){G(n,g.code);return}const T=document.createElement("a");T.href=g.data,T.target="_blank",T.click(),URL.revokeObjectURL(T.href)},r=async()=>{if(!_){ve(n,"请选择压缩包");return}$.value=!0,Nn(y,_).then(async I=>{I.code==0?(S.value.value=null,_=null,d.value="",w.value=!0,Ge(n,"上传成功"),await A()):en(n,I.code,I.data)}).catch(I=>{console.log(I),n.$message.error({duration:3e3,content:"上传失败"})}).finally(()=>{$.value=!1})},v=()=>{var I;(I=S.value)==null||I.click()},z=I=>{const g=I.target.files[0];g&&(d.value=g.name,_=g)},D=I=>{c.value=!0},V=()=>{c.value=!1},p=I=>{I.preventDefault(),I.stopPropagation(),c.value=!1;const g=I.dataTransfer.files[0];if(g){d.value=g.name;const T=new DataTransfer;T.items.add(g),S.value.files=T.files,_=g}},A=async()=>{const I=await Vn(o.value);if(I.code!==0){G(n,I.code),await X.push({name:"problem"});return}const g=I.data.problem;y=g.id,h.value=yt(g,{}),s.setTitle(g.title+" - "+s.getTitle),P.value=[],I.data.judges?(I.data.judges.forEach(T=>{P.value.push({file:T.key,size:T.size,lastModified:T.last_modified})}),P.value.sort((T,U)=>T.file.endsWith(".zip")&&!U.file.endsWith(".zip")?-1:!T.file.endsWith(".zip")&&U.file.endsWith(".zip")?1:T.file.endsWith(".yaml")&&!U.file.endsWith(".yaml")?-1:!T.file.endsWith(".yaml")&&U.file.endsWith(".yaml")?1:0)):ve(n,"评测数据不存在"),w.value=!1};return ce(async()=>{if(Array.isArray(l.params.problemKey)?o.value=l.params.problemKey[0]:o.value=l.params.problemKey,!o.value){ve(n,"题目不存在"),await X.push({name:"problem"});return}w.value=!0,await A()}),(I,g)=>{const T=Fe,U=De,L=B,F=Se,M=Ye,te=We,Z=Te,re=$e;return j(),R(re,{loading:w.value},{default:a(()=>[t(Z,null,{default:a(()=>[t(U,{span:7},{default:a(()=>[K("div",Cs,[K("div",{id:"drop-zone",style:wa(k.value),onClick:v,onDragenter:Lt(D,["prevent"]),onDragover:g[0]||(g[0]=Lt(()=>{},["prevent"])),onDragleave:Lt(V,["prevent"]),onDrop:p},[K("input",{ref_key:"fileInput",ref:S,type:"file",style:{display:"none"},onChange:z},null,544),x(" "+E(u.value),1)],36)]),t(T,{data:P.value,columns:C.value,"row-key":"id","vertical-align":"top",hover:!0},null,8,["data","columns"])]),_:1}),t(U,{span:5},{default:a(()=>[K("div",Ps,[K("div",Is,[t(F,null,{default:a(()=>[t(L,{onClick:r,theme:"danger",loading:$.value},{default:a(()=>g[1]||(g[1]=[x("上传")])),_:1},8,["loading"]),t(L,{onClick:i,theme:"warning"},{default:a(()=>g[2]||(g[2]=[x("编辑")])),_:1}),t(L,{onClick:b},{default:a(()=>g[3]||(g[3]=[x("查看")])),_:1})]),_:1})]),t(te,{layout:"vertical",bordered:!0},{default:a(()=>[t(M,{label:"标题"},{default:a(()=>{var J;return[x(E((J=h.value)==null?void 0:J.title),1)]}),_:1}),t(M,{label:"创建时间"},{default:a(()=>{var J;return[x(E((J=h.value)==null?void 0:J.insertTime),1)]}),_:1}),t(M,{label:"编辑时间"},{default:a(()=>{var J;return[x(E((J=h.value)==null?void 0:J.modifyTime),1)]}),_:1}),t(M,{label:"判题方式"},{default:a(()=>{var J;return[x(E((J=h.value)==null?void 0:J.judgeType),1)]}),_:1}),t(M,{label:"评测数据"},{default:a(()=>{var J;return[x(E((J=h.value)==null?void 0:J.judgeMd5),1)]}),_:1}),t(M,{label:"上传用户"},{default:a(()=>{var J;return[x(E((J=h.value)==null?void 0:J.inserterNickname),1)]}),_:1})]),_:1})])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),xs=oe(Ts,[["__scopeId","data-v-be774f38"]]);function Qt(e){const l={};return l.id=e.id,l.inserter=e.inserter,l.inserterUsername=e.inserter_username,l.inserterNickname=e.inserter_nickname,l.title=e.title,e.start_time?l.startTime=new Date(e.start_time).toLocaleString():l.startTime="无限制",e.end_time?l.endTime=new Date(e.end_time).toLocaleString():l.endTime="无限制",e.update_time?l.updateTime=new Date(e.update_time).toLocaleString():l.updateTime="",e.create_time?l.createTime=new Date(e.create_time).toLocaleString():l.createTime="",e.description?l.description=e.description:l.description="",l}function Vs(e){return W({url:"/collection?id="+e,method:"get"})}function Ds(e){return W({url:"/collection/edit?id="+e,method:"get"})}function $s(e,l){return W({url:"/collection/list?page="+e+"&page_size="+l,method:"get"})}function js(e){return W({url:"/collection/rank?id="+e,method:"get"})}function Ls(e){return W({url:"/collection/create",method:"post",data:e})}function Us(e){return W({url:"/collection/edit",method:"post",data:e})}function As(e){return W({url:"/collection/join",method:"post",data:{id:e}})}function zs(e){return W({url:"/collection/quit",method:"post",data:{id:e}})}const Ks={style:{margin:"10px"}},Rs=se({__name:"CollectionList",setup(e){const l=Ce(),n=Xe(),{globalProperties:s}=fe();let o=null;m(!1),m(!1);const y=m([{title:"ID",colKey:"id",width:"100",cell:(b,i)=>t(B,{variant:"text",onClick:()=>$(i.row.id)},{default:()=>[i.row.id]})},{title:"标题",colKey:"title",cell:(b,i)=>t(B,{variant:"text",onClick:()=>$(i.row.id)},{default:()=>[i.row.title]})},{title:"负责人",colKey:"inserterNickname",width:"200"},{title:"开始时间",colKey:"startTime",width:"180"},{title:"结束时间",colKey:"endTime",width:"180"}]),w=m(!1);let h=1,_=50;const S=m({current:h,pageSize:_,defaultCurrent:h,defaultPageSize:_,total:0,pageSizeOptions:[50,100]}),d=m(),c=m({title:"",username:""});m({title:"",description:"",open_time:[]});const $=b=>{b&&n.push({path:"/collection/"+b})},C=async()=>{await n.push({query:{...l.query,title:c.value.title,username:c.value.username,page:1,page_size:S.value.defaultPageSize}})},P=async(b,i)=>{var f;w.value=!0;try{const{current:r,pageSize:v}=b,z=await $s(r,v);if(d.value=[],z.code===0){const D=z.data.list;for(let V=0;V<D.length;V++){const p=D[V],A=Qt(p);(f=d.value)==null||f.push(A)}S.value={...S.value,total:z.data.total_count}}else i&&G(s,z.code)}catch(r){console.error(r),G(s,He())}finally{w.value=!1}},k=async b=>{await n.push({query:{...l.query,page:b.current,page_size:b.pageSize}})},u=async()=>{await n.push({name:"collection-create"})};return ce(async()=>{o=ze(()=>l.query,b=>{c.value.title=b.title||"",c.value.username=b.username||"";const i=parseInt(b.page)||S.value.defaultCurrent,f=parseInt(b.page_size)||S.value.defaultPageSize;h=i,_=f,S.value={...S.value,current:h,pageSize:_},P({current:h,pageSize:_},!0)},{immediate:!0})}),je(()=>{o&&o()}),(b,i)=>{const f=Fe,r=be,v=De,z=Ee,D=Re,V=B,p=Ke,A=Se,I=Te;return j(),R(I,null,{default:a(()=>[t(v,{span:9},{default:a(()=>[t(r,{style:{margin:"10px"}},{default:a(()=>[t(f,{data:d.value,columns:y.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:S.value,loading:w.value,onPageChange:k},null,8,["data","columns","pagination","loading"])]),_:1})]),_:1}),t(v,{span:3},{default:a(()=>[K("div",Ks,[t(r,{class:"sh-card"},{default:a(()=>[t(p,{model:c.value},{default:a(()=>[t(D,{label:"标题"},{default:a(()=>[t(z,{modelValue:c.value.title,"onUpdate:modelValue":i[0]||(i[0]=g=>c.value.title=g),placeholder:"暂不支持模糊查询"},null,8,["modelValue"])]),_:1}),t(D,{label:"负责人"},{default:a(()=>[t(z,{modelValue:c.value.username,"onUpdate:modelValue":i[1]||(i[1]=g=>c.value.username=g),placeholder:"仅支持输入完整用户名"},null,8,["modelValue"])]),_:1}),t(D,null,{default:a(()=>[t(V,{theme:"primary",onClick:C},{default:a(()=>i[2]||(i[2]=[x("提交")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(r,{class:"sh-card"},{default:a(()=>[t(A,null,{default:a(()=>[t(V,{onClick:u},{default:a(()=>i[3]||(i[3]=[x("创建")])),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})}}}),Es=oe(Rs,[["__scopeId","data-v-7974b460"]]),Ms={style:{margin:"20px"}},qs={class:"dida-operation-container"},Fs={style:{margin:"12px"}},Ns=se({__name:"CollectionDetail",setup(e){let l=Ce();const{globalProperties:n}=fe(),s=Ze(),o=qe();let y=0;const w=m(!1),h=m(null),_=m(!1),S=m(!1);let d={};const c=Je(()=>o.hasAuth(Ue.ManageCollection)||h.value&&o.getUserId==h.value.ownerId),$=i=>{if(!i||!d)return"default";const f=d[i];if(!f)return"default";switch(f){case Ae.Accept:return"success";case Ae.Attempt:return"warning";default:return"default"}},C=m([{title:"问题标识",colKey:"id",cell:(i,f)=>{const r=$(f.row.id);return t(B,{variant:"dashed",theme:r,onClick:()=>sa(f.row.id)},{default:()=>[f.row.id]})}},{title:"标题",colKey:"title",cell:(i,f)=>t(B,{variant:"text",onClick:()=>sa(f.row.id)},{default:()=>[f.row.title]})},{title:"正确",colKey:"accept",cell:(i,f)=>f.row.accept?f.row.accept:0},{title:"提交",colKey:"attempt",cell:(i,f)=>f.row.attempt?f.row.attempt:0}]),P=m([]),k=async()=>{if(!o.isLogin()){await X.push({name:"login"});return}S.value=!0;try{const i=await As(y);if(i.code!==0){G(n,i.code);return}_.value=!0,Ge(n,"加入成功")}finally{S.value=!1}},u=async()=>{if(!o.isLogin()){await X.push({name:"login"});return}S.value=!0;try{const i=await zs(y);if(i.code!==0){G(n,i.code);return}_.value=!1,Ge(n,"退出成功")}finally{S.value=!1}},b=()=>{h.value&&X.push({name:"collection-edit",params:{collectionId:h.value.id}})};return ce(async()=>{if(Array.isArray(l.params.collectionId)?y=Number(l.params.collectionId[0]):y=Number(l.params.collectionId),!y){await X.push({name:"problem-collection-list"});return}_.value=!1,w.value=!0;const i=await Vs(y);if(i.code!==0){w.value=!1,G(n,i.code),await X.push({name:"problem-collection-list"});return}_.value=i.data.joined,d=i.data.attempt_status||{},h.value=Qt(i.data.collection),P.value=i.data.problems,s.setTitle(h.value.title+" - "+s.getTitle),w.value=!1}),(i,f)=>{const r=Ta,v=Ia,z=Fe,D=be,V=De,p=B,A=Se,I=Ye,g=We,T=Me("md-preview"),U=Te,L=$e;return j(),R(L,{loading:w.value},{default:a(()=>[t(U,{class:"dida-main-content"},{default:a(()=>[t(V,{span:6},{default:a(()=>[K("div",Ms,[t(v,{"max-item-width":"300"},{default:a(()=>[t(r,{to:{name:"problem-collection-list"}},{default:a(()=>f[0]||(f[0]=[x("题目集合")])),_:1}),t(r,null,{default:a(()=>{var F;return[x(E((F=h.value)==null?void 0:F.title),1)]}),_:1})]),_:1})]),t(D,{style:{margin:"10px"}},{default:a(()=>[t(z,{data:P.value,columns:C.value,"row-key":"id","vertical-align":"top","table-layout":"auto",hover:!0},null,8,["data","columns"])]),_:1})]),_:1}),t(V,{span:6},{default:a(()=>{var F;return[K("div",qs,[t(A,null,{default:a(()=>[_.value?(j(),R(p,{key:0,onClick:u,loading:S.value},{default:a(()=>f[1]||(f[1]=[x("退出")])),_:1},8,["loading"])):(j(),R(p,{key:1,onClick:k,loading:S.value},{default:a(()=>f[2]||(f[2]=[x("加入")])),_:1},8,["loading"])),c.value?(j(),R(p,{key:2,onClick:b},{default:a(()=>f[3]||(f[3]=[x("编辑")])),_:1})):le("",!0)]),_:1})]),K("div",Fs,[t(g,{layout:"vertical",bordered:!0},{default:a(()=>[t(I,{label:"创建者"},{default:a(()=>{var M;return[x(E((M=h.value)==null?void 0:M.ownerNickname),1)]}),_:1})]),_:1}),t(g,{layout:"vertical",bordered:!0},{default:a(()=>[t(I,{label:"开始时间"},{default:a(()=>{var M;return[x(E((M=h.value)==null?void 0:M.startTime),1)]}),_:1})]),_:1}),t(g,{layout:"vertical",bordered:!0},{default:a(()=>[t(I,{label:"结束时间"},{default:a(()=>{var M;return[x(E((M=h.value)==null?void 0:M.endTime),1)]}),_:1})]),_:1})]),(F=h.value)!=null&&F.description?(j(),R(D,{key:0,style:{margin:"10px"}},{default:a(()=>{var M;return[t(T,{"model-value":(M=h.value)==null?void 0:M.description},null,8,["model-value"])]}),_:1})):le("",!0)]}),_:1})]),_:1})]),_:1},8,["loading"])}}}),Os=oe(Ns,[["__scopeId","data-v-c2a1787e"]]),Gs=se({__name:"CollectionRank",setup(e){const l=Ce(),n=Xe(),{globalProperties:s}=fe();let o=null,y=0,w=0;const h=m([{title:"Rank",colKey:"rank",align:"center"},{title:"序号",colKey:"index",align:"center"},{title:"Username",colKey:"username",cell:($,C)=>t(B,{variant:"text",onClick:()=>n.push({name:"user",params:{username:C.row.username}})},{default:()=>[C.row.username]})},{title:"昵称",colKey:"nickname",cell:($,C)=>t(B,{variant:"text",onClick:()=>n.push({name:"user",params:{username:C.row.username}})},{default:()=>[C.row.nickname]})},{title:"Count",colKey:"count",cell:($,C)=>t(B,{variant:"text",onClick:()=>n.push({name:"judge-list",query:{username:C.row.username,status:Be.Accept}})},{default:()=>[`${C.row.accept} / ${w}`]})},{title:"Progress",colKey:"progress",cell:($,C)=>{let P=100;return w>0&&(P=Number((C.row.accept/w*100).toFixed(2))),t(Gt,{percentage:P},null)}}]),_=m(!1),S=m([]),d=({col:$,rowIndex:C})=>{let P=1;for(let k=C+1;k<S.value.length&&S.value[k].rank===S.value[C].rank;k++)P++;if($.colKey==="rank")return{rowspan:P}},c=async $=>{_.value=!0;try{const C=await js(y);if(S.value=[],C.code===0){w=C.data.problem;const P=C.data.ranks,k=[];if(P){for(let i=0;i<P.length;i++){const f=P[i];let r={userId:f.inserter,username:f.inserter_username,nickname:f.inserter_nickname};r.accept=f.accept,k.push(r)}k.sort((i,f)=>i.accept!==f.accept?f.accept-i.accept:i.userId-f.userId);let u=0,b=-1;for(let i=0;i<k.length;i++)k[i].accept!==b&&(u=i+1,b=k[i].accept),k[i].index=i+1,k[i].rank=u}S.value=k}else $&&G(s,C.code)}catch(C){console.error(C),G(s,He())}finally{_.value=!1}};return ce(async()=>{o=ze(()=>l.query,async()=>{if(Array.isArray(l.params.collectionId)?y=Number(l.params.collectionId[0]):y=Number(l.params.collectionId),!y){await n.push({name:"problem-collection-list"});return}await c(!0)},{immediate:!0})}),je(()=>{o&&o()}),($,C)=>{const P=Fe,k=be,u=Te;return j(),R(u,null,{default:a(()=>[t(k,{style:{margin:"10px"}},{default:a(()=>[K("div",null,[t(P,{data:S.value,columns:h.value,"row-key":"index","rowspan-and-colspan":d,"vertical-align":"middle",bordered:!0,hover:!0,loading:_.value},null,8,["data","columns","loading"])])]),_:1})]),_:1})}}});var Le=(e=>(e[e.Valid=0]="Valid",e[e.Duplicate=1]="Duplicate",e[e.Invalid=2]="Invalid",e))(Le||{});const Hs={class:"dida-form-border"},Bs={style:{"text-align":"right"}},Js=se({name:"ParseProblemList",__name:"ParseProblemList",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(e){const{globalProperties:l}=fe(),n=m(!1),s=m(!1),o=m(""),y=ka(e,"modelValue");let w=[];const h=m([]),_=m([{title:"有效性",colKey:"validType",cell:(C,P)=>{switch(P.row.valid){case Le.Valid:return t(Qe,{theme:"success"},{default:()=>[x("有效")]});case Le.Duplicate:return t(Qe,{theme:"warning"},{default:()=>[x("重复")]});case Le.Invalid:return t(Qe,{theme:"danger"},{default:()=>[x("无效")]});default:return null}}},{title:"问题标识",colKey:"key",cell:(C,P)=>{const k=`/problem/${P.row.key}`;return t(nt,{href:k,target:"_blank"},{default:()=>[P.row.key]})}},{title:"标题",colKey:"title"}]),S=async C=>{const P=Array.from(new Set(C)),k=await On(P.map(f=>f));if(k.code!==0){G(l,k.code),s.value=!1;return}const u=[],b=k.data.problems;let i=[];C.forEach(f=>{const r=b.find(v=>v.id===f);if(r){const v=u.find(z=>z.id===f);r.valid=v?Le.Duplicate:Le.Valid,u.push({id:r.id,key:r.key,title:r.title,valid:r.valid}),v||i.push(f)}else u.push({id:0,key:"-",title:"-",valid:Le.Invalid})}),h.value=u,w=i,y.value=i},d=async C=>{const P=Array.from(new Set(C)),k=await Gn(P);if(k.code!==0){G(l,k.code),s.value=!1;return}const u=[],b=k.data.problems;let i=[];C.forEach(f=>{const r=b.find(v=>v.key.toLowerCase()===f.toLowerCase());if(r){const v=u.find(z=>z.key.toLowerCase()===f.toLowerCase());r.valid=v?Le.Duplicate:Le.Valid,u.push({id:r.id,key:r.key,title:r.title,valid:r.valid}),v||i.push(r.id)}else u.push({id:0,key:f,title:"-",valid:Le.Invalid})}),h.value=u,w=i,y.value=i},c=async()=>{s.value=!0;const C=Da(o.value);await d(C),n.value=!1,s.value=!1},$=()=>{h.value?o.value=h.value.map(C=>C.id).join(`
`):o.value="",n.value=!0};return ze(y,async C=>{if(JSON.stringify(C)!==JSON.stringify(w)){if(!C){w=[];return}await S(C),y.value?w=y.value:w=[]}},{deep:!0,immediate:!0}),(C,P)=>{const k=B,u=Fe,b=Vt,i=ot;return j(),ee(ue,null,[K("div",Hs,[K("div",Bs,[t(k,{onClick:$},{default:a(()=>P[2]||(P[2]=[x("编辑")])),_:1})]),t(u,{data:h.value,columns:_.value,"row-key":"id","vertical-align":"top","table-layout":"auto",hover:!0},null,8,["data","columns"])]),t(i,{visible:n.value,"onUpdate:visible":P[1]||(P[1]=f=>n.value=f),onConfirm:c,header:"请输入问题标识","confirm-loading":s.value},{default:a(()=>[P[3]||(P[3]=K("div",{style:{"margin-bottom":"10px"}},[K("span",null,"多条请以空格、换行、英文逗号隔开")],-1)),t(b,{modelValue:o.value,"onUpdate:modelValue":P[0]||(P[0]=f=>o.value=f),autosize:{minRows:5}},null,8,["modelValue"])]),_:1},8,["visible","confirm-loading"])],64)}}}),Na=oe(Js,[["__scopeId","data-v-194e87f3"]]),Ws={class:"dida-form-border"},Ys={style:{"text-align":"right"}},Xs=se({name:"ParseUserList",__name:"ParseUserList",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(e){const{globalProperties:l}=fe(),n=m(!1),s=m(!1),o=m(""),y=ka(e,"modelValue");let w=[];ze(y,async P=>{JSON.stringify(P)!==JSON.stringify(w)&&(w=P,await d(P))},{deep:!0});const h=m(),_=m([{title:"有效性",colKey:"validType",cell:(P,k)=>{switch(k.row.valid){case Le.Valid:return t(Qe,{theme:"success"},{default:()=>[x("有效")]});case Le.Duplicate:return t(Qe,{theme:"warning"},{default:()=>[x("重复")]});case Le.Invalid:return t(Qe,{theme:"danger"},{default:()=>[x("无效")]})}}},{title:"Username",colKey:"username"},{title:"昵称",colKey:"nickname"}]),S=(P,k)=>{if(P.code!==0){G(l,P.code),s.value=!1;return}const u=[],b=P.data.users;let i=[];k?k.forEach(f=>{let r=null;if(b&&(r=b.find(v=>v.username.toLowerCase()===f.toLowerCase())),r){const v=u.find(D=>D.username.toLowerCase()===f.toLowerCase()),z=v?Le.Duplicate:Le.Valid;u.push({id:r.id,username:r.username,nickname:r.nickname,valid:z}),v||i.push(r.id)}else u.push({id:-1,username:f,nickname:"-",valid:Le.Invalid})}):b&&b.forEach(f=>{const r=u.find(z=>z.id===f.id),v=r?Le.Duplicate:Le.Valid;u.push({id:f.id,username:f.username,nickname:f.nickname,valid:v}),r||i.push(f.id)}),h.value=u,w=i,y.value=i},d=async P=>{const k=Array.from(new Set(P)),u=await ro(k);S(u)},c=async P=>{const k=Array.from(new Set(P)),u=await io(k);S(u,P)},$=async()=>{s.value=!0;const P=Da(o.value);await c(P),n.value=!1,s.value=!1},C=()=>{h.value?o.value=h.value.map(P=>P.username).join(`
`):o.value="",n.value=!0};return(P,k)=>{const u=B,b=Fe,i=Vt,f=ot;return j(),ee(ue,null,[K("div",Ws,[K("div",Ys,[t(u,{onClick:C},{default:a(()=>k[2]||(k[2]=[x("编辑")])),_:1})]),t(b,{data:h.value,columns:_.value,"row-key":"id","vertical-align":"top","table-layout":"auto",hover:!0},null,8,["data","columns"])]),t(f,{visible:n.value,"onUpdate:visible":k[1]||(k[1]=r=>n.value=r),onConfirm:$,header:"请输入用户Username","confirm-loading":s.value},{default:a(()=>[k[3]||(k[3]=K("div",{style:{"margin-bottom":"10px"}},[K("span",null,"多条请以空格、换行、英文逗号隔开")],-1)),t(i,{modelValue:o.value,"onUpdate:modelValue":k[0]||(k[0]=r=>o.value=r),autosize:{minRows:5}},null,8,["modelValue"])]),_:1},8,["visible","confirm-loading"])],64)}}}),Oa=oe(Xs,[["__scopeId","data-v-d2170a86"]]),Zs={style:{margin:"10px"}},Qs={style:{margin:"12px"}},er={class:"dida-edit-container"},tr=se({__name:"CollectionEdit",setup(e){let l=Ce();const{globalProperties:n}=fe(),s=Ze(),o=m(""),y=m(!1),w=m(!1),h=m(!1),_=m(null),S=m({title:"",openTime:[],private:!0,problems:[],members:[],description:""}),d=m(""),c=m(""),$=m(!1),C=async()=>{$.value=!0,h.value=!1,$.value=!1},P=async()=>{w.value=!0;try{const f={title:S.value.title,problems:S.value.problems,members:S.value.members,private:S.value.private,description:S.value.description};S.value.openTime[0]&&(f.start_time=new Date(S.value.openTime[0])),S.value.openTime[1]&&(f.end_time=new Date(S.value.openTime[1]));const r=await Ls(f);if(r.code!==0){G(n,r.code);return}r.data!=null&&await X.push({name:"collection-detail",params:{collectionId:r.data}}),Ge(n,"创建成功")}finally{w.value=!1}},k=async()=>{w.value=!0;try{const f={id:Number(o.value),title:S.value.title,private:S.value.private,problems:S.value.problems,members:S.value.members,description:S.value.description};S.value.openTime[0]&&(f.start_time=new Date(S.value.openTime[0])),S.value.openTime[1]&&(f.end_time=new Date(S.value.openTime[1]));const r=await Us(f);if(r.code!==0){G(n,r.code);return}r.data!=null&&_.value&&(_.value.updateTime=new Date(r.data).toLocaleString()),Ge(n,"保存成功")}finally{w.value=!1}},u=f=>{S.value.description=f,y.value=!1};async function b(f,r){w.value=!0,ve(n,"本界面暂不支持上传图片"),w.value=!1}const i=async()=>{const f=await Ds(o.value);if(f.code!==0){G(n,f.code),console.error("collection get failed",f.code),await X.push({name:"problem-collection-list"});return}const r=f.data.collection;_.value=Qt(r),S.value.title=r.title,S.value.openTime=[],r.start_time?S.value.openTime.push(new Date(r.start_time)):S.value.openTime.push(""),r.end_time?S.value.openTime.push(new Date(r.end_time)):S.value.openTime.push(""),S.value.private=r.private,S.value.description=r.description,S.value.problems=r.problems,S.value.members=r.members,s.setTitle(r.title+" - "+s.getTitle);let v="";r.description&&(v=r.description),u(v)};return ce(async()=>{Array.isArray(l.params.collectionId)?o.value=l.params.collectionId[0]:o.value=l.params.collectionId,o.value?(y.value=!0,await i()):u("")}),(f,r)=>{const v=Ee,z=Re,D=Bt,V=bt,p=Ke,A=be,I=De,g=B,T=Se,U=Ye,L=We,F=Te,M=Me("md-editor-v3"),te=$e,Z=Vt,re=ot;return j(),ee(ue,null,[t(te,{loading:y.value},{default:a(()=>[t(F,null,{default:a(()=>[t(I,{span:8},{default:a(()=>[K("div",Zs,[t(A,{class:"sh-card"},{default:a(()=>[t(p,{model:S.value},{default:a(()=>[t(z,{label:"标题"},{default:a(()=>[t(v,{modelValue:S.value.title,"onUpdate:modelValue":r[0]||(r[0]=J=>S.value.title=J),placeholder:"题集标题"},null,8,["modelValue"])]),_:1}),t(z,{label:"开启时间"},{default:a(()=>[t(D,{modelValue:S.value.openTime,"onUpdate:modelValue":r[1]||(r[1]=J=>S.value.openTime=J),"allow-input":"",clearable:"",format:"YYYY-MM-DD HH:mm:ss","default-time":["00:00:00","23:59:59"]},null,8,["modelValue"])]),_:1}),t(z,{label:"私有"},{default:a(()=>[t(V,{modelValue:S.value.private,"onUpdate:modelValue":r[2]||(r[2]=J=>S.value.private=J)},null,8,["modelValue"])]),_:1}),t(z,{label:"成员"},{default:a(()=>[t(Oa,{modelValue:S.value.members,"onUpdate:modelValue":r[3]||(r[3]=J=>S.value.members=J)},null,8,["modelValue"])]),_:1}),t(z,{label:"问题"},{default:a(()=>[t(Na,{modelValue:S.value.problems,"onUpdate:modelValue":r[4]||(r[4]=J=>S.value.problems=J)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})])]),_:1}),t(I,{span:4},{default:a(()=>[K("div",Qs,[K("div",er,[o.value?(j(),R(T,{key:0},{default:a(()=>[t(g,{onClick:k,theme:"danger",loading:w.value},{default:a(()=>r[8]||(r[8]=[x("保存")])),_:1},8,["loading"])]),_:1})):(j(),R(T,{key:1},{default:a(()=>[t(g,{onClick:P,theme:"danger",loading:w.value},{default:a(()=>r[9]||(r[9]=[x("创建")])),_:1},8,["loading"])]),_:1}))]),o.value?(j(),R(L,{key:0,layout:"vertical",bordered:!0},{default:a(()=>[t(U,{label:"创建时间"},{default:a(()=>{var J;return[x(E((J=_.value)==null?void 0:J.createTime),1)]}),_:1}),t(U,{label:"编辑时间"},{default:a(()=>{var J;return[x(E((J=_.value)==null?void 0:J.updateTime),1)]}),_:1}),t(U,{label:"创建用户"},{default:a(()=>{var J;return[x(E((J=_.value)==null?void 0:J.inserterNickname),1)]}),_:1})]),_:1})):le("",!0)])]),_:1})]),_:1}),t(M,{id:"collection-description-editor",modelValue:S.value.description,"onUpdate:modelValue":r[5]||(r[5]=J=>S.value.description=J),onSave:k,onOnUploadImg:b,previewTheme:"cyanosis",class:"dida-description-editor"},null,8,["modelValue"]),t(te,{loading:w.value,attach:"#collection-description-editor","z-index":1e5},null,8,["loading"])]),_:1},8,["loading"]),t(re,{visible:h.value,"onUpdate:visible":r[7]||(r[7]=J=>h.value=J),onConfirm:C,header:d.value,"confirm-loading":$.value},{default:a(()=>[r[10]||(r[10]=K("div",{style:{"margin-bottom":"10px"}},[K("span",null,"多条请以空格、换行、英文逗号隔开")],-1)),t(Z,{modelValue:c.value,"onUpdate:modelValue":r[6]||(r[6]=J=>c.value=J),autosize:{minRows:5}},null,8,["modelValue"])]),_:1},8,["visible","header","confirm-loading"])],64)}}}),da=oe(tr,[["__scopeId","data-v-175825a1"]]);function ca(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!at(e)}const ar=se({__name:"JudgeJobList",setup(e){const l=Ce(),n=Xe(),{globalProperties:s}=fe();let o=!1,y=null,w;const h=m(!1),_=m(null),S=m(!1);let d=-1;const c=m({problemKey:"",username:"",language:void 0,status:void 0}),$=m([{title:"ID",colKey:"id",cell:(g,T)=>{let U=null;return Pt(T.row.status)&&Ct(T.row.language)&&(U=()=>{z(T.row.id)}),t(B,{variant:"text",onClick:U},{default:()=>[T.row.id]})}},{title:"问题",colKey:"problemKey",cell:(g,T)=>{if(d){let U;return t(B,{variant:"text",onClick:()=>vt(d,T.row.contestProblemIndex)},ca(U=tt(T.row.contestProblemIndex))?U:{default:()=>[U]})}return t(B,{variant:"text",onClick:()=>v(T.row.problemKey)},{default:()=>[T.row.problemKey]})}},{title:"状态",colKey:"status",align:"center",cell:(g,T)=>{let U=null;Pt(T.row.status)&&Ct(T.row.language)&&(U=()=>{z(T.row.id)});const L=T.row.status,F=Tt(L);let M=!Pt(L);const te=La(L);let Z=[];return dt(L)&&Z.push(t($e,{text:T.row.state,size:"small",class:"dida-status-loading"},null)),Z.push(t("span",null,[F])),t(B,{theme:te,variant:"outline",onClick:U,disabled:M},ca(Z)?Z:{default:()=>[Z]})}},{title:"分数",colKey:"score"},{title:"时间",colKey:"time"},{title:"内存",colKey:"memory"},{title:"代码",colKey:"code",cell:(g,T)=>{let U=!Ct(T.row.language);return t(B,{theme:"default",onClick:()=>r(T.row),disabled:U},{default:()=>[It(T.row.language)+" / "+T.row.codeLength]})}},{title:"作者",colKey:"inserter",width:200,cell:(g,T)=>t(B,{variant:"text",onClick:()=>D(T.row.inserterUsername)},{default:()=>[T.row.inserterNickname]})},{title:"提交时间",colKey:"insertTime",width:180}]),C=m(!1);let P=1,k=50;const u=m({current:P,pageSize:k,defaultCurrent:P,defaultPageSize:k,total:500,pageSizeOptions:[50,100],showPageSize:!1,totalContent:(g,T)=>t("div",null,[t(Qe,null,{default:()=>[x("目前仅支持获取前10页数据")]})])}),b=m(),i=m([]);i.value=Jt();const f=m([]);f.value=Ua();const r=async g=>{S.value=!0,h.value=!0;try{_.value=g;const T=await kn(Number(_.value.id));if(T.code===0){const U=T.data,L=Wt(U.language);_.value.code=`\`\`\`${L}
${U.code}
\`\`\``}else G(s,T.code)}finally{S.value=!1}},v=g=>{g&&n.push({path:"/problem/"+g})},z=g=>{g&&(d>0?n.push({name:"contest-judge-detail",params:{contestId:d,judgeId:g}}):n.push({name:"judge-detail",params:{judgeId:g}}))},D=g=>{g&&n.push({path:"/user/"+g})},V=async()=>{await n.push({query:{...l.query,page:1,page_size:k,problem_id:c.value.problemKey,username:c.value.username,language:c.value.language,status:c.value.status}})},p=async()=>{c.value.problemKey="",c.value.username="",c.value.language=void 0,c.value.status=void 0,await n.push({query:{...l.query,page:1,page_size:k,problem_id:"",username:"",language:void 0,status:void 0}})},A=async(g,T)=>{T&&(C.value=!0);let U=!1;try{const{current:L,pageSize:F}=g,M=await Sn(d,c.value.problemKey,c.value.username,c.value.language,c.value.status,L,F);if(b.value=[],M.code===0){if(!M.data.has_auth){ke(s,"您目前没有权限查看评测记录"),d?await n.push({name:"contest-detail",params:{contestId:d}}):await n.push({name:"judge-list"});return}M.data.list&&M.data.list.length>0?M.data.list.forEach(Z=>{var J;const re=Aa(Z);(J=b.value)==null||J.push(re),dt(Z.status)&&(U=!0)}):ke(s,"未找到记录")}else T&&G(s,M.code)}catch(L){console.error(L),T&&G(s,He())}finally{T&&(C.value=!1),U&&o&&(w=setTimeout(()=>{A({current:P,pageSize:k},!1)},5e3))}},I=async g=>{await n.push({query:{...l.query,page:g.current}})};return ce(async()=>{o=!0,y=ze(()=>l.query,g=>{Array.isArray(l.params.contestId)?d=Number(l.params.contestId[0]):d=Number(l.params.contestId),c.value.problemKey=g.problem_id||"",c.value.username=g.username||"",g.language!=null?c.value.language=Number(g.language):c.value.language=void 0,g.status!=null?c.value.status=Number(g.status):c.value.status=void 0;const T=parseInt(g.page)||u.value.defaultCurrent,U=parseInt(g.page_size)||u.value.defaultPageSize;P=T,k=U,u.value.pageSizeOptions.includes(k)||(k=u.value.defaultPageSize),u.value={...u.value,current:P,pageSize:k},A({current:P,pageSize:k},!0)},{immediate:!0})}),je(()=>{o=!1,y&&y(),clearTimeout(w)}),(g,T)=>{const U=Ee,L=Re,F=Ht,M=gt,te=B,Z=Se,re=Ke,J=Fe,de=be,ye=nt,Ie=Me("md-preview"),O=$e,N=ot;return j(),ee(ue,null,[t(de,{style:{margin:"10px"}},{default:a(()=>[t(re,{layout:"inline",onSubmit:V,onReset:p},{default:a(()=>[t(L,{label:"题号"},{default:a(()=>[t(U,{modelValue:c.value.problemKey,"onUpdate:modelValue":T[0]||(T[0]=q=>c.value.problemKey=q),placeholder:"请输入完整题号"},null,8,["modelValue"])]),_:1}),t(L,{label:"用户"},{default:a(()=>[t(U,{modelValue:c.value.username,"onUpdate:modelValue":T[1]||(T[1]=q=>c.value.username=q),placeholder:"仅支持输入完整用户名"},null,8,["modelValue"])]),_:1}),t(L,{label:"语言"},{default:a(()=>[t(M,{modelValue:c.value.language,"onUpdate:modelValue":T[2]||(T[2]=q=>c.value.language=q),placeholder:"请选择提交语言","auto-width":"",clearable:""},{default:a(()=>[(j(!0),ee(ue,null,xe(i.value,q=>(j(),R(F,{key:q.value,value:q.value,label:q.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(L,{label:"状态"},{default:a(()=>[t(M,{modelValue:c.value.status,"onUpdate:modelValue":T[3]||(T[3]=q=>c.value.status=q),placeholder:"请选择评测状态","auto-width":"",clearable:""},{default:a(()=>[(j(!0),ee(ue,null,xe(f.value,q=>(j(),R(F,{key:q.value,value:q.value,label:q.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(L,null,{default:a(()=>[t(Z,null,{default:a(()=>[t(te,{theme:"primary",type:"submit"},{default:a(()=>T[7]||(T[7]=[x("搜索")])),_:1}),t(te,{theme:"default",variant:"base",type:"reset"},{default:a(()=>T[8]||(T[8]=[x("重置")])),_:1})]),_:1})]),_:1})]),_:1}),t(J,{data:b.value,columns:$.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:u.value,loading:C.value,onPageChange:I,"table-layout":"auto"},null,8,["data","columns","pagination","loading"])]),_:1}),t(N,{visible:h.value,"onUpdate:visible":T[5]||(T[5]=q=>h.value=q),width:"800px","cancel-btn":null,"close-btn":!1,onConfirm:T[6]||(T[6]=q=>h.value=!1)},{header:a(()=>[t(ye,{onClick:T[4]||(T[4]=()=>{var q;z((q=_.value)==null?void 0:q.id)})},{default:a(()=>{var q,pe,Q;return[x(E(((q=_.value)==null?void 0:q.id)+" - "+me(It)((pe=_.value)!=null&&pe.language?(Q=_.value)==null?void 0:Q.language:me(jt).Unknown)),1)]}),_:1})]),default:a(()=>[t(O,{loading:S.value},{default:a(()=>{var q;return[t(Ie,{"model-value":(q=_.value)==null?void 0:q.code,"code-foldable":!1,style:{"min-height":"100px"}},null,8,["model-value"])]}),_:1},8,["loading"])]),_:1},8,["visible"])],64)}}}),ma=oe(ar,[["__scopeId","data-v-2f2ccbac"]]),lr={class:"dida-code-container"},nr={style:{margin:"20px"}},or={key:2,class:"dida-edit-container"};function zt(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!at(e)}const sr=se({__name:"JudgeJobDetail",setup(e){const l=Ce(),n=Xe(),s=qe(),{globalProperties:o}=fe();let y=!1,w,h=0,_=0;const S=m(""),d=m(null),c=m(""),$=m(0),C=m(null),P=m({from:"#5a96ff",to:"#00A870"}),k=m([{title:"ID",colKey:"id"},{title:"问题",colKey:"problemKey",cell:(p,A)=>{if(_){let I;return t(B,{variant:"text",onClick:()=>vt(_,A.row.contestProblemIndex)},zt(I=tt(A.row.contestProblemIndex))?I:{default:()=>[I]})}return t(B,{variant:"text",onClick:()=>v(A.row.problemKey)},{default:()=>[A.row.problemKey]})}},{title:"状态",colKey:"status",align:"center",cell:(p,A)=>{const I=A.row.status,g=Tt(I),T=La(I);let U=[];return dt(I)&&U.push(t($e,{text:A.row.state,size:"small",class:"dida-status-loading"},null)),U.push(t("span",null,[g])),t(B,{theme:T,variant:"outline"},zt(U)?U:{default:()=>[U]})}},{title:"分数",colKey:"score"},{title:"时间",colKey:"time"},{title:"内存",colKey:"memory"},{title:"代码",colKey:"language",cell:(p,A)=>t("span",null,[It(A.row.language)+" / "+A.row.codeLength])},{title:"作者",colKey:"inserter",width:200,cell:(p,A)=>t(B,{variant:"text",onClick:()=>z(A.row.inserterUsername)},{default:()=>[A.row.inserterNickname]})},{title:"提交时间",colKey:"insertTime",width:180}]),u=m(!1),b=m(!1),i=m(),f=Je(()=>s.hasAuth(Ue.ManageJudge)),r=async()=>{if(!b.value){b.value=!0;try{const p=await xn(h);p.code===0?await V(!0):G(o,p.code)}catch(p){console.error(p),G(o,He())}finally{b.value=!1}}},v=p=>{p&&n.push({path:"/problem/"+p})},z=p=>{p&&n.push({path:"/user/"+p})},D=p=>{const A=p.status,I=Tt(A);let g;switch(A){case Be.Init:case Be.Rejudge:case Be.Compiling:case Be.Running:g="default";break;case Be.Accept:g="success";break;case Be.PE:g="warning";break;default:g="danger";break}return t(Se,null,{default:()=>[t(B,{theme:"default",variant:"outline"},{default:()=>[p.taskId]}),t(B,{theme:g,variant:"outline"},zt(I)?I:{default:()=>[I]}),t("span",null,[x("分数："),p.score]),t("span",null,[x("用时："),p.time]),t("span",null,[x("内存："),p.memory])]})},V=async p=>{var I;p&&(u.value=!0);let A=!1;try{const g=await wn(h,_);if(i.value=[],g.code===0){const T=g.data,U=Aa(T);if((I=i.value)==null||I.push(U),S.value=U.judgerName,P.value.to="#00A870",dt(T.status)?(C.value="active",U.taskTotal>0?($.value=Number((U.taskCurrent/U.taskTotal*100).toFixed(2)),U.taskCurrent>=U.taskTotal&&($.value=99)):$.value=0):($.value=100,T.status===Be.Accept?C.value="success":T.status===Be.PE?(P.value.to="#F57C20",C.value="warning"):(P.value.to="#F56C6C",C.value="error")),T.code){const L=Wt(T.language);c.value=`\`\`\`${L}
${T.code}
\`\`\``}d.value=U,dt(T.status)&&(A=!0)}else p&&G(o,g.code),_?await n.push({name:"contest-judge",params:{contestId:_}}):await n.push({name:"judge-list"})}catch(g){console.error(g),p&&G(o,He())}finally{p&&(u.value=!1),A&&y&&(w=setTimeout(()=>{V(!1)},5e3))}};return ce(async()=>{if(y=!0,Array.isArray(l.params.judgeId)?h=Number(l.params.judgeId[0]):h=Number(l.params.judgeId),Array.isArray(l.params.contestId)?_=Number(l.params.contestId[0]):_=Number(l.params.contestId),!h){await n.push({name:"judge"});return}await V(!0)}),je(()=>{y=!1,clearTimeout(w)}),(p,A)=>{var de,ye,Ie;const I=Gt,g=Fe,T=be,U=Me("md-preview"),L=De,F=Ye,M=We,te=Te,Z=Al,re=zl,J=B;return j(),ee(ue,null,[t(I,{color:P.value,status:C.value,class:"dida-job-progress",percentage:$.value},null,8,["color","status","percentage"]),t(T,{style:{margin:"10px"}},{default:a(()=>[t(g,{data:i.value,columns:k.value,"row-key":"id","vertical-align":"top",hover:!0,loading:u.value},null,8,["data","columns","loading"])]),_:1}),t(te,null,{default:a(()=>[t(L,{span:8},{default:a(()=>[K("div",lr,[t(U,{"model-value":c.value,class:"dida-code-div"},null,8,["model-value"])])]),_:1}),t(L,{span:4},{default:a(()=>[K("div",nr,[t(M,{layout:"vertical",bordered:!0},{default:a(()=>[t(F,{label:"判题机"},{default:a(()=>[x(E(S.value),1)]),_:1}),t(F,{label:"判题时间"},{default:a(()=>{var O;return[x(E((O=d.value)==null?void 0:O.judgeTime),1)]}),_:1})]),_:1}),t(T,{class:"dida-card-tips"},{default:a(()=>{var O;return[x(E(u.value?"数据正在加载，请等待":me(oa)((O=d.value)==null?void 0:O.status)),1)]}),_:1})])]),_:1})]),_:1}),(de=d.value)!=null&&de.compileMessage?(j(),R(T,{key:0,class:"compile-message"},{default:a(()=>{var O;return[x(E((O=d.value)==null?void 0:O.compileMessage),1)]}),_:1})):le("",!0),(ye=d.value)!=null&&ye.task&&((Ie=d.value)==null?void 0:Ie.task.length)>0?(j(),R(re,{key:1,class:"task-panel"},{default:a(()=>{var O;return[(j(!0),ee(ue,null,xe((O=d.value)==null?void 0:O.task,(N,q)=>(j(),R(Z,{key:N.taskId,header:()=>D(N)},{default:a(()=>[t(T,null,{default:a(()=>[x(E(me(oa)(N.status)),1)]),_:2},1024),N.content?(j(),R(T,{key:0,class:"dida-card-tips"},{default:a(()=>[t(U,{"model-value":N.content},null,8,["model-value"])]),_:2},1024)):le("",!0),N.hint?(j(),R(T,{key:1,class:"dida-card-tips"},{default:a(()=>[t(U,{"model-value":N.hint},null,8,["model-value"])]),_:2},1024)):le("",!0)]),_:2},1032,["header"]))),128))]}),_:1})):le("",!0),f.value?(j(),ee("div",or,[t(J,{onClick:r,loading:b.value},{default:a(()=>A[0]||(A[0]=[x("重新评测")])),_:1},8,["loading"])])):le("",!0)],64)}}}),pa=oe(sr,[["__scopeId","data-v-22eabe14"]]),rr={style:{margin:"10px"}},ir=se({__name:"ContestList",setup(e){const l=Ce(),n=Xe(),{globalProperties:s}=fe();let o=null;const y=m([{title:"ID",colKey:"id",cell:(i,f)=>t(B,{variant:"text",onClick:()=>$(f.row.id)},{default:()=>[f.row.id]})},{title:"标题",colKey:"title",cell:(i,f)=>t(B,{variant:"text",onClick:()=>$(f.row.id)},{default:()=>[f.row.title]})},{title:"负责人",colKey:"ownerNickname",cell:(i,f)=>t(B,{variant:"text",onClick:()=>Xt(n,f.row.ownerUsername)},{default:()=>[f.row.ownerNickname]})},{title:"权限",colKey:"private",cell:(i,f)=>f.row.private?"私有":"公开"},{title:"开始时间",colKey:"startTime"},{title:"结束时间",colKey:"endTime"}]),w=m(!1);let h=1,_=50;const S=m({current:h,pageSize:_,defaultCurrent:h,defaultPageSize:_,total:0,pageSizeOptions:[50,100]}),d=m(),c=m({title:"",username:""}),$=i=>{i&&n.push({path:"/contest/"+i})},C=async()=>{await n.push({query:{...l.query,title:c.value.title,username:c.value.username,page:1,page_size:S.value.defaultPageSize}})},P=async()=>{c.value.title="",c.value.username="",await n.push({query:{...l.query,title:"",username:"",page:1,page_size:S.value.defaultPageSize}})},k=async(i,f)=>{var r;w.value=!0;try{const{current:v,pageSize:z}=i,D=await Mo(c.value.title,c.value.username,v,z);if(d.value=[],D.code===0){const V=D.data.list;for(let p=0;p<V.length;p++){const A=V[p],I=Zt(A);(r=d.value)==null||r.push(I)}S.value={...S.value,total:D.data.total_count}}else f&&G(s,D.code)}catch(v){console.error(v),G(s,He())}finally{w.value=!1}},u=async i=>{await n.push({query:{...l.query,page:i.current,page_size:i.pageSize}})},b=()=>{n.push({name:"contest-create"})};return ce(async()=>{o=ze(()=>l.query,i=>{c.value.title=i.title||"",c.value.username=i.username||"";const f=parseInt(i.page)||S.value.defaultCurrent,r=parseInt(i.page_size)||S.value.defaultPageSize;h=f,_=r,S.value={...S.value,current:h,pageSize:_},k({current:h,pageSize:_},!0)},{immediate:!0})}),je(()=>{o&&o()}),(i,f)=>{const r=Fe,v=be,z=De,D=Ee,V=Re,p=B,A=Se,I=Ke,g=Te;return j(),R(g,null,{default:a(()=>[t(z,{span:9},{default:a(()=>[t(v,{style:{margin:"10px"}},{default:a(()=>[t(r,{data:d.value,columns:y.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:S.value,loading:w.value,"table-layout":"auto",onPageChange:u,style:{"white-space":"nowrap"}},null,8,["data","columns","pagination","loading"])]),_:1})]),_:1}),t(z,{span:3},{default:a(()=>[K("div",rr,[t(v,{class:"sh-card"},{default:a(()=>[t(I,{model:c.value,onSubmit:C,onReset:P},{default:a(()=>[t(V,{label:"标题"},{default:a(()=>[t(D,{modelValue:c.value.title,"onUpdate:modelValue":f[0]||(f[0]=T=>c.value.title=T),placeholder:"暂不支持模糊查询"},null,8,["modelValue"])]),_:1}),t(V,{label:"负责人"},{default:a(()=>[t(D,{modelValue:c.value.username,"onUpdate:modelValue":f[1]||(f[1]=T=>c.value.username=T),placeholder:"仅支持输入完整用户名"},null,8,["modelValue"])]),_:1}),t(V,null,{default:a(()=>[t(A,null,{default:a(()=>[t(p,{theme:"primary",type:"submit"},{default:a(()=>f[2]||(f[2]=[x("提交")])),_:1}),t(p,{theme:"danger",type:"reset"},{default:a(()=>f[3]||(f[3]=[x("重置")])),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(v,{class:"sh-card"},{default:a(()=>[t(A,null,{default:a(()=>[t(p,{onClick:b},{default:a(()=>f[4]||(f[4]=[x("创建")])),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})}}}),fa=oe(ir,[["__scopeId","data-v-d94af270"]]);function Kt(e){return e*1<10?`0${e}`:e}const ur={name:"CountDown",emits:["on-end"],props:{format:{type:Function},target:{type:[Date,Number],required:!0},interval:{type:Number,default:1e3}},data(){return{lastTime:0,targetTime:0,timer:null}},computed:{result(){const{format:e=this.defaultFormat}=this;return e(this.lastTime)}},methods:{initTargetTime(){try{this.targetTime=Object.prototype.toString.call(this.target)==="[object Date]"?this.target.getTime():new Date(this.target).getTime()}catch(e){throw new Error("invalid target prop",e)}},updateTime(){const e=Date.now(),l=this.targetTime-e;this.lastTime=l>0?l:0},tick(){if(this.updateTime(),this.lastTime<=0){clearTimeout(this.timer),this.timer=null,this.$emit("on-end");return}this.timer=setTimeout(()=>{this.tick()},this.interval)},stop(){this.timer&&(clearTimeout(this.timer),this.timer=null)},defaultFormat(e){const s=Math.floor(e/36e5),o=Math.floor(e%36e5/6e4),y=Math.floor(e%6e4/1e3);return`${Kt(s)}:${Kt(o)}:${Kt(y)}`}},watch:{target(){this.stop(),this.initTargetTime(),this.tick()}},created(){this.initTargetTime(),this.updateTime()},mounted(){this.tick()},beforeUnmount(){this.stop()}};function dr(e,l,n,s,o,y){return j(),ee("span",null,E(y.result),1)}const cr=oe(ur,[["render",dr]]),mr={style:{margin:"20px"}},pr={style:{margin:"10px"}},fr={key:0,class:"dida-countdown-div"},vr={style:{"text-align":"center","align-content":"center",padding:"20px",height:"500px"}},_r={style:{"text-align":"center",width:"100%"}},gr={class:"dida-operation-container"},br={style:{margin:"12px"}},yr=se({__name:"ContestDetail",setup(e){let l=Ce();const{globalProperties:n}=fe(),s=Ze(),o=qe(),y=m(!1);let w=0;const h=m(!1),_=m(null),S=m(!1),d=m(!1),c=m(""),$=m(null),C=Je(()=>o.hasAuth(Ue.ManageContest)||_.value&&(o==null?void 0:o.getUserId)===_.value.inserter),P=V=>{if(!V||!b)return"default";const p=b[V];if(!p)return"default";switch(p){case Ae.Accept:return"success";case Ae.Attempt:return"warning";default:return"default"}},k=m([{title:"问题标识",colKey:"index",cell:(V,p)=>{const A=P(p.row.index);return t(B,{variant:"dashed",theme:A,onClick:async()=>await vt(w,p.row.index)},{default:()=>[p.row.id]})}},{title:"标题",colKey:"title",cell:(V,p)=>t(B,{variant:"text",onClick:async()=>await vt(w,p.row.index)},{default:()=>[p.row.title]})},{title:"正确",colKey:"accept"},{title:"提交",colKey:"attempt"}]),u=m([]);let b={},i=m(!1);const f=async()=>{await D()},r=()=>{X.push({name:"contest-edit",params:{contestId:w}})},v=async()=>{y.value=!0;try{const V=await Go(w);if(V.code!==0){G(n,V.code);return}const p=V.data;ke(n,"查重报告已生成，请前往查看"),window.open(p,"_blank")}finally{y.value=!1}},z=async()=>{if(!o.isLogin()){await X.push({name:"login"});return}if(!c.value){ve(n,"请输入密码");return}i.value=!0;try{const V=await Oo(w,c.value);if(V.code!==0){G(n,V.code);return}ke(n,"申请访问成功"),await D()}catch(V){console.error("Error submitting contest password:",V),G(n,"提交密码失败，请稍后再试")}finally{i.value=!1}},D=async()=>{h.value=!0;const V=await Ao(w);if(V.code!==0){h.value=!1,G(n,V.code),await X.push({name:"contest"});return}S.value=V.data.has_auth,d.value=V.data.need_password,$.value=null;const p=new Date(V.data.now);if(p<new Date(V.data.contest.start_time)){const A=new Date().getTime()-p.getTime();$.value=new Date(new Date(V.data.contest.start_time).getTime()+A)}_.value=Zt(V.data.contest),u.value=_.value.problems,b=V.data.attempt_status||{},s.setTitle(_.value.title+" - "+s.getTitle),h.value=!1};return ce(async()=>{if(Array.isArray(l.params.contestId)?w=Number(l.params.contestId[0]):w=Number(l.params.contestId),!w){await X.push({name:"contest"});return}await D()}),(V,p)=>{const A=xt,I=Fe,g=be,T=Ee,U=Re,L=B,F=Ke,M=De,te=Se,Z=Ye,re=We,J=Me("md-preview"),de=Te,ye=$e;return j(),R(ye,{loading:h.value},{default:a(()=>[t(de,{class:"dida-main-content"},{default:a(()=>[t(M,{span:6},{default:a(()=>{var Ie,O,N;return[K("div",mr,[K("h1",null,E((Ie=_.value)==null?void 0:Ie.title),1),(O=_.value)!=null&&O.notification?(j(),R(A,{key:0,theme:"info",message:(N=_.value)==null?void 0:N.notification},null,8,["message"])):le("",!0)]),K("div",pr,[S.value?(j(),R(g,{key:0},{default:a(()=>[$.value?(j(),ee("div",fr,[p[1]||(p[1]=K("p",{class:"dida-countdown-head"},"比赛开启倒计时",-1)),t(cr,{class:"dida-countdown-content",target:$.value,onOnEnd:f},null,8,["target"])])):(j(),R(I,{key:1,data:u.value,columns:k.value,"row-key":"id","table-layout":"auto","vertical-align":"top",hover:!0},null,8,["data","columns"]))]),_:1})):(j(),R(g,{key:1},{default:a(()=>[K("div",vr,[t(A,{theme:"warning",message:"您没有查看本比赛的权限"}),d.value?(j(),R(F,{key:0,style:{margin:"20px auto 0",width:"200px"},onSubmit:z,"label-width":"0"},{default:a(()=>[t(U,null,{default:a(()=>[t(T,{placeholder:"请输入密码",value:c.value,"onUpdate:value":p[0]||(p[0]=q=>c.value=q),style:{width:"300px"},type:"password",autocomplete:"new-password"},null,8,["value"])]),_:1}),t(U,null,{default:a(()=>[K("div",_r,[t(L,{theme:"primary",type:"submit",loading:me(i)},{default:a(()=>p[2]||(p[2]=[x("提交")])),_:1},8,["loading"])])]),_:1})]),_:1})):le("",!0)])]),_:1}))])]}),_:1}),t(M,{span:6},{default:a(()=>{var Ie;return[K("div",gr,[t(te,null,{default:a(()=>[C.value?(j(),R(L,{key:0,onClick:v,loading:y.value},{default:a(()=>p[3]||(p[3]=[x("查重")])),_:1},8,["loading"])):le("",!0),C.value?(j(),R(L,{key:1,onClick:r},{default:a(()=>p[4]||(p[4]=[x("编辑")])),_:1})):le("",!0)]),_:1})]),K("div",br,[t(re,{layout:"vertical",bordered:!0},{default:a(()=>[t(Z,{label:"创建时间"},{default:a(()=>{var O;return[x(E((O=_.value)==null?void 0:O.insertTime),1)]}),_:1})]),_:1}),t(re,{layout:"vertical",bordered:!0},{default:a(()=>[t(Z,{label:"编辑时间"},{default:a(()=>{var O;return[x(E((O=_.value)==null?void 0:O.modifyTime),1)]}),_:1})]),_:1}),t(re,{layout:"vertical",bordered:!0},{default:a(()=>[t(Z,{label:"开始时间"},{default:a(()=>{var O;return[x(E((O=_.value)==null?void 0:O.startTime),1)]}),_:1})]),_:1}),t(re,{layout:"vertical",bordered:!0},{default:a(()=>[t(Z,{label:"结束时间"},{default:a(()=>{var O;return[x(E((O=_.value)==null?void 0:O.endTime),1)]}),_:1})]),_:1})]),(Ie=_.value)!=null&&Ie.description?(j(),R(g,{key:0,style:{margin:"12px"}},{default:a(()=>{var O;return[t(J,{"model-value":(O=_.value)==null?void 0:O.description,class:"dida-content-description"},null,8,["model-value"])]}),_:1})):le("",!0)]}),_:1})]),_:1})]),_:1},8,["loading"])}}}),hr=oe(yr,[["__scopeId","data-v-dec87736"]]);function Ga(e){return e?Math.floor(e/1e9):0}function ut(e){if(e<=0)return"0 秒 ";let l="";const n=Math.floor(e/3600);n>0&&(l+=`${n} 小时 `);const s=Math.floor(e%3600/60);return(s>0||n>0)&&(n>0&&s<10&&(l+="0"),l+=`${s} 分钟 `),e=e%60,(e>0||s>0||n>0)&&((n>0||s>0)&&e<10&&(l+="0"),l+=`${e.toFixed(0)} 秒`),l}const wr=_t("contest",{state:()=>({starMembers:{}}),actions:{clear(){this.$patch({starMembers:{}})},addStarMember(e,l){this.starMembers[e]||(this.starMembers[e]={}),this.starMembers[e][l]=!0},removeStarMember(e,l){this.starMembers[e]&&(delete this.starMembers[e][l],Object.keys(this.starMembers[e]).length===0&&delete this.starMembers[e])},isStarMember(e,l){var n;return!!((n=this.starMembers[e])!=null&&n[l])}},persist:!0}),kr={style:{margin:"10px 10px 40px"}},Sr={style:{"text-align":"right","margin-bottom":"10px"}},Cr={class:"table-scroll-wrapper"};function va(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!at(e)}const Pr=se({__name:"ContestRank",setup(e){const l=Ce(),n=Xe(),s=wr(),{globalProperties:o}=fe();let y=!1,w=null,h=0,_=null,S=null,d=0;const c=m(0),$=m(0),C=m(!1),P=m(!0),k=m(!0);let u=null,b=null,i=1,f=50;const r=m({current:i,pageSize:f,defaultCurrent:1,defaultPageSize:50,total:0,pageSizeOptions:[50,100,1e3]}),v=N=>s&&s.isStarMember(h,N),z=async N=>{r.value={...r.value,current:N.current,pageSize:N.pageSize},await n.push({query:{...l.query,page:N.current,page_size:N.pageSize}})},D=N=>{if(N==null)return"-";const q=Math.floor(N/3600).toString().padStart(2,"0"),pe=Math.floor(N%3600/60).toString().padStart(2,"0"),Q=(N%60).toFixed(0).toString().padStart(2,"0");return`${q}:${pe}:${Q}`},V=m({});let p={userId:0,ac:-1};const A=[{title:"Rank",colKey:"rank",align:"center",fixed:"left"},{title:"昵称",colKey:"nickname",fixed:"left",attrs:N=>{let q={};return v(N.row.userId)&&(q={backgroundColor:"rgba(255,165,30,0.5)"}),{style:q}},cell:(N,q)=>{const pe=tn(q.row.nickname,18);let Q=null;return v(q.row.userId)?Q=t(B,{shape:"circle",variant:"text",class:"rank-unstar-button",onClick:()=>{s.removeStarMember(h,q.row.userId),ye()}},{icon:()=>t(ul,null,null)}):Q=t(B,{shape:"circle",variant:"text",class:"rank-star-button",onClick:()=>{s.addStarMember(h,q.row.userId),ye()}},{icon:()=>t(dl,null,null)}),t("div",{class:"rank-nickname-cell"},[t(Se,null,{default:()=>[t(Rl,{content:q.row.nickname},{default:()=>[t(B,{variant:"text",onClick:()=>n.push({name:"user",params:{username:q.row.username}})},va(pe)?pe:{default:()=>[pe]})]}),Q]})])}},{title:"Solved",colKey:"solved",align:"center",fixed:"left",cell:(N,q)=>t(B,{variant:"text",onClick:()=>n.push({name:"contest-judge",params:{contestId:h},query:{username:q.row.username,status:Be.Accept}})},{default:()=>[q.row.solved]})},{title:"Penalty",colKey:"penalty",align:"center",fixed:"left",cell:(N,q)=>D(q.row.penalty)}],I=m([]),g=m(!1);let T=[],U=[];const L=m([]);let F=[];const M=({col:N,rowIndex:q})=>{if(N.colKey==="rank"){let pe=r.value.current;r.value.current>Math.ceil(L.value.length/r.value.pageSize)&&(pe=Math.ceil(L.value.length/r.value.pageSize));let Q=r.value.pageSize*(pe-1),Y=1;for(let ae=q+1;Q+ae<L.value.length&&L.value[Q+ae].rank===L.value[Q+q].rank;ae++)Y++;return{rowspan:Y}}},te=(N,{value:q})=>ut(q),Z=()=>{u&&clearInterval(u),u=setInterval(()=>{y&&O(!1)},3e4),b&&clearInterval(b),b=setInterval(()=>{if(!y||!_)return;c.value=(new Date().getTime()-_.getTime())/1e3;const N=Math.min(c.value,$.value);c.value=Math.min(c.value,N),ye()},1e3)},re=()=>{u&&(clearInterval(u),u=null),b&&(clearInterval(b),b=null)},J=async N=>{k.value=N,N?(await O(!1),Z()):re()},de=()=>{ye(),r.value={...r.value,current:1}},ye=()=>{L.value=[];let N=[];if(p={},!_)return;for(let H=0;H<T.length;H++){const ie=T[H];let we={userId:ie.inserter,username:ie.inserter_username,nickname:ie.inserter_nickname},ge=0,Ve=0;ie.problems.forEach(he=>{let Ne=-1,lt=he.lock||0;if(he.attempt=he.attempt||0,he.ac){let rt=0;if(_&&(rt=_.getTime()),Ne=(new Date(he.ac).getTime()-rt)/1e3,Ne>c.value)return;ge++,Ve+=Ne,Ve+=he.attempt*20*60,p[he.index]===void 0?p[he.index]={userId:ie.inserter,ac:Ne}:p[he.index].ac>Ne&&(p[he.index].userId=ie.inserter,p[he.index].ac=Ne)}if(lt>0&&d>0){const rt=$.value-d;c.value<rt&&(lt=0)}const st=he.index;we[`problem_${st}`]={acDuration:Ne,attempt:he.attempt||0,lock:lt}}),we.solved=ge,we.penalty=Ve,N.push(we)}N.sort((H,ie)=>H.solved!==ie.solved?ie.solved-H.solved:H.penalty!==ie.penalty?H.penalty-ie.penalty:H.userId-ie.userId);const q=U;let pe=0,Q=0,Y=-1,ae=-1;for(let H=0;H<N.length;H++)q&&q.includes(N[H].userId)?N[H].rank="*":(Q++,(N[H].solved!==Y||N[H].penalty!==ae)&&(pe=Q,Y=N[H].solved,ae=N[H].penalty),N[H].rank=String(pe));C.value&&(N=N.filter(H=>v(H.userId)));const _e=document.querySelectorAll("tbody tr"),Pe={};F.forEach((H,ie)=>{const we=_e[ie];we&&(Pe[H.userId]=we.getBoundingClientRect())}),r.value={...r.value,total:N.length},L.value=N;for(let H=0;H<L.value.length;H++)L.value[H].index=H+1;if(F=[...L.value],P.value){const H={},ie=document.querySelectorAll("table tbody tr");L.value.forEach((we,ge)=>{const Ve=ie[ge];Ve&&(H[we.userId]=Ve.getBoundingClientRect())}),requestAnimationFrame(()=>{const we=document.querySelectorAll("table tbody tr");L.value.forEach((ge,Ve)=>{const he=we[Ve],Ne=Pe[ge.userId],lt=H[ge.userId];if(Ne&&lt){const st=Ne.top-lt.top;st!==0&&(he.style.transition="none",he.style.transform=`translateY(${st}px)`)}}),requestAnimationFrame(()=>{document.querySelectorAll("table tbody tr").forEach(Ve=>{Ve.style.transition="transform 300ms ease",Ve.style.transform=""})})})}},Ie=N=>{if(J(!1),!_)return;c.value=N;const q=Math.min($.value,(new Date().getTime()-(_==null?void 0:_.getTime()))/1e3);c.value=Math.min(c.value,q),ye()},O=async N=>{N&&(g.value=!0);try{const q=await qo(h);if(I.value=[...A],T=[],U=[],L.value=[],r.value={...r.value,total:0},q.code===0){if(!q.data.has_auth){ke(o,"您目前没有权限查看比赛排名"),await n.push({name:"contest-detail",params:{contestId:h}});return}q.data.contest.problems.sort((Y,ae)=>Y-ae),q.data.contest.problems.forEach((Y,ae)=>{I.value.push({colKey:`problem_${Y}`,align:"center",title:()=>{let _e;return t(B,{variant:"text",onClick:()=>n.push({name:"contest-problem-detail",params:{contestId:h,problemIndex:Y}})},va(_e=tt(Y))?_e:{default:()=>[_e]})},cell:(_e,Pe)=>{const H=Pe.row[`problem_${Y}`];if(!H)return"";let ie="";return H.acDuration>=0&&(ie=D(H.acDuration)),H.attempt>0&&(ie&&(ie+=" "),ie+=`(-${H.attempt})`),H.lock>0&&(ie&&(ie+=" "),ie+=`(+${H.lock})`),t("span",null,[ie])},attrs:_e=>{const Pe=_e.row[`problem_${Y}`];if(!Pe)return{};if(Pe.acDuration>=0){const H=p[Y];if(H!==void 0){const ie=_e.row.userId;if(H.userId===ie)return{style:{backgroundColor:"rgba(65,155,5,0.5)"}}}return{style:{backgroundColor:"rgba(130,255,30,0.5)"}}}return Pe.lock>0?{style:{backgroundColor:"rgb(255,180,50,0.5)"}}:Pe.attempt>0?{style:{backgroundColor:"rgba(255,120,120,0.5)"}}:{}}})});const pe=q.data.contest;if(_=new Date(pe.start_time),S=new Date(pe.end_time),T=q.data.ranks,U=q.data.v_members||[],$.value=Math.floor((S.getTime()-_.getTime())/1e3),V.value={0:"0",[Math.floor($.value/2)]:ut(Math.floor($.value/2)),[$.value]:ut($.value)},d=Ga(pe.lock_rank_duration||0),q.data.is_locked&&d>0){const Y=Math.max(0,$.value-d);V.value[Y]=t("span",{style:"color: #0052d9"},[x("锁榜("),ut(Y),x(")")])}c.value=Math.floor((new Date().getTime()-_.getTime())/1e3);const Q=Math.min(c.value,$.value);c.value=Math.min(c.value,Q),k.value=!0,Z(),ye()}else N&&G(o,q.code)}catch(q){console.error(q),N&&G(o,He())}finally{N&&(g.value=!1)}};return ce(async()=>{y=!0,w=ze(()=>l.query,async N=>{if(Array.isArray(l.params.contestId)?h=Number(l.params.contestId[0]):h=Number(l.params.contestId),!h){await n.push({name:"contest"});return}const q=parseInt(N.page)||r.value.defaultCurrent,pe=parseInt(N.page_size)||r.value.defaultPageSize;i=q,f=pe,r.value={...r.value,current:i,pageSize:f},await O(!0)},{immediate:!0})}),je(()=>{y=!1,w&&w(),re()}),(N,q)=>{const pe=bt,Q=Se,Y=Kl,ae=Fe,_e=be,Pe=Te;return j(),R(Pe,null,{default:a(()=>[t(_e,{style:{margin:"10px",width:"100%"}},{default:a(()=>[K("div",kr,[x(" 榜单时间 "+E(me(ut)(c.value))+" ",1),K("div",Sr,[t(Q,null,{default:a(()=>[t(pe,{size:"large",modelValue:C.value,"onUpdate:modelValue":q[0]||(q[0]=H=>C.value=H),onChange:de},{label:a(H=>[x(E(H.value?"仅展示收藏":"未过滤收藏"),1)]),_:1},8,["modelValue"]),t(pe,{size:"large",modelValue:P.value,"onUpdate:modelValue":q[1]||(q[1]=H=>P.value=H)},{label:a(H=>[x(E(H.value?"开启动画":"关闭动画"),1)]),_:1},8,["modelValue"]),t(pe,{size:"large",modelValue:k.value,"onUpdate:modelValue":q[2]||(q[2]=H=>k.value=H),onChange:J},{label:a(H=>[x(E(H.value?"自动刷新":"关闭刷新"),1)]),_:1},8,["modelValue"])]),_:1})]),t(Y,{modelValue:c.value,"onUpdate:modelValue":q[3]||(q[3]=H=>c.value=H),marks:V.value,max:$.value,label:te,"tooltip-props":{placement:"top"},onChangeEnd:Ie},null,8,["modelValue","marks","max"])]),K("div",Cr,[t(ae,{data:L.value,columns:I.value,"row-key":"index","vertical-align":"middle",bordered:!0,hover:!0,"table-layout":"auto","rowspan-and-colspan":M,loading:g.value,class:"dida-contest-rank-table",pagination:r.value,onPageChange:z},null,8,["data","columns","loading","pagination"])])]),_:1})]),_:1})}}}),Ir=oe(Pr,[["__scopeId","data-v-8d1f31d5"]]),Tr={style:{margin:"10px"}},xr={style:{margin:"12px"}},Vr={class:"dida-edit-container"},Dr={class:"dida-description-editor"},$r=se({__name:"ContestEdit",setup(e){let l=Ce();const{globalProperties:n}=fe(),s=Ze(),o=m(0),y=m(!1),w=m(!1),h=m("1"),_=m(!1),S=m(null),d=m({title:"",openTime:[],private:!0,password:"",problems:[],members:[],description:"",notification:"",lockRankDuration:0,alwaysLock:!0,submitAnytime:!1}),c=m(""),$=m(""),C=m(!1),P=async()=>{C.value=!0,_.value=!1,C.value=!1},k=async(r,v)=>{w.value=!0,await ct(r,v,n,()=>Ro(o.value)),w.value=!1},u=async()=>{w.value=!0;try{const r={title:d.value.title,description:d.value.description,notification:d.value.notification,lock_rank_duration:d.value.lockRankDuration,always_lock:d.value.alwaysLock,problems:d.value.problems,members:d.value.members,private:d.value.private,password:d.value.password,submit_anytime:d.value.submitAnytime};d.value.openTime[0]&&(r.start_time=new Date(d.value.openTime[0])),d.value.openTime[1]&&(r.end_time=new Date(d.value.openTime[1]));const v=await Fo(r);if(w.value=!0,v.code!==0){G(n,v.code);return}v.data!=null&&await X.push({name:"contest-detail",params:{contestId:v.data}}),Ge(n,"创建成功")}finally{w.value=!1}},b=async()=>{w.value=!0;try{const r={id:Number(o.value),title:d.value.title,notification:d.value.notification,lock_rank_duration:d.value.lockRankDuration,always_lock:d.value.alwaysLock,problems:d.value.problems,members:d.value.members,private:d.value.private,password:d.value.password,submit_anytime:d.value.submitAnytime,description:d.value.description};d.value.openTime[0]&&(r.start_time=new Date(d.value.openTime[0])),d.value.openTime[1]&&(r.end_time=new Date(d.value.openTime[1]));const v=await No(r);if(w.value=!0,v.code!==0){G(n,v.code);return}S.value&&(v.data.description!=null&&(d.value.description=v.data.description),v.data.update_time!=null&&(S.value.modifyTime=new Date(v.data.update_time).toLocaleString())),Ge(n,"保存成功")}finally{w.value=!1}},i=r=>{d.value.description=r,y.value=!1},f=async()=>{const r=await zo(o.value);if(r.code!==0){G(n,r.code),console.error("contest get failed",r.code),await X.push({name:"contest-list"});return}const v=r.data.contest;S.value=Zt(v),d.value.title=v.title,d.value.openTime=[],v.start_time?d.value.openTime.push(new Date(v.start_time)):d.value.openTime.push(""),v.end_time?d.value.openTime.push(new Date(v.end_time)):d.value.openTime.push(""),d.value.private=v.private,d.value.password=v.password||"",d.value.description=v.description||"",d.value.notification=v.notification||"",d.value.problems=v.problems,d.value.members=r.data.members,v.lock_rank_duration?d.value.lockRankDuration=Ga(v.lock_rank_duration):d.value.lockRankDuration=0,d.value.alwaysLock=v.always_lock,d.value.submitAnytime=v.submit_anytime,s.setTitle(v.title+" - "+s.getTitle);let z="";v.description&&(z=v.description),i(z)};return ce(async()=>{Array.isArray(l.params.contestId)?o.value=Number(l.params.contestId[0]):o.value=Number(l.params.contestId),o.value?(y.value=!0,await f()):i("")}),(r,v)=>{const z=Ee,D=Re,V=Bt,p=bt,A=Pa,I=Ke,g=Ml,T=El,U=be,L=De,F=B,M=Se,te=Ye,Z=We,re=Te,J=Me("md-editor-v3"),de=$e,ye=Vt,Ie=ot;return j(),ee(ue,null,[t(de,{loading:y.value},{default:a(()=>[t(re,null,{default:a(()=>[t(L,{span:8},{default:a(()=>[K("div",Tr,[t(U,{class:"sh-card"},{default:a(()=>[t(T,{modelValue:h.value,"onUpdate:modelValue":v[10]||(v[10]=O=>h.value=O)},{default:a(()=>[t(g,{value:"1",label:"基础信息",style:{padding:"10px"}},{default:a(()=>[t(I,{model:d.value,"label-width":"150px"},{default:a(()=>[t(D,{label:"标题"},{default:a(()=>[t(z,{modelValue:d.value.title,"onUpdate:modelValue":v[0]||(v[0]=O=>d.value.title=O),placeholder:"比赛标题"},null,8,["modelValue"])]),_:1}),t(D,{label:"通知"},{default:a(()=>[t(z,{modelValue:d.value.notification,"onUpdate:modelValue":v[1]||(v[1]=O=>d.value.notification=O),placeholder:"会更为醒目地提醒"},null,8,["modelValue"])]),_:1}),t(D,{label:"开启时间"},{default:a(()=>[t(V,{modelValue:d.value.openTime,"onUpdate:modelValue":v[2]||(v[2]=O=>d.value.openTime=O),"allow-input":"",clearable:"",format:"YYYY-MM-DD HH:mm:ss","default-time":["00:00:00","23:59:59"]},null,8,["modelValue"])]),_:1}),t(D,{label:"提交限制"},{default:a(()=>[t(p,{modelValue:d.value.submitAnytime,"onUpdate:modelValue":v[3]||(v[3]=O=>d.value.submitAnytime=O)},{label:a(O=>[x(E(O.value?"结束仍能提交":"仅比赛期间提交"),1)]),_:1},8,["modelValue"])]),_:1}),t(D,{label:"锁榜时长"},{default:a(()=>[t(A,{modelValue:d.value.lockRankDuration,"onUpdate:modelValue":v[4]||(v[4]=O=>d.value.lockRankDuration=O),min:0,format:me(ut),"auto-width":""},null,8,["modelValue","format"])]),_:1}),t(D,{label:"自动解锁"},{default:a(()=>[t(p,{modelValue:d.value.alwaysLock,"onUpdate:modelValue":v[5]||(v[5]=O=>d.value.alwaysLock=O)},{label:a(O=>[x(E(O.value?"结束后仍锁榜":"结束后解锁"),1)]),_:1},8,["modelValue"])]),_:1}),t(D,{label:"私有"},{default:a(()=>[t(p,{modelValue:d.value.private,"onUpdate:modelValue":v[6]||(v[6]=O=>d.value.private=O)},null,8,["modelValue"])]),_:1}),d.value.private?(j(),R(D,{key:0,label:"密码"},{default:a(()=>[t(z,{modelValue:d.value.password,"onUpdate:modelValue":v[7]||(v[7]=O=>d.value.password=O),type:"password",autocomplete:"current-password",placeholder:"请输入访问密码，留空代表关闭密码访问"},null,8,["modelValue"])]),_:1})):le("",!0)]),_:1},8,["model"])]),_:1}),t(g,{value:"2",label:"问题",style:{padding:"10px"}},{default:a(()=>[t(Na,{modelValue:d.value.problems,"onUpdate:modelValue":v[8]||(v[8]=O=>d.value.problems=O)},null,8,["modelValue"])]),_:1}),d.value.private?(j(),R(g,{key:0,value:"3",label:"成员",style:{padding:"10px"}},{default:a(()=>[t(Oa,{modelValue:d.value.members,"onUpdate:modelValue":v[9]||(v[9]=O=>d.value.members=O)},null,8,["modelValue"])]),_:1})):le("",!0)]),_:1},8,["modelValue"])]),_:1})])]),_:1}),t(L,{span:4},{default:a(()=>[K("div",xr,[K("div",Vr,[o.value?(j(),R(M,{key:0},{default:a(()=>[t(F,{onClick:b,theme:"danger",loading:w.value},{default:a(()=>v[14]||(v[14]=[x("保存")])),_:1},8,["loading"])]),_:1})):(j(),R(M,{key:1},{default:a(()=>[t(F,{onClick:u,theme:"danger",loading:w.value},{default:a(()=>v[15]||(v[15]=[x("创建")])),_:1},8,["loading"])]),_:1}))]),o.value?(j(),R(Z,{key:0,layout:"vertical",bordered:!0},{default:a(()=>[t(te,{label:"创建时间"},{default:a(()=>{var O;return[x(E((O=S.value)==null?void 0:O.insertTime),1)]}),_:1}),t(te,{label:"编辑时间"},{default:a(()=>{var O;return[x(E((O=S.value)==null?void 0:O.modifyTime),1)]}),_:1}),t(te,{label:"创建用户"},{default:a(()=>{var O;return[x(E((O=S.value)==null?void 0:O.inserterNickname),1)]}),_:1}),t(te,{label:"编辑用户"},{default:a(()=>{var O;return[x(E((O=S.value)==null?void 0:O.modifierNickname),1)]}),_:1})]),_:1})):le("",!0)])]),_:1})]),_:1}),K("div",Dr,[v[16]||(v[16]=K("p",null,"公告",-1)),t(J,{id:"contest-description-editor",modelValue:d.value.description,"onUpdate:modelValue":v[11]||(v[11]=O=>d.value.description=O),onSave:b,onOnUploadImg:k,previewTheme:"cyanosis"},null,8,["modelValue"]),t(de,{loading:w.value,attach:"#contest-description-editor","z-index":1e5},null,8,["loading"])])]),_:1},8,["loading"]),t(Ie,{visible:_.value,"onUpdate:visible":v[13]||(v[13]=O=>_.value=O),onConfirm:P,header:c.value,"confirm-loading":C.value},{default:a(()=>[v[17]||(v[17]=K("div",{style:{"margin-bottom":"10px"}},[K("span",null,"多条请换行隔开")],-1)),t(ye,{modelValue:$.value,"onUpdate:modelValue":v[12]||(v[12]=O=>$.value=O),autosize:{minRows:5}},null,8,["modelValue"])]),_:1},8,["visible","header","confirm-loading"])],64)}}}),_a=oe($r,[["__scopeId","data-v-cd3d0d0c"]]);function ea(e){const l={};return l.id=e.id,l.inserter=e.inserter,l.inserterUsername=e.inserter_username,l.inserterNickname=e.inserter_nickname,l.title=e.title,l.content=e.content,e.insert_time&&(l.insertTime=new Date(e.insert_time).toLocaleString()),e.modify_time&&(l.modifyTime=new Date(e.modify_time).toLocaleString()),e.update_time&&(l.updateTime=new Date(e.update_time).toLocaleString()),l.problemId=e.problem_id,l.problemKey=e.problem_key,l.problemTitle=e.problem_title,l.contestId=e.contest_id,l.contestTitle=e.contest_title,l.contestProblemIndex=e.contest_problem_index,l}function jr(e){const l={};return l.id=e.id,l.inserter=e.inserter,l.inserterUsername=e.inserter_username,l.inserterNickname=e.inserter_nickname,l.content="",e.content&&(l.content=e.content),e.insert_time&&(l.insertTime=new Date(e.insert_time).toLocaleString()),e.modify_time&&(l.modifyTime=new Date(e.modify_time).toLocaleString()),e.update_time&&(l.updateTime=new Date(e.update_time).toLocaleString()),l}function Lr(e){return W({url:"/discuss?id="+e,method:"get"})}function Ur(e){return W({url:"/discuss/edit?id="+e,method:"get"})}function Ar(e,l,n,s,o,y,w){const h={};return e?h.only_problem="1":h.only_problem="0",l&&(h.contest_id=l),n&&(h.problem_id=n),s&&(h.title=s),o&&(h.username=o),y&&(h.page=y),w&&(h.page_size=w),W({url:`/discuss/list?${new URLSearchParams(h).toString()}`,method:"get"})}function zr(e){return e||(e=0),W({url:"/discuss/image/token?id="+e,method:"get"})}function Kr(e,l){return e||(e=0),l||(l=0),W({url:"/discuss/comment/image/token?id="+e+"&comment_id="+l,method:"get"})}function Rr(e,l,n){return W({url:"/discuss/comment/list?id="+e+"&page="+l+"&page_size="+n,method:"get"})}function Er(e){return W({url:"/discuss/create",method:"post",data:e})}function Mr(e){return W({url:"/discuss/edit",method:"post",data:e})}function qr(e){return W({url:"/discuss/comment/create",method:"post",data:e})}function Fr(e){return W({url:"/discuss/comment/edit",method:"post",data:e})}const Nr={style:{margin:"10px"}};function Or(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!at(e)}const Gr=se({__name:"DiscussList",setup(e){const l=Ce(),n=Xe(),{globalProperties:s}=fe();let o=!1,y=null,w=-1,h=m(!1);const _=m([]),S=[],d=[{title:"标题",colKey:"title",cell:(D,V)=>t(B,{variant:"text",onClick:()=>i(V.row.id)},{default:()=>[V.row.title]})},{title:"创建人",colKey:"inserterNickname",width:"200",cell:(D,V)=>t(B,{variant:"text",onClick:async()=>await Xt(n,V.row.inserterUsername)},{default:()=>[V.row.inserterNickname]})},{title:"创建时间",colKey:"insertTime",width:"180"},{title:"更新时间",colKey:"updateTime",width:"180"}],c=m(!1);let $=1,C=50;const P=m({current:$,pageSize:C,defaultCurrent:$,defaultPageSize:C,total:0,pageSizeOptions:[50,100]}),k=m(),u=m({problemId:"",title:"",username:""}),b=(D,V)=>{n.push({name:"contest-problem-detail",params:{contestId:D,problemIndex:V}})},i=D=>{if(D){if(w){n.push({name:"contest-discuss-detail",params:{contestId:w,discussId:D}});return}n.push({name:"discuss-detail",params:{discussId:D}})}},f=async()=>{await n.push({query:{...l.query,problem_id:u.value.problemId,title:u.value.title,username:u.value.username,page:1,page_size:P.value.defaultPageSize}})},r=async(D,V)=>{var p;c.value=!0;try{const{current:A,pageSize:I}=D,g=await Ar(h.value,w,u.value.problemId,u.value.title,u.value.username,A,I);if(k.value=[],g.code===0){if(!g.data.has_auth){ke(s,"您目前没有权限查看讨论列表"),w?await n.push({name:"contest-detail",params:{contestId:w}}):await n.push({name:"discuss-list"});return}if(g.data.list){const T=g.data.list;for(let U=0;U<T.length;U++){const L=T[U],F=await ea(L);(p=k.value)==null||p.push(F)}}P.value={...P.value,total:g.data.total_count}}else V&&G(s,g.code)}catch(A){console.error(A),G(s,He())}finally{c.value=!1}},v=async D=>{await n.push({query:{...l.query,page:D.current,page_size:D.pageSize}})},z=async()=>{await n.push({name:"discuss-create"})};return ce(async()=>{o=!0,y=ze(()=>l.query,D=>{if(!o)return;h.value=l.name==="discuss-list-problem",Array.isArray(l.params.contestId)?w=Number(l.params.contestId[0]):w=Number(l.params.contestId),_.value=S,w?_.value=_.value.concat([{title:"问题标识",colKey:"contestProblemIndex",width:"100",cell:(A,I)=>{let g;return I.row.contestProblemIndex?t(B,{variant:"text",onClick:()=>b(w,I.row.contestProblemIndex)},Or(g=tt(I.row.contestProblemIndex))?g:{default:()=>[g]}):""}}]):_.value=_.value.concat([{title:"问题标识",colKey:"problemKey",width:"100",cell:(A,I)=>I.row.problemKey?t(B,{variant:"text",onClick:()=>Ot(I.row.problemKey)},{default:()=>[I.row.problemKey]}):""}]),_.value=_.value.concat(d),u.value.problemId=D.problem_id||"",u.value.title=D.title||"",u.value.username=D.username||"";const V=parseInt(D.page)||P.value.defaultCurrent,p=parseInt(D.page_size)||P.value.defaultPageSize;$=V,C=p,P.value={...P.value,current:$,pageSize:C},r({current:$,pageSize:C},!0)},{immediate:!0})}),je(()=>{o=!1,y&&y()}),(D,V)=>{const p=Fe,A=be,I=De,g=Ee,T=Re,U=B,L=Ke,F=Se,M=Te;return j(),R(M,null,{default:a(()=>[t(I,{span:9},{default:a(()=>[t(A,{style:{margin:"10px"}},{default:a(()=>[t(p,{data:k.value,columns:_.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:P.value,loading:c.value,"table-layout":"auto",onPageChange:v},null,8,["data","columns","pagination","loading"])]),_:1})]),_:1}),t(I,{span:3},{default:a(()=>[K("div",Nr,[t(A,{class:"sh-card"},{default:a(()=>[t(L,{model:u.value},{default:a(()=>[t(T,{label:"问题标识"},{default:a(()=>[t(g,{modelValue:u.value.problemId,"onUpdate:modelValue":V[0]||(V[0]=te=>u.value.problemId=te),placeholder:"请输入完整问题标识"},null,8,["modelValue"])]),_:1}),t(T,{label:"标题"},{default:a(()=>[t(g,{modelValue:u.value.title,"onUpdate:modelValue":V[1]||(V[1]=te=>u.value.title=te),placeholder:"暂不支持模糊查询"},null,8,["modelValue"])]),_:1}),t(T,{label:"创建人"},{default:a(()=>[t(g,{modelValue:u.value.username,"onUpdate:modelValue":V[2]||(V[2]=te=>u.value.username=te),placeholder:"仅支持输入完整用户名"},null,8,["modelValue"])]),_:1}),t(T,null,{default:a(()=>[t(U,{theme:"primary",onClick:f},{default:a(()=>V[3]||(V[3]=[x("提交")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(A,{class:"sh-card"},{default:a(()=>[t(F,null,{default:a(()=>[t(U,{onClick:z},{default:a(()=>V[4]||(V[4]=[x("创建")])),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})}}}),Rt=oe(Gr,[["__scopeId","data-v-626923dc"]]),Hr={key:0,style:{margin:"20px"}},Br={class:"dida-operation-container"},Jr={class:"dida-operation-container"},Wr={style:{margin:"10px"}},Yr={style:{margin:"10px"}},Xr={style:{margin:"10px"},class:"dida-operation-container"},Zr={style:{margin:"12px"}},Qr={key:0,class:"dida-edit-container"},ei=se({__name:"DiscussDetail",props:{discussId:{}},setup(e){const l=e;let n=Ce();const{globalProperties:s}=fe();let o=!1,y=null;const w=Ze(),h=qe();let _=m("");const S=m(0),d=m(!1),c=m(null),$=m(!1),C=m(!1),P=m(0),k=m("");let u=1,b=20;const i=m({current:1,pageSize:20,total:0,defaultPageSize:b,defaultCurrent:u,pageSizeOptions:[20,50]}),f=m([]),r=Je(()=>h.hasAuth(Ue.ManageDiscuss)),v=Je(()=>h.hasAuth(Ue.ManageDiscuss)||c.value&&h.getUserId==c.value.inserter),z=()=>{X.push({name:"discuss-edit",params:{discussId:S.value}})},D=()=>t("div",{class:"t-pagination__total"},[`共 ${i.value.total} 条回复`]),V=(U,L)=>{P.value=U,k.value=L;const F=document.getElementById("discuss-comment-editor");F&&F.scrollIntoView({behavior:"smooth"})},p=()=>{P.value=0,k.value="";const U=document.getElementById("discuss-comment-editor");U&&U.scrollIntoView({behavior:"smooth"})},A=async()=>{C.value=!0;try{let U;if(P.value){const L={id:P.value,discuss_id:S.value,content:k.value};if(U=await Fr(L),U.code!==0){G(s,U.code);return}Ge(s,"编辑成功"),P.value=0,k.value="",u===1?await g({current:1,pageSize:b},!0):await X.push({query:{current:1}});const F=document.getElementById("comment-divider");F&&F.scrollIntoView({behavior:"smooth"})}else{const L={discuss_id:S.value,content:k.value};if(U=await qr(L),U.code!==0){G(s,U.code);return}Ge(s,"编辑成功"),P.value=0,k.value="",u===1?await g({current:1,pageSize:b},!0):await X.push({query:{current:1}});const F=document.getElementById("comment-divider");F&&F.scrollIntoView({behavior:"smooth"})}}finally{C.value=!1}},I=async(U,L)=>{C.value=!0,await ct(U,L,s,()=>Kr(S.value,P.value)),C.value=!1},g=async(U,L)=>{var F;$.value=!0;try{const{current:M,pageSize:te}=U,Z=await Rr(S.value,M,te);if(f.value=[],Z.code===0){const re=Z.data.list;if(re)for(let J=0;J<re.length;J++){const de=re[J],ye=jr(de);(F=f.value)==null||F.push(ye)}i.value={...i.value,total:Z.data.total_count}}else L&&G(s,Z.code)}catch(M){console.error(M),G(s,He())}finally{$.value=!1}},T=async U=>{await X.push({query:{...n.query,page:U.current,page_size:U.pageSize}})};return ce(async()=>{if(o=!0,S.value=Number(l.discussId),S.value||(Array.isArray(n.params.discussId)?S.value=Number(n.params.discussId[0]):S.value=Number(n.params.discussId)),!S.value){ve(s,"讨论不存在"),await X.push({name:"discuss"});return}d.value=!0;const U=await Lr(S.value);if(U.code!==0){d.value=!1,G(s,U.code),await X.push({name:"discuss"});return}c.value=ea(U.data.discuss),w.setTitle(c.value.title+" - "+w.getTitle),_.value=c.value.content,d.value=!1,y=ze(()=>n.query,L=>{if(!o)return;const F=parseInt(L.page)||i.value.defaultCurrent,M=parseInt(L.page_size)||i.value.defaultPageSize;u=F,b=M,i.value={...i.value,current:u,pageSize:b},g({current:u,pageSize:b},!0)},{immediate:!0})}),je(()=>{o=!1,y&&y()}),(U,L)=>{const F=Ta,M=Ia,te=Me("md-preview"),Z=be,re=ql,J=Se,de=B,ye=Fl,Ie=Qe,O=Me("md-editor-v3"),N=$e,q=De,pe=Ye,Q=We,Y=Te;return j(),R(N,{loading:d.value},{default:a(()=>[t(Y,{class:"dida-main-content"},{default:a(()=>[t(q,{span:8},{default:a(()=>{var ae,_e,Pe;return[(ae=c.value)!=null&&ae.problemTitle||(_e=c.value)!=null&&_e.contestTitle?(j(),ee("div",Hr,[t(M,{"max-item-width":"300"},{default:a(()=>{var H,ie,we,ge,Ve;return[(H=c.value)!=null&&H.contestTitle?(j(),ee(ue,{key:0},[t(F,{to:{name:"contest-detail",params:{contestId:(ie=c.value)==null?void 0:ie.contestId}}},{default:a(()=>{var he;return[x(E((he=c.value)==null?void 0:he.contestTitle),1)]}),_:1},8,["to"]),(we=c.value)!=null&&we.contestProblemIndex?(j(),R(F,{key:0,to:{name:"contest-problem-detail",params:{problemIndex:(ge=c.value)==null?void 0:ge.contestProblemIndex}}},{default:a(()=>{var he,Ne;return[x(E(me(tt)((he=c.value)==null?void 0:he.contestProblemIndex))+" - "+E((Ne=c.value)==null?void 0:Ne.problemTitle),1)]}),_:1},8,["to"])):le("",!0)],64)):(j(),ee(ue,{key:1},[t(F,{to:{name:"discuss-list-problem"}},{default:a(()=>L[4]||(L[4]=[x(" 题目讨论")])),_:1}),t(F,{to:{name:"problem-detail",params:{problemId:(Ve=c.value)==null?void 0:Ve.problemId}}},{default:a(()=>{var he;return[x(E((he=c.value)==null?void 0:he.problemTitle),1)]}),_:1},8,["to"])],64))]}),_:1})])):le("",!0),t(Z,{style:{margin:"10px"},header:(Pe=c.value)==null?void 0:Pe.title,"header-bordered":!0},{default:a(()=>[t(te,{"model-value":me(_),previewTheme:"cyanosis"},null,8,["model-value"])]),_:1},8,["header"]),t(re,{id:"comment-divider"},{default:a(()=>L[5]||(L[5]=[x("评论区")])),_:1}),(j(!0),ee(ue,null,xe(f.value,(H,ie)=>(j(),R(Z,{key:ie,style:{margin:"10px"},"header-bordered":""},{header:a(()=>[K("div",Br,[t(J,null,{default:a(()=>[K("span",null,E(H.inserterNickname),1),K("span",null,E(H.insertTime),1)]),_:2},1024)]),K("div",Jr,[t(J,null,{default:a(()=>[r.value||me(h).getUserId===H.inserter?(j(),R(de,{key:0,onClick:()=>{V(H.id,H.content)}},{default:a(()=>L[6]||(L[6]=[x(" 编辑 ")])),_:2},1032,["onClick"])):le("",!0)]),_:2},1024)])]),default:a(()=>[t(te,{"model-value":H.content,previewTheme:"cyanosis"},null,8,["model-value"])]),_:2},1024))),128)),K("div",Wr,[t(ye,{modelValue:i.value.current,"onUpdate:modelValue":L[0]||(L[0]=H=>i.value.current=H),"page-size":i.value.pageSize,"onUpdate:pageSize":L[1]||(L[1]=H=>i.value.pageSize=H),total:i.value.total,"page-size-options":i.value.pageSizeOptions,"show-page-size":!1,"total-content":D,onChange:T},null,8,["modelValue","page-size","total","page-size-options"])]),t(re),K("div",Yr,[K("div",Xr,[t(Ie,{style:{margin:"10px"}},{default:a(()=>[x(E(P.value?"编辑回复":"发表回复"),1)]),_:1}),t(J,null,{default:a(()=>[t(de,{theme:"danger",onClick:p},{default:a(()=>L[7]||(L[7]=[x("清除")])),_:1}),t(de,{theme:"primary",onClick:A,loading:C.value},{default:a(()=>L[8]||(L[8]=[x("提交")])),_:1},8,["loading"])]),_:1})]),t(O,{id:"discuss-comment-editor",modelValue:k.value,"onUpdate:modelValue":L[2]||(L[2]=H=>k.value=H),previewTheme:"cyanosis",onSave:A,onOnUploadImg:I},null,8,["modelValue"]),t(N,{loading:C.value,attach:"#discuss-comment-editor","z-index":1e5},null,8,["loading"])])]}),_:1}),t(q,{span:4},{default:a(()=>[K("div",Zr,[v.value?(j(),ee("div",Qr,[t(de,{onClick:z},{default:a(()=>L[9]||(L[9]=[x("编辑")])),_:1})])):le("",!0),t(Q,{layout:"vertical",bordered:!0},{default:a(()=>[t(pe,{label:"创建时间"},{default:a(()=>{var ae;return[x(E((ae=c.value)==null?void 0:ae.insertTime),1)]}),_:1}),t(pe,{label:"编辑时间"},{default:a(()=>{var ae;return[x(E((ae=c.value)==null?void 0:ae.modifyTime),1)]}),_:1}),t(pe,{label:"更新时间"},{default:a(()=>{var ae;return[x(E((ae=c.value)==null?void 0:ae.updateTime),1)]}),_:1}),t(pe,{label:"创建用户"},{default:a(()=>[t(de,{variant:"text",onClick:L[3]||(L[3]=async()=>{var ae;return await me(Xt)(me(X),(ae=c.value)==null?void 0:ae.inserterUsername)})},{default:a(()=>{var ae;return[x(E((ae=c.value)==null?void 0:ae.inserterNickname),1)]}),_:1})]),_:1}),t(pe,{label:"标签"})]),_:1})])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),Et=oe(ei,[["__scopeId","data-v-6e73f8ab"]]),ti={style:{margin:"10px"}},ai={style:{margin:"12px"}},li={class:"dida-edit-container"},ni={class:"dida-description-editor"},oi=se({__name:"DiscussEdit",setup(e){let l=Ce();const{globalProperties:n}=fe();let s=null;const o=m(0),y=m(!1),w=m(!1),h=m(null),_=m({title:"",problemKey:"",content:""}),S=()=>{X.push({name:"discuss-detail",params:{discussId:o.value}})};async function d(k,u){w.value=!0,await ct(k,u,n,()=>zr(o.value)),w.value=!1}const c=async()=>{w.value=!0;try{const k={title:_.value.title,content:_.value.content,problem_key:_.value.problemKey},u=await Er(k);if(w.value=!0,u.code!==0){G(n,u.code);return}const b=u.data;await X.push({name:"discuss-detail",params:{discussId:b}}),Ge(n,"创建成功")}finally{w.value=!1}},$=async()=>{w.value=!0;try{const k={id:o.value,title:_.value.title,content:_.value.content,problem_key:_.value.problemKey},u=await Mr(k);if(w.value=!0,u.code!==0){G(n,u.code);return}h.value&&u.data.modify_time!=null&&(h.value.modifyTime=new Date(u.data.modify_time).toLocaleString()),u.data.content!=null&&(_.value.content=u.data.content),Ge(n,"保存成功")}finally{w.value=!1}},C=async()=>{o.value?await $():await c()},P=async()=>{const k=await Ur(o.value);if(k.code!==0){G(n,k.code),await X.push({name:"discuss"});return}const u=k.data.discuss;h.value=ea(u),_.value.title=u.title,_.value.content=u.content,_.value.problemKey=u.problem_key,y.value=!1};return ce(async()=>{s=ze(()=>l.params,async()=>{Array.isArray(l.params.discussId)?o.value=Number(l.params.discussId[0]):o.value=Number(l.params.discussId),o.value?(y.value=!0,await P()):(_.value.title="",_.value.problemKey="",_.value.content="")},{immediate:!0})}),je(()=>{s&&(s(),s=null)}),(k,u)=>{const b=Ee,i=Re,f=Ke,r=be,v=De,z=B,D=Se,V=Ye,p=We,A=Te,I=Me("md-editor-v3"),g=$e;return j(),R(g,{loading:y.value},{default:a(()=>[t(A,null,{default:a(()=>[t(v,{span:8},{default:a(()=>[K("div",ti,[t(r,{class:"sh-form-card"},{default:a(()=>[t(f,{model:_.value},{default:a(()=>[t(i,{label:"标题"},{default:a(()=>[t(b,{modelValue:_.value.title,"onUpdate:modelValue":u[0]||(u[0]=T=>_.value.title=T),placeholder:"讨论标题"},null,8,["modelValue"])]),_:1}),t(i,{label:"关联题目"},{default:a(()=>[t(b,{modelValue:_.value.problemKey,"onUpdate:modelValue":u[1]||(u[1]=T=>_.value.problemKey=T),placeholder:"讨论题目"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})])]),_:1}),t(v,{span:4},{default:a(()=>[K("div",ai,[K("div",li,[o.value?(j(),R(D,{key:0},{default:a(()=>[t(z,{onClick:$,theme:"danger",loading:w.value},{default:a(()=>u[3]||(u[3]=[x("保存")])),_:1},8,["loading"]),t(z,{onClick:S},{default:a(()=>u[4]||(u[4]=[x("查看")])),_:1})]),_:1})):(j(),R(D,{key:1},{default:a(()=>[t(z,{onClick:c,theme:"danger",loading:w.value},{default:a(()=>u[5]||(u[5]=[x("创建")])),_:1},8,["loading"])]),_:1}))]),o.value?(j(),R(p,{key:0,layout:"vertical",bordered:!0},{default:a(()=>[t(V,{label:"创建时间"},{default:a(()=>{var T;return[x(E((T=h.value)==null?void 0:T.insertTime),1)]}),_:1}),t(V,{label:"更新时间"},{default:a(()=>{var T;return[x(E((T=h.value)==null?void 0:T.modifyTime),1)]}),_:1}),t(V,{label:"创建用户"},{default:a(()=>{var T;return[x(E((T=h.value)==null?void 0:T.authorNickname),1)]}),_:1})]),_:1})):le("",!0)])]),_:1})]),_:1}),K("div",ni,[t(I,{id:"discuss-editor",modelValue:_.value.content,"onUpdate:modelValue":u[2]||(u[2]=T=>_.value.content=T),onSave:C,onOnUploadImg:d,previewTheme:"cyanosis"},null,8,["modelValue"]),t(g,{loading:w.value,attach:"#discuss-editor","z-index":1e5},null,8,["loading"])])]),_:1},8,["loading"])}}}),ga=oe(oi,[["__scopeId","data-v-7aa40f02"]]);function si(e,l){return W({url:"/rank/ac/all?page="+e+"&page_size="+l,method:"get"})}function ri(e,l){return W({url:"/rank/ac/problem?page="+e+"&page_size="+l,method:"get"})}function ii(e,l){return W({url:"/rank/ac/problem/today?page="+e+"&page_size="+l,method:"get"})}function ui(e,l){return W({url:"/rank/ac/problem/day7?page="+e+"&page_size="+l,method:"get"})}function di(e,l){return W({url:"/rank/ac/problem/day30?page="+e+"&page_size="+l,method:"get"})}function ci(e,l){return W({url:"/rank/ac/problem/year?page="+e+"&page_size="+l,method:"get"})}const mi={style:{margin:"10px"}};function Mt(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!at(e)}const pi=se({__name:"RankUser",props:{type:{}},setup(e){const l=Ce(),n=Xe(),{globalProperties:s}=fe();let o=null;const y=e,w=m(""),h=m(""),_={all:{header:"统计所有用户在本站的提交记录",content:"优先以AC记录数量排序，如果相同则提交所用次数较少的优先，如果仍相同，注册较早的用户靠前"},problem:{header:"统计所有用户在本站的提交记录",content:"以题目记录数量排序，如果相同，注册较早的用户靠前"},"problem-today":{header:"统计所有用户今日在本站的提交记录",content:"以今日题目记录数量排序，如果相同，注册较早的用户靠前"},"problem-day7":{header:"统计所有用户最近7日在本站的提交记录",content:"以7日题目记录数量排序（从7日前的0点开始计算），如果相同，注册较早的用户靠前"},"problem-day30":{header:"统计所有用户最近30日在本站的提交记录",content:"以30日题目记录数量排序（从30日前的0点开始计算），如果相同，注册较早的用户靠前"},"problem-year":{header:"统计所有用户最近1年在本站的提交记录",content:"以最近1年题目记录数量排序（从365日前的0点开始计算），如果相同，注册较早的用户靠前"}},S=m([]),d=[{title:"序号",colKey:"index"},{title:"用户名",colKey:"username",cell:(D,V)=>t(B,{variant:"dashed",onClick:()=>i(V.row.username)},{default:()=>[V.row.username]})},{title:"昵称",colKey:"nickname"},{title:"Slogan",colKey:"slogan"}],c=[{title:"题目数量",colKey:"problem_count",cell:(D,V)=>{let p=0;return V.row.problem_count&&(p=V.row.problem_count),t(B,{variant:"dashed",onClick:()=>f(V.row.username)},Mt(p)?p:{default:()=>[p]})}}],$=[{title:"正确",colKey:"accept",cell:(D,V)=>{let p=0;return V.row.accept&&(p=V.row.accept),t(B,{variant:"dashed",onClick:()=>f(V.row.username)},Mt(p)?p:{default:()=>[p]})}},{title:"提交",colKey:"attempt",cell:(D,V)=>{let p=0;return V.row.attempt&&(p=V.row.attempt),t(B,{variant:"dashed",onClick:()=>r(V.row.username)},Mt(p)?p:{default:()=>[p]})}}],C=m(!1);let P=1,k=50;const u=m({current:P,pageSize:k,defaultCurrent:P,defaultPageSize:k,total:0,pageSizeOptions:[50]}),b=m(),i=D=>{n.push({name:"user",params:{username:D}})},f=D=>{n.push({name:"judge-list",query:{username:D,status:Be.Accept}})},r=D=>{n.push({name:"judge-list",query:{username:D}})},v=async(D,V)=>{C.value=!0;try{b.value=[];const{current:p,pageSize:A}=D;let I=null;switch(y.type){case"problem":I=await ri(p,A);break;case"problem-today":I=await ii(p,A);break;case"problem-day7":I=await ui(p,A);break;case"problem-day30":I=await di(p,A);break;case"problem-year":I=await ci(p,A);break;default:I=await si(p,A);break}if(I.code===0){const g=I.data.list;if(!g||g.length<=0){u.value={...u.value,total:0},ke(s,"未找到记录");return}b.value=[];const T=u.value.pageSize*(u.value.current-1);let U=1;g.forEach(L=>{var M;const F=L;F.index=T+U++,(M=b.value)==null||M.push(F)}),u.value={...u.value,total:I.data.total_count}}else V&&G(s,I.code)}catch(p){console.error(p),G(s,He())}finally{C.value=!1}},z=async D=>{await n.push({query:{...l.query,page:D.current,page_size:D.pageSize}})};return ce(async()=>{C.value=!0,o=ze(()=>l.query,D=>{switch(y.type&&_[y.type]?(w.value=_[y.type].header,h.value=_[y.type].content):(w.value=_.all.header,h.value=_.all.content),y.type){case"all":S.value=d.concat($);break;default:S.value=d.concat(c);break}const V=parseInt(D.page)||u.value.defaultCurrent,p=parseInt(D.page_size)||u.value.defaultPageSize;P=V,k=p,u.value={...u.value,current:P,pageSize:k},v({current:P,pageSize:k},!0)},{immediate:!0})}),je(()=>{o&&o()}),(D,V)=>{const p=Fe,A=be,I=De,g=Te;return j(),R(g,null,{default:a(()=>[t(I,{span:9},{default:a(()=>[t(A,{style:{margin:"10px"}},{default:a(()=>[t(p,{data:b.value,columns:S.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:u.value,loading:C.value,"table-layout":"auto",onPageChange:z},null,8,["data","columns","pagination","loading"])]),_:1})]),_:1}),t(I,{span:3},{default:a(()=>[K("div",mi,[t(A,{class:"sh-card",header:w.value,"header-bordered":!0},{default:a(()=>[x(E(h.value),1)]),_:1},8,["header"])])]),_:1})]),_:1})}}}),it=oe(pi,[["__scopeId","data-v-13682529"]]),fi={style:{display:"flex","align-items":"center"}},vi={style:{color:"#409eff","margin-right":"20px"}},_i={class:"dida-login-footer"},gi=se({__name:"UserForget",setup(e){const{globalProperties:l}=fe(),n=qe(),s=m(!1),o=m(!1),y=m(!1),w=m("发送验证码");let h=null,_=-1;const S=m(!1),d=m(null),c=m(""),$=m({username:"",emailKey:"",password:"",confirmPassword:""}),P=m({username:[{required:!0,message:"请填写用户名"},{min:4,message:"用户名至少4个字符"},{max:20,message:"用户名最多20个字符"},{pattern:/^[a-zA-Z0-9_]+$/,message:"用户名只能包含字母、数字和下划线"}],password:[{required:!0,message:"请填写密码"},{min:6,message:"密码至少6个字符"},{max:20,message:"密码最多20个字符"}],confirmPassword:[{required:!0,message:"请确认密码"},{validator:v=>new Promise(z=>{const D=setTimeout(()=>{z($.value.password===v),clearTimeout(D)})}),message:"两次密码不一致"}],emailKey:[{required:!0,message:"请填写验证码"},{min:6,message:"请输入完整字符"},{max:6,message:"请输入完整字符"}]}),k=()=>{ke(l,"重置成功")},u=async v=>{if(!y.value){s.value=!0,o.value=!0;try{const z=await mo(v,$.value.username);z.code===0?(ke(l,"验证码发送成功"),c.value=z.data,o.value=!1,y.value=!0,h=new Date,w.value="60秒后重发",_=setInterval(()=>{const V=Math.floor((new Date().getTime()-(h==null?void 0:h.getTime()))/1e3);V>60?(w.value="发送验证码",y.value=!1,clearInterval(_)):w.value=`${60-V}秒后重发`},1e3)):G(l,z.code)}catch(z){console.error("Send email key error",z),ve(l,"发送验证码失败")}finally{s.value=!1}}},b=async()=>{var V;if(S.value=!0,y.value||o.value)return;await ft();const v=document.getElementById("cf-confirm-div");v&&v.remove();const z=document.createElement("div");z.id="cf-confirm-div",z.setAttribute("data-theme","light"),(V=d.value)==null||V.appendChild(z);const D=window;D.turnstile.ready(function(){D.turnstile.render("#cf-confirm-div",{sitekey:"0x4AAAAAABeM4SYPu2Rn7PmI",callback:async function(p){S.value=!1,await u(p)},"before-interactive-callback":function(){console.log("before-interactive-callback")}})})},i=m(()=>t(B,{onClick:b,disabled:y.value,loading:o.value,style:"width:120px"},{default:()=>[w.value]})),f=async()=>{s.value=!0;try{const v=await po($.value.username,$.value.password,$.value.emailKey);v.code===0?(ke(l,"密码修改成功"),l.$router.push({name:"login"})):G(l,v.code)}catch(v){console.error("Modify password error",v),ve(l,"修改密码失败")}finally{s.value=!1}},r=async({validateResult:v,firstError:z,e:D})=>{if(!s.value){if(D.preventDefault(),v!==!0){ve(l,z);return}c.value?await f():await b()}};return ce(()=>{if(n.isLogin()){l.$router.push({path:"/user"});return}}),je(()=>{}),(v,z)=>{const D=xt,V=Ee,p=Re,A=Ca,I=B,g=Ke,T=nt,U=be,L=ot;return j(),ee(ue,null,[t(U,{class:"yj-login-card",title:"欢迎使用DidaOJ~"},{default:a(()=>[t(D,{"max-line":1},{default:a(()=>z[6]||(z[6]=[K("span",null,"如果您未绑定邮箱或忘记用户名，可联系管理员寻求帮助",-1),K("span",null,"管理员邮箱：BoilTask@qq.com",-1)])),_:1}),t(D,{style:{"margin-top":"10px"}},{default:a(()=>z[7]||(z[7]=[K("p",null,"支持原acm.hpu.edu.cn、CodeOJ的用户直接登录",-1),K("p",null,"原DMOJ、hpuoj.com的用户，请先重置密码",-1),K("p",null,"可尝试学号/昵称等作为用户名登录，成功后有机会合并账户或修改用户名",-1)])),_:1}),t(g,{ref:"form",rules:P.value,data:$.value,colon:!0,onReset:k,onSubmit:r,class:"yj-login-form"},{default:a(()=>[t(p,{name:"username",label:"用户名"},{default:a(()=>[t(V,{modelValue:$.value.username,"onUpdate:modelValue":z[0]||(z[0]=F=>$.value.username=F),clearable:"",placeholder:"请输入完整用户名"},null,8,["modelValue"])]),_:1}),c.value?(j(),ee(ue,{key:0},[t(p,{name:"email",label:"发送邮箱"},{default:a(()=>[t(A,{append:i.value},{default:a(()=>[K("div",fi,[K("span",vi,E(c.value),1)])]),_:1},8,["append"])]),_:1}),t(p,{name:"emailKey",label:"验证码"},{default:a(()=>[t(V,{modelValue:$.value.emailKey,"onUpdate:modelValue":z[1]||(z[1]=F=>$.value.emailKey=F),clearable:"",placeholder:"请输入收到的验证码"},null,8,["modelValue"])]),_:1}),t(p,{name:"password",label:"新密码"},{default:a(()=>[t(V,{modelValue:$.value.password,"onUpdate:modelValue":z[2]||(z[2]=F=>$.value.password=F),type:"password",clearable:"",placeholder:"新密码"},null,8,["modelValue"])]),_:1}),t(p,{name:"confirmPassword",label:"确认密码"},{default:a(()=>[t(V,{modelValue:$.value.confirmPassword,"onUpdate:modelValue":z[3]||(z[3]=F=>$.value.confirmPassword=F),type:"password",clearable:"",placeholder:"请重复输入密码"},null,8,["modelValue"])]),_:1})],64)):le("",!0),c.value?(j(),R(p,{key:1},{default:a(()=>[t(I,{theme:"primary",type:"submit",block:"",loading:s.value},{default:a(()=>z[8]||(z[8]=[x("修改密码")])),_:1},8,["loading"])]),_:1})):(j(),R(p,{key:2},{default:a(()=>[t(I,{theme:"primary",type:"submit",block:"",loading:s.value},{default:a(()=>z[9]||(z[9]=[x("重置密码")])),_:1},8,["loading"])]),_:1}))]),_:1},8,["rules","data"]),K("div",_i,[t(T,{onClick:z[4]||(z[4]=()=>{me(l).$router.push({name:"login"})})},{default:a(()=>z[10]||(z[10]=[x("返回登陆 ")])),_:1})])]),_:1}),t(L,{visible:S.value,"onUpdate:visible":z[5]||(z[5]=F=>S.value=F),header:"正在加载人机验证","close-btn":!1,footer:!1},{default:a(()=>[K("div",{ref_key:"dialogContainer",ref:d,class:"cf-confirm-container"},null,512)]),_:1},8,["visible"])],64)}}}),bi=oe(gi,[["__scopeId","data-v-e960b193"]]),yi={class:"judger-status-panel"},hi={style:{"text-align":"center","margin-bottom":"20px"}},wi={class:"judger-status-panel"};function ki(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!at(e)}const Si=se({__name:"SystemStatus",setup(e){const{globalProperties:l}=fe();let n=!1;const s=m([]),o=m([]),y=m(!1),w=m(0),h=m(0),_=m(null),S=m(0),d=m(0),c=m(0);let $=-1,C;const P=b=>{let i="失效",f="danger";const r=new Date,v=new Date(b.modifyTime);return r.getTime()-v.getTime()>3e4?(i="离线",f="default"):b.cpuUsage>90?(i="CPU过高",f="warning"):b.memPercent>90?(i="内存过高",f="warning"):(i="在线",f="success"),t(Se,null,{default:()=>[t("span",null,[b.key,x(" - "),b.name]),t("span",null,[b.modifyTime]),t(Qe,{theme:f,size:"small"},ki(i)?i:{default:()=>[i]})]})},k=async()=>{const b={};for(let A=0;A<s.value.length;A++){const I=s.value[A];b[I.key]={...I}}const i={};for(let A=0;A<o.value.length;A++){const I=o.value[A];i[I.key]={...I}}const f=[],r=[],v=await vn();if(v.code!==0){G(l,v.code);return}const z=v.data.web,D={key:"didaoj"};z.name?D.name=z.name:D.name="-",z.modify_time?D.modifyTime=new Date(z.modify_time).toLocaleString():D.modifyTime="-",z.cpu_usage?D.cpuUsage=Number(z.cpu_usage):D.cpuUsage=0,z.mem_usage?D.memUsage=z.mem_usage/(1024*1024*1024):D.memUsage=0,z.mem_total?D.memTotal=z.mem_total/(1024*1024*1024):D.memTotal=0,D.memTotal>0?D.memPercent=Math.round(D.memUsage/D.memTotal*1e4)/100:D.memPercent=0,D.avgMessage=z.avg_message;const V=b[D.key];V?(D.cpuUsageFrom=V.cpuUsage,D.memPercentFrom=V.memPercent,D.memUsageFrom=V.memUsage,D.memTotalFrom=V.memTotal):(D.cpuUsageFrom=0,D.memPercentFrom=0,D.memUsageFrom=0,D.memTotalFrom=0),f.push(D),s.value=f;const p=v.data.judger;for(let A=0;A<p.length;A++){const I=p[A],g={key:I.key,name:I.name};I.name?g.name=I.name:g.name="-",I.modify_time?g.modifyTime=new Date(I.modify_time).toLocaleString():g.modifyTime="-",I.max_job?g.maxJob=Number(I.max_job):g.maxJob=0,I.cpu_usage?g.cpuUsage=Number(I.cpu_usage):g.cpuUsage=0,I.mem_usage?g.memUsage=I.mem_usage/(1024*1024*1024):g.memUsage=0,I.mem_total?g.memTotal=I.mem_total/(1024*1024*1024):g.memTotal=0,g.memTotal>0?g.memPercent=Math.round(g.memUsage/g.memTotal*1e4)/100:g.memPercent=0,g.avgMessage=I.avg_message,i[I.key]?(g.maxJobFrom=i[I.key].maxJob,g.cpuUsageFrom=i[I.key].cpuUsage,g.memPercentFrom=i[I.key].memPercent,g.memUsageFrom=i[I.key].memUsage,g.memTotalFrom=i[I.key].memTotal):(g.maxJobFrom=0,g.cpuUsageFrom=0,g.memPercentFrom=0,g.memUsageFrom=0,g.memTotalFrom=0),r.push(g)}o.value=r,w.value=h.value,h.value=v.data.judge_job,c.value=d.value,h.value>0?(_.value?d.value=(h.value-S.value)/((new Date().getTime()-_.value.getTime())/1e3)*60:(_.value=new Date,S.value=h.value,d.value=0,c.value=0),clearTimeout($),$=-1):$<0&&($=setTimeout(()=>{_.value=null,S.value=0},1e4))},u=async()=>{await k(),y.value=!1};return ce(()=>{n=!0,o.value=[],s.value=[],y.value=!0,u().finally(()=>{clearInterval(C),n&&(C=setInterval(()=>{u()},5e3))})}),je(()=>{n=!1,clearInterval(C)}),(b,i)=>{const f=Nl,r=Se,v=be,z=$e;return j(),R(z,{loading:y.value},{default:a(()=>[t(v,{title:"接口状态",class:"judger-status"},{default:a(()=>[K("div",yi,[(j(!0),ee(ue,null,xe(s.value,D=>(j(),R(v,{key:D.key,header:()=>P(D),class:"judge-status-judger"},{footer:a(()=>[K("span",null," 负载信息："+E(D.avgMessage),1)]),default:a(()=>[t(r,{class:"judge-status-judger"},{default:a(()=>[t(f,{title:"CPU使用率",value:D.cpuUsage,animation:{valueFrom:D.cpuUsageFrom,duration:2e3},"animation-start":!0,unit:"%",decimalPlaces:2},null,8,["value","animation"]),t(f,{title:"内存使用率",value:D.memPercent,animation:{valueFrom:D.memPercentFrom,duration:2e3},"animation-start":!0,unit:"%",decimalPlaces:2},null,8,["value","animation"]),t(f,{title:"内存使用量",animation:{valueFrom:D.memUsageFrom,duration:2e3},"animation-start":!0,value:D.memUsage,unit:"GB",decimalPlaces:2},null,8,["animation","value"]),t(f,{title:"内存总量",value:D.memTotal,animation:{valueFrom:D.memTotalFrom,duration:2e3},"animation-start":!0,unit:"GB",decimalPlaces:2},null,8,["value","animation"])]),_:2},1024)]),_:2},1032,["header"]))),128))])]),_:1}),t(v,{title:"判题机状态",class:"judger-status"},{default:a(()=>[K("div",hi,[t(r,null,{default:a(()=>[t(f,{title:"未完成的评测数量",value:h.value,animation:{valueFrom:w.value,duration:4e3},"animation-start":!0},null,8,["value","animation"]),_.value?(j(),R(f,{key:0,title:"评测数量趋势",value:d.value,animation:{valueFrom:c.value,duration:4e3},"animation-start":!0,decimalPlaces:2,unit:"/分钟"},null,8,["value","animation"])):(j(),R(f,{key:1,title:"评测数量趋势",format:()=>"样本较少"}))]),_:1})]),K("div",wi,[(j(!0),ee(ue,null,xe(o.value,D=>(j(),R(v,{key:D.key,header:()=>P(D),class:"judge-status-judger"},{footer:a(()=>[K("span",null," 负载信息："+E(D.avgMessage),1)]),default:a(()=>[t(r,{class:"judge-status-judger"},{default:a(()=>[t(f,{title:"并发",value:D.maxJob,animation:{valueFrom:D.maxJob,duration:2e3},"animation-start":!0},null,8,["value","animation"]),t(f,{title:"CPU使用率",value:D.cpuUsage,animation:{valueFrom:D.cpuUsageFrom,duration:2e3},"animation-start":!0,unit:"%",decimalPlaces:2},null,8,["value","animation"]),t(f,{title:"内存使用率",value:D.memPercent,animation:{valueFrom:D.memPercentFrom,duration:2e3},"animation-start":!0,unit:"%",decimalPlaces:2},null,8,["value","animation"]),t(f,{title:"内存使用量",animation:{valueFrom:D.memUsageFrom,duration:2e3},"animation-start":!0,value:D.memUsage,unit:"GB",decimalPlaces:2},null,8,["animation","value"]),t(f,{title:"内存总量",value:D.memTotal,animation:{valueFrom:D.memTotalFrom,duration:2e3},"animation-start":!0,unit:"GB",decimalPlaces:2},null,8,["value","animation"])]),_:2},1024)]),_:2},1032,["header"]))),128))])]),_:1})]),_:1},8,["loading"])}}}),Ci=oe(Si,[["__scopeId","data-v-f6ed2abe"]]),Pi=se({__name:"ManageJudge",setup(e){const{globalProperties:l}=fe(),n=m(!1),s=m(!1),o=m({problemKey:"",language:void 0,status:void 0}),y=m(!1),w=m([]);w.value=Jt();const h=m([]);h.value=Ua();const _=async()=>{n.value=!0;try{const c=await Pn();if(c.code!==0){G(l,c.code);return}ke(l,"重判成功"),await X.push({name:"judge-list"})}catch(c){console.error(c),G(l,"重判失败")}finally{n.value=!1}},S=async()=>{if(!o.value.problemKey&&o.value.language===void 0&&o.value.status===void 0){ve(l,"请输入问题标识");return}y.value=!0;try{const c=await In(o.value.problemKey,o.value.language,o.value.status);if(c.code!==0){G(l,c.code);return}ke(l,"重判成功"),await X.push({name:"judge-list",query:{problem_id:o.value.problemKey,language:o.value.language}})}catch(c){console.error(c),G(l,"重判失败")}finally{y.value=!1}},d=async()=>{s.value=!0;try{const c=await Tn();if(c.code!==0){G(l,c.code);return}ke(l,"重判成功"),await X.push({name:"judge-list"})}catch(c){console.error(c),G(l,"重判失败")}finally{s.value=!1}};return(c,$)=>{const C=B,P=be,k=Ee,u=Re,b=Ht,i=gt,f=Se,r=Ke;return j(),ee(ue,null,[t(P,{class:"yj-manage-card",title:"重判最近提交"},{default:a(()=>[t(C,{onClick:_,loading:n.value},{default:a(()=>$[3]||($[3]=[x("重判")])),_:1},8,["loading"])]),_:1}),t(P,{class:"yj-manage-card",title:"重判指定记录"},{default:a(()=>[t(r,{layout:"inline",onSubmit:S},{default:a(()=>[t(u,{label:"问题标识"},{default:a(()=>[t(k,{modelValue:o.value.problemKey,"onUpdate:modelValue":$[0]||($[0]=v=>o.value.problemKey=v),placeholder:"请输入完整问题标识"},null,8,["modelValue"])]),_:1}),t(u,{label:"语言"},{default:a(()=>[t(i,{modelValue:o.value.language,"onUpdate:modelValue":$[1]||($[1]=v=>o.value.language=v),placeholder:"请选择提交语言","auto-width":"",clearable:""},{default:a(()=>[(j(!0),ee(ue,null,xe(w.value,v=>(j(),R(b,{key:v.value,value:v.value,label:v.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(u,{label:"状态"},{default:a(()=>[t(i,{modelValue:o.value.status,"onUpdate:modelValue":$[2]||($[2]=v=>o.value.status=v),placeholder:"请选择评测状态","auto-width":"",clearable:""},{default:a(()=>[(j(!0),ee(ue,null,xe(h.value,v=>(j(),R(b,{key:v.value,value:v.value,label:v.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(u,null,{default:a(()=>[t(f,null,{default:a(()=>[t(C,{theme:"primary",type:"submit",loading:y.value},{default:a(()=>$[4]||($[4]=[x("重判")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1}),t(P,{class:"yj-manage-card",title:"重判所有"},{default:a(()=>[t(C,{onClick:d,theme:"danger",loading:s.value},{default:a(()=>$[5]||($[5]=[x("重判")])),_:1},8,["loading"])]),_:1})],64)}}}),Ii=oe(Pi,[["__scopeId","data-v-11ca8506"]]),Ti=se({__name:"ManageWeb",setup(e){const{globalProperties:l}=fe(),n=m({theme:"",content:""}),s=m({title:"",content:""}),o=m(!1),y=m(!1),w=m(!1);async function h($,C){w.value=!0,await ct($,C,l,_n),w.value=!1}const _=async()=>{y.value=!0;try{const $=await gn(n.value.theme,n.value.content);if($.code!==0){G(l,$.code);return}ke(l,"保存成功")}catch($){console.error($),G(l,"保存失败")}finally{y.value=!1}},S=async()=>{w.value=!0;try{const $=s.value.content,C=await bn(s.value.title,$);if(C.code!==0){G(l,C.code);return}s.value.content=C.data.content,ke(l,"保存成功")}catch($){console.error($),ve(l,"保存失败")}finally{w.value=!1}},d=async()=>{n.value=await $a()},c=async()=>{try{s.value=await ja()}catch{ve(l,"加载公告失败"),s.value={title:"",content:""}}};return ce(async()=>{o.value=!0;try{await d(),await c()}catch{ve(l,"加载数据失败")}o.value=!1}),($,C)=>{const P=gt,k=Re,u=Ee,b=B,i=Se,f=Ke,r=be,v=Me("md-editor-v3"),z=$e;return j(),R(z,{loading:o.value},{default:a(()=>[t(r,{class:"yj-manage-card",title:"站点通知"},{default:a(()=>[t(f,{onSubmit:_},{default:a(()=>[t(k,{label:"主题"},{default:a(()=>[t(P,{modelValue:n.value.theme,"onUpdate:modelValue":C[0]||(C[0]=D=>n.value.theme=D),options:[{label:"success",value:"success"},{label:"info",value:"info"},{label:"warning",value:"warning"},{label:"error",value:"error"}],placeholder:"请选择主题"},null,8,["modelValue"])]),_:1}),t(k,{label:"内容"},{default:a(()=>[t(u,{modelValue:n.value.content,"onUpdate:modelValue":C[1]||(C[1]=D=>n.value.content=D),placeholder:"请输入描述"},null,8,["modelValue"])]),_:1}),t(k,null,{default:a(()=>[t(i,null,{default:a(()=>[t(b,{theme:"primary",type:"submit",loading:y.value},{default:a(()=>C[4]||(C[4]=[x("保存")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1}),t(r,{class:"yj-manage-card",title:"首页公告"},{actions:a(()=>[t(b,{theme:"primary",loading:w.value,onClick:S},{default:a(()=>C[5]||(C[5]=[x("保存")])),_:1},8,["loading"])]),default:a(()=>[t(f,{onSubmit:S},{default:a(()=>[t(k,{label:"标题"},{default:a(()=>[t(u,{modelValue:s.value.title,"onUpdate:modelValue":C[2]||(C[2]=D=>s.value.title=D),placeholder:"请输入描述"},null,8,["modelValue"])]),_:1})]),_:1}),t(z,{loading:w.value},{default:a(()=>[t(v,{modelValue:s.value.content,"onUpdate:modelValue":C[3]||(C[3]=D=>s.value.content=D),onSave:S,onOnUploadImg:h,previewTheme:"cyanosis",class:"dida-description-editor"},null,8,["modelValue"])]),_:1},8,["loading"])]),_:1})]),_:1},8,["loading"])}}}),xi=oe(Ti,[["__scopeId","data-v-8c162eb5"]]),Ha=[{name:"problem-list",tab:"problem",sidebar:"problem-list",path:"",title:"问题列表",icon:"list",component:Uo},{name:"problem-detail",tab:"problem",sidebar:"problem-list",path:":problemKey+",title:"问题详情",icon:"list",component:At},{name:"problem-daily-list",tab:"problem",sidebar:"problem-daily-list",path:"daily",title:"每日一题",icon:"list",component:us},{name:"problem-daily-detail",tab:"problem",sidebar:"problem-daily-list",path:"daily/:dailyId+",title:"问题详情",icon:"list",component:At},{name:"problem-recommend",tab:"problem",sidebar:"problem-recommend",path:"recommend/:problemKey*",title:"问题推荐",icon:"cpu",needLogin:!0,component:gs},{name:"problem-collection-list",tab:"problem",sidebar:"problem-collection-list",path:"collection",title:"题目集合",icon:"list",disableTabPath:!0,component:Es},{name:"collection-detail",tab:"collection-detail-tab",sidebar:"collection-detail",path:":collectionId+",title:"题集详情",icon:"cpu",component:Os},{name:"collection-rank",tab:"collection-detail-tab",sidebar:"collection-rank",path:":collectionId+/rank",title:"题集排名",icon:"list",component:Gs},{name:"collection-edit",tab:"collection-detail-tab",sidebar:"collection-edit",disableSidebar:!0,needLogin:!0,path:":collectionId+/edit",title:"题集编辑",icon:"list",component:da},{name:"collection-create",tab:"collection-detail-tab",sidebar:"collection-create",needLogin:!0,disableSidebar:!0,path:"create",title:"新建题集",icon:"list",component:da},{name:"judge-list",tab:"judge",sidebar:"judge-list",path:"",title:"评测列表",icon:"list",component:ma},{name:"judge-detail",tab:"judge",sidebar:"judge-list",path:":judgeId+",title:"评测详情",icon:"cpu",component:pa},{name:"contest-list",tab:"contest",sidebar:"contest-list",path:"",title:"比赛列表",icon:"list",component:fa},{name:"contest-recent",tab:"contest",sidebar:"contest-recent",path:"recent",title:"近期比赛",icon:"list",component:fa},{name:"contest-create",tab:"contest",sidebar:"contest-create",disableSidebar:!0,needLogin:!0,path:"create",title:"新建比赛",icon:"list",component:_a},{name:"contest-edit",tab:"contest-detail-tab",sidebar:"contest-edit",disableSidebar:!0,needLogin:!0,path:":contestId+/edit",title:"比赛编辑",icon:"list",component:_a},{name:"contest-detail",tab:"contest-detail-tab",sidebar:"contest-detail",path:":contestId+",title:"比赛详情",icon:"cpu",component:hr},{name:"contest-problem-detail",tab:"contest-detail-tab",sidebar:"contest-problem-detail",path:":contestId+/problem/:problemIndex+",title:"问题详情",icon:"cpu",disableSidebar:!0,component:At},{name:"contest-judge",tab:"contest-detail-tab",sidebar:"contest-judge",path:":contestId+/judge",title:"评测列表",icon:"list",component:ma},{name:"contest-judge-detail",tab:"contest-detail-tab",sidebar:"contest-judge-detail",path:":contestId+/judge/:judgeId+",title:"评测详情",icon:"cpu",component:pa,disableSidebar:!0},{name:"contest-rank",tab:"contest-detail-tab",sidebar:"contest-rank",path:":contestId+/rank",title:"比赛排名",icon:"list",component:Ir},{name:"contest-discuss",tab:"contest-detail-tab",sidebar:"contest-discuss",path:":contestId+/discuss",title:"比赛讨论",icon:"list",component:Rt},{name:"contest-discuss-detail",tab:"contest-detail-tab",sidebar:"contest-discuss",path:":contestId+/discuss/:discussId+",title:"讨论详情",icon:"list",component:Et},{name:"discuss-list",tab:"discuss",sidebar:"discuss-list",path:"",title:"讨论列表",icon:"list",component:Rt},{name:"discuss-create",tab:"discuss",sidebar:"discuss-create",disableSidebar:!0,needLogin:!0,path:"create",title:"新建讨论",icon:"list",component:ga},{name:"discuss-edit",tab:"discuss-detail-tab",sidebar:"discuss-edit",disableSidebar:!0,needLogin:!0,path:":discussId+/edit",title:"编辑讨论",icon:"list",component:ga},{name:"discuss-list-problem",tab:"discuss",sidebar:"discuss-list-problem",path:"problem",title:"题目讨论",icon:"list",component:Rt},{name:"discuss-detail",tab:"discuss",sidebar:"discuss-list",path:":discussId+",title:"讨论详情",icon:"list",component:Et},{name:"rank-ac-all",tab:"rank",sidebar:"rank-ac-all",path:"ac",title:"AC排名",icon:"base-station",props:{type:"all"},component:it},{name:"rank-ac-problem",tab:"rank",sidebar:"rank-ac-problem",path:"ac/problem",title:"题量排名",icon:"base-station",props:{type:"problem"},component:it},{name:"rank-ac-problem-today",tab:"rank",sidebar:"rank-ac-problem-today",path:"ac/problem/today",title:"今日题量",icon:"base-station",props:{type:"problem-today"},component:it},{name:"rank-ac-problem-day7",tab:"rank",sidebar:"rank-ac-problem-day7",path:"ac/problem/day7",title:"7日题量",icon:"base-station",props:{type:"problem-day7"},component:it},{name:"rank-ac-problem-day30",tab:"rank",sidebar:"rank-ac-problem-day30",path:"ac/problem/day30",title:"30日题量",icon:"base-station",props:{type:"problem-day30"},component:it},{name:"rank-ac-problem-year",tab:"rank",sidebar:"rank-ac-problem-year",path:"ac/problem/year",title:"1年题量",icon:"base-station",props:{type:"problem-year"},component:it},{name:"system-status",tab:"system",sidebar:"system-status",path:"",title:"运行状态",icon:"base-station",component:Ci},{name:"system-about",tab:"system",sidebar:"system-about",path:"about",title:"关于",icon:"base-station",props:{discussId:"93"},component:Et},{name:"manage-problem-create",tab:"manage",sidebar:"manage-problem-create",disableSidebar:!0,path:"problem",title:"新建问题",icon:"list",component:ua,auths:[Ue.ManageProblem]},{name:"manage-problem",tab:"manage",sidebar:"manage-problem",disableSidebar:!0,path:"problem/:problemKey+",title:"问题编辑",icon:"list",component:ua,auths:[Ue.ManageProblem]},{name:"manage-problem-daily-create",tab:"manage",sidebar:"manage-problem-daily-create",disableSidebar:!0,path:"problem/daily",title:"新建每日一题",icon:"list",component:ia,auths:[Ue.ManageProblemDaily]},{name:"manage-problem-daily",tab:"manage",sidebar:"manage-problem-daily",disableSidebar:!0,path:"problem/daily/:dailyId+",title:"编辑每日一题",icon:"list",component:ia,auths:[Ue.ManageProblemDaily]},{name:"manage-problem-judge",tab:"manage",sidebar:"manage-problem-judge",disableSidebar:!0,path:"problem/:problemKey+/judge",title:"评测数据",icon:"list",component:xs,auths:[Ue.ManageProblem]},{name:"manage-web",tab:"manage",path:"web",sidebar:"manage-web",title:"站点管理",icon:"list",auths:[Ue.ManageWeb],component:xi},{name:"manage-judge",tab:"manage",path:"judge",sidebar:"manage-judge",title:"评测管理",icon:"list",auths:["i-manage-judge"],component:Ii},{name:"login-forget",tab:"login",path:"forget",title:"忘记密码",component:bi}],ba=(e,l,n,s)=>{s.tab==n&&(s.disableSidebar&&l!=s.sidebar||s.sidebar==null||s.sidebar!=s.name||e.push({name:s.name,title:s.title,icon:s.icon,to:{name:s.name}}))},Vi=(e,l)=>{const n=[];return Ha.forEach(s=>{if(Fa(s)){const o=[];s.children.forEach(y=>{ba(o,e,l,y)}),o.length>0&&n.push({title:s.title,children:o})}else ba(n,e,l,s)}),n},ya=(e,l)=>{const n=Io(l.tab),s={name:l.name,path:"/"+l.path,meta:{title:l.title+" - "+n.title,tab:l.tab,sidebar:l.sidebar,showSidebar:n.showSidebar,needLogin:n.needLogin||l.needLogin,tabAuths:n.auths,auths:l.auths},props:l.props,component:l.component};!n.disablePath&&!l.disableTabPath&&(s.path=n.path+s.path),e.push(s)},Di=e=>{Ha.forEach(l=>{Fa(l)?l.children.forEach(n=>{ya(e,n)}):ya(e,l)})},$i={class:"sh-main"},ji=se({__name:"View403",setup(e){let l=Ce();const n=m("");return ce(()=>{l.query.target?n.value=l.query.target:n.value=l.fullPath}),(s,o)=>{const y=B;return j(),ee("div",$i,[K("p",null,E(n.value),1),o[2]||(o[2]=K("p",null,"该页面无访问权限，请更换访问目标或重新登陆后再试",-1)),t(y,{theme:"primary",onClick:o[0]||(o[0]=()=>s.$router.push("/"))},{default:a(()=>o[1]||(o[1]=[x("返回首页")])),_:1})])}}}),Ba=oe(ji,[["__scopeId","data-v-777362b3"]]),ht=[];xo(ht);Di(ht);ht.push({path:"/403",name:"403",component:Ba});ht.push({path:"/:pathMatch(.*)*",name:"404",component:qa});const X=cl({history:ml("/"),routes:ht});X.beforeEach((e,l,n)=>{if(e.name==null||!X.hasRoute(e.name)){n({name:"home"});return}const s=e.matched[e.matched.length-1].meta;if(s.redirect){n({name:s.redirect});return}if(s.needLogin){const y=qe();if(y.getToken==null||y.getToken==""){n({name:"login",query:{redirect_uri:e.fullPath}});return}}const o=s.tabAuths;if(o&&!qe().hasAllAuths(o)){n({name:"403",query:{target:e.fullPath}});return}n()});X.afterEach((e,l)=>{if(e.name===l.name)return;const n=Dt(),s=Ze();let o=null;if(e.matched.length>0&&(o=e.matched[e.matched.length-1].meta),o!=null&&o.title&&s.setTitle(o==null?void 0:o.title),o!=null&&o.showSidebar){n.setSidebarShow(!0);const y=Vi(o==null?void 0:o.sidebar,o==null?void 0:o.tab);n.setMenuList(y),n.setMenuActiveName(o==null?void 0:o.sidebar)}else n.setSidebarShow(!1);window.scrollTo(0,0)});const Ja=_t("login",{state:()=>({Loaded:!1}),getters:{isLoaded(){return this.Loaded}}}),Li=se({__name:"HeaderContent",setup(e){const l=Ja(),n=qe(),{globalProperties:s}=fe(),o=m(l.isLoaded),y=m(!1),w=m(n.getUsername),h=m(n.getNickname),_=m(),S=()=>{_.value=To(n)};l.$subscribe(($,C)=>{o.value=C.Loaded}),n.$subscribe(($,C)=>{w.value=C.username,h.value=C.nickname,y.value=C.token!="",S()});const d=()=>{s.$router.currentRoute.value.name!=="login"&&s.$router.push({name:"login",query:{redirect_uri:s.$router.currentRoute.value.fullPath}})},c=()=>{n.clear(),s.$message.success({duration:3e3,content:"注销成功"}),s.$router.push({path:"/login",query:{redirect_uri:s.$router.currentRoute.value.fullPath}})};return ce(()=>{S()}),($,C)=>{const P=Me("router-link"),k=Va,u=xa,b=Ol,i=Gl;return j(),R(i,{modelValue:$.$route.meta.tab,"onUpdate:modelValue":C[0]||(C[0]=f=>$.$route.meta.tab=f),class:"sh-menu","expand-type":"popup"},{logo:a(()=>[t(P,{to:"/",class:"sh-logo"},{default:a(()=>C[1]||(C[1]=[x("DidaOJ")])),_:1})]),operations:a(()=>[o.value&&y.value?(j(),R(b,{key:0,title:h.value},{icon:a(()=>[t(k,{name:"user"})]),default:a(()=>[t(u,{value:"user",to:{path:"/user/"+w.value}},{default:a(()=>C[2]||(C[2]=[x("个人空间")])),_:1},8,["to"]),t(u,{value:"user_logout",onClick:c},{default:a(()=>C[3]||(C[3]=[x(" 注销")])),_:1})]),_:1},8,["title"])):o.value?(j(),R(u,{key:2,value:"login",onClick:d},{icon:a(()=>[t(k,{name:"login"})]),default:a(()=>[C[5]||(C[5]=x(" 登录 "))]),_:1})):(j(),R(u,{key:1,value:"login"},{icon:a(()=>[t(k,{name:"login"})]),default:a(()=>[C[4]||(C[4]=x(" ... "))]),_:1}))]),default:a(()=>[(j(!0),ee(ue,null,xe(_.value,f=>(j(),R(u,{key:f.name,value:f.name,to:{name:f.name}},{icon:a(()=>[f.icon?(j(),R(k,{key:0,name:f.icon},null,8,["name"])):le("",!0)]),default:a(()=>[x(" "+E(f.title),1)]),_:2},1032,["value","to"]))),128))]),_:1},8,["modelValue"])}}}),Ui=oe(Li,[["__scopeId","data-v-95e7494b"]]),Ai={id:"menu-container"},zi=se({__name:"SidebarContent",setup(e){const l=Dt(),n=m(!1),s=m(null),o=m(l.menuActiveName),y=m(l.menuList),w=m([]),h=m(!1),_=()=>{o.value=l.menuActiveName;const d=JSON.stringify(y.value),c=JSON.stringify(l.menuList);d!==c&&(w.value.push([...l.menuList]),S())},S=async()=>{if(w.value.length>0&&!h.value){for(h.value=!0;w.value.length>1;)w.value.shift();const d=w.value.shift();n.value=d.length<=0,y.value=[],await ft(),s.value&&s.value.updateActiveName(),await new Promise($=>setTimeout($,300)),y.value=d,await ft(),s.value&&s.value.updateActiveName();const c=300;await new Promise($=>setTimeout($,c)),h.value=!1,await S()}};return l.$subscribe((d,c)=>{_()}),ce(()=>{_()}),(d,c)=>{const $=Va,C=xa,P=Bl,k=Hl,u=$e;return j(),ee(ue,null,[K("div",Ai,[t(k,{modelValue:o.value,"onUpdate:modelValue":c[0]||(c[0]=b=>o.value=b),theme:"light",class:"sh-menu-container"},{default:a(()=>[t(pl,{name:"move-left"},{default:a(()=>[(j(!0),ee(ue,null,xe(y.value,(b,i)=>(j(),ee(ue,{key:i},[me(Vo)(b)?(j(),R(P,{key:0,title:b.title},{default:a(()=>[(j(!0),ee(ue,null,xe(b.children,(f,r)=>(j(),R(C,{key:f.name,value:f.name,to:f.to},la({default:a(()=>[x(" "+E(f.title),1)]),_:2},[f.icon?{name:"icon",fn:a(()=>[t($,{name:f.icon,class:Nt(f.iconClass)},null,8,["name","class"])]),key:"0"}:void 0]),1032,["value","to"]))),128))]),_:2},1032,["title"])):(j(),R(C,{key:b.name,value:b.name,to:b.to},la({default:a(()=>[x(" "+E(b.title),1)]),_:2},[b.icon?{name:"icon",fn:a(()=>[t($,{name:b.icon,class:Nt(b.iconClass)},null,8,["name","class"])]),key:"0"}:void 0]),1032,["value","to"]))],64))),128))]),_:1})]),_:1},8,["modelValue"])]),t(u,{size:"small",loading:n.value,"show-overlay":!0,attach:"#menu-container",class:"sh-sidebar-loading",style:{"align-items":"flex-start","padding-top":"100px"}},null,8,["loading"])],64)}}}),Ki=oe(zi,[["__scopeId","data-v-96e2d89f"]]),Ri={};function Ei(e,l){return null}const Mi=oe(Ri,[["render",Ei]]),qi={class:"footer"},Fi={class:"footer-left"},Ni={class:"foot-time"},Oi={class:"footer-center"},Gi={href:"https://beiancx.miit.gov.cn/",target:"_blank"},Hi={class:"footer-right"},Bi={class:"foot-text"},Ji={href:"https://github.com/hpu-developer/DiDaOJ-web",target:"_blank"},Wi={class:"foot-text"},Yi={href:"https://github.com/hpu-developer/DiDaOJ-go",target:"_blank"},Xi=se({__name:"FooterContent",setup(e){const l=m("");function n(){l.value=new Date().toLocaleString()}return ce(()=>{n(),setInterval(()=>{n()},1e3)}),(s,o)=>{const y=B;return j(),ee("div",qi,[K("div",Fi,[K("p",Ni,E(l.value),1)]),K("div",Oi,[K("a",Gi,[t(y,{theme:"default",variant:"outline",ghost:!0},{default:a(()=>o[0]||(o[0]=[x("豫ICP备15024677号-4")])),_:1})])]),K("div",Hi,[K("p",Bi,[K("a",Ji,[t(y,{theme:"default",variant:"outline",ghost:!0},{default:a(()=>o[1]||(o[1]=[x("@didaoj-web")])),_:1})])]),K("p",Wi,[K("a",Yi,[t(y,{theme:"default",variant:"outline",ghost:!0},{default:a(()=>o[2]||(o[2]=[x("@didaoj-go")])),_:1})])])])])}}}),Zi=oe(Xi,[["__scopeId","data-v-44f2e4e7"]]),kt=20,qt=100,Ft=50,Qi=se({__name:"ForceHiddenSidebarButton",setup(e){let l=Dt();const n=m({x:window.innerWidth-qt-kt,y:window.innerHeight-Ft-kt}),s=m(window.innerWidth),o=m(window.innerHeight);let y=!1,w={x:0,y:0};const h=b=>{y=!0;const i=b.clientX??b.touches[0].clientX,f=b.clientY??b.touches[0].clientY;w={x:i-n.value.x,y:f-n.value.y},document.addEventListener("mousemove",_),document.addEventListener("touchmove",_),document.addEventListener("mouseup",S),document.addEventListener("touchend",S)},_=b=>{if(!y)return;const i=b.clientX??b.touches[0].clientX,f=b.clientY??b.touches[0].clientY;let r=i-w.x,v=f-w.y;r=Math.max(0,Math.min(r,s.value-qt)),v=Math.max(0,Math.min(v,o.value-Ft)),n.value={x:r,y:v}},S=()=>{y=!1,document.removeEventListener("mousemove",_),document.removeEventListener("touchmove",_),document.removeEventListener("mouseup",S),document.removeEventListener("touchend",S)},d=()=>{s.value=window.innerWidth,o.value=window.innerHeight,n.value={x:Math.min(n.value.x,s.value-qt-kt),y:Math.min(n.value.y,o.value-Ft-kt)}};let c=m(l.forceHiddenSidebar),$=m(l.forceHiddenSidebar);const C=()=>{c.value=!c.value,l.setForceHiddenSidebar(c.value)},P=()=>{$.value||($.value=!0,l.setForceHiddenSidebar(c.value))},k=()=>{$.value&&($.value=!1,l.setForceHiddenSidebar(!1))},u=b=>{b>=800?k():P()};return u(s.value),ze(s,b=>{u(b)}),ce(()=>{window.addEventListener("resize",d)}),je(()=>{window.removeEventListener("resize",d)}),(b,i)=>{const f=B;return me($)?(j(),R(f,{key:0,class:"draggable-button",style:wa({top:`${n.value.y}px`,left:`${n.value.x}px`}),onMousedown:h,onTouchstart:h,variant:"dashed",theme:"primary",onClick:C},{default:a(()=>[x(E(me(c)?"显示":"隐藏"),1)]),_:1},8,["style"])):le("",!0)}}}),eu=oe(Qi,[["__scopeId","data-v-1aee5506"]]),St="DidaOJ",tu=se({__name:"App",setup(e){const{globalProperties:l}=fe(),n=Ja(),s=qe(),o=Ze(),y=Dt();n.$patch({Loaded:!1});const w=s.getToken,h=m(!1),_=m(!1);o.title&&o.title.length>0?document.title=o.title+" - "+St:document.title=St,o.$subscribe((C,P)=>{P.title&&P.title.length>0?document.title=P.title+" - "+St:document.title=St}),y.$subscribe((C,P)=>{h.value=P.showSidebar,_.value=h.value&&!P.forceHiddenSidebar});const S=Ce(),d=Je(()=>{const C=S.meta.auths;return C?!s.hasAllAuths(C):!1});function c(){l.$message.warning({duration:3e3,content:"登陆状态失效"}),n.$patch({Loaded:!0}),s.clear()}const $=async()=>{const C=document.querySelectorAll("oj-problem");if(C.length===0)return;let P={};C.forEach(b=>{const i=b.getAttribute("id"),f=document.createElement("span");f.setAttribute("style","padding:5px"),b.replaceWith(f);const r=m("default");P[i]||(P[i]=[]),P[i].push(r);let v=i;i&&!i.includes("-")&&(v="DidaOJ-"+i),Sa({render:()=>_l(B,{innerHTML:v,onClick:()=>{window.open(`/problem/${i}`,"_blank")},size:"small",variant:"outline",theme:r.value})}).mount(f)});const k=[];for(const b in P)k.push(b);const u=await Ea(k);if(u.code===0)for(const b in P){const i=P[b];if(!i)continue;let f="primary";const r=u.data[b];if(r)switch(r){case Ae.Accept:f="success";break;case Ae.Attempt:f="warning";break}for(const v of i)v.value=f}};return ce(()=>{document.addEventListener("DOMContentLoaded",()=>{new MutationObserver(()=>{an(()=>{$()},1e3)()}).observe(document.body,{childList:!0,subtree:!0}),fl.autoSpacingPage()}),w?no().then(C=>{C.code==0?(s.loadResponse(C.data),n.$patch({Loaded:!0})):(G(l,C.code),n.$patch({Loaded:!0}),s.clear())}).catch(C=>{console.log(C),c()}):n.$patch({Loaded:!0})}),(C,P)=>{const k=Jl,u=Yl,b=Me("RouterView"),i=Xl,f=Wl,r=Zl;return j(),ee(ue,null,[t(f,{class:"sh-app-layout"},{default:a(()=>[t(k,{class:"sh-header"},{default:a(()=>[t(Ui)]),_:1}),t(f,null,{default:a(()=>[t(vl,{name:"slide"},{default:a(()=>[_.value?(j(),R(u,{key:0,class:"sh-sidebar"},{default:a(()=>[t(Ki)]),_:1})):le("",!0)]),_:1}),t(f,{class:Nt(["sh-main-layout",{expanded:!_.value}])},{default:a(()=>[t(Mi),t(i,{class:"sh-main-content"},{default:a(()=>[d.value?(j(),R(Ba,{key:0})):(j(),R(b,{key:1}))]),_:1}),t(Zi)]),_:1},8,["class"])]),_:1})]),_:1}),h.value?(j(),R(eu,{key:0})):le("",!0),t(r,{container:"body",offset:["24px","80px"],size:"small"})],64)}}}),au=oe(tu,[["__scopeId","data-v-66c2cfa5"]]);function lu(e,l={}){const n=/\{\{%\s*(\w+)\s+([^%]+?)\s*%\}\}/g,s=l.renderers||{},o=e.renderer.rules.text??function(y,w){return y[w].content};e.renderer.rules.text=function(y,w,h,_,S){const c=y[w].content;return n.test(c)?c.replace(n,(C,P,k)=>{const u=s[P];if(typeof u=="function"){const b=k.trim().split(/\s+/);return u(b)}else return`<span class="shortcode-${P}">${P}: ${k.trim()}</span>`}):o(y,w,h,_,S)}}function nu(e,l){const n=/\{\{%\s*(\w+)\s*%\}\}([\s\S]*?)\{\{%\s*\/\1\s*%\}\}/g;e.core.ruler.push("shortcode_color",s=>{for(const o of s.tokens){if(o.type!=="inline")continue;let y=o.content,w=!1;y=y.replace(n,(h,_,S)=>{var c;const d=(c=l.renderers)==null?void 0:c[_];return d?(w=!0,d([],S.trim())):h}),w&&(o.type="html_inline",o.tag="",o.attrs=null,o.content=y,o.children=[])}})}ln({editorExtensions:{prettier:{prettierInstance:Cl,parserMarkdownInstance:Sl},highlight:{instance:rn},screenfull:{instance:kl},katex:{instance:wl},cropper:{instance:hl},mermaid:{instance:yl}},markdownItConfig(e){e.use(Ut,"align-left",{render(l,n){return l[n].nesting===1?`<div class="sh-align-left">
`:`</div>
`}}),e.use(Ut,"align-center",{render(l,n){return l[n].nesting===1?`<div class="sh-align-center">
`:`</div>
`}}),e.use(Ut,"align-right",{render(l,n){return l[n].nesting===1?`<div class="sh-align-right">
`:`</div>
`}}),e.use(lu,{renderers:{problem:([l])=>`<oj-problem id="${l}">${l}</oj-problem>`}}),e.use(nu,{renderers:{red:(l,n)=>`<span class="dida-font-red">${n}</span>`,green:(l,n)=>`<span class="dida-font-green">${n}</span>`,blue:(l,n)=>`<span class="dida-font-blue">${n}</span>`}})},markdownItPlugins(e){return[...e,{type:"linkAttr",plugin:Pl,options:{matcher(l){return!l.startsWith("#")},attrs:{target:"_blank"}}}]}});const Wa=gl();Wa.use(bl);const mt=Sa(au);mt.use(Wa);mt.use(X);mt.use(Ql);mt.use(nn);mt.use(on);mt.mount("#app");sn().then(()=>{console.log("Text cache reinitialized")}).catch(e=>{console.error("Text cache reinitialization failed",e)});
