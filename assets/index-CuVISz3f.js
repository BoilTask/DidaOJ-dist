import{bm as at,bn as jt,n as te,r as p,o as le,G as Lt,bo as Z,bp as $,s as t,bq as n,br as E,F as ee,bs as ge,bt as G,bu as M,ap as I,u as De,bv as re,bw as fe,aD as me,g as aa,bx as na,by as la,bz as oa,J as ke,q as Te,bA as sa,bB as Ue,c as Ve,y as Le,bC as Oe,bD as ut,bE as pt,ac as ra,bF as zt,bG as ua,bH as ia,aM as ca,bI as it,a0 as da,bJ as ma,bK as pa,B as fa,bL as _a}from"./node_modules-hIhvVsNv.js";import{L as ye,C as ie,S as _e,a as ga,T as va,b as be,A as ft,c as ba,d as ha,e as ya,f as wa,g as Ge,R as ve,B as N,F as Ae,h as Re,I as ze,D as Be,i as Vt,j as qe,k as Me,l as ka,m as xe,n as _t,O as $t,P as Ca,o as Dt,p as Ut,q as Sa,r as Pa,s as Ia,t as Ta,u as xa,v as ja,w as La,M as At,x as Rt,y as za,H as Va,z as $a,E as Da,G as Ua,J as Aa,K as Ra,N as Ea,Q as qa,U as Ma}from"./tdesign-vue-next-Md7Lz-6G.js";import{V as pe}from"./vditor-DArazWIS.js";import{e as ht}from"./monaco-editor-CQR2TFay.js";import{H as Ka,v as Fa}from"./highlight.js-D9zWiMxS.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const v of u.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&s(v)}).observe(document,{childList:!0,subtree:!0});function l(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerPolicy&&(u.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?u.credentials="include":o.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function s(o){if(o.ep)return;o.ep=!0;const u=l(o);fetch(o.href,u)}})();var je=(e=>(e.Manage="i-manage",e.ManageJudge="i-manage-judge",e.ManageProblem="i-manage-problem",e))(je||{});const Ga={"r-admin":["i-manage","i-manage-judge","i-manage-problem"]};function Na(e){if(e==null)return[];const a=[];for(const l of e){const s=Ga[l];s!=null&&a.push(...s)}return[...new Set(a)]}function Oa(e,a){if(e==null||a==null)return!1;const l=Na(e);for(const s of a)if(!l.includes(s))return!1;return!0}const we=at("user",{state:()=>({token:"",userId:-1,username:"",nickname:"",roles:[]}),getters:{getToken(){return this.token},getUserId(){return this.userId},getUsername(){return this.username},getNickname(){return this.nickname}},actions:{clear(){this.$patch({token:"",userId:-1,username:"",nickname:"",roles:[]})},loadResponse(e){this.$patch({token:e.token,userId:e.user_id,username:e.username,nickname:e.nickname,roles:e.roles})},isLogin(){return this.token!=null&&this.token!=""},hasAuth(e){return this.hasAllAuths([e])},hasAllAuths(e){return e?Oa(this.roles,e):!0}},persist:!0}),Ee=at("webStyle",{state:()=>({title:""}),getters:{getTitle(){return this.title}},actions:{setTitle(e){this.title=e}}}),nt=at("sidebarStyle",{state:()=>({showSidebar:!1,forceHiddenSidebar:!1,menuActiveName:"",menuList:[]}),getters:{getMenuList(){return this.menuList}},actions:{setSidebarShow(e){this.showSidebar=e},setForceHiddenSidebar(e){this.forceHiddenSidebar=e},setMenuActiveName(e){this.menuActiveName=e},clearMenuList(){this.menuList=[]},setMenuList(e){this.menuList=e},addMenuList(e){this.menuList.push(e)}}}),Je=jt.create({timeout:6e4,withCredentials:!1,headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});Je.interceptors.response.use(function(e){return e.data},function(e){return Promise.reject(e)});function Ha(){return Je({baseURL:"https://r2-oj.didapipa.com",url:"/system/notification.json?"+Date.now(),method:"get"})}function Ba(){return Je({baseURL:"https://r2-oj.didapipa.com",url:"/status/judger.json?"+Date.now(),method:"get"})}function Et(e){return Je({baseURL:"https://r2-oj.didapipa.com",url:"/status/judger/"+e+".json?"+Date.now(),method:"get"})}function Ja(e){return Je({baseURL:"https://r2-oj.didapipa.com",url:"/status/web.json?"+Date.now(),method:"get"})}const Wa={class:"judger-status-panel"},Xa={class:"judger-status-panel"};function Ya(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!De(e)}const Za=te({__name:"SystemStatus",setup(e){const a=p([]),l=p([]),s=p(!1),o=p(!1);let u;const v=h=>{let r="失效",_="danger";const b=new Date,y=new Date(h.updateTime);return b.getTime()-y.getTime()>3e4?(r="离线",_="default"):h.cpuUsage>90?(r="CPU过高",_="warning"):h.memPercent>90?(r="内存过高",_="warning"):(r="在线",_="success"),t(_e,null,{default:()=>[t("span",null,[h.key,I(" - "),h.name]),t("span",null,[h.updateTime]),t(va,{theme:_,size:"small"},Ya(r)?r:{default:()=>[r]})]})},j=async()=>{const h=[{key:"didaoj",name:"DidaOj"}],r={};for(let b=0;b<a.value.length;b++){const y=a.value[b];r[y.key]=y}const _=[];for(let b=0;b<h.length;b++){const y=h[b],m={key:y.key},c=await Ja(y.key);c&&(c.name?m.name=c.name:m.name="-",c.update_time?m.updateTime=new Date(c.update_time).toLocaleString():m.updateTime="-",c.cpu_usage?m.cpuUsage=Number(c.cpu_usage):m.cpuUsage=0,c.mem_usage?m.memUsage=c.mem_usage/(1024*1024*1024):m.memUsage=0,c.mem_total?m.memTotal=c.mem_total/(1024*1024*1024):m.memTotal=0,m.memTotal>0?m.memPercent=Math.round(m.memUsage/m.memTotal*1e4)/100:m.memPercent=0,m.avgMessage=c.avg_message,r[y.key]?(m.cpuUsageFrom=r[y.key].cpuUsage,m.memPercentFrom=r[y.key].memPercent,m.memUsageFrom=r[y.key].memUsage,m.memTotalFrom=r[y.key].memTotal):(m.cpuUsageFrom=0,m.memPercentFrom=0,m.memUsageFrom=0,m.memTotalFrom=0),_.push(m))}a.value=_},k=async()=>{const h=await Ba(),r={};for(let b=0;b<l.value.length;b++){const y=l.value[b];r[y.key]=y}const _=[];for(let b=0;b<h.judgers.length;b++){const y=h.judgers[b],m={key:y.key,name:y.name},c=await Et(y.key);c&&(c.name?m.name=c.name:m.name="-",c.update_time?m.updateTime=new Date(c.update_time).toLocaleString():m.updateTime="-",c.cpu_usage?m.cpuUsage=Number(c.cpu_usage):m.cpuUsage=0,c.mem_usage?m.memUsage=c.mem_usage/(1024*1024*1024):m.memUsage=0,c.mem_total?m.memTotal=c.mem_total/(1024*1024*1024):m.memTotal=0,m.memTotal>0?m.memPercent=Math.round(m.memUsage/m.memTotal*1e4)/100:m.memPercent=0,m.avgMessage=c.avg_message,r[y.key]?(m.cpuUsageFrom=r[y.key].cpuUsage,m.memPercentFrom=r[y.key].memPercent,m.memUsageFrom=r[y.key].memUsage,m.memTotalFrom=r[y.key].memTotal):(m.cpuUsageFrom=0,m.memPercentFrom=0,m.memUsageFrom=0,m.memTotalFrom=0),_.push(m))}l.value=_},f=async()=>{await j(),s.value=!1,await k(),o.value=!1};return le(async()=>{l.value=[],a.value=[],o.value=!0,s.value=!0,await f(),u=setInterval(()=>{f()},5e3)}),Lt(()=>{clearInterval(u)}),(h,r)=>{const _=ga,b=_e,y=ie,m=ye;return $(),Z(ee,null,[t(y,{title:"接口状态",class:"judger-status"},{default:n(()=>[t(m,{loading:s.value},{default:n(()=>[E("div",Wa,[($(!0),Z(ee,null,ge(a.value,c=>($(),G(y,{key:c.key,header:()=>v(c),class:"judge-status-judger"},{footer:n(()=>[E("span",null," 负载信息："+M(c.avgMessage),1)]),default:n(()=>[t(b,{class:"judge-status-judger"},{default:n(()=>[t(_,{title:"CPU使用率",value:c.cpuUsage,animation:{valueFrom:c.cpuUsageFrom,duration:2e3},"animation-start":!0,unit:"%",decimalPlaces:2},null,8,["value","animation"]),t(_,{title:"内存使用率",value:c.memPercent,animation:{valueFrom:c.memPercentFrom,duration:2e3},"animation-start":!0,unit:"%",decimalPlaces:2},null,8,["value","animation"]),t(_,{title:"内存使用量",animation:{valueFrom:c.memUsageFrom,duration:2e3},"animation-start":!0,value:c.memUsage,unit:"GB",decimalPlaces:2},null,8,["animation","value"]),t(_,{title:"内存总量",value:c.memTotal,animation:{valueFrom:c.memTotalFrom,duration:2e3},"animation-start":!0,unit:"GB",decimalPlaces:2},null,8,["value","animation"])]),_:2},1024)]),_:2},1032,["header"]))),128))])]),_:1},8,["loading"])]),_:1}),t(y,{title:"判题机状态",class:"judger-status"},{default:n(()=>[t(m,{loading:o.value},{default:n(()=>[E("div",Xa,[($(!0),Z(ee,null,ge(l.value,c=>($(),G(y,{key:c.key,header:()=>v(c),class:"judge-status-judger"},{footer:n(()=>[E("span",null," 负载信息："+M(c.avgMessage),1)]),default:n(()=>[t(b,{class:"judge-status-judger"},{default:n(()=>[t(_,{title:"CPU使用率",value:c.cpuUsage,animation:{valueFrom:c.cpuUsageFrom,duration:2e3},"animation-start":!0,unit:"%",decimalPlaces:2},null,8,["value","animation"]),t(_,{title:"内存使用率",value:c.memPercent,animation:{valueFrom:c.memPercentFrom,duration:2e3},"animation-start":!0,unit:"%",decimalPlaces:2},null,8,["value","animation"]),t(_,{title:"内存使用量",animation:{valueFrom:c.memUsageFrom,duration:2e3},"animation-start":!0,value:c.memUsage,unit:"GB",decimalPlaces:2},null,8,["animation","value"]),t(_,{title:"内存总量",value:c.memTotal,animation:{valueFrom:c.memTotalFrom,duration:2e3},"animation-start":!0,unit:"GB",decimalPlaces:2},null,8,["value","animation"])]),_:2},1024)]),_:2},1032,["header"]))),128))])]),_:1},8,["loading"])]),_:1})],64)}}}),ne=(e,a)=>{const l=e.__vccOpts||e;for(const[s,o]of a)l[s]=o;return l},ct=ne(Za,[["__scopeId","data-v-b8c98192"]]),Qa={style:{"text-align":"right"}},en=te({__name:"Hitokoto",setup(e){const a=p(!1),l=p(""),s=p(""),o=p(""),u=async()=>{a.value=!0;try{const j=await(await fetch("https://v1.hitokoto.cn")).json();s.value=j.hitokoto,o.value=j.creator,l.value="—— "+j.from}catch(v){s.value="一言获取失败了，但至少您还可以访问本站。",o.value="BoilTask",l.value="DidaOJ",console.error("Error fetching Hitokoto:",v)}finally{a.value=!1}};return le(()=>{u()}),(v,j)=>{const k=ie,f=ye;return $(),G(f,{loading:a.value},{default:n(()=>[t(k,{title:"一言 © Hitokoto"},{actions:n(()=>[I(" @"+M(o.value),1)]),default:n(()=>[E("div",null,[E("span",null,M(s.value),1),E("p",Qa,M(l.value),1)])]),_:1})]),_:1},8,["loading"])}}}),tn={class:"sh-main"},an={class:"dida-swiper-div"},nn=te({__name:"HomeView",setup(e){let a=-1;const l=p(null),s=async()=>{l.value=await Ha()};return le(async()=>{await s(),a=setInterval(()=>{s()},3e4)}),Lt(()=>{clearInterval(a)}),(o,u)=>{const v=ft,j=ha,k=ba,f=ie,h=be,r=Ge,_=wa,b=ya,y=ve;return $(),G(y,null,{default:n(()=>[t(h,{span:8},{default:n(()=>[E("div",tn,[l.value?($(),G(v,{key:0,style:{margin:"20px"},theme:l.value.theme},{default:n(()=>[I(M(l.value.content),1)]),_:1},8,["theme"])):re("",!0),E("div",an,[t(k,{class:"dida-swiper"},{default:n(()=>[t(j,null,{default:n(()=>u[0]||(u[0]=[E("img",{src:"https://cdn.codeoj.cn/image/banner.jpg",class:"swiper-img"},null,-1)])),_:1}),t(j,null,{default:n(()=>u[1]||(u[1]=[E("img",{src:"https://cdn.codeoj.cn/image/banner.jpg",class:"swiper-img"},null,-1)])),_:1})]),_:1})]),t(f,{title:"正在完善，欢迎提供意见建议",style:{width:"500px",margin:"0 auto"}},{default:n(()=>u[2]||(u[2]=[E("p",null,[E("a",{href:"https://codeoj.cn/",target:"_blank"},"CodeOJ"),I("的迁移计划")],-1),E("p",null,"正在开发中",-1)])),_:1})])]),_:1}),t(h,{span:4},{default:n(()=>[t(en,{style:{margin:"10px"}}),t(ct),t(f,{style:{margin:"10px"},bordered:!0},{header:n(()=>u[3]||(u[3]=[E("b",null,"友情链接",-1)])),default:n(()=>[t(b,null,{default:n(()=>[t(_,null,{default:n(()=>[t(r,{href:"https://boiltask.com",target:"_blank"},{default:n(()=>u[4]||(u[4]=[I("BoilTask Blog")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),ln=ne(nn,[["__scopeId","data-v-1e5edfb9"]]),on={class:"sh-main"},sn=te({__name:"View404",setup(e){let a=fe(),l=p(a.fullPath);return(s,o)=>{const u=N;return $(),Z("div",on,[E("p",null,M(me(l)),1),o[2]||(o[2]=E("p",null,"该页面无效或已被迁移，请重新选择访问目标",-1)),t(u,{theme:"primary",onClick:o[0]||(o[0]=()=>s.$router.push("/"))},{default:n(()=>o[1]||(o[1]=[I("返回首页")])),_:1})])}}}),qt=ne(sn,[["__scopeId","data-v-d4218944"]]);let dt=null;async function rn(){dt=await cn()}function un(e,a="zh"){if(dt==null)return[!1,e.toString()];const l=dt[e.toString()];if(!l)return[!1,e.toString()];let s=l[a];return s||(a="zh",s=l[a]),s?[!0,s]:[!1,e.toString()]}async function cn(){return new Promise((e,a)=>{e({404:{zh:"接口未找到"},1e3:{zh:"系统错误，请重试或等待管理员修复"},1001:{zh:"系统异常，请重试或等待管理员修复"},1002:{zh:"未知错误"},1003:{zh:"操作过于频繁，请稍后重试"},10001:{zh:"权限异常，请重新登陆后再试"},10002:{zh:"参数不符合要求"},10003:{zh:"未找到目标数据"},100001:{zh:"用户名不存在或密码不匹配"},100002:{zh:"邮件发送失败，可能是邮箱无效或达到了每日注册上限，如有问题可联系管理员解决"},100003:{zh:"验证码错误或已过期，请重新获取"},100004:{zh:"注册用户失败，可能存在同名用户"},100005:{zh:"用户名不存在，或您未在本系统绑定邮箱，请联系管理员寻求帮助"},100006:{zh:"验证码错误或已过期，请重新获取"},100007:{zh:"已存在相同标题的题目"}})})}function ce(){const{appContext:e}=aa();return{globalProperties:e.config.globalProperties}}function Ie(){return 1e3}function mt(e,a,l=3e3){e.$message.success({duration:l,content:a})}function ue(e,a,l=3e3){e.$message.info({duration:l,content:a})}function se(e,a,l=3e3){e.$message.error({duration:l,content:a})}function O(e,a,l=3e3){const[s,o]=un(a),u=s?o:`系统错误，错误提示[${o}]`;e.$message.error({duration:l,content:u})}const dn="https://oj-api.didapipa.com/",Y=jt.create({baseURL:dn,timeout:6e4,withCredentials:!0,headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});Y.interceptors.request.use(e=>{const l=we().getToken;return l&&(e.headers["X-Token"]=l),e},e=>Promise.reject(e));Y.interceptors.response.use(function(e){return e.data},function(e){return Promise.reject(e)});function mn(e){const a={};return a.id=e.id,a.username=e.username,a.nickname=e.nickname,a.email=e.email,a.slogan=e.slogan,a.organization=e.organization,a.accept=e.accept,a.attempt=e.attempt,e.email&&(a.avatar=`https://www.gravatar.com/avatar/${na(e.email.toLowerCase().trim())}?d=identicon&s=100`),a}function pn(e,a){return Y({url:"/user/login",method:"post",data:{username:e,password:a}})}function fn(){return Y({url:"/user/login/refresh",method:"post"})}function _n(e){const a={username:e};return Y({url:`/user/info?${new URLSearchParams(a).toString()}`,method:"get"})}function gn(e,a){return Y({url:"/user/register/email",method:"post",data:{token:e,email:a}})}function vn(e,a,l,s,o){return Y({url:"/user/register",method:"post",data:{username:e,password:a,email:l,key:s,nickname:o}})}function bn(e,a){return Y({url:"/user/forget",method:"post",data:{token:e,username:a}})}function hn(e,a,l){return Y({url:"/user/password/modify",method:"post",data:{username:e,password:a,key:l}})}const yn={class:"dida-login-footer"},wn=te({__name:"LoginView",setup(e){const{globalProperties:a}=ce(),l=we(),s=p(!1),o=p({username:"",password:""}),u=()=>{ue(a,"重置成功")},v=({validateResult:j,firstError:k})=>{s.value||(s.value=!0,pn(o.value.username,o.value.password).then(f=>{if(f.code===0){l.loadResponse(f.data),ue(a,"登录成功");let h=a.$route.query.redirect_uri;h||(h="/user/"+f.data.username),a.$router.push({path:h})}else O(a,f.code)}).catch(f=>{console.error("Login error",f),se(a,"登录失败")}).finally(()=>{s.value=!1}))};return le(()=>{if(l.isLogin()){a.$router.push({path:"/user"});return}}),(j,k)=>{const f=ze,h=Re,r=N,_=Ae,b=Ge,y=ie;return $(),G(y,{class:"yj-login-card",title:"欢迎使用DidaOJ~"},{default:n(()=>[t(_,{ref:"form",data:o.value,colon:!0,onReset:u,onSubmit:v,class:"yj-login-form","label-width":0},{default:n(()=>[t(h,{name:"username"},{default:n(()=>[t(f,{modelValue:o.value.username,"onUpdate:modelValue":k[0]||(k[0]=m=>o.value.username=m),clearable:"",placeholder:"请输入用户名"},{"prefix-icon":n(()=>[t(me(la))]),_:1},8,["modelValue"])]),_:1}),t(h,{name:"password"},{default:n(()=>[t(f,{modelValue:o.value.password,"onUpdate:modelValue":k[1]||(k[1]=m=>o.value.password=m),type:"password",clearable:"",placeholder:"请输入密码"},{"prefix-icon":n(()=>[t(me(oa))]),_:1},8,["modelValue"])]),_:1}),t(h,null,{default:n(()=>[t(r,{theme:"primary",type:"submit",block:"",loading:s.value},{default:n(()=>k[4]||(k[4]=[I("登录")])),_:1},8,["loading"])]),_:1})]),_:1},8,["data"]),E("div",yn,[t(b,{onClick:k[2]||(k[2]=()=>{me(a).$router.push({name:"login-forget"})})},{default:n(()=>k[5]||(k[5]=[I("忘记密码")])),_:1}),t(b,{onClick:k[3]||(k[3]=()=>{me(a).$router.push({name:"register"})})},{default:n(()=>k[6]||(k[6]=[I("注册账户")])),_:1})])]),_:1})}}}),kn=ne(wn,[["__scopeId","data-v-be6a0deb"]]),Cn={class:"dida-login-footer"},Sn=te({__name:"RegisterView",setup(e){const{globalProperties:a}=ce(),l=we(),s=p(!1),o=p(!1),u=p(!1),v=p("发送验证码");let j=null,k=-1;const f=p(!1),h=p(null),r=p({username:"",password:"",confirmPassword:"",nickname:"",email:"",emailKey:""}),b=p({username:[{required:!0,message:"请填写用户名"},{min:4,message:"用户名至少4个字符"},{max:20,message:"用户名最多20个字符"},{pattern:/^[a-zA-Z0-9_]+$/,message:"用户名只能包含字母、数字和下划线"}],password:[{required:!0,message:"请填写密码"},{min:6,message:"密码至少6个字符"},{max:20,message:"密码最多20个字符"}],confirmPassword:[{required:!0,message:"请确认密码"},{validator:L=>new Promise(T=>{const C=setTimeout(()=>{T(r.value.password===L),clearTimeout(C)})}),message:"两次密码不一致"}],nickname:[{required:!0,message:"请填写昵称"},{min:1,message:"昵称至少1个字符"},{max:30,message:"昵称最多30个字符"}],email:[{required:!0,message:"请填写邮箱"},{pattern:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,message:"邮箱格式不正确"}],emailKey:[{required:!0,message:"请填写验证码"},{min:6,message:"请输入完整字符"},{max:6,message:"请输入完整字符"}]}),y=p(()=>t(N,{onClick:m,disabled:u.value,loading:o.value,style:"width:120px"},{default:()=>[v.value]})),m=async()=>{var i;if(!r.value.email){se(a,"请输入邮箱");return}if(!r.value.email.match(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/)){se(a,"邮箱格式不正确");return}if(u.value||o.value)return;f.value=!0,await Te();const L=document.getElementById("cf-confirm-div");L&&L.remove();const T=document.createElement("div");T.id="cf-confirm-div",T.setAttribute("data-theme","light"),(i=h.value)==null||i.appendChild(T);const C=window;C.turnstile.ready(function(){C.turnstile.render("#cf-confirm-div",{sitekey:"0x4AAAAAABeM4SYPu2Rn7PmI",callback:async function(D){f.value=!1,await c(D)},"before-interactive-callback":function(){console.log("before-interactive-callback")}})})},c=async L=>{if(!u.value){o.value=!0;try{const T=await gn(L,r.value.email);if(T.code!==0){O(a,T.code);return}ue(a,"发送验证码成功"),o.value=!1,u.value=!0,j=new Date,v.value="60秒后重发",k=setInterval(()=>{const i=Math.floor((new Date().getTime()-(j==null?void 0:j.getTime()))/1e3);i>60?(v.value="发送验证码",u.value=!1,clearInterval(k)):v.value=`${60-i}秒后重发`},1e3)}catch{se(a,"发送验证码失败")}finally{o.value=!1}}},x=()=>{ue(a,"重置成功")},A=({validateResult:L,firstError:T,e:C})=>{if(!s.value){if(C.preventDefault(),L!==!0){se(a,T);return}if(r.value.password!==r.value.confirmPassword){se(a,"两次密码不一致");return}s.value=!0,vn(r.value.username,r.value.password,r.value.email,r.value.emailKey,r.value.nickname).then(i=>{i.code===0?(ue(a,"注册成功，可使用账号信息登录"),a.$router.push({name:"login"})):O(a,i.code)}).catch(i=>{console.error("Login error",i),se(a,"登录失败")}).finally(()=>{s.value=!1})}};return le(()=>{if(l.isLogin()){a.$router.push({path:"/user"});return}}),ke(()=>{clearInterval(k)}),(L,T)=>{const C=ze,i=Re,D=Vt,R=N,V=Ae,P=Ge,g=ie,U=Be;return $(),Z(ee,null,[t(g,{class:"yj-login-card",title:"欢迎使用DidaOJ~"},{default:n(()=>[t(V,{ref:"form",rules:b.value,data:r.value,colon:!0,onReset:x,onSubmit:A,class:"yj-login-form"},{default:n(()=>[t(i,{name:"username",label:"用户名"},{default:n(()=>[t(C,{modelValue:r.value.username,"onUpdate:modelValue":T[0]||(T[0]=S=>r.value.username=S),clearable:"",placeholder:"用于登录与查找"},null,8,["modelValue"])]),_:1}),t(i,{name:"password",label:"密码"},{default:n(()=>[t(C,{modelValue:r.value.password,"onUpdate:modelValue":T[1]||(T[1]=S=>r.value.password=S),type:"password",clearable:"",placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),t(i,{name:"confirmPassword",label:"确认密码"},{default:n(()=>[t(C,{modelValue:r.value.confirmPassword,"onUpdate:modelValue":T[2]||(T[2]=S=>r.value.confirmPassword=S),type:"password",clearable:"",placeholder:"请确认密码"},null,8,["modelValue"])]),_:1}),t(i,{name:"nickname",label:"昵称"},{default:n(()=>[t(C,{modelValue:r.value.nickname,"onUpdate:modelValue":T[3]||(T[3]=S=>r.value.nickname=S),clearable:"",placeholder:"用于优先在网站各处展示"},null,8,["modelValue"])]),_:1}),t(i,{name:"email",label:"邮箱"},{default:n(()=>[t(C,{modelValue:r.value.email,"onUpdate:modelValue":T[4]||(T[4]=S=>r.value.email=S),clearable:"",placeholder:"请填写常用邮箱"},null,8,["modelValue"])]),_:1}),t(i,{name:"emailKey",label:"验证码"},{default:n(()=>[t(D,{append:y.value},{default:n(()=>[t(C,{modelValue:r.value.emailKey,"onUpdate:modelValue":T[5]||(T[5]=S=>r.value.emailKey=S),clearable:"",placeholder:"请输入验证码",style:{width:"140px"}},null,8,["modelValue"])]),_:1},8,["append"])]),_:1}),t(i,null,{default:n(()=>[t(R,{theme:"primary",type:"submit",block:"",loading:s.value},{default:n(()=>T[8]||(T[8]=[I("注册")])),_:1},8,["loading"])]),_:1})]),_:1},8,["rules","data"]),E("div",Cn,[t(P,{onClick:T[6]||(T[6]=()=>{me(a).$router.push({name:"login"})})},{default:n(()=>T[9]||(T[9]=[I("返回登陆 ")])),_:1})])]),_:1}),t(U,{visible:f.value,"onUpdate:visible":T[7]||(T[7]=S=>f.value=S),header:"正在加载人机验证","close-btn":!1,footer:!1},{default:n(()=>[E("div",{ref_key:"dialogContainer",ref:h,class:"cf-confirm-container"},null,512)]),_:1},8,["visible"])],64)}}}),Pn=ne(Sn,[["__scopeId","data-v-d25e7538"]]),In={style:{margin:"12px"}},Tn=te({__name:"UserView",setup(e){let a=fe();const{globalProperties:l}=ce(),s=Ee();let o="";const u=p(!1),v=p(null),j=p([]),k=async f=>{u.value=!0;try{let h=await _n(f);if(h.code!==0){u.value=!1,O(l,h.code),await W.push({name:"home"});return}v.value=mn(h.data.user),j.value=h.data.problems_ac,s.setTitle(v.value.nickname+" - "+s.getTitle)}catch{se(l,"获取用户信息失败"),await W.push({name:"home"})}finally{u.value=!1}};return sa(async(f,h,r)=>{if(Array.isArray(f.params.username)?o=f.params.username[0]:o=f.params.username,!o){await W.push({name:"home"});return}await k(o),r()}),le(async()=>{if(Array.isArray(a.params.username)?o=a.params.username[0]:o=a.params.username,!o){await W.push({name:"home"});return}await k(o)}),(f,h)=>{const r=N,_=_e,b=ie,y=be,m=ka,c=Me,x=qe,A=ve,L=ye;return $(),G(L,{loading:u.value},{default:n(()=>[t(A,{class:"dida-main-content"},{default:n(()=>[t(y,{span:8},{default:n(()=>[t(b,{style:{margin:"10px"},title:"AC题目"},{default:n(()=>[t(_,{style:{"flex-wrap":"wrap"}},{default:n(()=>[($(!0),Z(ee,null,ge(j.value,T=>($(),G(r,{key:T,size:"small",onClick:()=>me(W).push({name:"problem-detail",params:{problemId:T}})},{default:n(()=>[I(M(T),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1}),t(y,{span:4},{default:n(()=>[E("div",In,[t(x,{layout:"vertical",bordered:!0},{default:n(()=>[t(c,{label:"头像"},{default:n(()=>{var T;return[t(m,{shape:"round",size:"100px",image:(T=v.value)==null?void 0:T.avatar,"hide-on-load-failed":!1},null,8,["image"])]}),_:1}),t(c,{label:"昵称"},{default:n(()=>{var T;return[I(M((T=v.value)==null?void 0:T.nickname),1)]}),_:1}),t(c,{label:"Slogan"},{default:n(()=>{var T;return[I(M((T=v.value)==null?void 0:T.slogan),1)]}),_:1}),t(c,{label:"邮箱"},{default:n(()=>{var T;return[I(M((T=v.value)==null?void 0:T.email),1)]}),_:1}),t(c,{label:"组织"},{default:n(()=>{var T;return[I(M((T=v.value)==null?void 0:T.organization),1)]}),_:1}),t(c,{label:"通过数量"},{default:n(()=>{var T;return[I(M((T=v.value)==null?void 0:T.accept),1)]}),_:1}),t(c,{label:"提交数量"},{default:n(()=>{var T;return[I(M((T=v.value)==null?void 0:T.attempt),1)]}),_:1})]),_:1})])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),xn=ne(Tn,[["__scopeId","data-v-cef20b99"]]),gt=[{name:"home",path:"/",title:"首页",showSidebar:!1,disableGenerateTab:!0,component:ln},{name:"problem",path:"/problem",title:"题目",icon:"calculation",showSidebar:!0,redirect:"problem-list"},{name:"judge",path:"/judge",title:"评测",icon:"code",showSidebar:!0,redirect:"judge-list"},{name:"contest",path:"/contest",title:"比赛",icon:"application",showSidebar:!0,redirect:"contest-list"},{name:"contest-detail-tab",title:"比赛",path:"/contest",showSidebar:!0,disableGenerateTab:!0,redirect:"contest-list"},{name:"discuss",title:"讨论",path:"/discuss",icon:"sonic",showSidebar:!0,redirect:"discuss-list"},{name:"rank",path:"/rank",title:"排名",icon:"chart-column",showSidebar:!0,redirect:"rank-ac-all"},{name:"tool",path:"/tool",title:"工具",icon:"tools",showSidebar:!0,redirect:"tool-paste"},{name:"system",path:"/system",title:"系统",icon:"dashboard",showSidebar:!0,redirect:"system-status"},{name:"manage",path:"/manage",title:"管理",icon:"command",showSidebar:!0,redirect:"manage-judge",auths:[je.Manage]},{name:"login",path:"/login",title:"登陆",showSidebar:!1,disableGenerateTab:!0,component:kn},{name:"register",path:"/register",title:"注册",showSidebar:!1,disableGenerateTab:!0,component:Pn},{name:"user",path:"/user/:username+",title:"用户",showSidebar:!1,needLogin:!0,disableGenerateTab:!0,component:xn},{name:"404",path:"/404",title:"404",showSidebar:!1,disableGenerateTab:!0,component:qt}],jn=e=>gt.find(a=>a.name==e),Ln=e=>{const a=[];return gt.forEach(l=>{!l.disableGenerateTab&&e.hasAllAuths(l.auths)&&a.push(l)}),a},zn=e=>{gt.forEach(a=>{const l={name:a.name,path:a.path,meta:{title:a.title,tab:a.name,showSidebar:a.showSidebar,needLogin:a.needLogin,redirect:a.redirect,tabAuths:a.auths},component:a.component};e.push(l)})};function Mt(e){return e.children!==void 0}function Vn(e){return e.children!==void 0}var Kt=(e=>(e[e.Unknown=-1]="Unknown",e[e.C=0]="C",e[e.Cpp=1]="Cpp",e[e.Java=2]="Java",e[e.Python=3]="Python",e[e.Pascal=4]="Pascal",e[e.Golang=5]="Golang",e[e.Max=6]="Max",e))(Kt||{});function Ft(){const e=[-1,6];return Object.values(Kt).filter(a=>typeof a=="number"&&!e.includes(a)).map(a=>({value:a,label:Gt(a)}))}function $n(e){return e>-1&&e<6}function Gt(e){switch(e){case 0:return"C";case 1:return"C++";case 2:return"Java";case 3:return"Python";case 4:return"Pascal";case 5:return"Golang";default:return"Unknown"}}function vt(e){switch(e){case 0:return"c";case 1:return"cpp";case 2:return"java";case 3:return"python";case 4:return"pascal";case 5:return"go";default:return"text"}}var he=(e=>(e[e.Init=0]="Init",e[e.Rejudge=1]="Rejudge",e[e.Submitting=2]="Submitting",e[e.Queuing=3]="Queuing",e[e.Compiling=4]="Compiling",e[e.Running=5]="Running",e[e.Accept=6]="Accept",e[e.PE=7]="PE",e[e.WA=8]="WA",e[e.TLE=9]="TLE",e[e.MLE=10]="MLE",e[e.OLE=11]="OLE",e[e.RE=12]="RE",e[e.CE=13]="CE",e[e.CLE=14]="CLE",e[e.JudgeFail=15]="JudgeFail",e[e.SubmitFail=16]="SubmitFail",e[e.Unknown=17]="Unknown",e))(he||{});const Dn=e=>{switch(e){case 0:return"普通评测";case 1:return"特殊评测";default:return"未知"}},tt=e=>{switch(e){case 0:return"等待处理";case 1:return"重新评测";case 2:return"提交中";case 3:return"队列中";case 4:return"编译中";case 5:return"运行中";case 6:return"通过";case 7:return"格式错误";case 8:return"答案错误";case 9:return"超时";case 10:return"内存超限";case 11:return"输出超限";case 12:return"运行错误";case 13:return"编译错误";case 14:return"编译超限";case 15:return"评测失败";case 16:return"提交失败";case 17:return"未知";default:return e}},Nt=e=>{switch(e){case 0:case 1:case 2:case 3:case 4:case 5:return"default";case 6:return"success";case 7:return"warning";default:return"danger"}};function Un(){const e=[17];return Object.values(he).filter(a=>typeof a=="number"&&!e.includes(a)).map(a=>({value:a,label:tt(a)}))}function Ke(e){switch(e){case 0:case 1:case 2:case 3:case 4:case 5:return!0;default:return!1}}function Ot(e){var l;const a={};if(a.id=e.id,a.problemId=e.problem_id,a.contestProblemIndex=e.contest_problem_index,a.status=e.status,Ke(e.status)?a.score="-":a.score=e.score.toString(),e.time?a.time=Math.ceil(e.time/1e6)+"ms":a.time="-",e.memory?a.memory=(e.memory/1024/1024).toFixed(2)+"MB":a.memory="-",a.language=Gt(e.language),a.codeLength=e.code_length,e.approve_time?a.approveTime=new Date(e.approve_time).toLocaleString():a.approveTime="-",a.author=e.author,a.authorUsername=e.author_username,a.authorNickname=e.author_nickname,a.code=e.code,a.compileMessage=e.compile_message,a.taskCurrent=e.task_current,a.taskTotal=e.task_total,a.task=[],e.task)for(let s=0;s<((l=e.task)==null?void 0:l.length);s++){const o=e.task[s],u={};u.taskId=o.task_id,u.status=o.status,o.time?u.time=Math.ceil(o.time/1e6)+"ms":u.time="-",o.memory?u.memory=(o.memory/1024/1024).toFixed(2)+"MB":u.memory="-",u.score=o.score,u.content=o.content,u.waHint=o.wa_hint,!u.content&&!u.waHint&&(u.content="无提示信息"),a.task.push(u)}return e.judger&&(a.judger=e.judger),e.judge_time&&(a.judgeTime=new Date(e.judge_time).toLocaleString()),a}function An(e,a,l,s,o){return Y({url:"/judge/approve",method:"post",data:{problem_id:e,contest_id:a,problem_index:l,language:s,code:o}})}function Rn(e){return Y({url:"/judge?id="+e,method:"get"})}function En(e){return Y({url:"/judge/code?id="+e,method:"get"})}function qn(e,a,l,s,o,u,v){const j=new URLSearchParams({contest_id:String(e),problem_id:a,username:l,language:String(s),status:String(o),page:String(u),page_size:String(v)});return Y({url:`/judge/list?${j.toString()}`,method:"get"})}function Mn(){return Y({url:"/judge/rejudge/recently",method:"post"})}function Kn(e){return Y({url:"/judge/rejudge/problem",method:"post",data:{id:e}})}function Fn(){return Y({url:"/judge/rejudge/all",method:"post",timeout:0})}function Gn(e){return Y({url:"/judge/rejudge",method:"post",data:{id:Number(e)}})}var He=(e=>(e[e.None=0]="None",e[e.Attempt=1]="Attempt",e[e.Accept=2]="Accept",e))(He||{});function We(e,a){const l={};if(l.id=e.id,l.author=e.author,l.title=e.title,l.tags=[],e.tags)for(const s of e.tags){const o=a[s];o&&l.tags.push(o)}if(l.accept=e.accept,l.attempt=e.attempt,e.description!=null&&(l.description=e.description),e.time_limit!=null&&e.time_limit>=0?l.timeLimit=e.time_limit.toString()+" ms":l.timeLimit="未知",e.memory_limit!=null&&e.memory_limit>=0?l.memoryLimit=(e.memory_limit/1024).toFixed(2)+" MB":l.memoryLimit="未知",e.judge_type!=null&&(l.judgeType=Dn(e.judge_type)),e.insert_time!=null&&(l.insertTime=new Date(e.insert_time).toLocaleString()),e.update_time!=null&&(l.updateTime=new Date(e.update_time).toLocaleString()),e.creator_nickname!=null&&(l.creatorNickname=e.creator_nickname),e.source!=null){const s=/\[([^\]]+)\]\(([^)]+)\)/,o=e.source.match(s);o?(l.source=o[1],l.sourceUrl=o[2]):(l.source=e.source,l.sourceUrl="")}return e.judge_md5!=null&&(l.judgeMd5=e.judge_md5),e.origin_oj!=null&&(l.originOj=e.origin_oj),e.origin_id!=null&&(l.originId=e.origin_id),e.origin_url!=null&&(l.originUrl=e.origin_url),l}function Ht(e,a,l){const s={};return e?s.id=e:(s.contest_id=a,s.problem_index=l),Y({url:`/problem?${new URLSearchParams(s).toString()}`,method:"get"})}function Bt(e){return Y({url:"/problem/tag/list?max_count="+e,method:"get"})}function Nn(e){return Y({url:"/problem/judge?id="+e,method:"get"})}function On(e,a,l,s,o){const u={};return e&&(u.oj=e),a&&(u.title=a),l&&(u.tag=l),s&&(u.page=s),o&&(u.page_size=o),Y({url:`/problem/list?${new URLSearchParams(u).toString()}`,method:"get"})}function Hn(e){const a={};return e&&(a.problem_id=e),Y({url:`/problem/recommend?${new URLSearchParams(a).toString()}`,method:"get"})}function Jt(e,a){return Y({url:"/problem/crawl",method:"post",data:{oj:e,id:a}})}function Bn(e,a,l,s,o,u){return Y({url:"/problem/create",method:"post",data:{title:e,time_limit:a,memory_limit:l,source:s,tags:o,description:u}})}function Jn(e,a,l,s,o,u,v){return Y({url:"/problem/edit",method:"post",data:{id:e,title:a,time_limit:l,memory_limit:s,source:o,tags:u,description:v}})}function Wn(e,a){return Y({url:"/problem/judge/data/download?id="+e+"&key="+a,method:"get"})}function Xn(e,a){const l=new FormData;return l.append("id",e),l.append("zip",a),Y({url:"/problem/judge/data",method:"post",data:l,headers:{"Content-Type":"multipart/form-data"},timeout:1e3*60*5})}const Yn={style:{margin:"10px"}},Zn={key:0,class:"dida-operation-container"};function Qn(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!De(e)}const el=te({__name:"ProblemList",setup(e){const a=fe(),l=Ue(),{globalProperties:s}=ce(),o=we();let u=null;const v=p(!1),j={};let k={};const f=p(!1),h=Ve(()=>o.hasAuth(je.ManageProblem)),r=p([{title:"ID",colKey:"id",cell:(S,d)=>{let w=i(d.row.id);return t(N,{variant:"dashed",theme:w,onClick:()=>C(d.row.id)},{default:()=>[d.row.id]})}},{title:"标题",colKey:"title",cell:(S,d)=>t(N,{variant:"text",onClick:()=>C(d.row.id)},{default:()=>[d.row.title]})},{title:"标签",colKey:"tags",cell:(S,d)=>{const w=d.row.tags;if(!w||w.length===0)return"";let z=[];for(let q=0;q<w.length;q++){const F=w[q];z.push(t(N,{key:q,theme:"default",variant:"outline",size:"small",onClick:()=>V(F)},{default:()=>[F.name]}))}return t(_e,null,Qn(z)?z:{default:()=>[z]})}},{title:"正确",colKey:"accept"},{title:"提交",colKey:"attempt"}]),_=p(!1);let b=1,y=50;const m=p({current:b,pageSize:y,defaultCurrent:b,defaultPageSize:y,total:0,pageSizeOptions:[50,100]}),c=p(),x=p(),A=[{label:"DidaOJ",value:"didaoj"},{label:"HDU",value:"hdu"},{label:"POJ",value:"poj"},{label:"NYOJ",value:"nyoj"}],L=p({oj:"",title:"",tag:""}),T=p({oj:"",problem:""}),C=S=>{S&&l.push({path:"/problem/"+S})},i=S=>{if(!S||!k)return"default";const d=k[S];if(!d)return"default";switch(d){case He.Accept:return"success";case He.Attempt:return"warning";default:return"default"}},D=async()=>{await l.push({query:{...a.query,oj:L.value.oj,title:L.value.title,tag:L.value.tag,page:1,page_size:m.value.defaultPageSize}})},R=async()=>{try{f.value=!0;const S=await Jt(T.value.oj,T.value.problem);S.code===0?(ue(s,"搜索成功"),await l.push({name:"problem-detail",params:{problemId:S.data}})):O(s,S.code)}catch(S){console.error(S),O(s,Ie())}finally{f.value=!1}},V=S=>{S&&l.push({query:{...a.query,title:"",tag:S.name,page:1,page_size:m.value.defaultPageSize}})},P=()=>{l.push({name:"manage-problem-create"})},g=async(S,d)=>{_.value=!0;try{const{current:w,pageSize:z}=S,q=await On(L.value.oj,L.value.title,L.value.tag,w,z);if(c.value=[],q.code===0){const F=q.data.list;if(!F||F.length<=0){m.value={...m.value,total:0},k={},ue(s,"未找到记录");return}F.forEach(H=>{var oe;const J=We(H,j);(oe=c.value)==null||oe.push(J)}),m.value={...m.value,total:q.data.total_count},k=q.data.problem_attempt_status}else d&&O(s,q.code)}catch(w){console.error(w),O(s,Ie())}finally{_.value=!1}},U=async S=>{await l.push({query:{...a.query,page:S.current,page_size:S.pageSize}})};return le(async()=>{_.value=!0,x.value=[],Bt(-1).then(S=>{if(S.code===0){x.value=S.data.list,v.value=S.data.total_count>S.data.list.length;for(let d=0;d<S.data.list.length;d++){const w=S.data.list[d];j[w.id]=w}u=Le(()=>a.query,d=>{L.value.oj=d.oj||"",L.value.title=d.title||"",L.value.tag=d.tag||"";const w=parseInt(d.page)||m.value.defaultCurrent,z=parseInt(d.page_size)||m.value.defaultPageSize;b=w,y=z,m.value={...m.value,current:b,pageSize:y},g({current:b,pageSize:y},!0)},{immediate:!0})}else v.value=!0}).catch(S=>{console.error(S),v.value=!0})}),ke(()=>{u&&u()}),(S,d)=>{const w=xe,z=ie,q=be,F=N,H=_e,J=_t,oe=Re,K=ze,de=Ae,Ce=ve;return $(),G(Ce,null,{default:n(()=>[t(q,{span:9},{default:n(()=>[t(z,{style:{margin:"10px"}},{default:n(()=>[t(w,{data:c.value,columns:r.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:m.value,"table-layout":"auto",loading:_.value,onPageChange:U},null,8,["data","columns","pagination","loading"])]),_:1})]),_:1}),t(q,{span:3},{default:n(()=>[E("div",Yn,[h.value?($(),Z("div",Zn,[t(H,null,{default:n(()=>[t(F,{onClick:P},{default:n(()=>d[6]||(d[6]=[I("新建")])),_:1})]),_:1})])):re("",!0),t(z,{class:"sh-card"},{default:n(()=>[t(de,{model:L.value,onSubmit:D},{default:n(()=>[t(oe,{label:"OJ"},{default:n(()=>[t(J,{modelValue:L.value.oj,"onUpdate:modelValue":d[0]||(d[0]=Q=>L.value.oj=Q),options:A,placeholder:"请选择OJ",clearable:""},null,8,["modelValue"])]),_:1}),t(oe,{label:"标题"},{default:n(()=>[t(K,{modelValue:L.value.title,"onUpdate:modelValue":d[1]||(d[1]=Q=>L.value.title=Q),placeholder:"请输入关键词"},null,8,["modelValue"])]),_:1}),t(oe,{label:"标签"},{default:n(()=>[t(K,{modelValue:L.value.tag,"onUpdate:modelValue":d[2]||(d[2]=Q=>L.value.tag=Q),placeholder:"暂不支持模糊查询"},null,8,["modelValue"])]),_:1}),t(oe,null,{default:n(()=>[t(F,{theme:"primary",type:"submit"},{default:n(()=>d[7]||(d[7]=[I("搜索")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(z,{class:"sh-card"},{default:n(()=>[t(de,{model:T.value,onSubmit:R},{default:n(()=>[t(oe,{label:"OJ"},{default:n(()=>[t(J,{modelValue:T.value.oj,"onUpdate:modelValue":d[3]||(d[3]=Q=>T.value.oj=Q),options:A,placeholder:"请选择OJ",clearable:""},null,8,["modelValue"])]),_:1}),t(oe,{label:"题目"},{default:n(()=>[t(K,{modelValue:T.value.problem,"onUpdate:modelValue":d[4]||(d[4]=Q=>T.value.problem=Q),placeholder:"请输入原始题号"},null,8,["modelValue"])]),_:1}),t(oe,null,{default:n(()=>[t(F,{theme:"primary",type:"submit",loading:f.value},{default:n(()=>d[8]||(d[8]=[I("前往")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1}),t(z,{class:"sh-card sh-background-black"},{default:n(()=>[($(!0),Z(ee,null,ge(x.value,Q=>($(),G(F,{class:"sh-tag-button",theme:"default",variant:"outline",ghost:!0,onClick:()=>V(Q)},{default:n(()=>[I(M(Q.name),1)]),_:2},1032,["onClick"]))),256)),v.value?($(),G(F,{key:0,class:"sh-tag-button",theme:"default",variant:"outline",ghost:!0,onClick:d[5]||(d[5]=()=>S.$router.push("/problem/tags"))},{default:n(()=>d[9]||(d[9]=[I(" ... ")])),_:1})):re("",!0)]),_:1})])]),_:1})]),_:1})}}}),tl=ne(el,[["__scopeId","data-v-a3b9d39b"]]);function Fe(e){e.querySelectorAll("pre > code:not([data-copy-attached])").forEach(l=>{l.setAttribute("data-copy-attached","true");const s=l.parentElement,o=document.createElement("div");o.className="copy-wrapper";const u=document.createElement("button");u.className="copy-btn",u.innerText="复制",u.addEventListener("click",async()=>{try{await navigator.clipboard.writeText(l.innerText),u.innerText="已复制",setTimeout(()=>u.innerText="复制",1500)}catch{u.innerText="失败"}}),s.replaceWith(o),o.appendChild(u),o.appendChild(s)})}function $e(e){let a="";for(;e>0;)e--,a=String.fromCharCode(65+e%26)+a,e=Math.floor(e/26);return a}async function Wt(e){const a={};if(a.id=e.id,a.ownerId=e.owner_id,a.ownerUsername=e.owner_username,a.ownerNickname=e.owner_nickname,a.title=e.title,a.startTime=new Date(e.start_time).toLocaleString(),a.endTime=new Date(e.end_time).toLocaleString(),e.descriptions){a.descriptions=[];const l={math:{inlineDigit:!0,engine:"KaTeX"}};for(let s=0;s<e.descriptions.length;s++){const o=e.descriptions[s],u={};u.title=o.title,u.content=await pe.md2html(o.content,l),u.sort=o.sort,a.descriptions.push(u)}}if(a.notification=e.notification,e.problems){a.problems=[],e.problems.sort((l,s)=>l.index-s.index);for(let l=0;l<e.problems.length;l++){const s=e.problems[l];s.accept||(s.accept=0),s.attempt||(s.attempt=0),s.id=$e(s.index),a.problems.push(s)}}return a}function al(e){return Y({url:"/contest?id="+e,method:"get"})}function nl(e,a){return Y({url:"/contest/list?page="+e+"&page_size="+a,method:"get"})}function ll(e){return Y({url:"/contest/rank?id="+e,method:"get"})}function ol(e){return Y({url:"/contest/create",method:"post",data:e})}const sl=["innerHTML"],rl={style:{margin:"12px"}},ul={key:1},il={class:"dida-operation-container"},cl={class:"dida-operation-container"},dl={class:"dida-code-submit-div"},ml=te({__name:"ProblemDetail",setup(e){let a=fe();const{globalProperties:l}=ce(),s=Ee(),o=we();let u=p(""),v="",j=0,k=0;const f=p(null),h=p(!1),r=p(null);let _=null;const b=p(null),y=p(!1),m=p(!1),c={},x=p(""),A=p([]);A.value=Ft();const L=Ve(()=>o.hasAuth(je.ManageProblem)),T=S=>{S&&W.push({name:"problem-list",query:{...a.query,title:"",tag:S.name}})},C=()=>{W.push({name:"manage-problem",params:{problemId:v}})},i=()=>{v?W.push({name:"judge-list",query:{problem_id:v}}):W.push({name:"contest-judge",params:{contestId:j},query:{problem_id:$e(k)}})},D=()=>{v?W.push({name:"discuss-list-problem",query:{problem_id:v}}):W.push({name:"contest-discuss",params:{contestId:j},query:{problem_id:$e(k)}})},R=()=>{W.push({name:"problem-recommend",params:{problemId:v}})},V=async()=>{var w,z;const S=(w=r.value)==null?void 0:w.originOj,d=(z=r.value)==null?void 0:z.originId;if(!(!S||!d))try{y.value=!0;const q=await Jt(S,d);q.code===0?(await U(),ue(l,"更新成功")):O(l,q.code)}catch{se(l,"更新失败，请稍后再试")}finally{y.value=!1}},P=async()=>{if(!v){se(l,"问题ID无效");return}const S=parseInt(x.value);if(!$n(S)){se(l,"请选择所编写的语言");return}const d=_==null?void 0:_.getValue();if(!d){se(l,"请输入所需提交的代码");return}m.value=!0;try{const w=await An(v,j,k,S,d);if(w.code!==0){O(l,w.code);return}ue(l,"提交成功，正在跳转到详情页面");const z=w.data.id;await W.push({path:"/judge/"+z})}finally{m.value=!1}},g=S=>{if(!_)return;const d=_.getModel();d&&ht.setModelLanguage(d,vt(S))},U=async()=>{let S=await Ht(v,j,k);if(S.code!==0){h.value=!1,O(l,S.code),await W.push({name:"problem"});return}S.data.tags&&S.data.tags.forEach(z=>{c[z.id]=z}),r.value=We(S.data.problem,c),s.setTitle(r.value.title+" - "+s.getTitle);let d=r.value.description;const w={math:{inlineDigit:!0,engine:"KaTeX"}};u.value=await pe.md2html(d,w),await Te(()=>{f.value&&(pe.mathRender(f.value),pe.highlightRender({lineNumber:!0,enable:!0},f.value),Fe(f.value),!_&&b.value&&(_=ht.create(b.value,{value:"",language:"cpp",minimap:{enabled:!0},colorDecorators:!0,readOnly:!1,theme:"vs-dark"}))),h.value=!1})};return le(async()=>{if(Array.isArray(a.params.problemId)?v=a.params.problemId[0]:v=a.params.problemId,!v){if(Array.isArray(a.params.contestId)?j=Number(a.params.contestId[0]):j=Number(a.params.contestId),!j){se(l,"题目不存在"),await W.push({name:"problem"});return}if(Array.isArray(a.params.problemIndex)?k=parseInt(a.params.problemIndex[0]):k=parseInt(a.params.problemIndex),!k){se(l,"题目不存在"),await W.push({name:"problem"});return}}h.value=!0,await U()}),(S,d)=>{const w=ie,z=be,q=Me,F=Ge,H=N,J=_e,oe=qe,K=$t,de=_t,Ce=ve,Q=ye;return $(),G(Q,{loading:h.value},{default:n(()=>[t(Ce,{class:"dida-main-content"},{default:n(()=>[t(z,{span:8},{default:n(()=>[t(w,{style:{margin:"10px"}},{default:n(()=>[E("div",{innerHTML:me(u),ref_key:"markdownRef",ref:f},null,8,sl)]),_:1})]),_:1}),t(z,{span:4},{default:n(()=>[E("div",rl,[t(oe,{layout:"vertical",bordered:!0},{default:n(()=>{var ae;return[t(q,{label:"标题"},{default:n(()=>{var B;return[I(M((B=r.value)==null?void 0:B.title),1)]}),_:1}),t(q,{label:"时间限制"},{default:n(()=>{var B;return[I(M((B=r.value)==null?void 0:B.timeLimit),1)]}),_:1}),t(q,{label:"内存限制"},{default:n(()=>{var B;return[I(M((B=r.value)==null?void 0:B.memoryLimit),1)]}),_:1}),t(q,{label:"判题方式"},{default:n(()=>{var B;return[I(M((B=r.value)==null?void 0:B.judgeType),1)]}),_:1}),t(q,{label:"正确提交"},{default:n(()=>{var B;return[I(M((B=r.value)==null?void 0:B.accept),1)]}),_:1}),t(q,{label:"提交总数"},{default:n(()=>{var B;return[I(M((B=r.value)==null?void 0:B.attempt),1)]}),_:1}),t(q,{label:"创建时间"},{default:n(()=>{var B;return[I(M((B=r.value)==null?void 0:B.insertTime),1)]}),_:1}),t(q,{label:"更新时间"},{default:n(()=>{var B;return[I(M((B=r.value)==null?void 0:B.updateTime),1)]}),_:1}),t(q,{label:"上传用户"},{default:n(()=>{var B;return[I(M((B=r.value)==null?void 0:B.creatorNickname),1)]}),_:1}),t(q,{label:"题目来源"},{default:n(()=>{var B,X,Se;return[(B=r.value)!=null&&B.sourceUrl?($(),G(F,{key:0,href:(X=r.value)==null?void 0:X.sourceUrl,target:"_blank"},{default:n(()=>{var Pe;return[I(M((Pe=r.value)==null?void 0:Pe.source),1)]}),_:1},8,["href"])):($(),Z("span",ul,M((Se=r.value)==null?void 0:Se.source),1))]}),_:1}),(ae=r.value)!=null&&ae.originUrl?($(),G(q,{key:0,label:"原题链接"},{default:n(()=>{var B;return[t(F,{href:(B=r.value)==null?void 0:B.originUrl,target:"_blank"},{default:n(()=>{var X,Se;return[I(M((X=r.value)==null?void 0:X.originOj)+" - "+M((Se=r.value)==null?void 0:Se.originId),1)]}),_:1},8,["href"])]}),_:1})):re("",!0),me(v)?($(),G(q,{key:1,label:"标签"},{default:n(()=>[t(J,null,{default:n(()=>{var B;return[($(!0),Z(ee,null,ge((B=r.value)==null?void 0:B.tags,X=>($(),G(H,{key:X.id,variant:"dashed",onClick:()=>T(X)},{default:n(()=>[I(M(X.name),1)]),_:2},1032,["onClick"]))),128))]}),_:1})]),_:1})):re("",!0)]}),_:1}),E("div",il,[t(J,null,{default:n(()=>[t(H,{onClick:i},{default:n(()=>d[1]||(d[1]=[I("提交记录")])),_:1}),t(H,{onClick:D},{default:n(()=>d[2]||(d[2]=[I("题目讨论")])),_:1}),me(v)?($(),G(H,{key:0,onClick:R},{default:n(()=>d[3]||(d[3]=[I("题目推荐")])),_:1})):re("",!0)]),_:1})]),E("div",cl,[t(J,null,{default:n(()=>{var ae;return[L.value?($(),G(H,{key:0,onClick:C},{default:n(()=>d[4]||(d[4]=[I("编辑")])),_:1})):re("",!0),(ae=r.value)!=null&&ae.originId?($(),G(H,{key:1,onClick:V,loading:y.value},{default:n(()=>d[5]||(d[5]=[I("更新描述 ")])),_:1},8,["loading"])):re("",!0)]}),_:1})]),E("div",dl,[t(J,null,{default:n(()=>[t(de,{modelValue:x.value,"onUpdate:modelValue":d[0]||(d[0]=ae=>x.value=ae),label:"语言：",placeholder:"请选择提交语言","auto-width":"",clearable:"",onChange:g},{default:n(()=>[($(!0),Z(ee,null,ge(A.value,ae=>($(),G(K,{key:ae.value,value:ae.value,label:ae.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"]),t(H,{onClick:P,loading:m.value},{default:n(()=>d[6]||(d[6]=[I("提交")])),_:1},8,["loading"])]),_:1}),E("div",{ref_key:"codeEditRef",ref:b,class:"dida-code-editor"},null,512)])])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),yt=ne(ml,[["__scopeId","data-v-ba139ead"]]),pl={style:{margin:"10px"}};function fl(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!De(e)}const _l=te({__name:"ProblemRecommend",setup(e){const a=fe(),l=Ue(),{globalProperties:s}=ce();let o=null,u="",v={},j={};const k=p([{title:"ID",colKey:"id",cell:(m,c)=>{let x=_(c.row.id);return t(N,{variant:"dashed",theme:x,onClick:()=>r(c.row.id)},{default:()=>[c.row.id]})}},{title:"标题",colKey:"title",cell:(m,c)=>t(N,{variant:"text",onClick:()=>r(c.row.id)},{default:()=>[c.row.title]})},{title:"标签",colKey:"tags",cell:(m,c)=>{const x=c.row.tags;if(!x||x.length===0)return"";let A=[];for(let L=0;L<x.length;L++){const T=x[L];A.push(t(N,{key:L,theme:"default",variant:"outline",size:"small",onClick:()=>b(T)},{default:()=>[T.name]}))}return t(_e,null,fl(A)?A:{default:()=>[A]})}},{title:"正确",colKey:"accept"},{title:"提交",colKey:"attempt"}]),f=p(!1),h=p(),r=m=>{m&&l.push({path:"/problem/"+m})},_=m=>{if(!m||!j)return"default";const c=j[m];if(!c)return"default";switch(c){case He.Accept:return"success";case He.Attempt:return"warning";default:return"default"}},b=m=>{m&&l.push({name:"problem-list",query:{tag:m.name}})},y=async m=>{f.value=!0;try{const c=await Hn(u);if(h.value=[],c.code===0){const x=c.data.list;if(!x||x.length<=0){ue(s,"未找到记录");return}v={},c.data.tags&&c.data.tags.forEach(A=>{v[A.id]=A}),x.forEach(A=>{var T;const L=We(A,v);(T=h.value)==null||T.push(L)})}else m&&O(s,c.code)}catch(c){console.error(c),O(s,Ie())}finally{f.value=!1}};return le(async()=>{f.value=!0,o=Le(()=>a.query,m=>{Array.isArray(a.params.problemId)?u=a.params.problemId[0]:u=a.params.problemId,y(!0)},{immediate:!0})}),ke(()=>{o&&o()}),(m,c)=>{const x=xe,A=ie,L=be,T=ve;return $(),G(T,null,{default:n(()=>[t(L,{span:9},{default:n(()=>[t(A,{style:{margin:"10px"}},{default:n(()=>[t(x,{data:h.value,columns:k.value,"row-key":"id","vertical-align":"top",hover:!0,"table-layout":"auto",loading:f.value},null,8,["data","columns","loading"])]),_:1})]),_:1}),t(L,{span:3},{default:n(()=>[E("div",pl,[t(A,{class:"sh-card",header:"题目推荐","header-bordered":!0},{default:n(()=>c[0]||(c[0]=[I(" 根据本站其他用户的提交记录推荐类似题目"),E("br",null,null,-1),I("依据推荐算法来计算，与本用户相似度最高的用户做的题，大概率被自己感兴趣。 ")])),_:1})])]),_:1})]),_:1})}}}),gl=ne(_l,[["__scopeId","data-v-3b5a8a61"]]),vl=["innerHTML"];function wt(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!De(e)}const bl=te({__name:"JudgeJobList",setup(e){const a=fe(),l=Ue(),{globalProperties:s}=ce();let o=!1,u=null,v;const j=p(!1),k=p(null),f=p(null),h=p(!1);let r=-1;const _=p({problemId:"",username:"",language:void 0,status:void 0}),b=p([{title:"ID",colKey:"id",cell:(d,w)=>t(N,{variant:"text",onClick:()=>R(w.row.id)},{default:()=>[w.row.id]})},{title:"问题",colKey:"problemId",cell:(d,w)=>{if(r){let z;return t(N,{variant:"text",onClick:()=>D(r,w.row.contestProblemIndex)},wt(z=$e(w.row.contestProblemIndex))?z:{default:()=>[z]})}return t(N,{variant:"text",onClick:()=>i(w.row.problemId)},{default:()=>[w.row.problemId]})}},{title:"状态",colKey:"status",align:"center",cell:(d,w)=>{const z=w.row.status,q=tt(z),F=Nt(z);let H=[];return Ke(z)&&H.push(t(ye,{text:w.row.state,size:"small",class:"dida-status-loading"},null)),H.push(t("span",null,[q])),t(N,{theme:F,variant:"outline",onClick:()=>R(w.row.id)},wt(H)?H:{default:()=>[H]})}},{title:"分数",colKey:"score"},{title:"时间",colKey:"time"},{title:"内存",colKey:"memory"},{title:"代码",colKey:"code",cell:(d,w)=>t(N,{theme:"default",onClick:()=>C(w.row)},{default:()=>[w.row.language+" / "+w.row.codeLength]})},{title:"作者",colKey:"author",width:200,cell:(d,w)=>t(N,{variant:"text",onClick:()=>V(w.row.authorUsername)},{default:()=>[w.row.authorNickname]})},{title:"提交时间",colKey:"approveTime",width:180}]),y=p(!1);let m=1,c=50;const x=p({current:m,pageSize:c,defaultCurrent:m,defaultPageSize:c,total:0,pageSizeOptions:[50,100]}),A=p(),L=p([]);L.value=Ft();const T=p([]);T.value=Un();const C=async d=>{h.value=!0,j.value=!0;try{k.value=d;const w=await En(Number(k.value.id));if(w.code===0){const z=w.data,F=`\`\`\`${vt(z.language)}
${z.code}
\`\`\``,H={};k.value.code=await pe.md2html(F,H),await Te(()=>{f.value&&(pe.highlightRender({lineNumber:!0,enable:!0},f.value),Fe(f.value))})}else O(s,w.code)}finally{h.value=!1}},i=d=>{d&&l.push({path:"/problem/"+d})},D=(d,w)=>{l.push({name:"contest-problem-detail",params:{contestId:d,problemIndex:w}})},R=d=>{d&&(r>0?l.push({name:"contest-judge-detail",params:{contestId:r,judgeId:d}}):l.push({name:"judge-detail",params:{judgeId:d}}))},V=d=>{d&&l.push({path:"/user/"+d})},P=async()=>{await l.push({query:{...a.query,page:1,page_size:c,problem_id:_.value.problemId,username:_.value.username,language:_.value.language,status:_.value.status}})},g=async()=>{_.value.problemId="",_.value.username="",_.value.language=void 0,_.value.status=void 0,await l.push({query:{...a.query,page:1,page_size:c,problem_id:"",username:"",language:void 0,status:void 0}})},U=async(d,w)=>{w&&(y.value=!0);let z=!1;try{const{current:q,pageSize:F}=d,H=await qn(r,_.value.problemId,_.value.username,_.value.language,_.value.status,q,F);A.value=[],H.code===0?H.data.list&&H.data.list.length>0?(H.data.list.forEach(oe=>{var de;const K=Ot(oe);(de=A.value)==null||de.push(K),Ke(oe.status)&&(z=!0)}),x.value={...x.value,total:H.data.total_count}):(ue(s,"未找到记录"),x.value={...x.value,total:0}):w&&O(s,H.code)}catch(q){console.error(q),w&&O(s,Ie())}finally{w&&(y.value=!1),z&&o&&(v=setTimeout(()=>{U({current:m,pageSize:c},!1)},5e3))}},S=async d=>{await l.push({query:{...a.query,page:d.current,page_size:d.pageSize}})};return le(async()=>{o=!0,u=Le(()=>a.query,d=>{Array.isArray(a.params.contestId)?r=Number(a.params.contestId[0]):r=Number(a.params.contestId),_.value.problemId=d.problem_id||"",_.value.username=d.username||"",d.language!=null?_.value.language=Number(d.language):_.value.language=void 0,d.status!=null?_.value.status=Number(d.status):_.value.status=void 0;const w=parseInt(d.page)||x.value.defaultCurrent,z=parseInt(d.page_size)||x.value.defaultPageSize;m=w,c=z,x.value.pageSizeOptions.includes(c)||(c=x.value.defaultPageSize),x.value={...x.value,current:m,pageSize:c},U({current:m,pageSize:c},!0)},{immediate:!0})}),ke(()=>{o=!1,u&&u(),clearTimeout(v)}),(d,w)=>{const z=ze,q=Re,F=$t,H=_t,J=N,oe=_e,K=Ae,de=xe,Ce=ie,Q=Ge,ae=ye,B=Be;return $(),Z(ee,null,[t(Ce,{style:{margin:"10px"}},{default:n(()=>[t(K,{layout:"inline",onSubmit:P,onReset:g},{default:n(()=>[t(q,{label:"题号"},{default:n(()=>[t(z,{modelValue:_.value.problemId,"onUpdate:modelValue":w[0]||(w[0]=X=>_.value.problemId=X),placeholder:"请输入完整题号"},null,8,["modelValue"])]),_:1}),t(q,{label:"用户"},{default:n(()=>[t(z,{modelValue:_.value.username,"onUpdate:modelValue":w[1]||(w[1]=X=>_.value.username=X),placeholder:"仅支持输入完整用户名"},null,8,["modelValue"])]),_:1}),t(q,{label:"语言"},{default:n(()=>[t(H,{modelValue:_.value.language,"onUpdate:modelValue":w[2]||(w[2]=X=>_.value.language=X),placeholder:"请选择提交语言","auto-width":"",clearable:""},{default:n(()=>[($(!0),Z(ee,null,ge(L.value,X=>($(),G(F,{key:X.value,value:X.value,label:X.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(q,{label:"状态"},{default:n(()=>[t(H,{modelValue:_.value.status,"onUpdate:modelValue":w[3]||(w[3]=X=>_.value.status=X),placeholder:"请选择评测状态","auto-width":"",clearable:""},{default:n(()=>[($(!0),Z(ee,null,ge(T.value,X=>($(),G(F,{key:X.value,value:X.value,label:X.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(q,null,{default:n(()=>[t(oe,null,{default:n(()=>[t(J,{theme:"primary",type:"submit"},{default:n(()=>w[7]||(w[7]=[I("搜索")])),_:1}),t(J,{theme:"default",variant:"base",type:"reset"},{default:n(()=>w[8]||(w[8]=[I("重置")])),_:1})]),_:1})]),_:1})]),_:1}),t(de,{data:A.value,columns:b.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:x.value,loading:y.value,onPageChange:S,"table-layout":"auto"},null,8,["data","columns","pagination","loading"])]),_:1}),t(B,{visible:j.value,"onUpdate:visible":w[5]||(w[5]=X=>j.value=X),width:"800px","cancel-btn":null,"close-btn":!1,onConfirm:w[6]||(w[6]=X=>j.value=!1)},{header:n(()=>[t(Q,{onClick:w[4]||(w[4]=()=>{var X;R((X=k.value)==null?void 0:X.id)})},{default:n(()=>{var X,Se;return[I(M(((X=k.value)==null?void 0:X.id)+" - "+((Se=k.value)==null?void 0:Se.language)),1)]}),_:1})]),default:n(()=>[t(ae,{loading:h.value},{default:n(()=>{var X;return[E("div",{innerHTML:(X=k.value)==null?void 0:X.code,ref_key:"markdownCodeRef",ref:f,style:{"min-height":"100px"}},null,8,vl)]}),_:1},8,["loading"])]),_:1},8,["visible"])],64)}}}),kt=ne(bl,[["__scopeId","data-v-ae344c2e"]]),hl={class:"dida-code-container"},yl=["innerHTML"],wl={key:2,class:"dida-edit-container"};function Ct(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!De(e)}const kl=te({__name:"JudgeJobDetail",setup(e){const a=fe(),l=Ue(),s=we(),{globalProperties:o}=ce();let u=!1,v,j=-1;const k=p(""),f=p(null),h=p(""),r=p(null),_=p(0),b=p(null),y=p({from:"#5a96ff",to:"#00A870"});let m=!1;const c=p([{title:"ID",colKey:"id"},{title:"问题",colKey:"problemId",cell:(g,U)=>t(N,{variant:"text",onClick:()=>i(U.row.problemId)},{default:()=>[U.row.problemId]})},{title:"状态",colKey:"status",align:"center",cell:(g,U)=>{const S=U.row.status,d=tt(S),w=Nt(S);let z=[];return Ke(S)&&z.push(t(ye,{text:U.row.state,size:"small",class:"dida-status-loading"},null)),z.push(t("span",null,[d])),t(N,{theme:w,variant:"outline"},Ct(z)?z:{default:()=>[z]})}},{title:"分数",colKey:"score"},{title:"时间",colKey:"time"},{title:"内存",colKey:"memory"},{title:"代码",colKey:"language",cell:(g,U)=>t("span",null,[U.row.language+" / "+U.row.codeLength])},{title:"作者",colKey:"author",width:200,cell:(g,U)=>t(N,{variant:"text",onClick:()=>D(U.row.authorUsername)},{default:()=>[U.row.authorNickname]})},{title:"提交时间",colKey:"approveTime",width:180}]),x=p(!1),A=p(!1),L=p(),T=Ve(()=>s.hasAuth(je.ManageJudge)),C=async()=>{if(!A.value){A.value=!0;try{const g=await Gn(j);g.code===0?await V(!0):O(o,g.code)}catch(g){console.error(g),O(o,Ie())}finally{A.value=!1}}},i=g=>{g&&l.push({path:"/problem/"+g})},D=g=>{g&&l.push({path:"/user/"+g})},R=g=>{const U=g.status,S=tt(U);let d;switch(U){case he.Init:case he.Rejudge:case he.Compiling:case he.Running:d="default";break;case he.Accept:d="success";break;case he.PE:d="warning";break;default:d="danger";break}return t(_e,null,{default:()=>[t(N,{theme:"default",variant:"outline"},{default:()=>[g.taskId]}),t(N,{theme:d,variant:"outline"},Ct(S)?S:{default:()=>[S]}),t("span",null,[I("分数："),g.score]),t("span",null,[I("用时："),g.time]),t("span",null,[I("内存："),g.memory])]})},V=async g=>{var S;g&&(x.value=!0);let U=!1;try{const d=await Rn(j);if(L.value=[],d.code===0){const w=d.data,z=Ot(w);if((S=L.value)==null||S.push(z),w.judger){const F=await Et(w.judger);k.value=F.name}else k.value="";y.value.to="#00A870",Ke(w.status)?(b.value="active",z.taskTotal>0?(_.value=z.taskCurrent/z.taskTotal*100,z.taskCurrent>=z.taskTotal&&(_.value=99)):_.value=0):(_.value=100,w.status===he.Accept?b.value="success":w.status===he.PE?(y.value.to="#F57C20",b.value="warning"):(y.value.to="#F56C6C",b.value="error"));const q={};if(w.code){const H=`\`\`\`${vt(w.language)}
${w.code}
\`\`\``;h.value=await pe.md2html(H,q),await Te(()=>{r.value&&(m||(m=!0,pe.highlightRender({lineNumber:!0,enable:!0},r.value)),Fe(r.value))})}f.value=z,Ke(w.status)&&(U=!0)}else g&&O(o,d.code)}catch(d){console.error(d),g&&O(o,Ie())}finally{g&&(x.value=!1),U&&u&&(v=setTimeout(()=>{V(!1)},5e3))}};function P(){r.value&&r.value.parentElement&&(r.value.style.maxWidth=r.value.parentElement.clientWidth+"px")}return le(async()=>{if(u=!0,Array.isArray(a.params.judgeId)?j=Number(a.params.judgeId[0]):j=Number(a.params.judgeId),!j){await l.push({name:"judge"});return}await V(!0),P(),window.addEventListener("resize",P)}),ke(()=>{u=!1,window.removeEventListener("resize",P),clearTimeout(v)}),(g,U)=>{var de,Ce,Q;const S=Ca,d=xe,w=ie,z=be,q=Me,F=qe,H=ve,J=Dt,oe=Ut,K=N;return $(),Z(ee,null,[t(S,{color:y.value,status:b.value,class:"dida-job-progress",percentage:_.value},null,8,["color","status","percentage"]),t(w,{style:{margin:"10px"}},{default:n(()=>[t(d,{data:L.value,columns:c.value,"row-key":"id","vertical-align":"top",hover:!0,loading:x.value},null,8,["data","columns","loading"])]),_:1}),t(H,null,{default:n(()=>[t(z,{span:8},{default:n(()=>[E("div",hl,[E("div",{innerHTML:h.value,ref_key:"markdownCodeRef",ref:r,class:"dida-code-div"},null,8,yl)])]),_:1}),t(z,{span:4},{default:n(()=>[t(F,{layout:"vertical",bordered:!0,style:{margin:"10px"}},{default:n(()=>[t(q,{label:"判题机"},{default:n(()=>[I(M(k.value),1)]),_:1}),t(q,{label:"判题时间"},{default:n(()=>{var ae;return[I(M((ae=f.value)==null?void 0:ae.judgeTime),1)]}),_:1})]),_:1})]),_:1})]),_:1}),(de=f.value)!=null&&de.compileMessage?($(),G(w,{key:0,class:"compile-message"},{default:n(()=>{var ae;return[I(M((ae=f.value)==null?void 0:ae.compileMessage),1)]}),_:1})):re("",!0),(Ce=f.value)!=null&&Ce.task&&((Q=f.value)==null?void 0:Q.task.length)>0?($(),G(oe,{key:1,class:"task-panel"},{default:n(()=>{var ae;return[($(!0),Z(ee,null,ge((ae=f.value)==null?void 0:ae.task,(B,X)=>($(),G(J,{key:B.taskId,header:()=>R(B)},{default:n(()=>[I(M(B.content)+" "+M(B.waHint),1)]),_:2},1032,["header"]))),128))]}),_:1})):re("",!0),T.value?($(),Z("div",wl,[t(K,{onClick:C,loading:A.value},{default:n(()=>U[0]||(U[0]=[I("重新评测")])),_:1},8,["loading"])])):re("",!0)],64)}}}),St=ne(kl,[["__scopeId","data-v-c193991c"]]),Cl={style:{margin:"10px"}},Sl=te({__name:"ContestList",setup(e){const a=fe(),l=Ue(),{globalProperties:s}=ce();let o=null;const u=p(!1),v=p(!1),j=p([{title:"ID",colKey:"id",width:"100",cell:(C,i)=>t(N,{variant:"text",onClick:()=>m(i.row.id)},{default:()=>[i.row.id]})},{title:"标题",colKey:"title",cell:(C,i)=>t(N,{variant:"text",onClick:()=>m(i.row.id)},{default:()=>[i.row.title]})},{title:"负责人",colKey:"ownerNickname",width:"200"},{title:"开始时间",colKey:"startTime",width:"180"},{title:"结束时间",colKey:"endTime",width:"180"}]),k=p(!1);let f=1,h=50;const r=p({current:f,pageSize:h,defaultCurrent:f,defaultPageSize:h,total:0,pageSizeOptions:[50,100]}),_=p(),b=p({title:"",username:""}),y=p({title:"",description:"",open_time:[]}),m=C=>{C&&l.push({path:"/contest/"+C})},c=async()=>{await l.push({query:{...a.query,title:b.value.title,username:b.value.username,page:1,page_size:r.value.defaultPageSize}})},x=async(C,i)=>{var D;k.value=!0;try{const{current:R,pageSize:V}=C,P=await nl(R,V);if(_.value=[],P.code===0){const g=P.data.list;for(let U=0;U<g.length;U++){const S=g[U],d=await Wt(S);(D=_.value)==null||D.push(d)}r.value={...r.value,total:P.data.total_count}}else i&&O(s,P.code)}catch(R){console.error(R),O(s,Ie())}finally{k.value=!1}},A=async C=>{await l.push({query:{...a.query,page:C.current,page_size:C.pageSize}})},L=()=>{u.value=!0},T=async()=>{v.value=!0,console.log("contestCreateForm",y.value),ol(y.value).then(C=>{C.code===0?(ue(s,"创建比赛成功"),u.value=!1,l.push({path:"/contest/"+C.data.id})):O(s,C.code)}).finally(()=>{v.value=!1})};return le(async()=>{o=Le(()=>a.query,C=>{b.value.title=C.title||"",b.value.username=C.username||"";const i=parseInt(C.page)||r.value.defaultCurrent,D=parseInt(C.page_size)||r.value.defaultPageSize;f=i,h=D,r.value={...r.value,current:f,pageSize:h},x({current:f,pageSize:h},!0)},{immediate:!0})}),ke(()=>{o&&o()}),(C,i)=>{const D=xe,R=ie,V=be,P=ze,g=Re,U=N,S=Ae,d=_e,w=ve,z=Sa,q=Be;return $(),Z(ee,null,[t(w,null,{default:n(()=>[t(V,{span:9},{default:n(()=>[t(R,{style:{margin:"10px"}},{default:n(()=>[t(D,{data:_.value,columns:j.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:r.value,loading:k.value,onPageChange:A},null,8,["data","columns","pagination","loading"])]),_:1})]),_:1}),t(V,{span:3},{default:n(()=>[E("div",Cl,[t(R,{class:"sh-card"},{default:n(()=>[t(S,{model:b.value},{default:n(()=>[t(g,{label:"标题"},{default:n(()=>[t(P,{modelValue:b.value.title,"onUpdate:modelValue":i[0]||(i[0]=F=>b.value.title=F),placeholder:"暂不支持模糊查询"},null,8,["modelValue"])]),_:1}),t(g,{label:"负责人"},{default:n(()=>[t(P,{modelValue:b.value.username,"onUpdate:modelValue":i[1]||(i[1]=F=>b.value.username=F),placeholder:"仅支持输入完整用户名"},null,8,["modelValue"])]),_:1}),t(g,null,{default:n(()=>[t(U,{theme:"primary",onClick:c},{default:n(()=>i[6]||(i[6]=[I("提交")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(R,{class:"sh-card"},{default:n(()=>[t(d,null,{default:n(()=>[t(U,{onClick:L},{default:n(()=>i[7]||(i[7]=[I("创建")])),_:1})]),_:1})]),_:1})])]),_:1})]),_:1}),t(q,{visible:u.value,"onUpdate:visible":i[5]||(i[5]=F=>u.value=F),header:"创建比赛",onConfirm:T,"confirm-loading":v.value},{default:n(()=>[t(S,{"label-width":80,model:y.value,onSubmit:i[4]||(i[4]=Oe(()=>{},["prevent"]))},{default:n(()=>[t(g,{label:"标题"},{default:n(()=>[t(P,{modelValue:y.value.title,"onUpdate:modelValue":i[2]||(i[2]=F=>y.value.title=F),placeholder:"请输入标题"},null,8,["modelValue"])]),_:1}),t(g,{label:"开启时间"},{default:n(()=>[t(z,{"enable-time-picker":"","allow-input":"",clearable:"",modelValue:y.value.open_time,"onUpdate:modelValue":i[3]||(i[3]=F=>y.value.open_time=F)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","confirm-loading"])],64)}}}),Pt=ne(Sl,[["__scopeId","data-v-3e6ea683"]]),Pl={style:{margin:"20px"}},Il=["innerHTML"],Tl={style:{margin:"12px"}},xl=te({__name:"ContestDetail",setup(e){let a=fe();const{globalProperties:l}=ce(),s=Ee();let o=0;const u=p(!1),v=p(null),j=p([{title:"问题ID",colKey:"id",cell:(h,r)=>t(N,{variant:"text",onClick:()=>f(o,r.row.index)},{default:()=>[r.row.id]})},{title:"标题",colKey:"title",cell:(h,r)=>t(N,{variant:"text",onClick:()=>f(o,r.row.index)},{default:()=>[r.row.title]})},{title:"正确",colKey:"accept"},{title:"提交",colKey:"attempt"}]),k=p([]),f=(h,r)=>{W.push({name:"contest-problem-detail",params:{contestId:h,problemIndex:r}})};return le(async()=>{if(Array.isArray(a.params.contestId)?o=Number(a.params.contestId[0]):o=Number(a.params.contestId),!o){await W.push({name:"contest"});return}u.value=!0;const h=await al(o);if(h.code!==0){u.value=!1,O(l,h.code),await W.push({name:"contest"});return}v.value=await Wt(h.data),k.value=v.value.problems,s.setTitle(v.value.title+" - "+s.getTitle),await Te(()=>{const r=document.querySelectorAll(".dida-content-description");r&&r.length>0&&r.forEach(_=>{pe.mathRender(_),pe.highlightRender({lineNumber:!0,enable:!0},_),Fe(_)}),u.value=!1})}),(h,r)=>{const _=ft,b=N,y=_e,m=Dt,c=Ut,x=xe,A=ie,L=be,T=Me,C=qe,i=ve,D=ye;return $(),G(D,{loading:u.value},{default:n(()=>[t(i,{class:"dida-main-content"},{default:n(()=>[t(L,{span:8},{default:n(()=>{var R,V,P;return[E("div",Pl,[E("h1",null,M((R=v.value)==null?void 0:R.title),1),(V=v.value)!=null&&V.notification?($(),G(_,{key:0,theme:"info",message:(P=v.value)==null?void 0:P.notification},null,8,["message"])):re("",!0)]),t(c,{"default-value":[0],"expand-icon":!1,borderless:!0},{default:n(()=>{var g;return[($(!0),Z(ee,null,ge((g=v.value)==null?void 0:g.descriptions,(U,S)=>($(),G(m,{key:S,header:U.title},ut({default:n(()=>[E("div",{innerHTML:U.content,class:"dida-content-description"},null,8,Il)]),_:2},[S===0?{name:"headerRightContent",fn:n(()=>[t(y,{size:"small"},{default:n(()=>[t(b,{size:"small"},{default:n(()=>r[0]||(r[0]=[I("收起全部")])),_:1}),t(b,{size:"small"},{default:n(()=>r[1]||(r[1]=[I("展开全部")])),_:1})]),_:1})]),key:"0"}:void 0]),1032,["header"]))),128))]}),_:1}),t(A,{style:{margin:"10px"}},{default:n(()=>[t(x,{data:k.value,columns:j.value,"row-key":"id","vertical-align":"top",hover:!0},null,8,["data","columns"])]),_:1})]}),_:1}),t(L,{span:4},{default:n(()=>[E("div",Tl,[t(C,{layout:"vertical",bordered:!0},{default:n(()=>[t(T,{label:"开始时间"},{default:n(()=>{var R;return[I(M((R=v.value)==null?void 0:R.startTime),1)]}),_:1})]),_:1})])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),jl=ne(xl,[["__scopeId","data-v-0c96c05a"]]);function Ll(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!De(e)}const zl=te({__name:"ContestRank",setup(e){const a=fe(),l=Ue(),{globalProperties:s}=ce();let o=null,u=0;const v=b=>{if(b==null)return"-";const y=Math.floor(b/3600).toString().padStart(2,"0"),m=Math.floor(b%3600/60).toString().padStart(2,"0"),c=(b%60).toString().padStart(2,"0");return`${y}:${m}:${c}`},j=[{title:"Rank",colKey:"rank",align:"center",cell:(b,y)=>t(N,{variant:"text",onClick:()=>l.push({name:"contest-user-rank",params:{contestId:u,userId:y.row.user_id}})},{default:()=>[y.row.rank]})},{title:"昵称",colKey:"nickname",cell:(b,y)=>t(N,{variant:"text",onClick:()=>l.push({name:"user",params:{username:y.row.username}})},{default:()=>[y.row.nickname]})},{title:"Solved",colKey:"solved",align:"center",cell:(b,y)=>t(N,{variant:"text",onClick:()=>l.push({name:"contest-judge",params:{contestId:u},query:{username:y.row.username,status:he.Accept}})},{default:()=>[y.row.solved]})},{title:"Penalty",colKey:"penalty",align:"center",cell:(b,y)=>v(y.row.penalty)}],k=p([]),f=p(!1),h=p(),r=()=>{document.body.clientWidth<1e3?k.value.forEach(y=>{y.width="auto"}):k.value.forEach(y=>{y.width="150px"})},_=async b=>{f.value=!0;try{const y=await ll(u);if(k.value=j,h.value=[],y.code===0){y.data.problems.sort((A,L)=>A-L),y.data.problems.forEach((A,L)=>{k.value.push({title:$e(A),colKey:`problem_${A}`,align:"center",title:(T,{colIndex:C})=>{let i;return t(N,{variant:"text",onClick:()=>l.push({name:"contest-problem-detail",params:{contestId:u,problemIndex:A}})},Ll(i=$e(A))?i:{default:()=>[i]})},cell:(T,C)=>{const i=C.row[`problem_${A}`];if(!i)return"";let D="";return i.acDuration>=0&&(D=v(i.acDuration)),i.attempt>0&&(D&&(D+=" "),D+=`(-${i.attempt})`),t("span",null,[D])},attrs:T=>{const C=T.row[`problem_${A}`];return C?C.acDuration>=0?{style:{backgroundColor:"rgba(130,255,30,0.5)"}}:{style:{backgroundColor:"rgba(255,120,120,0.5)"}}:{}}})});const m=new Date(y.data.start_time),c=y.data.ranks,x=[];for(let A=0;A<c.length;A++){const L=c[A];let T={username:L.author_username,nickname:L.author_nickname},C=0,i=0;L.problems.forEach((D,R)=>{let V=-1;D.ac&&(C++,V=(new Date(D.ac).getTime()-m.getTime())/1e3,i+=V,i+=D.attempt*20*60);const P=D.index;T[`problem_${P}`]={acDuration:V,attempt:D.attempt}}),T.solved=C,T.penalty=i,x.push(T)}x.sort((A,L)=>A.solved!==L.solved?L.solved-A.solved:A.penalty-L.penalty);for(let A=0;A<x.length;A++)x[A].rank=A+1;h.value=x}else b&&O(s,y.code)}catch(y){console.error(y),O(s,Ie())}finally{f.value=!1}};return le(async()=>{o=Le(()=>a.query,async b=>{if(Array.isArray(a.params.contestId)?u=Number(a.params.contestId[0]):u=Number(a.params.contestId),!u){await l.push({name:"contest"});return}await _(!0),r(),window.addEventListener("resize",r)},{immediate:!0})}),ke(()=>{window.removeEventListener("resize",r),o&&o()}),(b,y)=>{const m=xe,c=ie,x=ve;return $(),G(x,null,{default:n(()=>[t(c,{style:{margin:"10px"}},{default:n(()=>[E("div",null,[t(m,{data:h.value,columns:k.value,"row-key":"id","vertical-align":"top",hover:!0,"table-layout":"auto",loading:f.value},null,8,["data","columns","loading"])])]),_:1})]),_:1})}}});function Xt(e){const a={};return a.id=e.id,a.authorId=e.author_id,a.authorUsername=e.author_username,a.authorNickname=e.author_nickname,a.title=e.title,a.content=e.content,e.insert_time&&(a.insertTime=new Date(e.insert_time).toLocaleString()),e.modify_time&&(a.modifyTime=new Date(e.modify_time).toLocaleString()),e.update_time&&(a.updateTime=new Date(e.update_time).toLocaleString()),a.problemId=e.problem_id,a.problemTitle=e.problem_title,a.contestId=e.contest_id,a.contestTitle=e.contest_title,a.contestProblemIndex=e.contest_problem_index,a}async function Vl(e){const a={};if(a.id=e.id,a.authorId=e.author_id,a.authorUsername=e.author_username,a.authorNickname=e.author_nickname,a.content="",e.content){const l={math:{inlineDigit:!0,engine:"KaTeX"}};a.content=await pe.md2html(e.content,l)}return e.insert_time&&(a.insertTime=new Date(e.insert_time).toLocaleString()),e.modify_time&&(a.modifyTime=new Date(e.modify_time).toLocaleString()),e.update_time&&(a.updateTime=new Date(e.update_time).toLocaleString()),a}function $l(e){return Y({url:"/discuss?id="+e,method:"get"})}function Dl(e,a,l,s,o,u){const v={};return e&&(v.contest_id=e),a&&(v.problem_id=a),l&&(v.title=l),s&&(v.username=s),o&&(v.page=o),u&&(v.page_size=u),Y({url:`/discuss/list?${new URLSearchParams(v).toString()}`,method:"get"})}function Ul(e,a,l){return Y({url:"/discuss/comment/list?id="+e+"&page="+a+"&page_size="+l,method:"get"})}function Al(e){return Y({url:"/discuss/create",method:"post",data:e})}const Yt=async(e,a)=>{a&&await e.push({name:"user",params:{username:a}})},Rl={style:{margin:"10px"}};function El(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!De(e)}const ql=te({__name:"DiscussList",setup(e){const a=fe(),l=Ue(),{globalProperties:s}=ce();let o=null;const u=p(!1),v=p(!1);let j=-1;const k=p([]),f=[],h=[{title:"标题",colKey:"title",cell:(P,g)=>t(N,{variant:"text",onClick:()=>T(g.row.id)},{default:()=>[g.row.title]})},{title:"创建人",colKey:"authorNickname",width:"200",cell:(P,g)=>t(N,{variant:"text",onClick:async()=>await Yt(l,g.row.authorUsername)},{default:()=>[g.row.authorNickname]})},{title:"创建时间",colKey:"insertTime",width:"180"},{title:"更新时间",colKey:"updateTime",width:"180"}],r=p(!1);let _=1,b=50;const y=p({current:_,pageSize:b,defaultCurrent:_,defaultPageSize:b,total:0,pageSizeOptions:[50,100]}),m=p(),c=p({problemId:"",title:"",username:""}),x=p({title:"",content:""}),A=P=>{P&&l.push({name:"problem-detail",params:{problemId:P}})},L=(P,g)=>{l.push({name:"contest-problem-detail",params:{contestId:P,problemIndex:g}})},T=P=>{if(P){if(j){l.push({name:"contest-discuss-detail",params:{contestId:j,discussId:P}});return}l.push({name:"discuss-detail",params:{discussId:P}})}},C=async()=>{await l.push({query:{...a.query,problem_id:c.value.problemId,title:c.value.title,username:c.value.username,page:1,page_size:y.value.defaultPageSize}})},i=async(P,g)=>{var U;r.value=!0;try{const{current:S,pageSize:d}=P,w=await Dl(j,c.value.problemId,c.value.title,c.value.username,S,d);if(m.value=[],w.code===0){if(w.data.list){const z=w.data.list;for(let q=0;q<z.length;q++){const F=z[q],H=await Xt(F);(U=m.value)==null||U.push(H)}}y.value={...y.value,total:w.data.total_count}}else g&&O(s,w.code)}catch(S){console.error(S),O(s,Ie())}finally{r.value=!1}},D=async P=>{await l.push({query:{...a.query,page:P.current,page_size:P.pageSize}})},R=()=>{u.value=!0},V=async()=>{v.value=!0,console.log("discussCreateForm",x.value),Al(x.value).then(P=>{P.code===0?(ue(s,"创建比赛成功"),u.value=!1,l.push({path:"/discuss/"+P.data.id})):O(s,P.code)}).finally(()=>{v.value=!1})};return le(async()=>{o=Le(()=>a.query,P=>{Array.isArray(a.params.contestId)?j=Number(a.params.contestId[0]):j=Number(a.params.contestId),k.value=f,j?k.value=k.value.concat([{title:"问题ID",colKey:"contestProblemIndex",width:"100",cell:(S,d)=>{let w;return d.row.contestProblemIndex?t(N,{variant:"text",onClick:()=>L(j,d.row.contestProblemIndex)},El(w=$e(d.row.contestProblemIndex))?w:{default:()=>[w]}):""}}]):k.value=k.value.concat([{title:"问题ID",colKey:"problemId",width:"100",cell:(S,d)=>d.row.problemId?t(N,{variant:"text",onClick:()=>A(d.row.problemId)},{default:()=>[d.row.problemId]}):""}]),k.value=k.value.concat(h),c.value.problemId=P.problem_id||"",c.value.title=P.title||"",c.value.username=P.username||"";const g=parseInt(P.page)||y.value.defaultCurrent,U=parseInt(P.page_size)||y.value.defaultPageSize;_=g,b=U,y.value={...y.value,current:_,pageSize:b},i({current:_,pageSize:b},!0)},{immediate:!0})}),ke(()=>{o&&o()}),(P,g)=>{const U=xe,S=ie,d=be,w=ze,z=Re,q=N,F=Ae,H=_e,J=ve,oe=Be;return $(),Z(ee,null,[t(J,null,{default:n(()=>[t(d,{span:9},{default:n(()=>[t(S,{style:{margin:"10px"}},{default:n(()=>[t(U,{data:m.value,columns:k.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:y.value,loading:r.value,"table-layout":"auto",onPageChange:D},null,8,["data","columns","pagination","loading"])]),_:1})]),_:1}),t(d,{span:3},{default:n(()=>[E("div",Rl,[t(S,{class:"sh-card"},{default:n(()=>[t(F,{model:c.value},{default:n(()=>[t(z,{label:"问题ID"},{default:n(()=>[t(w,{modelValue:c.value.problemId,"onUpdate:modelValue":g[0]||(g[0]=K=>c.value.problemId=K),placeholder:"请输入完整问题ID"},null,8,["modelValue"])]),_:1}),t(z,{label:"标题"},{default:n(()=>[t(w,{modelValue:c.value.title,"onUpdate:modelValue":g[1]||(g[1]=K=>c.value.title=K),placeholder:"暂不支持模糊查询"},null,8,["modelValue"])]),_:1}),t(z,{label:"创建人"},{default:n(()=>[t(w,{modelValue:c.value.username,"onUpdate:modelValue":g[2]||(g[2]=K=>c.value.username=K),placeholder:"仅支持输入完整用户名"},null,8,["modelValue"])]),_:1}),t(z,null,{default:n(()=>[t(q,{theme:"primary",onClick:C},{default:n(()=>g[6]||(g[6]=[I("提交")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(S,{class:"sh-card"},{default:n(()=>[t(H,null,{default:n(()=>[t(q,{onClick:R},{default:n(()=>g[7]||(g[7]=[I("创建")])),_:1})]),_:1})]),_:1})])]),_:1})]),_:1}),t(oe,{visible:u.value,"onUpdate:visible":g[5]||(g[5]=K=>u.value=K),header:"创建讨论",onConfirm:V,"confirm-loading":v.value},{default:n(()=>[t(F,{"label-width":80,model:x.value,onSubmit:g[4]||(g[4]=Oe(()=>{},["prevent"]))},{default:n(()=>[t(z,{label:"标题"},{default:n(()=>[t(w,{modelValue:x.value.title,"onUpdate:modelValue":g[3]||(g[3]=K=>x.value.title=K),placeholder:"请输入标题"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","confirm-loading"])],64)}}}),Ze=ne(ql,[["__scopeId","data-v-29a5b754"]]),Ml={key:0,style:{margin:"20px"}},Kl=["innerHTML"],Fl=["innerHTML"],Gl={style:{margin:"10px"}},Nl={style:{margin:"10px"}},Ol={style:{margin:"10px","text-align":"right"}},Hl={style:{margin:"12px"}},Bl={key:0,class:"dida-edit-container"},Jl=te({__name:"DiscussDetail",props:{discussId:{}},setup(e){const a=e;let l=fe();const{globalProperties:s}=ce();let o=null;const u=Ee(),v=we();let j=p("");const k=p(""),f=p(null),h=p(!1),r=p(null),_=p(!1);let b=1,y=20;const m=p({current:1,total:0,defaultPageSize:y,defaultCurrent:b,pageSizeOptions:[20,50]}),c=p([]),x={},A=Ve(()=>v.hasAuth(je.ManageDiscuss)),L=V=>{V&&W.push({name:"discuss-list",query:{...l.query,title:"",tag:V.name}})},T=()=>{W.push({name:"manage-discuss",params:{discussId:k.value}})},C=()=>t("div",{class:"t-pagination__total"},[`共 ${m.value.total} 条回复`]),i=()=>{},D=async(V,P)=>{var g;_.value=!0;try{const{current:U,pageSize:S}=V,d=await Ul(k.value,U,S);if(c.value=[],d.code===0){const w=d.data.list;if(w)for(let z=0;z<w.length;z++){const q=w[z],F=await Vl(q);(g=c.value)==null||g.push(F),await Te(()=>{const H=document.querySelectorAll(".dida-discuss-content");H&&H.length>0&&H.forEach(J=>{pe.mathRender(J),pe.highlightRender({lineNumber:!0,enable:!0},J),Fe(J)})})}m.value={...m.value,total:d.data.total_count}}else P&&O(s,d.code)}catch(U){console.error(U),O(s,Ie())}finally{_.value=!1}},R=async V=>{await W.push({query:{...l.query,page:V.current,page_size:V.pageSize}})};return le(async()=>{if(k.value=a.discussId,k.value||(Array.isArray(l.params.discussId)?k.value=l.params.discussId[0]:k.value=l.params.discussId),!k.value){se(s,"讨论不存在"),await W.push({name:"discuss"});return}h.value=!0;const V=await $l(k.value);if(V.code!==0){h.value=!1,O(s,V.code),await W.push({name:"discuss"});return}V.data.tags&&V.data.tags.forEach(S=>{x[S.id]=S}),r.value=Xt(V.data.discuss),u.setTitle(r.value.title+" - "+u.getTitle);let P=r.value.content;const g={math:{inlineDigit:!0,engine:"KaTeX"}};j.value=await pe.md2html(P,g),await Te(()=>{f.value&&(pe.mathRender(f.value),pe.highlightRender({lineNumber:!0,enable:!0},f.value),Fe(f.value)),h.value=!1}),o=Le(()=>l.query,S=>{const d=parseInt(S.page)||m.value.defaultCurrent,w=parseInt(S.page_size)||m.value.defaultPageSize;b=d,y=w,m.value={...m.value,current:b,pageSize:y},D({current:b,pageSize:y},!0)},{immediate:!0});const U={after:()=>{}};new pe("commentEditRef",U)}),ke(()=>{o&&o()}),(V,P)=>{const g=Ia,U=Pa,S=ie,d=_e,w=Ta,z=N,q=be,F=Me,H=qe,J=ve,oe=ye;return $(),G(oe,{loading:h.value},{default:n(()=>[t(J,{class:"dida-main-content"},{default:n(()=>[t(q,{span:8},{default:n(()=>{var K,de,Ce;return[(K=r.value)!=null&&K.problemTitle||(de=r.value)!=null&&de.contestTitle?($(),Z("div",Ml,[t(U,{"max-item-width":"300"},{default:n(()=>{var Q,ae,B,X,Se;return[(Q=r.value)!=null&&Q.contestTitle?($(),Z(ee,{key:0},[t(g,{to:{name:"contest-detail",params:{contestId:(ae=r.value)==null?void 0:ae.contestId}}},{default:n(()=>{var Pe;return[I(M((Pe=r.value)==null?void 0:Pe.contestTitle),1)]}),_:1},8,["to"]),(B=r.value)!=null&&B.contestProblemIndex?($(),G(g,{key:0,to:{name:"contest-problem-detail",params:{problemIndex:(X=r.value)==null?void 0:X.contestProblemIndex}}},{default:n(()=>{var Pe,bt;return[I(M(me($e)((Pe=r.value)==null?void 0:Pe.contestProblemIndex))+" - "+M((bt=r.value)==null?void 0:bt.problemTitle),1)]}),_:1},8,["to"])):re("",!0)],64)):($(),Z(ee,{key:1},[t(g,{to:{name:"discuss-list-problem"}},{default:n(()=>P[3]||(P[3]=[I(" 问题讨论")])),_:1}),t(g,{to:{name:"problem-detail",params:{problemId:(Se=r.value)==null?void 0:Se.problemId}}},{default:n(()=>{var Pe;return[I(M((Pe=r.value)==null?void 0:Pe.problemTitle),1)]}),_:1},8,["to"])],64))]}),_:1})])):re("",!0),t(S,{style:{margin:"10px"},header:(Ce=r.value)==null?void 0:Ce.title,"header-bordered":!0},{default:n(()=>[E("div",{innerHTML:me(j),class:"dida-discuss-content"},null,8,Kl)]),_:1},8,["header"]),($(!0),Z(ee,null,ge(c.value,(Q,ae)=>($(),G(S,{key:ae,style:{margin:"10px"},"header-bordered":""},{header:n(()=>[t(d,null,{default:n(()=>[E("span",null,M(Q.authorNickname),1),E("span",null,M(Q.insertTime),1)]),_:2},1024)]),default:n(()=>[E("div",{innerHTML:Q.content,class:"dida-discuss-content"},null,8,Fl)]),_:2},1024))),128)),E("div",Gl,[t(w,{modelValue:m.value.current,"onUpdate:modelValue":P[0]||(P[0]=Q=>m.value.current=Q),"page-size":m.value.pageSize,"onUpdate:pageSize":P[1]||(P[1]=Q=>m.value.pageSize=Q),total:m.value.total,"page-size-options":m.value.pageSizeOptions,"show-page-size":!1,"total-content":C,onChange:R},null,8,["modelValue","page-size","total","page-size-options"])]),E("div",Nl,[P[5]||(P[5]=E("div",{id:"commentEditRef",class:"dida-comment-editor"},null,-1)),E("div",Ol,[t(d,null,{default:n(()=>[t(z,{theme:"primary",onClick:i},{default:n(()=>P[4]||(P[4]=[I("提交")])),_:1})]),_:1})])])]}),_:1}),t(q,{span:4},{default:n(()=>[E("div",Hl,[A.value?($(),Z("div",Bl,[t(z,{onClick:T},{default:n(()=>P[6]||(P[6]=[I("编辑")])),_:1})])):re("",!0),t(H,{layout:"vertical",bordered:!0},{default:n(()=>[t(F,{label:"创建时间"},{default:n(()=>{var K;return[I(M((K=r.value)==null?void 0:K.insertTime),1)]}),_:1}),t(F,{label:"编辑时间"},{default:n(()=>{var K;return[I(M((K=r.value)==null?void 0:K.modifyTime),1)]}),_:1}),t(F,{label:"更新时间"},{default:n(()=>{var K;return[I(M((K=r.value)==null?void 0:K.updateTime),1)]}),_:1}),t(F,{label:"创建用户"},{default:n(()=>[t(z,{variant:"text",onClick:P[2]||(P[2]=async()=>{var K;return await me(Yt)(me(W),(K=r.value)==null?void 0:K.authorUsername)})},{default:n(()=>{var K;return[I(M((K=r.value)==null?void 0:K.authorNickname),1)]}),_:1})]),_:1}),t(F,{label:"标签"},{default:n(()=>[t(d,null,{default:n(()=>{var K;return[($(!0),Z(ee,null,ge((K=r.value)==null?void 0:K.tags,de=>($(),G(z,{key:de.id,variant:"dashed",onClick:()=>L(de)},{default:n(()=>[I(M(de.name),1)]),_:2},1032,["onClick"]))),128))]}),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),lt=ne(Jl,[["__scopeId","data-v-2c25e4fb"]]);function Wl(e,a){return Y({url:"/rank/ac/all?page="+e+"&page_size="+a,method:"get"})}function Xl(e,a){return Y({url:"/rank/ac/problem?page="+e+"&page_size="+a,method:"get"})}function Yl(e,a){return Y({url:"/rank/ac/problem/today?page="+e+"&page_size="+a,method:"get"})}function Zl(e,a){return Y({url:"/rank/ac/problem/day7?page="+e+"&page_size="+a,method:"get"})}function Ql(e,a){return Y({url:"/rank/ac/problem/year?page="+e+"&page_size="+a,method:"get"})}const eo={style:{margin:"10px"}};function ot(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!De(e)}const to=te({__name:"RankUser",props:{type:{}},setup(e){const a=fe(),l=Ue(),{globalProperties:s}=ce();let o=null;const u=e,v=p(""),j=p(""),k={all:{header:"统计所有用户在本站的提交记录",content:"优先以AC记录数量排序，如果相同则提交所用次数较少的优先，如果仍相同，注册较早的用户靠前"},problem:{header:"统计所有用户在本站的提交记录",content:"以题目记录数量排序，如果相同，注册较早的用户靠前"},"problem-today":{header:"统计所有用户今日在本站的提交记录",content:"以今日题目记录数量排序，如果相同，注册较早的用户靠前"},"problem-day7":{header:"统计所有用户最近7日在本站的提交记录",content:"以7日题目记录数量排序（从7日前的0点开始计算），如果相同，注册较早的用户靠前"},"problem-year":{header:"统计所有用户最近1年在本站的提交记录",content:"以最近1年题目记录数量排序（从365日前的0点开始计算），如果相同，注册较早的用户靠前"}},f=p([]),h=[{title:"序号",colKey:"index"},{title:"用户名",colKey:"username",cell:(D,R)=>t(N,{variant:"dashed",onClick:()=>A(R.row.username)},{default:()=>[R.row.username]})},{title:"昵称",colKey:"nickname"},{title:"Slogan",colKey:"slogan"}],r=[{title:"题目数量",colKey:"problem_count",cell:(D,R)=>{let V=0;return R.row.problem_count&&(V=R.row.problem_count),t(N,{variant:"dashed",onClick:()=>L(R.row.username)},ot(V)?V:{default:()=>[V]})}}],_=[{title:"正确",colKey:"accept",cell:(D,R)=>{let V=0;return R.row.accept&&(V=R.row.accept),t(N,{variant:"dashed",onClick:()=>L(R.row.username)},ot(V)?V:{default:()=>[V]})}},{title:"提交",colKey:"attempt",cell:(D,R)=>{let V=0;return R.row.attempt&&(V=R.row.attempt),t(N,{variant:"dashed",onClick:()=>T(R.row.username)},ot(V)?V:{default:()=>[V]})}}],b=p(!1);let y=1,m=50;const c=p({current:y,pageSize:m,defaultCurrent:y,defaultPageSize:m,total:0,pageSizeOptions:[50]}),x=p(),A=D=>{l.push({name:"user",params:{username:D}})},L=D=>{l.push({name:"judge-list",query:{username:D,status:he.Accept}})},T=D=>{l.push({name:"judge-list",query:{username:D}})},C=async(D,R)=>{b.value=!0;try{x.value=[];const{current:V,pageSize:P}=D;let g=null;switch(u.type){case"problem":g=await Xl(V,P);break;case"problem-today":g=await Yl(V,P);break;case"problem-day7":g=await Zl(V,P);break;case"problem-year":g=await Ql(V,P);break;default:g=await Wl(V,P);break}if(g.code===0){const U=g.data.list;if(!U||U.length<=0){c.value={...c.value,total:0},ue(s,"未找到记录");return}x.value=[];const S=c.value.pageSize*(c.value.current-1);let d=1;U.forEach(w=>{var q;const z=w;z.index=S+d++,(q=x.value)==null||q.push(z)}),c.value={...c.value,total:g.data.total_count}}else R&&O(s,g.code)}catch(V){console.error(V),O(s,Ie())}finally{b.value=!1}},i=async D=>{await l.push({query:{...a.query,page:D.current,page_size:D.pageSize}})};return le(async()=>{b.value=!0,o=Le(()=>a.query,D=>{switch(u.type&&k[u.type]?(v.value=k[u.type].header,j.value=k[u.type].content):(v.value=k.all.header,j.value=k.all.content),u.type){case"all":f.value=h.concat(_);break;default:f.value=h.concat(r);break}const R=parseInt(D.page)||c.value.defaultCurrent,V=parseInt(D.page_size)||c.value.defaultPageSize;y=R,m=V,c.value={...c.value,current:y,pageSize:m},C({current:y,pageSize:m},!0)},{immediate:!0})}),ke(()=>{o&&o()}),(D,R)=>{const V=xe,P=ie,g=be,U=ve;return $(),G(U,null,{default:n(()=>[t(g,{span:9},{default:n(()=>[t(P,{style:{margin:"10px"}},{default:n(()=>[t(V,{data:x.value,columns:f.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:c.value,loading:b.value,"table-layout":"auto",onPageChange:i},null,8,["data","columns","pagination","loading"])]),_:1})]),_:1}),t(g,{span:3},{default:n(()=>[E("div",eo,[t(P,{class:"sh-card",header:v.value,"header-bordered":!0},{default:n(()=>[I(M(j.value),1)]),_:1},8,["header"])])]),_:1})]),_:1})}}}),Ne=ne(to,[["__scopeId","data-v-ad6297d7"]]),ao=te({__name:"ManageJudge",setup(e){const{globalProperties:a}=ce(),l=p(""),s=p(!1),o=p(!1),u=p(!1),v=async()=>{s.value=!0;try{const f=await Mn();if(f.code!==0){O(a,f.code);return}ue(a,"重判成功"),await W.push({name:"judge-list"})}catch(f){console.error(f),O(a,"重判失败")}finally{s.value=!1}},j=async()=>{if(l.value===""){O(a,"请输入问题Id");return}o.value=!0;try{const f=await Kn(l.value);if(f.code!==0){O(a,f.code);return}ue(a,"重判成功"),await W.push({name:"judge-list",query:{problem_id:l.value}})}catch(f){console.error(f),O(a,"重判失败")}finally{o.value=!1}},k=async()=>{u.value=!0;try{const f=await Fn();if(f.code!==0){O(a,f.code);return}ue(a,"重判成功"),await W.push({name:"judge-list"})}catch(f){console.error(f),O(a,"重判失败")}finally{u.value=!1}};return(f,h)=>{const r=N,_=ie,b=ze,y=_e;return $(),Z(ee,null,[t(_,{class:"yj-manage-card",title:"重判最近提交"},{default:n(()=>[t(r,{onClick:v,loading:s.value},{default:n(()=>h[1]||(h[1]=[I("重判")])),_:1},8,["loading"])]),_:1}),t(_,{class:"yj-manage-card",title:"重判问题"},{default:n(()=>[t(y,null,{default:n(()=>[t(b,{modelValue:l.value,"onUpdate:modelValue":h[0]||(h[0]=m=>l.value=m),placeholder:"输入问题Id"},null,8,["modelValue"]),t(r,{onClick:j,loading:o.value},{default:n(()=>h[2]||(h[2]=[I("重判")])),_:1},8,["loading"])]),_:1})]),_:1}),t(_,{class:"yj-manage-card",title:"重判所有"},{default:n(()=>[t(r,{onClick:k,theme:"danger",loading:u.value},{default:n(()=>h[3]||(h[3]=[I("重判")])),_:1},8,["loading"])]),_:1})],64)}}}),no=ne(ao,[["__scopeId","data-v-14c853f1"]]),lo={style:{margin:"10px"}},oo={key:1},so={style:{margin:"12px"}},ro={class:"dida-edit-container"},uo=te({__name:"ProblemEdit",setup(e){let a=fe();const{globalProperties:l}=ce(),s=Ee(),o=p(""),u=p(!1);let v=null;const j=p(!1),k=p(null),f=p({title:"",timeLimit:0,memoryLimit:0,source:"",tags:[]}),h=p([]),r=p([]),_=Ve(()=>{const C=[],i=h.value;for(let D=0,R=i.length;D<R;D++)i[D].value&&C.push(i[D].value);return C}),b=(C,i)=>{const{trigger:D,index:R,item:V}=i;if(D==="clear"&&(h.value=[]),["tag-remove","backspace"].includes(D)&&h.value.splice(R,1),D==="enter"){for(let g=0;g<r.value.length;g++){const U=r.value[g];if(U.label===V){for(let S=0;S<h.value.length;S++)if(h.value[S].label===U.label)return;h.value.push(U);return}}const P={label:V,value:V};h.value.push(P),r.value=r.value.concat(P)}},y=(C,{current:i,type:D})=>{if(!i){h.value=D==="check"?r.value.slice(1):[];return}if(D==="check"){const R=r.value.find(V=>V.value===i);if(!R)return;h.value.push(R)}else h.value=h.value.filter(R=>R.value!==i)},m=()=>{W.push({name:"problem-detail",params:{problemId:o.value}})},c=()=>{W.push({name:"manage-problem-judge",params:{problemId:o.value}})},x=async()=>{if(v){j.value=!0,f.value.tags=[];for(let C=0;C<h.value.length;C++){const i=h.value[C];i&&i.label&&f.value.tags.push(i.label)}try{const C=await Bn(f.value.title,f.value.timeLimit,f.value.memoryLimit,f.value.source,f.value.tags,v.getValue());if(j.value=!0,C.code!==0){O(l,C.code);return}C.data!=null&&await W.push({name:"problem-detail",params:{problemId:C.data}}),mt(l,"创建成功")}finally{j.value=!1}}},A=async()=>{if(v){j.value=!0,f.value.tags=[];for(let C=0;C<h.value.length;C++){const i=h.value[C];i&&i.label&&f.value.tags.push(i.label)}try{const C=await Jn(o.value,f.value.title,f.value.timeLimit,f.value.memoryLimit,f.value.source,f.value.tags,v.getValue());if(j.value=!0,C.code!==0){O(l,C.code);return}C.data!=null&&(k.value.updateTime=new Date(C.data).toLocaleString()),mt(l,"保存成功")}finally{j.value=!1}}},L=C=>{const i={after:()=>{v==null||v.setValue(C),u.value=!1}};v=new pe("problemEditDiv",i)},T=async()=>{const C=await Ht(o.value,void 0,void 0);if(C.code!==0){O(l,C.code),console.error("problem get failed",C.code),await W.push({name:"problem"});return}const i=C.data.problem;if(k.value=We(i,{}),f.value.title=i.title,f.value.timeLimit=i.time_limit,f.value.memoryLimit=i.memory_limit,f.value.source=i.source,f.value.tags=[],h.value=[],C.data.tags)for(let R=0;R<C.data.tags.length;R++){const V=C.data.tags[R];V&&V.name&&(f.value.tags.push(V.name),h.value.push({label:V.name,value:V.id}))}s.setTitle(i.title+" - "+s.getTitle);let D=i.description;L(D)};return le(async()=>{Array.isArray(a.params.problemId)?o.value=a.params.problemId[0]:o.value=a.params.problemId,o.value?(u.value=!0,Bt(-1).then(async C=>{C.code===0?(C.data.list&&C.data.list.forEach(i=>{r.value.push({label:i.name,value:i.id})}),await T()):(O(l,C.code),console.error("problem tag get failed",C.code),await W.push({name:"problem"}))}).catch(async C=>{console.error(C),O(l,"获取数据异常"),await W.push({name:"problem"})})):(f.value.timeLimit=1e3,f.value.memoryLimit=65536,L(""))}),(C,i)=>{const D=ze,R=Re,V=xa,P=La,g=ja,U=Ae,S=ie,d=be,w=N,z=_e,q=pt("space"),F=Me,H=qe,J=ve,oe=ye;return $(),G(oe,{loading:u.value},{default:n(()=>[t(J,null,{default:n(()=>[t(d,{span:8},{default:n(()=>[E("div",lo,[t(S,{class:"sh-card"},{default:n(()=>[t(U,{model:f.value},{default:n(()=>[t(R,{label:"标题"},{default:n(()=>[t(D,{modelValue:f.value.title,"onUpdate:modelValue":i[0]||(i[0]=K=>f.value.title=K),placeholder:"问题标题"},null,8,["modelValue"])]),_:1}),t(R,{label:"时间限制"},{default:n(()=>[t(V,{modelValue:f.value.timeLimit,"onUpdate:modelValue":i[1]||(i[1]=K=>f.value.timeLimit=K),theme:"normal",min:0},{suffix:n(()=>i[4]||(i[4]=[E("span",null,"ms",-1)])),_:1},8,["modelValue"])]),_:1}),t(R,{label:"内存限制"},{default:n(()=>[t(V,{modelValue:f.value.memoryLimit,"onUpdate:modelValue":i[2]||(i[2]=K=>f.value.memoryLimit=K),theme:"normal",min:0},{suffix:n(()=>i[5]||(i[5]=[E("span",null,"KB",-1)])),_:1},8,["modelValue"])]),_:1}),t(R,{label:"来源"},{default:n(()=>[t(D,{modelValue:f.value.source,"onUpdate:modelValue":i[3]||(i[3]=K=>f.value.source=K),placeholder:"请输入题目来源"},null,8,["modelValue"])]),_:1}),t(R,{label:"标签"},{default:n(()=>[t(g,{value:h.value,"allow-input":!0,placeholder:"请选择或输入","tag-input-props":{excessTagsDisplayType:"break-line"},"popup-props":{overlayInnerClassName:["narrow-scrollbar"],overlayInnerStyle:{maxHeight:"280px",overflowY:"auto",overscrollBehavior:"contain",padding:"6px"}},clearable:"",multiple:"",onTagChange:b},{panel:n(()=>[r.value.length?($(),G(P,{key:0,value:_.value,options:r.value,onChange:y},null,8,["value","options"])):($(),Z("div",oo,"暂无数据"))]),suffixIcon:n(()=>[t(me(ra))]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1})])]),_:1}),t(d,{span:4},{default:n(()=>[E("div",so,[E("div",ro,[o.value?($(),G(z,{key:0},{default:n(()=>[t(w,{onClick:A,theme:"danger",loading:j.value},{default:n(()=>i[6]||(i[6]=[I("保存")])),_:1},8,["loading"]),t(w,{onClick:c,theme:"warning"},{default:n(()=>i[7]||(i[7]=[I("判题数据")])),_:1}),t(w,{onClick:m},{default:n(()=>i[8]||(i[8]=[I("查看")])),_:1})]),_:1})):($(),G(q,{key:1},{default:n(()=>[t(w,{onClick:x,theme:"danger",loading:j.value},{default:n(()=>i[9]||(i[9]=[I("创建")])),_:1},8,["loading"])]),_:1}))]),o.value?($(),G(H,{key:0,layout:"vertical",bordered:!0},{default:n(()=>[t(F,{label:"创建时间"},{default:n(()=>{var K;return[I(M((K=k.value)==null?void 0:K.insertTime),1)]}),_:1}),t(F,{label:"更新时间"},{default:n(()=>{var K;return[I(M((K=k.value)==null?void 0:K.updateTime),1)]}),_:1}),t(F,{label:"判题方式"},{default:n(()=>{var K;return[I(M((K=k.value)==null?void 0:K.judgeType),1)]}),_:1}),t(F,{label:"上传用户"},{default:n(()=>{var K;return[I(M((K=k.value)==null?void 0:K.creatorNickname),1)]}),_:1})]),_:1})):re("",!0)])]),_:1})]),_:1}),i[10]||(i[10]=E("div",{id:"problemEditDiv",class:"dida-description-editor"},null,-1))]),_:1},8,["loading"])}}}),It=ne(uo,[["__scopeId","data-v-4cb84894"]]),io={style:{margin:"10px"}},co={style:{margin:"12px"}},mo={class:"dida-edit-container"},po=te({__name:"ProblemJudge",setup(e){let a=fe();const{globalProperties:l}=ce(),s=Ee(),o=p(""),u=p(!1),v=p(null);let j=null;const k=p(null),f=p(""),h=p(!1),r=p(!1),_=p([{title:"文件",colKey:"file"},{title:"大小",colKey:"size",width:150,cell:(P,g)=>g.row.size.toFixed(0)+" B"},{title:"最后修改时间",colKey:"lastModified",width:180,cell:(P,g)=>new Date(g.row.lastModified).toLocaleString()},{title:"操作",colKey:"action",width:100,cell:(P,g)=>t(N,{onClick:()=>A(g.row.file)},{default:()=>[I("下载")]})}]),b=p([]),y=Ve(()=>({border:"2px dashed #ccc",borderRadius:"6px",padding:"20px",textAlign:"center",cursor:"pointer",backgroundColor:h.value?"#f0f9ff":"#fff",transition:"background-color 0.2s ease"})),m=Ve(()=>f.value?`已选择：${f.value}`:h.value?"松开文件以上传":"拖拽文件到这里，或点击选择文件"),c=()=>{W.push({name:"problem-detail",params:{problemId:o.value}})},x=()=>{W.push({name:"manage-problem",params:{problemId:o.value}})},A=async P=>{const g=await Wn(o.value,P);if(g.code!==0){O(l,g.code);return}const U=document.createElement("a");U.href=g.data,U.target="_blank",U.click(),URL.revokeObjectURL(U.href)},L=async()=>{if(!j){se(l,"请选择压缩包");return}r.value=!0,Xn(o.value,j).then(async P=>{P.code==0?(k.value.value=null,j=null,f.value="",u.value=!0,mt(l,"上传成功"),await V()):O(l,P.code)}).catch(P=>{console.log(P),l.$message.error({duration:3e3,content:"申请失败"})}).finally(()=>{r.value=!1})},T=()=>{var P;(P=k.value)==null||P.click()},C=P=>{const g=P.target.files[0];g&&(f.value=g.name,j=g)},i=P=>{h.value=!0},D=()=>{h.value=!1},R=P=>{P.preventDefault(),P.stopPropagation(),h.value=!1;const g=P.dataTransfer.files[0];if(g){f.value=g.name;const U=new DataTransfer;U.items.add(g),k.value.files=U.files,j=g}},V=async()=>{const P=await Nn(o.value);if(P.code!==0){O(l,P.code),await W.push({name:"problem"});return}const g=P.data.problem;v.value=We(g,{}),s.setTitle(g.title+" - "+s.getTitle),b.value=[],P.data.judges?P.data.judges.forEach(U=>{b.value.push({file:U.key,size:U.size,lastModified:U.last_modified})}):se(l,"评测数据不存在"),u.value=!1};return le(async()=>{if(Array.isArray(a.params.problemId)?o.value=a.params.problemId[0]:o.value=a.params.problemId,!o.value){se(l,"题目不存在"),await W.push({name:"problem"});return}u.value=!0,await V()}),(P,g)=>{const U=xe,S=be,d=N,w=_e,z=Me,q=qe,F=ve,H=ye;return $(),G(H,{loading:u.value},{default:n(()=>[t(F,null,{default:n(()=>[t(S,{span:7},{default:n(()=>[E("div",io,[E("div",{id:"drop-zone",style:zt(y.value),onClick:T,onDragenter:Oe(i,["prevent"]),onDragover:g[0]||(g[0]=Oe(()=>{},["prevent"])),onDragleave:Oe(D,["prevent"]),onDrop:R},[E("input",{ref_key:"fileInput",ref:k,type:"file",style:{display:"none"},onChange:C},null,544),I(" "+M(m.value),1)],36)]),t(U,{data:b.value,columns:_.value,"row-key":"id","vertical-align":"top",hover:!0},null,8,["data","columns"])]),_:1}),t(S,{span:5},{default:n(()=>[E("div",co,[E("div",mo,[t(w,null,{default:n(()=>[t(d,{onClick:L,theme:"danger",loading:r.value},{default:n(()=>g[1]||(g[1]=[I("上传")])),_:1},8,["loading"]),t(d,{onClick:x,theme:"warning"},{default:n(()=>g[2]||(g[2]=[I("编辑")])),_:1}),t(d,{onClick:c},{default:n(()=>g[3]||(g[3]=[I("查看")])),_:1})]),_:1})]),t(q,{layout:"vertical",bordered:!0},{default:n(()=>[t(z,{label:"标题"},{default:n(()=>{var J;return[I(M((J=v.value)==null?void 0:J.title),1)]}),_:1}),t(z,{label:"创建时间"},{default:n(()=>{var J;return[I(M((J=v.value)==null?void 0:J.insertTime),1)]}),_:1}),t(z,{label:"更新时间"},{default:n(()=>{var J;return[I(M((J=v.value)==null?void 0:J.updateTime),1)]}),_:1}),t(z,{label:"判题方式"},{default:n(()=>{var J;return[I(M((J=v.value)==null?void 0:J.judgeType),1)]}),_:1}),t(z,{label:"评测数据"},{default:n(()=>{var J;return[I(M((J=v.value)==null?void 0:J.judgeMd5),1)]}),_:1}),t(z,{label:"上传用户"},{default:n(()=>{var J;return[I(M((J=v.value)==null?void 0:J.creatorNickname),1)]}),_:1})]),_:1})])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),fo=ne(po,[["__scopeId","data-v-3be5c9c9"]]),_o={style:{display:"flex","align-items":"center"}},go={style:{color:"#409eff","margin-right":"20px"}},vo={class:"dida-login-footer"},bo=te({__name:"UserForget",setup(e){const{globalProperties:a}=ce(),l=we(),s=p(!1),o=p(!1),u=p(!1),v=p("发送验证码");let j=null,k=-1;const f=p(!1),h=p(null),r=p(""),_=p({username:"",emailKey:"",password:"",confirmPassword:""}),y=p({username:[{required:!0,message:"请填写用户名"},{min:4,message:"用户名至少4个字符"},{max:20,message:"用户名最多20个字符"},{pattern:/^[a-zA-Z0-9_]+$/,message:"用户名只能包含字母、数字和下划线"}],password:[{required:!0,message:"请填写密码"},{min:6,message:"密码至少6个字符"},{max:20,message:"密码最多20个字符"}],confirmPassword:[{required:!0,message:"请确认密码"},{validator:C=>new Promise(i=>{const D=setTimeout(()=>{i(_.value.password===C),clearTimeout(D)})}),message:"两次密码不一致"}],emailKey:[{required:!0,message:"请填写验证码"},{min:6,message:"请输入完整字符"},{max:6,message:"请输入完整字符"}]}),m=()=>{ue(a,"重置成功")},c=async C=>{if(!u.value){s.value=!0,o.value=!0;try{const i=await bn(C,_.value.username);i.code===0?(ue(a,"验证码发送成功"),r.value=i.data,o.value=!1,u.value=!0,j=new Date,v.value="60秒后重发",k=setInterval(()=>{const R=Math.floor((new Date().getTime()-(j==null?void 0:j.getTime()))/1e3);R>60?(v.value="发送验证码",u.value=!1,clearInterval(k)):v.value=`${60-R}秒后重发`},1e3)):O(a,i.code)}catch(i){console.error("Send email key error",i),se(a,"发送验证码失败")}finally{s.value=!1}}},x=async()=>{var R;if(f.value=!0,u.value||o.value)return;await Te();const C=document.getElementById("cf-confirm-div");C&&C.remove();const i=document.createElement("div");i.id="cf-confirm-div",i.setAttribute("data-theme","light"),(R=h.value)==null||R.appendChild(i);const D=window;D.turnstile.ready(function(){D.turnstile.render("#cf-confirm-div",{sitekey:"0x4AAAAAABeM4SYPu2Rn7PmI",callback:async function(V){f.value=!1,await c(V)},"before-interactive-callback":function(){console.log("before-interactive-callback")}})})},A=p(()=>t(N,{onClick:x,disabled:u.value,loading:o.value,style:"width:120px"},{default:()=>[v.value]})),L=async()=>{s.value=!0;try{const C=await hn(_.value.username,_.value.password,_.value.emailKey);C.code===0?(ue(a,"密码修改成功"),a.$router.push({name:"login"})):O(a,C.code)}catch(C){console.error("Modify password error",C),se(a,"修改密码失败")}finally{s.value=!1}},T=async({validateResult:C,firstError:i,e:D})=>{if(!s.value){if(D.preventDefault(),C!==!0){se(a,i);return}r.value?await L():await x()}};return le(()=>{if(l.isLogin()){a.$router.push({path:"/user"});return}}),ke(()=>{}),(C,i)=>{const D=ft,R=ze,V=Re,P=Vt,g=N,U=Ae,S=Ge,d=ie,w=Be;return $(),Z(ee,null,[t(d,{class:"yj-login-card",title:"欢迎使用DidaOJ~"},{default:n(()=>[t(D,{"max-line":1},{default:n(()=>i[6]||(i[6]=[E("span",null,"如果您未绑定邮箱或忘记用户名，可联系管理员寻求帮助",-1),E("span",null,"管理员邮箱：BoilTask@qq.com",-1)])),_:1}),t(U,{ref:"form",rules:y.value,data:_.value,colon:!0,onReset:m,onSubmit:T,class:"yj-login-form"},{default:n(()=>[t(V,{name:"username",label:"用户名"},{default:n(()=>[t(R,{modelValue:_.value.username,"onUpdate:modelValue":i[0]||(i[0]=z=>_.value.username=z),clearable:"",placeholder:"请输入完整用户名"},null,8,["modelValue"])]),_:1}),r.value?($(),Z(ee,{key:0},[t(V,{name:"email",label:"发送邮箱"},{default:n(()=>[t(P,{append:A.value},{default:n(()=>[E("div",_o,[E("span",go,M(r.value),1)])]),_:1},8,["append"])]),_:1}),t(V,{name:"emailKey",label:"验证码"},{default:n(()=>[t(R,{modelValue:_.value.emailKey,"onUpdate:modelValue":i[1]||(i[1]=z=>_.value.emailKey=z),clearable:"",placeholder:"请输入收到的验证码"},null,8,["modelValue"])]),_:1}),t(V,{name:"password",label:"新密码"},{default:n(()=>[t(R,{modelValue:_.value.password,"onUpdate:modelValue":i[2]||(i[2]=z=>_.value.password=z),type:"password",clearable:"",placeholder:"新密码"},null,8,["modelValue"])]),_:1}),t(V,{name:"confirmPassword",label:"确认密码"},{default:n(()=>[t(R,{modelValue:_.value.confirmPassword,"onUpdate:modelValue":i[3]||(i[3]=z=>_.value.confirmPassword=z),type:"password",clearable:"",placeholder:"请重复输入密码"},null,8,["modelValue"])]),_:1})],64)):re("",!0),r.value?($(),G(V,{key:1},{default:n(()=>[t(g,{theme:"primary",type:"submit",block:"",loading:s.value},{default:n(()=>i[7]||(i[7]=[I("修改密码")])),_:1},8,["loading"])]),_:1})):($(),G(V,{key:2},{default:n(()=>[t(g,{theme:"primary",type:"submit",block:"",loading:s.value},{default:n(()=>i[8]||(i[8]=[I("重置密码")])),_:1},8,["loading"])]),_:1}))]),_:1},8,["rules","data"]),E("div",vo,[t(S,{onClick:i[4]||(i[4]=()=>{me(a).$router.push({name:"login"})})},{default:n(()=>i[9]||(i[9]=[I("返回登陆 ")])),_:1})])]),_:1}),t(w,{visible:f.value,"onUpdate:visible":i[5]||(i[5]=z=>f.value=z),header:"正在加载人机验证","close-btn":!1,footer:!1},{default:n(()=>[E("div",{ref_key:"dialogContainer",ref:h,class:"cf-confirm-container"},null,512)]),_:1},8,["visible"])],64)}}}),ho=ne(bo,[["__scopeId","data-v-d3cb1db8"]]),Zt=[{name:"problem-list",tab:"problem",sidebar:"problem-list",path:"",title:"问题列表",icon:"list",component:tl},{name:"problem-detail",tab:"problem",sidebar:"problem-list",path:":problemId+",title:"问题详情",icon:"list",component:yt},{name:"problem-recommend",tab:"problem",sidebar:"problem-recommend",path:"recommend/:problemId*",title:"问题推荐",icon:"cpu",needLogin:!0,component:gl},{name:"judge-list",tab:"judge",sidebar:"judge-list",path:"",title:"评测列表",icon:"list",component:kt},{name:"judge-detail",tab:"judge",sidebar:"judge-list",path:":judgeId+",title:"评测详情",icon:"cpu",component:St},{name:"contest-list",tab:"contest",sidebar:"contest-list",path:"",title:"比赛列表",icon:"list",component:Pt},{name:"contest-recent",tab:"contest",sidebar:"contest-recent",path:"recent",title:"近期比赛",icon:"list",component:Pt},{name:"contest-detail",tab:"contest-detail-tab",sidebar:"contest-detail",path:":contestId+",title:"比赛详情",icon:"cpu",component:jl},{name:"contest-problem-detail",tab:"contest-detail-tab",sidebar:"contest-problem-detail",path:":contestId+/problem/:problemIndex+",title:"问题详情",icon:"cpu",disableSidebar:!0,component:yt},{name:"contest-judge",tab:"contest-detail-tab",sidebar:"contest-judge",path:":contestId+/judge",title:"评测列表",icon:"list",component:kt},{name:"contest-judge-detail",tab:"contest-detail-tab",sidebar:"contest-judge-detail",path:":contestId+/judge/:judgeId+",title:"评测详情",icon:"cpu",component:St,disableSidebar:!0},{name:"contest-rank",tab:"contest-detail-tab",sidebar:"contest-rank",path:":contestId+/rank",title:"比赛排名",icon:"list",component:zl},{name:"contest-discuss",tab:"contest-detail-tab",sidebar:"contest-discuss",path:":contestId+/discuss",title:"比赛讨论",icon:"list",component:Ze},{name:"contest-discuss-detail",tab:"contest-detail-tab",sidebar:"contest-discuss",path:":contestId+/discuss/:discussId+",title:"讨论详情",icon:"list",component:lt},{name:"discuss-list",tab:"discuss",sidebar:"discuss-list",path:"",title:"讨论列表",icon:"list",component:Ze},{name:"discuss-list-problem",tab:"discuss",sidebar:"discuss-list-problem",path:"problem",title:"问题讨论",icon:"list",component:Ze},{name:"discuss-list-judge",tab:"discuss",sidebar:"discuss-list-judge",path:"judge",title:"评测讨论",icon:"list",component:Ze},{name:"discuss-detail",tab:"discuss",sidebar:"discuss-list",path:":discussId+",title:"讨论详情",icon:"list",component:lt},{name:"rank-ac-all",tab:"rank",sidebar:"rank-ac-all",path:"ac",title:"AC排名",icon:"base-station",props:{type:"all"},component:Ne},{name:"rank-ac-problem",tab:"rank",sidebar:"rank-ac-problem",path:"ac/problem",title:"题量排名",icon:"base-station",props:{type:"problem"},component:Ne},{name:"rank-ac-problem-today",tab:"rank",sidebar:"rank-ac-problem-today",path:"ac/problem/today",title:"今日题量",icon:"base-station",props:{type:"problem-today"},component:Ne},{name:"rank-ac-problem-day7",tab:"rank",sidebar:"rank-ac-problem-day7",path:"ac/problem/day7",title:"7日题量",icon:"base-station",props:{type:"problem-day7"},component:Ne},{name:"rank-ac-problem-year",tab:"rank",sidebar:"rank-ac-problem-year",path:"ac/problem/year",title:"1年题量",icon:"base-station",props:{type:"problem-year"},component:Ne},{name:"tool-paste",tab:"tool",sidebar:"tool-paste",path:"paste",title:"码池",icon:"base-station",component:ct},{name:"system-status",tab:"system",sidebar:"system-status",path:"",title:"运行状态",icon:"base-station",component:ct},{name:"system-about",tab:"system",sidebar:"system-about",path:"about",title:"关于",icon:"base-station",props:{discussId:"52"},component:lt},{name:"manage-problem-create",tab:"manage",sidebar:"manage-problem-create",disableSidebar:!0,path:"problem",title:"新建问题",icon:"list",component:It,auths:[je.ManageProblem]},{name:"manage-problem",tab:"manage",sidebar:"manage-problem",disableSidebar:!0,path:"problem/:problemId+",title:"问题编辑",icon:"list",component:It,auths:[je.ManageProblem]},{name:"manage-problem-judge",tab:"manage",sidebar:"manage-problem-judge",disableSidebar:!0,path:"problem/:problemId+/judge",title:"评测数据",icon:"list",component:fo,auths:[je.ManageProblem]},{name:"manage-judge",tab:"manage",path:"judge",sidebar:"manage-judge",title:"评测管理",icon:"list",auths:["i-manage-judge"],component:no},{name:"login-forget",tab:"login",path:"forget",title:"忘记密码",component:ho}],Tt=(e,a,l,s)=>{s.tab==l&&(s.disableSidebar&&a!=s.sidebar||s.sidebar==null||s.sidebar!=s.name||e.push({name:s.name,title:s.title,icon:s.icon,to:{name:s.name}}))},yo=(e,a)=>{const l=[];return Zt.forEach(s=>{if(Mt(s)){const o=[];s.children.forEach(u=>{Tt(o,e,a,u)}),o.length>0&&l.push({title:s.title,children:o})}else Tt(l,e,a,s)}),l},xt=(e,a)=>{const l=jn(a.tab),s={name:a.name,path:"/"+a.path,meta:{title:a.title+" - "+l.title,tab:a.tab,sidebar:a.sidebar,showSidebar:l.showSidebar,needLogin:l.needLogin||a.needLogin,tabAuths:l.auths,auths:a.auths},props:a.props,component:a.component};l.disablePath||(s.path=l.path+s.path),e.push(s)},wo=e=>{Zt.forEach(a=>{Mt(a)?a.children.forEach(l=>{xt(e,l)}):xt(e,a)})},ko={class:"sh-main"},Co=te({__name:"View403",setup(e){let a=fe();const l=p("");return le(()=>{a.query.target?l.value=a.query.target:l.value=a.fullPath}),(s,o)=>{const u=N;return $(),Z("div",ko,[E("p",null,M(l.value),1),o[2]||(o[2]=E("p",null,"该页面无访问权限，请更换访问目标或重新登陆后再试",-1)),t(u,{theme:"primary",onClick:o[0]||(o[0]=()=>s.$router.push("/"))},{default:n(()=>o[1]||(o[1]=[I("返回首页")])),_:1})])}}}),Qt=ne(Co,[["__scopeId","data-v-777362b3"]]),Xe=[];zn(Xe);wo(Xe);Xe.push({path:"/403",name:"403",component:Qt});Xe.push({path:"/:pathMatch(.*)*",name:"404",component:qt});const W=ua({history:ia("/"),routes:Xe});W.beforeEach((e,a,l)=>{if(e.name==null||!W.hasRoute(e.name)){l({name:"home"});return}const s=e.matched[e.matched.length-1].meta;if(s.redirect){l({name:s.redirect});return}if(s.needLogin){const u=we();if(u.getToken==null||u.getToken==""){l({name:"login",query:{redirect_uri:e.fullPath}});return}}const o=s.tabAuths;if(o&&!we().hasAllAuths(o)){l({name:"403",query:{target:e.fullPath}});return}l()});W.afterEach((e,a)=>{if(e.name===a.name)return;const l=nt(),s=Ee();let o=null;if(e.matched.length>0&&(o=e.matched[e.matched.length-1].meta),o!=null&&o.title&&s.setTitle(o==null?void 0:o.title),o!=null&&o.showSidebar){l.setSidebarShow(!0);const u=yo(o==null?void 0:o.sidebar,o==null?void 0:o.tab);l.setMenuList(u),l.setMenuActiveName(o==null?void 0:o.sidebar)}else l.setSidebarShow(!1)});const ea=at("login",{state:()=>({Loaded:!1}),getters:{isLoaded(){return this.Loaded}}}),So=te({__name:"HeaderContent",setup(e){const a=ea(),l=we(),{globalProperties:s}=ce(),o=p(a.isLoaded),u=p(!1),v=p(l.getUsername),j=p(l.getNickname),k=p(),f=()=>{k.value=Ln(l)};a.$subscribe((_,b)=>{o.value=b.Loaded}),l.$subscribe((_,b)=>{v.value=b.username,j.value=b.nickname,u.value=b.token!="",f()});const h=()=>{s.$router.currentRoute.value.name!=="login"&&s.$router.push({name:"login",query:{redirect_uri:s.$router.currentRoute.value.fullPath}})},r=()=>{l.clear(),s.$message.success({duration:3e3,content:"注销成功"}),s.$router.push({path:"/login",query:{redirect_uri:s.$router.currentRoute.value.fullPath}})};return le(()=>{f()}),(_,b)=>{const y=pt("router-link"),m=Rt,c=At,x=za,A=Va;return $(),G(A,{modelValue:_.$route.meta.tab,"onUpdate:modelValue":b[0]||(b[0]=L=>_.$route.meta.tab=L),class:"sh-menu","expand-type":"popup"},{logo:n(()=>[t(y,{to:"/",class:"sh-logo"},{default:n(()=>b[1]||(b[1]=[I("DidaOJ")])),_:1})]),operations:n(()=>[o.value&&u.value?($(),G(x,{key:0,title:j.value},{icon:n(()=>[t(m,{name:"user"})]),default:n(()=>[t(c,{value:"user",to:{path:"/user/"+v.value}},{default:n(()=>b[2]||(b[2]=[I("个人空间")])),_:1},8,["to"]),t(c,{value:"user_logout",onClick:r},{default:n(()=>b[3]||(b[3]=[I(" 注销")])),_:1})]),_:1},8,["title"])):o.value?($(),G(c,{key:2,value:"login",onClick:h},{icon:n(()=>[t(m,{name:"login"})]),default:n(()=>[b[5]||(b[5]=I(" 登录 "))]),_:1})):($(),G(c,{key:1,value:"login"},{icon:n(()=>[t(m,{name:"login"})]),default:n(()=>[b[4]||(b[4]=I(" ... "))]),_:1}))]),default:n(()=>[($(!0),Z(ee,null,ge(k.value,L=>($(),G(c,{key:L.name,value:L.name,to:{name:L.name}},{icon:n(()=>[L.icon?($(),G(m,{key:0,name:L.icon},null,8,["name"])):re("",!0)]),default:n(()=>[I(" "+M(L.title),1)]),_:2},1032,["value","to"]))),128))]),_:1},8,["modelValue"])}}}),Po=ne(So,[["__scopeId","data-v-c64d812f"]]),Io={id:"menu-container"},To=te({__name:"SidebarContent",setup(e){const a=nt(),l=p(!1),s=p(null),o=p(a.menuActiveName),u=p(a.menuList),v=p([]),j=p(!1),k=()=>{o.value=a.menuActiveName;const h=JSON.stringify(u.value),r=JSON.stringify(a.menuList);h!==r&&(v.value.push([...a.menuList]),f())},f=async()=>{if(v.value.length>0&&!j.value){for(j.value=!0;v.value.length>1;)v.value.shift();const h=v.value.shift();l.value=h.length<=0,u.value=[],await Te(),s.value&&s.value.updateActiveName(),await new Promise(_=>setTimeout(_,300)),u.value=h,await Te(),s.value&&s.value.updateActiveName();const r=300;await new Promise(_=>setTimeout(_,r)),j.value=!1,await f()}};return a.$subscribe((h,r)=>{k()}),le(()=>{k()}),(h,r)=>{const _=Rt,b=At,y=Da,m=$a,c=ye;return $(),Z(ee,null,[E("div",Io,[t(m,{modelValue:o.value,"onUpdate:modelValue":r[0]||(r[0]=x=>o.value=x),theme:"light",class:"sh-menu-container"},{default:n(()=>[t(ca,{name:"move-left"},{default:n(()=>[($(!0),Z(ee,null,ge(u.value,(x,A)=>($(),Z(ee,{key:A},[me(Vn)(x)?($(),G(y,{key:0,title:x.title},{default:n(()=>[($(!0),Z(ee,null,ge(x.children,(L,T)=>($(),G(b,{key:L.name,value:L.name,to:L.to},ut({default:n(()=>[I(" "+M(L.title),1)]),_:2},[L.icon?{name:"icon",fn:n(()=>[t(_,{name:L.icon,class:it(L.iconClass)},null,8,["name","class"])]),key:"0"}:void 0]),1032,["value","to"]))),128))]),_:2},1032,["title"])):($(),G(b,{key:x.name,value:x.name,to:x.to},ut({default:n(()=>[I(" "+M(x.title),1)]),_:2},[x.icon?{name:"icon",fn:n(()=>[t(_,{name:x.icon,class:it(x.iconClass)},null,8,["name","class"])]),key:"0"}:void 0]),1032,["value","to"]))],64))),128))]),_:1})]),_:1},8,["modelValue"])]),t(c,{size:"small",loading:l.value,"show-overlay":!0,attach:"#menu-container",class:"sh-sidebar-loading",style:{"align-items":"flex-start","padding-top":"100px"}},null,8,["loading"])],64)}}}),xo=ne(To,[["__scopeId","data-v-96e2d89f"]]),jo={};function Lo(e,a){return null}const zo=ne(jo,[["render",Lo]]),Vo={class:"footer"},$o={class:"footer-left"},Do={class:"foot-time"},Uo={class:"footer-center"},Ao={href:"https://beiancx.miit.gov.cn/",target:"_blank"},Ro={class:"footer-right"},Eo={class:"foot-text"},qo={href:"https://github.com/hpu-developer/DiDaOJ-web",target:"_blank"},Mo={class:"foot-text"},Ko={href:"https://github.com/hpu-developer/DiDaOJ-go",target:"_blank"},Fo=te({__name:"FooterContent",setup(e){const a=p("");function l(){a.value=new Date().toLocaleString()}return le(()=>{l(),setInterval(()=>{l()},1e3)}),(s,o)=>{const u=N;return $(),Z("div",Vo,[E("div",$o,[E("p",Do,M(a.value),1)]),E("div",Uo,[E("a",Ao,[t(u,{theme:"default",variant:"outline",ghost:!0},{default:n(()=>o[0]||(o[0]=[I("豫ICP备15024677号-4")])),_:1})])]),E("div",Ro,[E("p",Eo,[E("a",qo,[t(u,{theme:"default",variant:"outline",ghost:!0},{default:n(()=>o[1]||(o[1]=[I("@didaoj-web")])),_:1})])]),E("p",Mo,[E("a",Ko,[t(u,{theme:"default",variant:"outline",ghost:!0},{default:n(()=>o[2]||(o[2]=[I("@didaoj-go")])),_:1})])])])])}}}),Go=ne(Fo,[["__scopeId","data-v-979fed79"]]),Qe=20,st=100,rt=50,No=te({__name:"ForceHiddenSidebarButton",setup(e){let a=nt();const l=p({x:window.innerWidth-st-Qe,y:window.innerHeight-rt-Qe}),s=p(window.innerWidth),o=p(window.innerHeight);let u=!1,v={x:0,y:0};const j=x=>{u=!0;const A=x.clientX??x.touches[0].clientX,L=x.clientY??x.touches[0].clientY;v={x:A-l.value.x,y:L-l.value.y},document.addEventListener("mousemove",k),document.addEventListener("touchmove",k),document.addEventListener("mouseup",f),document.addEventListener("touchend",f)},k=x=>{if(!u)return;const A=x.clientX??x.touches[0].clientX,L=x.clientY??x.touches[0].clientY;let T=A-v.x,C=L-v.y;T=Math.max(0,Math.min(T,s.value-st)),C=Math.max(0,Math.min(C,o.value-rt)),l.value={x:T,y:C}},f=()=>{u=!1,document.removeEventListener("mousemove",k),document.removeEventListener("touchmove",k),document.removeEventListener("mouseup",f),document.removeEventListener("touchend",f)},h=()=>{s.value=window.innerWidth,o.value=window.innerHeight,l.value={x:Math.min(l.value.x,s.value-st-Qe),y:Math.min(l.value.y,o.value-rt-Qe)}};let r=p(a.forceHiddenSidebar),_=p(a.forceHiddenSidebar);const b=()=>{r.value=!r.value,a.setForceHiddenSidebar(r.value)},y=()=>{_.value||(_.value=!0,a.setForceHiddenSidebar(r.value))},m=()=>{_.value&&(_.value=!1,a.setForceHiddenSidebar(!1))},c=x=>{x>=800?m():y()};return c(s.value),Le(s,x=>{c(x)}),le(()=>{window.addEventListener("resize",h)}),ke(()=>{window.removeEventListener("resize",h)}),(x,A)=>{const L=N;return me(_)?($(),G(L,{key:0,class:"draggable-button",style:zt({top:`${l.value.y}px`,left:`${l.value.x}px`}),onMousedown:j,onTouchstart:j,variant:"dashed",theme:"primary",onClick:b},{default:n(()=>[I(M(me(r)?"显示":"隐藏"),1)]),_:1},8,["style"])):re("",!0)}}}),Oo=ne(No,[["__scopeId","data-v-1aee5506"]]),et="DidaOJ",Ho=te({__name:"App",setup(e){const{globalProperties:a}=ce(),l=ea(),s=we(),o=Ee(),u=nt();l.$patch({Loaded:!1});const v=s.getToken,j=p(!1),k=p(!1);o.title&&o.title.length>0?document.title=o.title+" - "+et:document.title=et,o.$subscribe((_,b)=>{b.title&&b.title.length>0?document.title=b.title+" - "+et:document.title=et}),u.$subscribe((_,b)=>{j.value=b.showSidebar,k.value=j.value&&!b.forceHiddenSidebar});const f=fe(),h=Ve(()=>{const _=f.meta.auths;return _?!s.hasAllAuths(_):!1});function r(){a.$message.warning({duration:3e3,content:"登陆状态失效"}),l.$patch({Loaded:!0}),s.clear()}return le(()=>{if(v==""){l.$patch({Loaded:!0});return}fn().then(_=>{_.code==0?(s.loadResponse(_.data),l.$patch({Loaded:!0})):(O(a,_.code),l.$patch({Loaded:!0}),s.clear())}).catch(_=>{console.log(_),r()})}),(_,b)=>{const y=Ua,m=Ra,c=pt("RouterView"),x=Ea,A=Aa,L=qa;return $(),Z(ee,null,[t(A,null,{default:n(()=>[t(y,{class:"sh-header"},{default:n(()=>[t(Po)]),_:1}),t(A,null,{default:n(()=>[t(da,{name:"slide"},{default:n(()=>[k.value?($(),G(m,{key:0,class:"sh-sidebar"},{default:n(()=>[t(xo)]),_:1})):re("",!0)]),_:1}),t(A,{class:it(["sh-main-layout",{expanded:!k.value}])},{default:n(()=>[t(zo),t(x,{class:"sh-main-content"},{default:n(()=>[h.value?($(),G(Qt,{key:0})):($(),G(c,{key:1}))]),_:1}),t(Go)]),_:1},8,["class"])]),_:1})]),_:1}),j.value?($(),G(Oo,{key:0})):re("",!0),t(L,{container:"body",offset:["24px","80px"],size:"small"})],64)}}}),Bo=ne(Ho,[["__scopeId","data-v-9e122cb4"]]);Ka.registerLanguage("verilog",Fa);const ta=ma();ta.use(pa);const Ye=fa(Bo);Ye.use(ta);Ye.use(W);Ye.use(Ma);Ye.use(_a);Ye.mount("#app");rn().then(()=>{console.log("Text cache reinitialized")}).catch(e=>{console.error("Text cache reinitialization failed",e)});
