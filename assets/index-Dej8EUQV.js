import{bm as He,bn as Rt,bo as X,s as a,bp as n,bq as z,br as D,ap as k,n as Q,r as d,bs as le,bt as M,aD as ne,g as Et,o as te,bu as O,bv as ot,bw as qe,bx as lt,F as Z,by as ue,bz as ce,aM as At,bA as Ge,bB as Be,q as ge,y as Ve,J as ke,bC as st,c as be,a0 as Mt,bD as ze,u as Je,bE as je,ac as qt,bF as Ut,bG as Ht,bH as Nt,bI as Kt,B as Ot,bJ as Ft}from"./node_modules-CwWekrCs.js";import{R as fe,C as _e,a as se,B as K,F as Ce,b as Se,I as ve,L as rt,M as ut,c as it,S as Gt,H as Bt,d as Xt,e as Wt,f as pe,g as Jt,h as Yt,A as Zt,i as Qt,j as ea,T as Le,k as de,D as $e,l as De,m as ct,O as dt,n as Ye,P as ta,o as mt,p as pt,q as ft,r as aa,s as na,t as oa,u as la,v as sa,w as ra}from"./tdesign-vue-next-DqGW_ASx.js";import{V as ae}from"./vditor-DArazWIS.js";import{e as et}from"./monaco-editor-DCUKHC_e.js";import{H as ua,v as ia}from"./highlight.js-D9zWiMxS.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const C of u.addedNodes)C.tagName==="LINK"&&C.rel==="modulepreload"&&s(C)}).observe(document,{childList:!0,subtree:!0});function o(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function s(l){if(l.ep)return;l.ep=!0;const u=o(l);fetch(l.href,u)}})();var ye=(e=>(e.Manage="i-manage",e.ManageJudge="i-manage-judge",e.ManageProblem="i-manage-problem",e))(ye||{});const ca={"r-admin":["i-manage","i-manage-judge","i-manage-problem"]};function da(e){if(e==null)return[];const t=[];for(const o of e){const s=ca[o];s!=null&&t.push(...s)}return[...new Set(t)]}function ma(e,t){if(e==null||t==null)return!1;const o=da(e);for(const s of t)if(!o.includes(s))return!1;return!0}const me=He("user",{state:()=>({token:"",userId:-1,username:"",nickname:"",roles:[]}),getters:{getToken(){return this.token},getUserId(){return this.userId},getUsername(){return this.username},getNickname(){return this.nickname}},actions:{clear(){this.$patch({token:"",userId:-1,username:"",nickname:"",roles:[]})},loadResponse(e){this.$patch({token:e.token,userId:e.user_id,username:e.username,nickname:e.nickname,roles:e.roles})},isLogin(){return this.token!=null&&this.token!=""},hasAuth(e){return this.hasAllAuths([e])},hasAllAuths(e){return e?ma(this.roles,e):!0}},persist:!0}),pa="https://oj-api.didapipa.com/",W=Rt.create({baseURL:pa,timeout:6e4,withCredentials:!0,headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});W.interceptors.request.use(e=>{const o=me().getToken;return o&&(e.headers["X-Token"]=o),e},e=>Promise.reject(e));W.interceptors.response.use(function(e){return e.data},function(e){return Promise.reject(e)});function _t(e,t){return W({url:"/user/login",method:"post",data:{username:e,password:t}})}function fa(){return W({url:"/user/login/refresh",method:"post"})}const gt=He("login",{state:()=>({Loaded:!1}),getters:{isLoaded(){return this.Loaded}}}),xe=He("webStyle",{state:()=>({title:""}),getters:{getTitle(){return this.title}},actions:{setTitle(e){this.title=e}}}),Ne=He("sidebarStyle",{state:()=>({showSidebar:!1,forceHiddenSidebar:!1,menuActiveName:"",menuList:[]}),getters:{getMenuList(){return this.menuList}},actions:{setSidebarShow(e){this.showSidebar=e},setForceHiddenSidebar(e){this.forceHiddenSidebar=e},setMenuActiveName(e){this.menuActiveName=e},clearMenuList(){this.menuList=[]},setMenuList(e){this.menuList=e},addMenuList(e){this.menuList.push(e)}}}),J=(e,t)=>{const o=e.__vccOpts||e;for(const[s,l]of t)o[s]=l;return o},_a={},ga={class:"sh-main"};function va(e,t){const o=se,s=_e,l=fe;return z(),X("div",ga,[a(l,null,{default:n(()=>[a(s,{span:6},{default:n(()=>[a(o,{title:"正在完善，欢迎提供意见建议"},{default:n(()=>t[0]||(t[0]=[D("p",null,[D("a",{href:"https://codeoj.cn/",target:"_blank"},"CodeOJ"),k("的迁移计划")],-1),D("p",null,"正在开发中",-1)])),_:1})]),_:1})]),_:1})])}const ha=J(_a,[["render",va],["__scopeId","data-v-78f609f9"]]),ba={class:"sh-main"},ya=Q({__name:"View404",setup(e){let t=le(),o=d(t.fullPath);return(s,l)=>{const u=K;return z(),X("div",ba,[D("p",null,M(ne(o)),1),l[2]||(l[2]=D("p",null,"该页面无效或已被迁移，请重新选择访问目标",-1)),a(u,{theme:"primary",onClick:l[0]||(l[0]=()=>s.$router.push("/"))},{default:n(()=>l[1]||(l[1]=[k("返回首页")])),_:1})])}}}),vt=J(ya,[["__scopeId","data-v-d4218944"]]);let Xe=null;async function wa(){Xe=await Ca()}function ka(e,t="zh"){if(Xe==null)return[!1,e.toString()];const o=Xe[e.toString()];if(!o)return[!1,e.toString()];let s=o[t];return s||(t="zh",s=o[t]),s?[!0,s]:[!1,e.toString()]}async function Ca(){return new Promise((e,t)=>{e({404:{zh:"接口未找到"},1e3:{zh:"系统错误"},10001:{zh:"权限异常，请重新登陆后再试"},10002:{zh:"参数不符合要求"},10003:{zh:"未找到目标数据"},100001:{zh:"用户名不存在或密码不匹配"}})})}function oe(){const{appContext:e}=Et();return{globalProperties:e.config.globalProperties}}function we(){return 1e3}function ht(e,t,o=3e3){e.$message.success({duration:o,content:t})}function re(e,t,o=3e3){e.$message.info({duration:o,content:t})}function ie(e,t,o=3e3){e.$message.error({duration:o,content:t})}function H(e,t,o=3e3){const[s,l]=ka(t),u=s?l:`系统错误，错误提示[${l}]`;e.$message.error({duration:o,content:u})}const Sa={class:"dida-login-footer"},La=Q({__name:"LoginView",setup(e){const{globalProperties:t}=oe(),o=me(),s=d(!1),l=d({account:"",password:""}),u=()=>{re(t,"重置成功")},C=({validateResult:x,firstError:m})=>{s.value||_t(l.value.account,l.value.password).then(r=>{if(r.code===0){o.loadResponse(r.data),re(t,"登录成功");let p=t.$route.query.redirect_uri;p||(p="/user/"+r.data.username),t.$router.push({path:p})}else H(t,r.code)}).catch(r=>{console.error("Login error",r),ie(t,"登录失败")})};return te(()=>{if(o.isLogin()){t.$router.push({path:"/user"});return}}),(x,m)=>{const r=ve,p=Se,f=K,L=Ce,w=rt,j=se;return z(),O(j,{class:"yj-login-card",title:"欢迎使用DidaOJ~"},{default:n(()=>[a(L,{ref:"form",data:l.value,colon:!0,onReset:u,onSubmit:C,class:"yj-login-form","label-width":0},{default:n(()=>[a(p,{name:"account"},{default:n(()=>[a(r,{modelValue:l.value.account,"onUpdate:modelValue":m[0]||(m[0]=V=>l.value.account=V),clearable:"",placeholder:"请输入账户名"},{"prefix-icon":n(()=>[a(ne(ot))]),_:1},8,["modelValue"])]),_:1}),a(p,{name:"password"},{default:n(()=>[a(r,{modelValue:l.value.password,"onUpdate:modelValue":m[1]||(m[1]=V=>l.value.password=V),type:"password",clearable:"",placeholder:"请输入密码"},{"prefix-icon":n(()=>[a(ne(qe))]),_:1},8,["modelValue"])]),_:1}),a(p,null,{default:n(()=>[a(f,{theme:"primary",type:"submit",block:"",loading:s.value},{default:n(()=>m[4]||(m[4]=[k("登录")])),_:1},8,["loading"])]),_:1})]),_:1},8,["data"]),D("div",Sa,[a(w,{onClick:m[2]||(m[2]=()=>{ne(t).$router.push({name:"login-forget"})})},{default:n(()=>m[5]||(m[5]=[k("忘记密码")])),_:1}),a(w,{onClick:m[3]||(m[3]=()=>{ne(t).$router.push({name:"register"})})},{default:n(()=>m[6]||(m[6]=[k("注册账户")])),_:1})])]),_:1})}}}),Pa=J(La,[["__scopeId","data-v-9450941b"]]),Ta={};function Ia(e,t){return" TODO "}const Va=J(Ta,[["render",Ia]]),xa={class:"dida-login-footer"},ja=Q({__name:"RegisterView",setup(e){const{globalProperties:t}=oe(),o=me(),s=d(!1),l=d({account:"",password:"",confirmPassword:"",email:""}),u=()=>{re(t,"重置成功")},C=({validateResult:x,firstError:m})=>{s.value||_t(l.value.account,l.value.password).then(r=>{if(r.code===0){o.loadResponse(r.data),re(t,"登录成功");let p=t.$route.query.redirect_uri;p||(p="/user/"+r.data.username),t.$router.push({path:p})}else H(t,r.code)}).catch(r=>{console.error("Login error",r),ie(t,"登录失败")})};return te(()=>{if(o.isLogin()){t.$router.push({path:"/user"});return}}),(x,m)=>{const r=ve,p=Se,f=K,L=Ce,w=rt,j=se;return z(),O(j,{class:"yj-login-card",title:"欢迎使用DidaOJ~"},{default:n(()=>[a(L,{ref:"form",data:l.value,colon:!0,onReset:u,onSubmit:C,class:"yj-login-form","label-width":0},{default:n(()=>[a(p,{name:"account"},{default:n(()=>[a(r,{modelValue:l.value.account,"onUpdate:modelValue":m[0]||(m[0]=V=>l.value.account=V),clearable:"",placeholder:"请输入账户名"},{"prefix-icon":n(()=>[a(ne(ot))]),_:1},8,["modelValue"])]),_:1}),a(p,{name:"password"},{default:n(()=>[a(r,{modelValue:l.value.password,"onUpdate:modelValue":m[1]||(m[1]=V=>l.value.password=V),type:"password",clearable:"",placeholder:"请输入密码"},{"prefix-icon":n(()=>[a(ne(qe))]),_:1},8,["modelValue"])]),_:1}),a(p,{name:"confirm-password"},{default:n(()=>[a(r,{modelValue:l.value.confirmPassword,"onUpdate:modelValue":m[2]||(m[2]=V=>l.value.confirmPassword=V),type:"password",clearable:"",placeholder:"请确认密码"},{"prefix-icon":n(()=>[a(ne(qe))]),_:1},8,["modelValue"])]),_:1}),a(p,{name:"email"},{default:n(()=>[a(r,{modelValue:l.value.email,"onUpdate:modelValue":m[3]||(m[3]=V=>l.value.email=V),type:"password",clearable:"",placeholder:"邮箱"},{"prefix-icon":n(()=>[a(ne(qe))]),_:1},8,["modelValue"])]),_:1}),a(p,null,{default:n(()=>[a(f,{theme:"primary",type:"submit",block:"",loading:s.value},{default:n(()=>m[5]||(m[5]=[k("注册")])),_:1},8,["loading"])]),_:1})]),_:1},8,["data"]),D("div",xa,[a(w,{onClick:m[4]||(m[4]=()=>{ne(t).$router.push({name:"login"})})},{default:n(()=>m[6]||(m[6]=[k("返回登陆")])),_:1})])]),_:1})}}}),za=J(ja,[["__scopeId","data-v-e840b450"]]),Ze=[{name:"home",path:"/",title:"首页",showSidebar:!1,disableGenerateTab:!0,component:ha},{name:"problem",path:"/problem",title:"题目",icon:"dashboard",showSidebar:!0,redirect:"problem-list"},{name:"judge",path:"/judge",title:"评测",icon:"dashboard",showSidebar:!0,redirect:"judge-list"},{name:"contest",path:"/contest",title:"比赛",icon:"dashboard",showSidebar:!0,redirect:"contest-list"},{name:"contest-detail",title:"比赛",path:"/contest",showSidebar:!0,disableGenerateTab:!0,redirect:"contest-list"},{name:"discuss",title:"讨论",path:"/discuss",showSidebar:!0,redirect:"discuss-list"},{name:"manage",path:"/manage",title:"管理",icon:"dashboard",showSidebar:!0,redirect:"manage-judge",auths:[ye.Manage]},{name:"login",path:"/login",title:"登陆",showSidebar:!1,disableGenerateTab:!0,component:Pa},{name:"register",path:"/register",title:"注册",showSidebar:!1,disableGenerateTab:!0,component:za},{name:"user",path:"/user/:username+",title:"用户",showSidebar:!1,needLogin:!0,disableGenerateTab:!0,component:Va},{name:"404",path:"/404",title:"404",showSidebar:!1,disableGenerateTab:!0,component:vt}],$a=e=>Ze.find(t=>t.name==e),Da=e=>{const t=[];return Ze.forEach(o=>{!o.disableGenerateTab&&e.hasAllAuths(o.auths)&&t.push(o)}),t},Ra=e=>{Ze.forEach(t=>{const o={name:t.name,path:t.path,meta:{title:t.title,tab:t.name,showSidebar:t.showSidebar,needLogin:t.needLogin,redirect:t.redirect,tabAuths:t.auths},component:t.component};e.push(o)})},Ea=Q({__name:"HeaderContent",setup(e){const t=gt(),o=me(),{globalProperties:s}=oe(),l=d(t.isLoaded),u=d(!1),C=d(o.getUsername),x=d(o.getNickname),m=d(),r=()=>{m.value=Da(o)};t.$subscribe((L,w)=>{l.value=w.Loaded}),o.$subscribe((L,w)=>{C.value=w.username,x.value=w.nickname,u.value=w.token!="",r()});const p=()=>{s.$router.currentRoute.value.name!=="login"&&s.$router.push({name:"login",query:{redirect_uri:s.$router.currentRoute.value.fullPath}})},f=()=>{o.clear(),s.$message.success({duration:3e3,content:"注销成功"}),s.$router.push({path:"/login",query:{redirect_uri:s.$router.currentRoute.value.fullPath}})};return te(()=>{r()}),(L,w)=>{const j=lt("router-link"),V=it,E=ut,$=Gt,G=Bt;return z(),O(G,{modelValue:L.$route.meta.tab,"onUpdate:modelValue":w[0]||(w[0]=P=>L.$route.meta.tab=P),class:"sh-menu","expand-type":"popup"},{logo:n(()=>[a(j,{to:"/",class:"sh-logo"},{default:n(()=>w[1]||(w[1]=[k("DidaOJ")])),_:1})]),operations:n(()=>[l.value&&u.value?(z(),O($,{key:0,title:x.value},{icon:n(()=>[a(V,{name:"user"})]),default:n(()=>[a(E,{value:"user",to:{path:"/user/"+C.value}},{default:n(()=>w[2]||(w[2]=[k("个人空间")])),_:1},8,["to"]),a(E,{value:"user_logout",onClick:f},{default:n(()=>w[3]||(w[3]=[k(" 注销")])),_:1})]),_:1},8,["title"])):l.value?(z(),O(E,{key:2,value:"login",onClick:p},{icon:n(()=>[a(V,{name:"login"})]),default:n(()=>[w[5]||(w[5]=k(" 登录 "))]),_:1})):(z(),O(E,{key:1,value:"login"},{icon:n(()=>[a(V,{name:"login"})]),default:n(()=>[w[4]||(w[4]=k(" ... "))]),_:1}))]),default:n(()=>[(z(!0),X(Z,null,ue(m.value,P=>(z(),O(E,{key:P.name,value:P.name,to:{name:P.name}},{icon:n(()=>[P.icon?(z(),O(V,{key:0,name:P.icon},null,8,["name"])):ce("",!0)]),default:n(()=>[k(" "+M(P.title),1)]),_:2},1032,["value","to"]))),128))]),_:1},8,["modelValue"])}}}),Aa=J(Ea,[["__scopeId","data-v-a4891d9b"]]);function bt(e){return e.children!==void 0}function Ma(e){return e.children!==void 0}const qa={id:"menu-container"},Ua=Q({__name:"SidebarContent",setup(e){const t=Ne(),o=d(!1),s=d(null),l=d(t.menuActiveName),u=d(t.menuList),C=d([]),x=d(!1),m=()=>{l.value=t.menuActiveName;const p=JSON.stringify(u.value),f=JSON.stringify(t.menuList);p!==f&&(C.value.push([...t.menuList]),r())},r=async()=>{if(C.value.length>0&&!x.value){for(x.value=!0;C.value.length>1;)C.value.shift();const p=C.value.shift();o.value=p.length<=0,u.value=[],await ge(),s.value&&s.value.updateActiveName(),await new Promise(L=>setTimeout(L,300)),u.value=p,await ge(),s.value&&s.value.updateActiveName();const f=300;await new Promise(L=>setTimeout(L,f)),x.value=!1,await r()}};return t.$subscribe((p,f)=>{m()}),te(()=>{m()}),(p,f)=>{const L=it,w=ut,j=Wt,V=Xt,E=pe;return z(),X(Z,null,[D("div",qa,[a(V,{modelValue:l.value,"onUpdate:modelValue":f[0]||(f[0]=$=>l.value=$),theme:"light",class:"sh-menu-container"},{default:n(()=>[a(At,{name:"move-left"},{default:n(()=>[(z(!0),X(Z,null,ue(u.value,($,G)=>(z(),X(Z,{key:G},[ne(Ma)($)?(z(),O(j,{key:0,title:$.title},{default:n(()=>[(z(!0),X(Z,null,ue($.children,(P,I)=>(z(),O(w,{key:P.name,value:P.name,to:P.to},Ge({default:n(()=>[k(" "+M(P.title),1)]),_:2},[P.icon?{name:"icon",fn:n(()=>[a(L,{name:P.icon,class:Be(P.iconClass)},null,8,["name","class"])]),key:"0"}:void 0]),1032,["value","to"]))),128))]),_:2},1032,["title"])):(z(),O(w,{key:$.name,value:$.name,to:$.to},Ge({default:n(()=>[k(" "+M($.title),1)]),_:2},[$.icon?{name:"icon",fn:n(()=>[a(L,{name:$.icon,class:Be($.iconClass)},null,8,["name","class"])]),key:"0"}:void 0]),1032,["value","to"]))],64))),128))]),_:1})]),_:1},8,["modelValue"])]),a(E,{size:"small",loading:o.value,"show-overlay":!0,attach:"#menu-container",class:"sh-sidebar-loading",style:{"align-items":"flex-start","padding-top":"100px"}},null,8,["loading"])],64)}}}),Ha=J(Ua,[["__scopeId","data-v-96e2d89f"]]),Na={};function Ka(e,t){return null}const Oa=J(Na,[["render",Ka]]),Fa={class:"footer"},Ga={class:"footer-left"},Ba={class:"foot-time"},Xa={class:"footer-center"},Wa={href:"https://boiltask.com",target:"_blank"},Ja={class:"footer-right"},Ya={class:"foot-text"},Za={href:"https://github.com/hpu-user/DiDaOJ-web",target:"_blank"},Qa=Q({__name:"FooterContent",setup(e){const t=d("");function o(){t.value=new Date().toLocaleString()}return te(()=>{o(),setInterval(()=>{o()},1e3)}),(s,l)=>{const u=K;return z(),X("div",Fa,[D("div",Ga,[D("p",Ba,M(t.value),1)]),D("div",Xa,[D("a",Wa,[a(u,{theme:"default",variant:"outline",ghost:!0},{default:n(()=>l[0]||(l[0]=[k("@BoilTask")])),_:1})])]),D("div",Ja,[D("p",Ya,[D("a",Za,[a(u,{theme:"default",variant:"outline",ghost:!0},{default:n(()=>l[1]||(l[1]=[k("@didaoj-web")])),_:1})])])])])}}}),en=J(Qa,[["__scopeId","data-v-400ac98b"]]),Ae=20,Oe=100,Fe=50,tn=Q({__name:"ForceHiddenSidebarButton",setup(e){let t=Ne();const o=d({x:window.innerWidth-Oe-Ae,y:window.innerHeight-Fe-Ae}),s=d(window.innerWidth),l=d(window.innerHeight);let u=!1,C={x:0,y:0};const x=$=>{u=!0;const G=$.clientX??$.touches[0].clientX,P=$.clientY??$.touches[0].clientY;C={x:G-o.value.x,y:P-o.value.y},document.addEventListener("mousemove",m),document.addEventListener("touchmove",m),document.addEventListener("mouseup",r),document.addEventListener("touchend",r)},m=$=>{if(!u)return;const G=$.clientX??$.touches[0].clientX,P=$.clientY??$.touches[0].clientY;let I=G-C.x,T=P-C.y;I=Math.max(0,Math.min(I,s.value-Oe)),T=Math.max(0,Math.min(T,l.value-Fe)),o.value={x:I,y:T}},r=()=>{u=!1,document.removeEventListener("mousemove",m),document.removeEventListener("touchmove",m),document.removeEventListener("mouseup",r),document.removeEventListener("touchend",r)},p=()=>{s.value=window.innerWidth,l.value=window.innerHeight,o.value={x:Math.min(o.value.x,s.value-Oe-Ae),y:Math.min(o.value.y,l.value-Fe-Ae)}};let f=d(t.forceHiddenSidebar),L=d(t.forceHiddenSidebar);const w=()=>{f.value=!f.value,t.setForceHiddenSidebar(f.value)},j=()=>{L.value||(L.value=!0,t.setForceHiddenSidebar(f.value))},V=()=>{L.value&&(L.value=!1,t.setForceHiddenSidebar(!1))},E=$=>{$>=800?V():j()};return E(s.value),Ve(s,$=>{E($)}),te(()=>{window.addEventListener("resize",p)}),ke(()=>{window.removeEventListener("resize",p)}),($,G)=>{const P=K;return ne(L)?(z(),O(P,{key:0,class:"draggable-button",style:st({top:`${o.value.y}px`,left:`${o.value.x}px`}),onMousedown:x,onTouchstart:x,variant:"dashed",theme:"primary",onClick:w},{default:n(()=>[k(M(ne(f)?"显示":"隐藏"),1)]),_:1},8,["style"])):ce("",!0)}}}),an=J(tn,[["__scopeId","data-v-1aee5506"]]),nn={class:"sh-main"},on=Q({__name:"View403",setup(e){let t=le();const o=d("");return te(()=>{t.query.target?o.value=t.query.target:o.value=t.fullPath}),(s,l)=>{const u=K;return z(),X("div",nn,[D("p",null,M(o.value),1),l[2]||(l[2]=D("p",null,"该页面无访问权限，请更换访问目标或重新登陆后再试",-1)),a(u,{theme:"primary",onClick:l[0]||(l[0]=()=>s.$router.push("/"))},{default:n(()=>l[1]||(l[1]=[k("返回首页")])),_:1})])}}}),yt=J(on,[["__scopeId","data-v-8f62f1f8"]]),Me="DidaOJ",ln=Q({__name:"App",setup(e){const{globalProperties:t}=oe(),o=gt(),s=me(),l=xe(),u=Ne();o.$patch({Loaded:!1});const C=s.getToken,x=d(!1),m=d(!1);l.title&&l.title.length>0?document.title=l.title+" - "+Me:document.title=Me,l.$subscribe((L,w)=>{w.title&&w.title.length>0?document.title=w.title+" - "+Me:document.title=Me}),u.$subscribe((L,w)=>{x.value=w.showSidebar,m.value=x.value&&!w.forceHiddenSidebar});const r=le(),p=be(()=>{const L=r.meta.auths;return L?!s.hasAllAuths(L):!1});function f(){t.$message.warning({duration:3e3,content:"登陆状态失效"}),o.$patch({Loaded:!0}),s.clear()}return te(()=>{if(C==""){o.$patch({Loaded:!0});return}fa().then(L=>{L.code==0?(s.loadResponse(L.data),o.$patch({Loaded:!0})):(H(t,L.code),o.$patch({Loaded:!0}),s.clear())}).catch(L=>{console.log(L),f()})}),(L,w)=>{const j=Jt,V=Zt,E=lt("RouterView"),$=Qt,G=Yt,P=ea;return z(),X(Z,null,[a(G,null,{default:n(()=>[a(j,{class:"sh-header"},{default:n(()=>[a(Aa)]),_:1}),a(G,null,{default:n(()=>[a(Mt,{name:"slide"},{default:n(()=>[m.value?(z(),O(V,{key:0,class:"sh-sidebar"},{default:n(()=>[a(Ha)]),_:1})):ce("",!0)]),_:1}),a(G,{class:Be(["sh-main-layout",{expanded:!m.value}])},{default:n(()=>[a(Oa),a($,{class:"sh-main-content"},{default:n(()=>[p.value?(z(),O(yt,{key:0})):(z(),O(E,{key:1}))]),_:1}),a(en)]),_:1},8,["class"])]),_:1})]),_:1}),x.value?(z(),O(an,{key:0})):ce("",!0),a(P,{container:"body",offset:["24px","80px"],size:"small"})],64)}}}),sn=J(ln,[["__scopeId","data-v-851fc4f3"]]);var wt=(e=>(e[e.Unknown=-1]="Unknown",e[e.C=0]="C",e[e.Cpp=1]="Cpp",e[e.Java=2]="Java",e[e.Python=3]="Python",e[e.Pascal=4]="Pascal",e[e.Golang=5]="Golang",e[e.Max=6]="Max",e))(wt||{});function kt(){const e=[-1,4,5,6];return Object.values(wt).filter(t=>typeof t=="number"&&!e.includes(t)).map(t=>({value:t,label:Ct(t)}))}function rn(e){return e>-1&&e<6}function Ct(e){switch(e){case 0:return"C";case 1:return"C++";case 2:return"Java";case 3:return"Python";case 4:return"Pascal";case 5:return"Golang";default:return"Unknown"}}function Qe(e){switch(e){case 0:return"c";case 1:return"cpp";case 2:return"java";case 3:return"python";case 4:return"pascal";case 5:return"golang";default:return"text"}}var Y=(e=>(e[e.Init=0]="Init",e[e.Rejudge=1]="Rejudge",e[e.Submitting=2]="Submitting",e[e.Queuing=3]="Queuing",e[e.Compiling=4]="Compiling",e[e.Running=5]="Running",e[e.Accept=6]="Accept",e[e.PE=7]="PE",e[e.WA=8]="WA",e[e.TLE=9]="TLE",e[e.MLE=10]="MLE",e[e.OLE=11]="OLE",e[e.RE=12]="RE",e[e.CE=13]="CE",e[e.CLE=14]="CLE",e[e.JudgeFail=15]="JudgeFail",e[e.SubmitFail=16]="SubmitFail",e[e.Unknown=17]="Unknown",e))(Y||{});const un=e=>{switch(e){case 0:return"普通评测";case 1:return"特殊评测";default:return"未知"}},Ue=e=>{switch(e){case 0:return"等待处理";case 1:return"重新评测";case 2:return"提交中";case 3:return"队列中";case 4:return"编译中";case 5:return"运行中";case 6:return"通过";case 7:return"格式错误";case 8:return"答案错误";case 9:return"超时";case 10:return"内存超限";case 11:return"输出超限";case 12:return"运行错误";case 13:return"编译错误";case 14:return"编译超限";case 15:return"评测失败";case 16:return"提交失败";case 17:return"未知";default:return e}};function cn(){const e=[17];return Object.values(Y).filter(t=>typeof t=="number"&&!e.includes(t)).map(t=>({value:t,label:Ue(t)}))}function Te(e){switch(e){case 0:case 1:case 2:case 3:case 4:case 5:return!0;default:return!1}}function St(e){var o;const t={};if(t.id=e.id,t.problemId=e.problem_id,t.status=e.status,Te(e.status)?t.score="-":t.score=e.score.toString(),e.time?t.time=Math.ceil(e.time/1e6)+"ms":t.time="-",e.memory?t.memory=(e.memory/1024/1024).toFixed(2)+"MB":t.memory="-",t.language=Ct(e.language),t.codeLength=e.code_length,e.approve_time?t.approveTime=new Date(e.approve_time).toLocaleString():t.approveTime="-",t.author=e.author,t.authorUsername=e.author_username,t.authorNickname=e.author_nickname,t.code=e.code,t.compileMessage=e.compile_message,t.taskCurrent=e.task_current,t.taskTotal=e.task_total,t.task=[],e.task)for(let s=0;s<((o=e.task)==null?void 0:o.length);s++){const l=e.task[s],u={};u.taskId=l.task_id,u.status=l.status,l.time?u.time=Math.ceil(l.time/1e6)+"ms":u.time="-",l.memory?u.memory=(l.memory/1024/1024).toFixed(2)+"MB":u.memory="-",u.score=l.score,u.content=l.content,u.waHint=l.wa_hint,!u.content&&!u.waHint&&(u.content="无提示信息"),t.task.push(u)}return t}function dn(e,t,o){return W({url:"/judge/approve",method:"post",data:{problem_id:e,language:t,code:o}})}function Lt(e){return W({url:"/judge?id="+e,method:"get"})}function mn(e,t,o,s,l,u){const C=new URLSearchParams({problem_id:e,username:t,language:String(o),status:String(s),page:String(l),page_size:String(u)});return W({url:`/judge/list?${C.toString()}`,method:"get"})}function pn(){return W({url:"/judge/rejudge/recently",method:"post"})}function fn(e){return W({url:"/judge/rejudge/problem",method:"post",data:{id:e}})}function _n(){return W({url:"/judge/rejudge/all",method:"post",timeout:0})}function gn(e){return W({url:"/judge/rejudge",method:"post",data:{id:e}})}var We=(e=>(e[e.None=0]="None",e[e.Attempt=1]="Attempt",e[e.Accept=2]="Accept",e))(We||{});function Ke(e,t){const o={};if(o.id=e.id,o.author=e.author,o.title=e.title,o.tags=[],e.tags)for(const s of e.tags){const l=t[s];l&&o.tags.push(l)}return o.accept=e.accept,o.attempt=e.attempt,e.description!=null&&(o.description=e.description),e.time_limit!=null&&(o.timeLimit=e.time_limit.toString()+" ms"),e.memory_limit!=null&&(o.memoryLimit=(e.memory_limit/1024).toFixed(2)+" MB"),e.judge_type!=null&&(o.judgeType=un(e.judge_type)),e.insert_time!=null&&(o.insertTime=new Date(e.insert_time).toLocaleString()),e.update_time!=null&&(o.updateTime=new Date(e.update_time).toLocaleString()),e.creator_nickname!=null&&(o.creatorNickname=e.creator_nickname),e.source!=null&&(o.source=e.source),e.judge_md5!=null&&(o.judgeMd5=e.judge_md5),o}function Pt(e){return W({url:"/problem?id="+e,method:"get"})}function Tt(e){return W({url:"/problem/tag/list?max_count="+e,method:"get"})}function vn(e){return W({url:"/problem/judge?id="+e,method:"get"})}function hn(e,t,o,s){return W({url:"/problem/list?title="+e+"&tag="+t+"&page="+o+"&page_size="+s,method:"get"})}function bn(e,t,o,s,l,u,C){return W({url:"/problem/edit",method:"post",data:{id:e,title:t,time_limit:o,memory_limit:s,source:l,tags:u,description:C}})}function yn(e,t){return W({url:"/problem/judge/data/download?id="+e+"&key="+t,method:"get"})}function wn(e,t){const o=new FormData;return o.append("id",e),o.append("zip",t),W({url:"/problem/judge/data",method:"post",data:o,headers:{"Content-Type":"multipart/form-data"},timeout:1e3*60*5})}const kn={style:{margin:"10px"}};function Cn(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Je(e)}const Sn=Q({__name:"ProblemList",setup(e){const t=le(),o=ze(),{globalProperties:s}=oe();let l=null;const u=d(!1),C={};let x={};const m=d([{title:"ID",colKey:"id",cell:(i,y)=>{let c=$(y.row.id);return a(K,{variant:"dashed",theme:c,onClick:()=>E(y.row.id)},{default:()=>[y.row.id]})}},{title:"标题",colKey:"title",cell:(i,y)=>a(K,{variant:"text",onClick:()=>E(y.row.id)},{default:()=>[y.row.title]})},{title:"标签",colKey:"tags",cell:(i,y)=>{const c=y.row.tags;if(!c||c.length===0)return"";let S=[];for(let v=0;v<c.length;v++){const _=c[v];S.push(a(K,{key:v,theme:"default",variant:"outline"},{default:()=>[_.name]}))}return a(de,null,Cn(S)?S:{default:()=>[S]})}},{title:"正确",colKey:"accept"},{title:"提交",colKey:"attempt"}]),r=d(!1);let p=1,f=50;const L=d({defaultPageSize:f,defaultCurrent:p,total:0,pageSizeOptions:[50,100]}),w=d(),j=d(),V=d({title:"",tag:""}),E=i=>{i&&o.push({path:"/problem/"+i})},$=i=>{if(!i||!x)return"default";const y=x[i];if(!y)return"default";switch(y){case We.Accept:return"success";case We.Attempt:return"warning";default:return"default"}},G=async()=>{await o.push({query:{...t.query,title:V.value.title,tag:V.value.tag,page:1,page_size:L.value.defaultPageSize}})},P=i=>{i&&o.push({query:{...t.query,title:"",tag:i.name,page:1,page_size:L.value.defaultPageSize}})},I=async(i,y)=>{r.value=!0;try{const{current:c,pageSize:S}=i,v=await hn(V.value.title,V.value.tag,c,S);if(w.value=[],v.code===0){const _=v.data.list;if(!_||_.length<=0){L.value={...L.value,total:0},x=null,re(s,"未找到记录");return}_.forEach(g=>{var R;const h=Ke(g,C);(R=w.value)==null||R.push(h)}),L.value={...L.value,total:v.data.total_count},x=v.data.problem_attempt_status}else y&&H(s,v.code)}catch(c){console.error(c),H(s,we())}finally{r.value=!1}},T=async i=>{await o.push({query:{...t.query,page:i.current,page_size:i.pageSize}})};return te(async()=>{r.value=!0,j.value=[],Tt(-1).then(i=>{if(i.code===0){j.value=i.data.list,u.value=i.data.total_count>i.data.list.length;for(let y=0;y<i.data.list.length;y++){const c=i.data.list[y];C[c.id]=c}l=Ve(()=>t.query,y=>{V.value.title=y.title||"",V.value.tag=y.tag||"";const c=parseInt(y.page)||L.value.defaultCurrent,S=parseInt(y.page_size)||L.value.defaultPageSize;p=c,f=S,L.value={...L.value,current:p,pageSize:f},I({current:p,pageSize:f},!0)},{immediate:!0})}else u.value=!0}).catch(i=>{console.error(i),u.value=!0})}),ke(()=>{l&&l()}),(i,y)=>{const c=Le,S=se,v=_e,_=ve,g=Se,h=K,R=Ce,U=fe;return z(),O(U,null,{default:n(()=>[a(v,{span:9},{default:n(()=>[a(S,{style:{margin:"10px"}},{default:n(()=>[a(c,{data:w.value,columns:m.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:L.value,loading:r.value,onPageChange:T},null,8,["data","columns","pagination","loading"])]),_:1})]),_:1}),a(v,{span:3},{default:n(()=>[D("div",kn,[a(S,{class:"sh-card"},{default:n(()=>[a(R,{model:V.value},{default:n(()=>[a(g,{label:"标题"},{default:n(()=>[a(_,{modelValue:V.value.title,"onUpdate:modelValue":y[0]||(y[0]=A=>V.value.title=A),placeholder:"暂不支持模糊查询"},null,8,["modelValue"])]),_:1}),a(g,{label:"标签"},{default:n(()=>[a(_,{modelValue:V.value.tag,"onUpdate:modelValue":y[1]||(y[1]=A=>V.value.tag=A),placeholder:"暂不支持模糊查询"},null,8,["modelValue"])]),_:1}),a(g,null,{default:n(()=>[a(h,{theme:"primary",onClick:G},{default:n(()=>y[3]||(y[3]=[k("搜索")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(S,{class:"sh-card sh-background-black"},{default:n(()=>[(z(!0),X(Z,null,ue(j.value,A=>(z(),O(h,{class:"sh-tag-button",theme:"default",variant:"outline",ghost:!0,onClick:()=>P(A)},{default:n(()=>[k(M(A.name),1)]),_:2},1032,["onClick"]))),256)),u.value?(z(),O(h,{key:0,class:"sh-tag-button",theme:"default",variant:"outline",ghost:!0,onClick:y[2]||(y[2]=()=>i.$router.push("/problem/tags"))},{default:n(()=>y[4]||(y[4]=[k(" ... ")])),_:1})):ce("",!0)]),_:1})])]),_:1})]),_:1})}}}),Ln=J(Sn,[["__scopeId","data-v-6d4b777e"]]);function Ie(e){e.querySelectorAll("pre > code:not([data-copy-attached])").forEach(o=>{o.setAttribute("data-copy-attached","true");const s=o.parentElement,l=document.createElement("div");l.className="copy-wrapper";const u=document.createElement("button");u.className="copy-btn",u.innerText="复制",u.addEventListener("click",async()=>{try{await navigator.clipboard.writeText(o.innerText),u.innerText="已复制",setTimeout(()=>u.innerText="复制",1500)}catch{u.innerText="失败"}}),s.replaceWith(l),l.appendChild(u),l.appendChild(s)})}const Pn=["innerHTML"],Tn={style:{margin:"12px"}},In={key:0,class:"dida-edit-container"},Vn={class:"dida-operation-container"},xn={class:"dida-code-submit-div"},jn=Q({__name:"ProblemDetail",setup(e){let t=le();const{globalProperties:o}=oe(),s=xe(),l=me();let u=d("");const C=d(""),x=d(null),m=d(!1),r=d(null);let p=null;const f=d(null),L={},w=d(""),j=d([]);j.value=kt();const V=be(()=>l.hasAuth(ye.ManageProblem)),E=y=>{y&&B.push({name:"problem-list",query:{...t.query,title:"",tag:y.name}})},$=()=>{B.push({name:"manage-problem",params:{problemId:C.value}})},G=()=>{B.push({name:"judge-list",query:{problem_id:C.value}})},P=()=>{},I=()=>{B.push({name:"problem-recommend",params:{problemId:C.value}})},T=async()=>{if(!C.value){ie(o,"问题ID无效");return}const y=parseInt(w.value);if(!rn(y)){ie(o,"请选择所编写的语言");return}const c=p==null?void 0:p.getValue();if(!c){ie(o,"请输入所需提交的代码");return}const S=await dn(C.value,y,c);if(S.code!==0){H(o,S.code);return}re(o,"提交成功，正在跳转到详情页面");const v=S.data.id;await B.push({path:"/judge/"+v})},i=y=>{p&&et.setModelLanguage(p.getModel(),Qe(y))};return te(async()=>{if(Array.isArray(t.params.problemId)?C.value=t.params.problemId[0]:C.value=t.params.problemId,!C.value){ie(o,"题目不存在"),await B.push({name:"problem"});return}m.value=!0;const y=await Pt(C.value);if(y.code!==0){m.value=!1,H(o,y.code),await B.push({name:"problem"});return}y.data.tags&&y.data.tags.forEach(v=>{L[v.id]=v}),r.value=Ke(y.data.problem,L),s.setTitle(r.value.title+" - "+s.getTitle);let c=r.value.description;const S={math:{inlineDigit:!0,engine:"KaTeX"}};u.value=await ae.md2html(c,S),await ge(()=>{x.value&&(ae.mathRender(x.value),ae.highlightRender({lineNumber:!0,enable:!0},x.value),Ie(x.value),f.value&&(p=et.create(f.value,{value:"",language:"cpp",minimap:{enabled:!0},colorDecorators:!0,readOnly:!1,theme:"vs-dark"}))),m.value=!1})}),(y,c)=>{const S=se,v=_e,_=K,g=De,h=de,R=$e,U=dt,A=ct,F=fe,q=pe;return z(),O(q,{loading:m.value},{default:n(()=>[a(F,{class:"dida-main-content"},{default:n(()=>[a(v,{span:8},{default:n(()=>[a(S,{style:{margin:"10px"}},{default:n(()=>[D("div",{innerHTML:ne(u),ref_key:"markdownRef",ref:x},null,8,Pn)]),_:1})]),_:1}),a(v,{span:4},{default:n(()=>[D("div",Tn,[V.value?(z(),X("div",In,[a(_,{onClick:$},{default:n(()=>c[1]||(c[1]=[k("编辑")])),_:1})])):ce("",!0),a(R,{layout:"vertical",bordered:!0},{default:n(()=>[a(g,{label:"标题"},{default:n(()=>{var b;return[k(M((b=r.value)==null?void 0:b.title),1)]}),_:1}),a(g,{label:"时间限制"},{default:n(()=>{var b;return[k(M((b=r.value)==null?void 0:b.timeLimit),1)]}),_:1}),a(g,{label:"内存限制"},{default:n(()=>{var b;return[k(M((b=r.value)==null?void 0:b.memoryLimit),1)]}),_:1}),a(g,{label:"判题方式"},{default:n(()=>{var b;return[k(M((b=r.value)==null?void 0:b.judgeType),1)]}),_:1}),a(g,{label:"正确提交"},{default:n(()=>{var b;return[k(M((b=r.value)==null?void 0:b.accept),1)]}),_:1}),a(g,{label:"提交总数"},{default:n(()=>{var b;return[k(M((b=r.value)==null?void 0:b.attempt),1)]}),_:1}),a(g,{label:"创建时间"},{default:n(()=>{var b;return[k(M((b=r.value)==null?void 0:b.insertTime),1)]}),_:1}),a(g,{label:"更新时间"},{default:n(()=>{var b;return[k(M((b=r.value)==null?void 0:b.updateTime),1)]}),_:1}),a(g,{label:"上传用户"},{default:n(()=>{var b;return[k(M((b=r.value)==null?void 0:b.creatorNickname),1)]}),_:1}),a(g,{label:"题目来源"},{default:n(()=>{var b;return[k(M((b=r.value)==null?void 0:b.source),1)]}),_:1}),a(g,{label:"标签"},{default:n(()=>[a(h,null,{default:n(()=>{var b;return[(z(!0),X(Z,null,ue((b=r.value)==null?void 0:b.tags,N=>(z(),O(_,{key:N.id,variant:"dashed",onClick:()=>E(N)},{default:n(()=>[k(M(N.name),1)]),_:2},1032,["onClick"]))),128))]}),_:1})]),_:1})]),_:1}),D("div",Vn,[a(h,null,{default:n(()=>[a(_,{onClick:G},{default:n(()=>c[2]||(c[2]=[k("提交记录")])),_:1}),a(_,{onClick:P},{default:n(()=>c[3]||(c[3]=[k("题目讨论")])),_:1}),a(_,{onClick:I},{default:n(()=>c[4]||(c[4]=[k("题目推荐")])),_:1})]),_:1})]),D("div",xn,[a(h,null,{default:n(()=>[a(A,{modelValue:w.value,"onUpdate:modelValue":c[0]||(c[0]=b=>w.value=b),label:"语言：",placeholder:"请选择提交语言","auto-width":"",clearable:"",onChange:i},{default:n(()=>[(z(!0),X(Z,null,ue(j.value,b=>(z(),O(U,{key:b.value,value:b.value,label:b.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"]),a(_,{onClick:T},{default:n(()=>c[5]||(c[5]=[k("提交")])),_:1})]),_:1}),D("div",{ref_key:"codeEditRef",ref:f,class:"dida-code-editor"},null,512)])])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),zn=J(jn,[["__scopeId","data-v-6e73045f"]]),$n={};function Dn(e,t){return" TODO "}const Rn=J($n,[["render",Dn]]),En=["innerHTML"];function An(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Je(e)}const Mn=Q({__name:"JudgeJobList",setup(e){const t=le(),o=ze(),{globalProperties:s}=oe();let l=!1,u=null;const C=d(!1),x=d(""),m=d(""),r=d(null),p=d(!1),f=d({problemId:"",username:"",language:void 0,status:void 0}),L=d([{title:"ID",colKey:"id",cell:(g,h)=>a(K,{variant:"text",onClick:()=>i(h.row.id)},{default:()=>[h.row.id]})},{title:"问题",colKey:"problemId",cell:(g,h)=>a(K,{variant:"text",onClick:()=>T(h.row.problemId)},{default:()=>[h.row.problemId]})},{title:"状态",colKey:"status",align:"center",cell:(g,h)=>{const R=h.row.status,U=Ue(R);let A;switch(R){case Y.Init:case Y.Rejudge:case Y.Compiling:case Y.Running:A="default";break;case Y.Accept:A="success";break;case Y.PE:A="warning";break;default:A="danger";break}let F=[];return Te(R)&&F.push(a(pe,{text:h.row.state,size:"small",class:"dida-status-loading"},null)),F.push(a("span",null,[U])),a(K,{theme:A,variant:"outline",onClick:()=>i(h.row.id)},An(F)?F:{default:()=>[F]})}},{title:"分数",colKey:"score"},{title:"时间",colKey:"time"},{title:"内存",colKey:"memory"},{title:"代码",colKey:"code",cell:(g,h)=>a(K,{theme:"default",onClick:()=>I(h.row.id)},{default:()=>[h.row.language+" / "+h.row.codeLength]})},{title:"作者",colKey:"author",width:200,cell:(g,h)=>a(K,{variant:"text",onClick:()=>y(h.row.authorUsername)},{default:()=>[h.row.authorNickname]})},{title:"提交时间",colKey:"approveTime",width:180}]),w=d(!1);let j=1,V=50;const E=d({current:j,pageSize:V,defaultCurrent:j,defaultPageSize:V,total:0,pageSizeOptions:[50,100]}),$=d(),G=d([]);G.value=kt();const P=d([]);P.value=cn();const I=async g=>{if(g){p.value=!0,C.value=!0,x.value=g,m.value="";try{const h=await Lt(g);if(h.code===0){const R=h.data,A=`\`\`\`${Qe(R.language)}
${R.code}
\`\`\``,F={};m.value=await ae.md2html(A,F),await ge(()=>{r.value&&(ae.highlightRender({lineNumber:!0,enable:!0},r.value),Ie(r.value))})}else H(s,h.code)}finally{p.value=!1}}},T=g=>{g&&o.push({path:"/problem/"+g})},i=g=>{g&&o.push({path:"/judge/"+g})},y=g=>{g&&o.push({path:"/user/"+g})},c=async()=>{await o.push({query:{...t.query,page:1,page_size:V,problem_id:f.value.problemId,username:f.value.username,language:f.value.language,status:f.value.status}})},S=async()=>{f.value.problemId="",f.value.username="",f.value.language=void 0,f.value.status=void 0,await o.push({query:{...t.query,page:1,page_size:V,problem_id:"",username:"",language:void 0,status:void 0}})},v=async(g,h)=>{h&&(w.value=!0);let R=!1;try{const{current:U,pageSize:A}=g,F=await mn(f.value.problemId,f.value.username,f.value.language,f.value.status,U,A);$.value=[],F.code===0?F.data.list&&F.data.list.length>0?(F.data.list.forEach(b=>{var Pe;const N=St(b);(Pe=$.value)==null||Pe.push(N),Te(b.status)&&(R=!0)}),E.value={...E.value,total:F.data.total_count}):(re(s,"未找到记录"),E.value={...E.value,total:0}):h&&H(s,F.code)}catch(U){console.error(U),h&&H(s,we())}finally{h&&(w.value=!1),R&&l&&setTimeout(()=>{v({current:j,pageSize:V},!1)},5e3)}},_=async g=>{await o.push({query:{...t.query,page:g.current,page_size:g.pageSize}})};return te(async()=>{l=!0,u=Ve(()=>t.query,g=>{f.value.problemId=g.problem_id||"",f.value.username=g.username||"",g.language!=null?f.value.language=Number(g.language):f.value.language=void 0,g.status!=null?f.value.status=Number(g.status):f.value.status=void 0;const h=parseInt(g.page)||E.value.defaultCurrent,R=parseInt(g.page_size)||E.value.defaultPageSize;j=h,V=R,E.value.pageSizeOptions.includes(V)||(V=E.value.defaultPageSize),E.value={...E.value,current:j,pageSize:V},v({current:j,pageSize:V},!0)},{immediate:!0})}),ke(()=>{l=!1,u&&u()}),(g,h)=>{const R=ve,U=Se,A=dt,F=ct,q=K,b=de,N=Ce,Pe=Le,zt=se,$t=pe,Dt=Ye;return z(),X(Z,null,[a(zt,{style:{margin:"10px"}},{default:n(()=>[a(N,{layout:"inline",onSubmit:c,onReset:S},{default:n(()=>[a(U,{label:"题号"},{default:n(()=>[a(R,{modelValue:f.value.problemId,"onUpdate:modelValue":h[0]||(h[0]=ee=>f.value.problemId=ee),placeholder:"请输入完整题号"},null,8,["modelValue"])]),_:1}),a(U,{label:"用户"},{default:n(()=>[a(R,{modelValue:f.value.username,"onUpdate:modelValue":h[1]||(h[1]=ee=>f.value.username=ee),placeholder:"仅支持输入完整用户名"},null,8,["modelValue"])]),_:1}),a(U,{label:"语言"},{default:n(()=>[a(F,{modelValue:f.value.language,"onUpdate:modelValue":h[2]||(h[2]=ee=>f.value.language=ee),placeholder:"请选择提交语言","auto-width":"",clearable:""},{default:n(()=>[(z(!0),X(Z,null,ue(G.value,ee=>(z(),O(A,{key:ee.value,value:ee.value,label:ee.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(U,{label:"状态"},{default:n(()=>[a(F,{modelValue:f.value.status,"onUpdate:modelValue":h[3]||(h[3]=ee=>f.value.status=ee),placeholder:"请选择评测状态","auto-width":"",clearable:""},{default:n(()=>[(z(!0),X(Z,null,ue(P.value,ee=>(z(),O(A,{key:ee.value,value:ee.value,label:ee.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(U,null,{default:n(()=>[a(b,null,{default:n(()=>[a(q,{theme:"primary",type:"submit"},{default:n(()=>h[6]||(h[6]=[k("搜索")])),_:1}),a(q,{theme:"default",variant:"base",type:"reset"},{default:n(()=>h[7]||(h[7]=[k("重置")])),_:1})]),_:1})]),_:1})]),_:1}),a(Pe,{data:$.value,columns:L.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:E.value,loading:w.value,onPageChange:_},null,8,["data","columns","pagination","loading"])]),_:1}),a(Dt,{visible:C.value,"onUpdate:visible":h[4]||(h[4]=ee=>C.value=ee),header:x.value,width:"800px","cancel-btn":null,"close-btn":!1,onConfirm:h[5]||(h[5]=ee=>C.value=!1)},{default:n(()=>[a($t,{loading:p.value},{default:n(()=>[D("div",{innerHTML:m.value,ref_key:"markdownCodeRef",ref:r,style:{"min-height":"100px"}},null,8,En)]),_:1},8,["loading"])]),_:1},8,["visible","header"])],64)}}}),qn=J(Mn,[["__scopeId","data-v-6953f5a5"]]),Un=["innerHTML"],Hn={key:2,class:"dida-edit-container"};function tt(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Je(e)}const Nn=Q({__name:"JudgeJobDetail",setup(e){const t=le(),o=ze(),s=me(),{globalProperties:l}=oe();let u=!1,C=-1;const x=d(null),m=d(""),r=d(null),p=d(0),f=d(null),L=d({from:"#5a96ff",to:"#00A870"});let w=!1;const j=d([{title:"ID",colKey:"id"},{title:"问题",colKey:"problemId",cell:(c,S)=>a(K,{variant:"text",onClick:()=>I(S.row.problemId)},{default:()=>[S.row.problemId]})},{title:"状态",colKey:"status",align:"center",cell:(c,S)=>{const v=S.row.status,_=Ue(v);let g;switch(v){case Y.Init:case Y.Rejudge:case Y.Compiling:case Y.Running:g="default";break;case Y.Accept:g="success";break;case Y.PE:g="warning";break;default:g="danger";break}let h=[];return Te(v)&&h.push(a(pe,{text:S.row.state,size:"small",class:"dida-status-loading"},null)),h.push(a("span",null,[_])),a(K,{theme:g,variant:"outline"},tt(h)?h:{default:()=>[h]})}},{title:"分数",colKey:"score"},{title:"时间",colKey:"time"},{title:"内存",colKey:"memory"},{title:"代码",colKey:"language",cell:(c,S)=>a("span",null,[S.row.language+" / "+S.row.codeLength])},{title:"作者",colKey:"author",width:200,cell:(c,S)=>a(K,{variant:"text",onClick:()=>T(S.row.authorUsername)},{default:()=>[S.row.authorNickname]})},{title:"提交时间",colKey:"approveTime",width:180}]),V=d(!1),E=d(!1),$=d(),G=be(()=>s.hasAuth(ye.ManageJudge)),P=async()=>{if(!E.value){E.value=!0;try{const c=await gn(C);c.code===0?await y(!0):H(l,c.code)}catch(c){console.error(c),H(l,we())}finally{E.value=!1}}},I=c=>{c&&o.push({path:"/problem/"+c})},T=c=>{c&&o.push({path:"/user/"+c})},i=c=>{const S=c.status,v=Ue(S);let _;switch(S){case Y.Init:case Y.Rejudge:case Y.Compiling:case Y.Running:_="default";break;case Y.Accept:_="success";break;case Y.PE:_="warning";break;default:_="danger";break}return a(de,null,{default:()=>[a(K,{theme:"default",variant:"outline"},{default:()=>[c.taskId]}),a(K,{theme:_,variant:"outline"},tt(v)?v:{default:()=>[v]}),a("span",null,[k("分数："),c.score]),a("span",null,[k("用时："),c.time]),a("span",null,[k("内存："),c.memory])]})},y=async c=>{var v;c&&(V.value=!0);let S=!1;try{const _=await Lt(C);if($.value=[],_.code===0){const g=_.data,h=St(g);(v=$.value)==null||v.push(h),L.value.to="#00A870",Te(g.status)?(f.value="active",h.taskTotal>0?(p.value=h.taskCurrent/h.taskTotal*100,h.taskCurrent>=h.taskTotal&&(p.value=99)):p.value=0):(p.value=100,g.status===Y.Accept?f.value="success":g.status===Y.PE?(L.value.to="#F57C20",f.value="warning"):(L.value.to="#F56C6C",f.value="error"));const R={};if(g.code){const A=`\`\`\`${Qe(g.language)}
${g.code}
\`\`\``;m.value=await ae.md2html(A,R),await ge(()=>{r.value&&(w||(w=!0,ae.highlightRender({lineNumber:!0,enable:!0},r.value)),Ie(r.value))})}x.value=h,Te(g.status)&&(S=!0)}else c&&H(l,_.code)}catch(_){console.error(_),c&&H(l,we())}finally{c&&(V.value=!1),S&&u&&setTimeout(()=>{y(!1)},5e3)}};return te(async()=>{if(u=!0,t.params.judgeId&&t.params.judgeId.length===1)C=parseInt(t.params.judgeId[0]);else{await o.push({name:"judge"});return}await y(!0)}),ke(()=>{u=!1}),(c,S)=>{var A,F;const v=ta,_=Le,g=se,h=mt,R=pt,U=K;return z(),X(Z,null,[a(v,{color:L.value,status:f.value,class:"dida-job-progress",percentage:p.value},null,8,["color","status","percentage"]),a(g,{style:{margin:"10px"}},{default:n(()=>[a(_,{data:$.value,columns:j.value,"row-key":"id","vertical-align":"top",hover:!0,loading:V.value},null,8,["data","columns","loading"])]),_:1}),D("div",{innerHTML:m.value,ref_key:"markdownCodeRef",ref:r},null,8,Un),(A=x.value)!=null&&A.compileMessage?(z(),O(g,{key:0,class:"compile-message"},{default:n(()=>{var q;return[k(M((q=x.value)==null?void 0:q.compileMessage),1)]}),_:1})):ce("",!0),((F=x.value)==null?void 0:F.task.length)>0?(z(),O(R,{key:1,class:"task-panel"},{default:n(()=>{var q;return[(z(!0),X(Z,null,ue((q=x.value)==null?void 0:q.task,b=>(z(),O(h,{key:b.taskId,header:()=>i(b)},{default:n(()=>[k(M(b.content)+" "+M(b.waHint),1)]),_:2},1032,["header"]))),128))]}),_:1})):ce("",!0),G.value?(z(),X("div",Hn,[a(U,{onClick:P,loading:E.value},{default:n(()=>S[0]||(S[0]=[k("重新评测")])),_:1},8,["loading"])])):ce("",!0)],64)}}}),Kn=J(Nn,[["__scopeId","data-v-9b3735e5"]]);function On(e){let t="";for(e++;e>0;)e--,t=String.fromCharCode(65+e%26)+t,e=Math.floor(e/26);return t}async function It(e){const t={};if(t.id=e.id,t.ownerId=e.owner_id,t.ownerUsername=e.owner_username,t.ownerNickname=e.owner_nickname,t.title=e.title,t.startTime=new Date(e.start_time).toLocaleString(),t.endTime=new Date(e.end_time).toLocaleString(),e.descriptions){t.descriptions=[];const o={math:{inlineDigit:!0,engine:"KaTeX"}};for(let s=0;s<e.descriptions.length;s++){const l=e.descriptions[s],u={};u.title=l.title,u.content=await ae.md2html(l.content,o),u.sort=l.sort,t.descriptions.push(u)}}if(t.notification=e.notification,e.problems){t.problems=[],e.problems.sort((o,s)=>o.sort-s.sort);for(let o=0;o<e.problems.length;o++){const s=e.problems[o];s.accept||(s.accept=0),s.attempt||(s.attempt=0),s.id=On(o),t.problems.push(s)}}return t}function Fn(e){return W({url:"/contest?id="+e,method:"get"})}function Gn(e,t){return W({url:"/contest/list?page="+e+"&page_size="+t,method:"get"})}function Bn(e){return W({url:"/contest/create",method:"post",data:e})}const Xn={style:{margin:"10px"}},Wn=Q({__name:"ContestList",setup(e){const t=le(),o=ze(),{globalProperties:s}=oe();let l=null;const u=d(!1),C=d(!1),x=d([{title:"ID",colKey:"id",width:"100",cell:(T,i)=>a(K,{variant:"text",onClick:()=>V(i.row.id)},{default:()=>[i.row.id]})},{title:"标题",colKey:"title",cell:(T,i)=>a(K,{variant:"text",onClick:()=>V(i.row.id)},{default:()=>[i.row.title]})},{title:"负责人",colKey:"ownerNickname",width:"200"},{title:"开始时间",colKey:"startTime",width:"180"},{title:"结束时间",colKey:"endTime",width:"180"}]),m=d(!1);let r=1,p=50;const f=d({defaultPageSize:p,defaultCurrent:r,total:0,pageSizeOptions:[50,100]}),L=d(),w=d({title:"",username:""}),j=d({title:"",description:"",open_time:[]}),V=T=>{T&&o.push({path:"/contest/"+T})},E=async()=>{await o.push({query:{...t.query,title:w.value.title,username:w.value.username,page:1,page_size:f.value.defaultPageSize}})},$=async(T,i)=>{var y;m.value=!0;try{const{current:c,pageSize:S}=T,v=await Gn(c,S);if(L.value=[],v.code===0){const _=v.data.list;for(let g=0;g<_.length;g++){const h=_[g],R=await It(h);(y=L.value)==null||y.push(R)}f.value={...f.value,total:v.data.total_count}}else i&&H(s,v.code)}catch(c){console.error(c),H(s,we())}finally{m.value=!1}},G=async T=>{await o.push({query:{...t.query,page:T.current,page_size:T.pageSize}})},P=()=>{u.value=!0},I=async()=>{C.value=!0,console.log("contestCreateForm",j.value),Bn(j.value).then(T=>{T.code===0?(re(s,"创建比赛成功"),u.value=!1,o.push({path:"/contest/"+T.data.id})):H(s,T.code)}).finally(()=>{C.value=!1})};return te(async()=>{l=Ve(()=>t.query,T=>{w.value.title=T.title||"",w.value.username=T.username||"";const i=parseInt(T.page)||f.value.defaultCurrent,y=parseInt(T.page_size)||f.value.defaultPageSize;r=i,p=y,f.value={...f.value,current:r,pageSize:p},$({current:r,pageSize:p},!0)},{immediate:!0})}),ke(()=>{l&&l()}),(T,i)=>{const y=Le,c=se,S=_e,v=ve,_=Se,g=K,h=Ce,R=de,U=fe,A=ft,F=Ye;return z(),X(Z,null,[a(U,null,{default:n(()=>[a(S,{span:9},{default:n(()=>[a(c,{style:{margin:"10px"}},{default:n(()=>[a(y,{data:L.value,columns:x.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:f.value,loading:m.value,onPageChange:G},null,8,["data","columns","pagination","loading"])]),_:1})]),_:1}),a(S,{span:3},{default:n(()=>[D("div",Xn,[a(c,{class:"sh-card"},{default:n(()=>[a(h,{model:w.value},{default:n(()=>[a(_,{label:"标题"},{default:n(()=>[a(v,{modelValue:w.value.title,"onUpdate:modelValue":i[0]||(i[0]=q=>w.value.title=q),placeholder:"暂不支持模糊查询"},null,8,["modelValue"])]),_:1}),a(_,{label:"负责人"},{default:n(()=>[a(v,{modelValue:w.value.username,"onUpdate:modelValue":i[1]||(i[1]=q=>w.value.username=q),placeholder:"仅支持输入完整用户名"},null,8,["modelValue"])]),_:1}),a(_,null,{default:n(()=>[a(g,{theme:"primary",onClick:E},{default:n(()=>i[6]||(i[6]=[k("提交")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(c,{class:"sh-card"},{default:n(()=>[a(R,null,{default:n(()=>[a(g,{onClick:P},{default:n(()=>i[7]||(i[7]=[k("创建")])),_:1})]),_:1})]),_:1})])]),_:1})]),_:1}),a(F,{visible:u.value,"onUpdate:visible":i[5]||(i[5]=q=>u.value=q),header:"创建比赛",onConfirm:I,"confirm-loading":C.value},{default:n(()=>[a(h,{"label-width":80,model:j.value,onSubmit:i[4]||(i[4]=je(()=>{},["prevent"]))},{default:n(()=>[a(_,{label:"标题"},{default:n(()=>[a(v,{modelValue:j.value.title,"onUpdate:modelValue":i[2]||(i[2]=q=>j.value.title=q),placeholder:"请输入标题"},null,8,["modelValue"])]),_:1}),a(_,{label:"开启时间"},{default:n(()=>[a(A,{"enable-time-picker":"","allow-input":"",clearable:"",modelValue:j.value.open_time,"onUpdate:modelValue":i[3]||(i[3]=q=>j.value.open_time=q)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","confirm-loading"])],64)}}}),he=J(Wn,[["__scopeId","data-v-98695ddd"]]),Jn=["innerHTML"],Yn={style:{margin:"12px"}},Zn=Q({__name:"ContestDetail",setup(e){let t=le();const{globalProperties:o}=oe(),s=d(""),l=d(!1),u=d(null),C=d([{title:"ID",colKey:"id",cell:(m,r)=>a(K,{variant:"text"},{default:()=>[r.row.id]})},{title:"标题",colKey:"title",cell:(m,r)=>a(K,{variant:"text"},{default:()=>[r.row.title]})},{title:"正确",colKey:"accept"},{title:"提交",colKey:"attempt"}]),x=d([]);return te(async()=>{if(t.params.contestId&&t.params.contestId.length===1)s.value=t.params.contestId[0];else{await B.push({name:"contest"});return}l.value=!0;const m=await Fn(s.value);if(m.code!==0){l.value=!1,H(o,m.code),await B.push({name:"contest"});return}u.value=await It(m.data),x.value=u.value.problems,await ge(()=>{const r=document.querySelectorAll(".dida-content-description");r&&r.length>0&&r.forEach(p=>{ae.mathRender(p),ae.highlightRender({lineNumber:!0,enable:!0},p),Ie(p)}),l.value=!1})}),(m,r)=>{const p=aa,f=K,L=de,w=mt,j=pt,V=Le,E=se,$=_e,G=De,P=$e,I=fe,T=pe;return z(),O(T,{loading:l.value},{default:n(()=>[a(I,{class:"dida-main-content"},{default:n(()=>[a($,{span:8},{default:n(()=>{var i,y,c;return[D("h1",null,M((i=u.value)==null?void 0:i.title),1),(y=u.value)!=null&&y.notification?(z(),O(p,{key:0,theme:"info",message:(c=u.value)==null?void 0:c.notification},null,8,["message"])):ce("",!0),a(j,{"default-value":[0],"expand-icon":!1,borderless:!0},{default:n(()=>{var S;return[(z(!0),X(Z,null,ue((S=u.value)==null?void 0:S.descriptions,(v,_)=>(z(),O(w,{key:_,header:v.title},Ge({default:n(()=>[D("div",{innerHTML:v.content,class:"dida-content-description"},null,8,Jn)]),_:2},[_===0?{name:"headerRightContent",fn:n(()=>[a(L,{size:"small"},{default:n(()=>[a(f,{size:"small"},{default:n(()=>r[0]||(r[0]=[k("收起全部")])),_:1}),a(f,{size:"small"},{default:n(()=>r[1]||(r[1]=[k("展开全部")])),_:1})]),_:1})]),key:"0"}:void 0]),1032,["header"]))),128))]}),_:1}),a(E,{style:{margin:"10px"}},{default:n(()=>[a(V,{data:x.value,columns:C.value,"row-key":"id","vertical-align":"top",hover:!0},null,8,["data","columns"])]),_:1})]}),_:1}),a($,{span:4},{default:n(()=>[D("div",Yn,[a(P,{layout:"vertical",bordered:!0},{default:n(()=>[a(G,{label:"开始时间"},{default:n(()=>{var i;return[k(M((i=u.value)==null?void 0:i.startTime),1)]}),_:1})]),_:1})])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),Qn=J(Zn,[["__scopeId","data-v-59bdedc1"]]);function Vt(e){const t={};return t.id=e.id,t.authorId=e.author_id,t.authorUsername=e.author_username,t.authorNickname=e.author_nickname,t.title=e.title,t.content=e.content,e.insert_time&&(t.insertTime=new Date(e.insert_time).toLocaleString()),e.modify_time&&(t.modifyTime=new Date(e.modify_time).toLocaleString()),e.update_time&&(t.updateTime=new Date(e.update_time).toLocaleString()),t}async function eo(e){const t={};if(t.id=e.id,t.authorId=e.author_id,t.authorUsername=e.author_username,t.authorNickname=e.author_nickname,t.content="",e.content){const o={math:{inlineDigit:!0,engine:"KaTeX"}};t.content=await ae.md2html(e.content,o)}return e.insert_time&&(t.insertTime=new Date(e.insert_time).toLocaleString()),e.modify_time&&(t.modifyTime=new Date(e.modify_time).toLocaleString()),e.update_time&&(t.updateTime=new Date(e.update_time).toLocaleString()),t}function to(e){return W({url:"/discuss?id="+e,method:"get"})}function ao(e,t){return W({url:"/discuss/list?page="+e+"&page_size="+t,method:"get"})}function no(e,t,o){return W({url:"/discuss/comment/list?id="+e+"&page="+t+"&page_size="+o,method:"get"})}function oo(e){return W({url:"/discuss/create",method:"post",data:e})}const lo={style:{margin:"10px"}},so=Q({__name:"DiscussList",setup(e){const t=le(),o=ze(),{globalProperties:s}=oe();let l=null;const u=d(!1),C=d(!1),x=d([{title:"ID",colKey:"id",width:"100",cell:(T,i)=>a(K,{variant:"text",onClick:()=>V(i.row.id)},{default:()=>[i.row.id]})},{title:"标题",colKey:"title",cell:(T,i)=>a(K,{variant:"text",onClick:()=>V(i.row.id)},{default:()=>[i.row.title]})},{title:"创建人",colKey:"authorNickname",width:"200"},{title:"创建时间",colKey:"insertTime",width:"180"},{title:"更新时间",colKey:"updateTime",width:"180"}]),m=d(!1);let r=1,p=50;const f=d({defaultPageSize:p,defaultCurrent:r,total:0,pageSizeOptions:[50,100]}),L=d(),w=d({title:"",username:""}),j=d({title:"",description:"",open_time:[]}),V=T=>{T&&o.push({path:"/discuss/"+T})},E=async()=>{await o.push({query:{...t.query,title:w.value.title,username:w.value.username,page:1,page_size:f.value.defaultPageSize}})},$=async(T,i)=>{var y;m.value=!0;try{const{current:c,pageSize:S}=T,v=await ao(c,S);if(L.value=[],v.code===0){const _=v.data.list;for(let g=0;g<_.length;g++){const h=_[g],R=await Vt(h);(y=L.value)==null||y.push(R)}f.value={...f.value,total:v.data.total_count}}else i&&H(s,v.code)}catch(c){console.error(c),H(s,we())}finally{m.value=!1}},G=async T=>{await o.push({query:{...t.query,page:T.current,page_size:T.pageSize}})},P=()=>{u.value=!0},I=async()=>{C.value=!0,console.log("discussCreateForm",j.value),oo(j.value).then(T=>{T.code===0?(re(s,"创建比赛成功"),u.value=!1,o.push({path:"/discuss/"+T.data.id})):H(s,T.code)}).finally(()=>{C.value=!1})};return te(async()=>{l=Ve(()=>t.query,T=>{w.value.title=T.title||"",w.value.username=T.username||"";const i=parseInt(T.page)||f.value.defaultCurrent,y=parseInt(T.page_size)||f.value.defaultPageSize;r=i,p=y,f.value={...f.value,current:r,pageSize:p},$({current:r,pageSize:p},!0)},{immediate:!0})}),ke(()=>{l&&l()}),(T,i)=>{const y=Le,c=se,S=_e,v=ve,_=Se,g=K,h=Ce,R=de,U=fe,A=ft,F=Ye;return z(),X(Z,null,[a(U,null,{default:n(()=>[a(S,{span:9},{default:n(()=>[a(c,{style:{margin:"10px"}},{default:n(()=>[a(y,{data:L.value,columns:x.value,"row-key":"id","vertical-align":"top",hover:!0,pagination:f.value,loading:m.value,onPageChange:G},null,8,["data","columns","pagination","loading"])]),_:1})]),_:1}),a(S,{span:3},{default:n(()=>[D("div",lo,[a(c,{class:"sh-card"},{default:n(()=>[a(h,{model:w.value},{default:n(()=>[a(_,{label:"标题"},{default:n(()=>[a(v,{modelValue:w.value.title,"onUpdate:modelValue":i[0]||(i[0]=q=>w.value.title=q),placeholder:"暂不支持模糊查询"},null,8,["modelValue"])]),_:1}),a(_,{label:"创建人"},{default:n(()=>[a(v,{modelValue:w.value.username,"onUpdate:modelValue":i[1]||(i[1]=q=>w.value.username=q),placeholder:"仅支持输入完整用户名"},null,8,["modelValue"])]),_:1}),a(_,null,{default:n(()=>[a(g,{theme:"primary",onClick:E},{default:n(()=>i[6]||(i[6]=[k("提交")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(c,{class:"sh-card"},{default:n(()=>[a(R,null,{default:n(()=>[a(g,{onClick:P},{default:n(()=>i[7]||(i[7]=[k("创建")])),_:1})]),_:1})]),_:1})])]),_:1})]),_:1}),a(F,{visible:u.value,"onUpdate:visible":i[5]||(i[5]=q=>u.value=q),header:"创建比赛",onConfirm:I,"confirm-loading":C.value},{default:n(()=>[a(h,{"label-width":80,model:j.value,onSubmit:i[4]||(i[4]=je(()=>{},["prevent"]))},{default:n(()=>[a(_,{label:"标题"},{default:n(()=>[a(v,{modelValue:j.value.title,"onUpdate:modelValue":i[2]||(i[2]=q=>j.value.title=q),placeholder:"请输入标题"},null,8,["modelValue"])]),_:1}),a(_,{label:"开启时间"},{default:n(()=>[a(A,{"enable-time-picker":"","allow-input":"",clearable:"",modelValue:j.value.open_time,"onUpdate:modelValue":i[3]||(i[3]=q=>j.value.open_time=q)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","confirm-loading"])],64)}}}),ro=J(so,[["__scopeId","data-v-39d9d4c3"]]),uo=["innerHTML"],io=["innerHTML"],co={style:{margin:"10px"}},mo={style:{margin:"12px"}},po={key:0,class:"dida-edit-container"},fo={class:"dida-operation-container"},_o=Q({__name:"DiscussDetail",setup(e){let t=le();const{globalProperties:o}=oe();let s=null;const l=xe(),u=me();let C=d("");const x=d(""),m=d(null),r=d(!1),p=d(null),f=d(!1);let L=1,w=20;const j=d({current:1,total:0,defaultPageSize:w,defaultCurrent:L,pageSizeOptions:[20,50]}),V=d([]),E={},$=be(()=>u.hasAuth(ye.ManageDiscuss)),G=c=>{c&&B.push({name:"discuss-list",query:{...t.query,title:"",tag:c.name}})},P=()=>{B.push({name:"manage-discuss",params:{discussId:x.value}})},I=()=>a("div",{class:"t-pagination__total"},[`共 ${j.value.total} 条回复`]),T=()=>{B.push({name:"discuss-recommend",params:{discussId:x.value}})},i=async(c,S)=>{var v;f.value=!0;try{const{current:_,pageSize:g}=c,h=await no(x.value,_,g);if(V.value=[],h.code===0){const R=h.data.list;if(R)for(let U=0;U<R.length;U++){const A=R[U],F=await eo(A);(v=V.value)==null||v.push(F),await ge(()=>{const q=document.querySelectorAll(".dida-discuss-content");q&&q.length>0&&q.forEach(b=>{ae.mathRender(b),ae.highlightRender({lineNumber:!0,enable:!0},b),Ie(b)})})}j.value={...j.value,total:h.data.total_count}}else S&&H(o,h.code)}catch(_){console.error(_),H(o,we())}finally{f.value=!1}},y=async c=>{await B.push({query:{...t.query,page:c.current,page_size:c.pageSize}})};return te(async()=>{if(Array.isArray(t.params.discussId)?x.value=t.params.discussId[0]:x.value=t.params.discussId,!x.value){ie(o,"题目不存在"),await B.push({name:"discuss"});return}r.value=!0;const c=await to(x.value);if(c.code!==0){r.value=!1,H(o,c.code),await B.push({name:"discuss"});return}c.data.tags&&c.data.tags.forEach(_=>{E[_.id]=_}),p.value=Vt(c.data.discuss),l.setTitle(p.value.title+" - "+l.getTitle);let S=p.value.content;const v={math:{inlineDigit:!0,engine:"KaTeX"}};C.value=await ae.md2html(S,v),await ge(()=>{m.value&&(ae.mathRender(m.value),ae.highlightRender({lineNumber:!0,enable:!0},m.value),Ie(m.value)),r.value=!1}),s=Ve(()=>t.query,_=>{const g=parseInt(_.page)||j.value.defaultCurrent,h=parseInt(_.page_size)||j.value.defaultPageSize;L=g,w=h,j.value={...j.value,current:L,pageSize:w},i({current:L,pageSize:w},!0)},{immediate:!0})}),ke(()=>{s&&s()}),(c,S)=>{const v=se,_=de,g=na,h=_e,R=K,U=De,A=$e,F=fe,q=pe;return z(),O(q,{loading:r.value},{default:n(()=>[a(F,{class:"dida-main-content"},{default:n(()=>[a(h,{span:8},{default:n(()=>{var b;return[a(v,{style:{margin:"10px"},header:(b=p.value)==null?void 0:b.title},{default:n(()=>[D("div",{innerHTML:ne(C),class:"dida-discuss-content"},null,8,uo)]),_:1},8,["header"]),(z(!0),X(Z,null,ue(V.value,(N,Pe)=>(z(),O(v,{key:Pe,style:{margin:"10px"},"header-bordered":""},{header:n(()=>[a(_,null,{default:n(()=>[D("span",null,M(N.authorNickname),1),D("span",null,M(N.insertTime),1)]),_:2},1024)]),default:n(()=>[D("div",{innerHTML:N.content,class:"dida-discuss-content"},null,8,io)]),_:2},1024))),128)),D("div",co,[a(g,{modelValue:j.value.current,"onUpdate:modelValue":S[0]||(S[0]=N=>j.value.current=N),"page-size":j.value.pageSize,"onUpdate:pageSize":S[1]||(S[1]=N=>j.value.pageSize=N),total:j.value.total,"page-size-options":j.value.pageSizeOptions,"show-page-size":!1,"total-content":I,onChange:y},null,8,["modelValue","page-size","total","page-size-options"])])]}),_:1}),a(h,{span:4},{default:n(()=>[D("div",mo,[$.value?(z(),X("div",po,[a(R,{onClick:P},{default:n(()=>S[2]||(S[2]=[k("编辑")])),_:1})])):ce("",!0),a(A,{layout:"vertical",bordered:!0},{default:n(()=>[a(U,{label:"创建时间"},{default:n(()=>{var b;return[k(M((b=p.value)==null?void 0:b.insertTime),1)]}),_:1}),a(U,{label:"编辑时间"},{default:n(()=>{var b;return[k(M((b=p.value)==null?void 0:b.modifyTime),1)]}),_:1}),a(U,{label:"更新时间"},{default:n(()=>{var b;return[k(M((b=p.value)==null?void 0:b.updateTime),1)]}),_:1}),a(U,{label:"创建用户"},{default:n(()=>{var b;return[k(M((b=p.value)==null?void 0:b.authorNickname),1)]}),_:1}),a(U,{label:"标签"},{default:n(()=>[a(_,null,{default:n(()=>{var b;return[(z(!0),X(Z,null,ue((b=p.value)==null?void 0:b.tags,N=>(z(),O(R,{key:N.id,variant:"dashed",onClick:()=>G(N)},{default:n(()=>[k(M(N.name),1)]),_:2},1032,["onClick"]))),128))]}),_:1})]),_:1})]),_:1}),D("div",fo,[a(_,null,{default:n(()=>[a(R,{onClick:T},{default:n(()=>S[3]||(S[3]=[k("临时按钮")])),_:1})]),_:1})])])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),go=J(_o,[["__scopeId","data-v-a3165c80"]]),vo=Q({__name:"ManageJudge",setup(e){const{globalProperties:t}=oe(),o=d(""),s=d(!1),l=d(!1),u=async()=>{try{const m=await pn();if(m.code!==0){H(t,m.code);return}re(t,"重判成功"),await B.push({name:"judge-list"})}catch(m){console.error(m),H(t,"重判失败")}},C=async()=>{if(o.value===""){H(t,"请输入问题Id");return}s.value=!0;try{const m=await fn(o.value);if(m.code!==0){H(t,m.code);return}re(t,"重判成功"),await B.push({name:"judge-list",query:{problem_id:o.value}})}catch(m){console.error(m),H(t,"重判失败")}finally{s.value=!1}},x=async()=>{l.value=!0;try{const m=await _n();if(m.code!==0){H(t,m.code);return}re(t,"重判成功"),await B.push({name:"judge-list"})}catch(m){console.error(m),H(t,"重判失败")}finally{l.value=!1}};return(m,r)=>{const p=K,f=se,L=ve,w=de;return z(),X(Z,null,[a(f,{class:"yj-manage-card",title:"重判最近提交"},{default:n(()=>[a(p,{onClick:u},{default:n(()=>r[1]||(r[1]=[k("重判")])),_:1})]),_:1}),a(f,{class:"yj-manage-card",title:"重判问题"},{default:n(()=>[a(w,null,{default:n(()=>[a(L,{modelValue:o.value,"onUpdate:modelValue":r[0]||(r[0]=j=>o.value=j),placeholder:"输入问题Id"},null,8,["modelValue"]),a(p,{onClick:C,loading:s.value},{default:n(()=>r[2]||(r[2]=[k("重判")])),_:1},8,["loading"])]),_:1})]),_:1}),a(f,{class:"yj-manage-card",title:"重判所有"},{default:n(()=>[a(p,{onClick:x,theme:"danger",loading:l.value},{default:n(()=>r[3]||(r[3]=[k("重判")])),_:1},8,["loading"])]),_:1})],64)}}}),ho=J(vo,[["__scopeId","data-v-60a14d44"]]),bo={style:{margin:"10px"}},yo={key:1},wo={style:{margin:"12px"}},ko={class:"dida-edit-container"},Co=Q({__name:"ProblemEdit",setup(e){let t=le();const{globalProperties:o}=oe(),s=xe(),l=d(""),u=d(!1);let C=null;const x=d(!1),m=d(null),r=d({title:"",timeLimit:0,memoryLimit:0,source:"",tags:[]}),p=d([]),f=d([]),L=be(()=>{const P=[],I=p.value;for(let T=0,i=I.length;T<i;T++)I[T].value&&P.push(I[T].value);return P}),w=(P,I)=>{const{trigger:T,index:i,item:y}=I;if(T==="clear"&&(p.value=[]),["tag-remove","backspace"].includes(T)&&p.value.splice(i,1),T==="enter"){for(let S=0;S<f.value.length;S++){const v=f.value[S];if(v.label===y){for(let _=0;_<p.value.length;_++)if(p.value[_].label===v.label)return;p.value.push(v);return}}const c={label:y,value:y};p.value.push(c),f.value=f.value.concat(c)}},j=(P,{current:I,type:T})=>{if(!I){p.value=T==="check"?f.value.slice(1):[];return}if(T==="check"){const i=f.value.find(y=>y.value===I);if(!i)return;p.value.push(i)}else p.value=p.value.filter(i=>i.value!==I)},V=()=>{B.push({name:"problem-detail",params:{problemId:l.value}})},E=()=>{B.push({name:"manage-problem-judge",params:{problemId:l.value}})},$=async()=>{if(C){x.value=!0,r.value.tags=[];for(let P=0;P<p.value.length;P++){const I=p.value[P];I&&I.label&&r.value.tags.push(I.label)}try{const P=await bn(l.value,r.value.title,r.value.timeLimit,r.value.memoryLimit,r.value.source,r.value.tags,C.getValue());if(x.value=!0,P.code!==0){H(o,P.code);return}P.data!=null&&(m.value.updateTime=new Date(P.data).toLocaleString()),ht(o,"保存成功")}finally{x.value=!1}}},G=async()=>{const P=await Pt(l.value);if(P.code!==0){H(o,P.code),console.error("problem get failed",P.code),await B.push({name:"problem"});return}const I=P.data.problem;if(m.value=Ke(I,{}),r.value.title=I.title,r.value.timeLimit=I.time_limit,r.value.memoryLimit=I.memory_limit,r.value.source=I.source,r.value.tags=[],p.value=[],P.data.tags)for(let y=0;y<P.data.tags.length;y++){const c=P.data.tags[y];c&&c.name&&(r.value.tags.push(c.name),p.value.push({label:c.name,value:c.id}))}s.setTitle(I.title+" - "+s.getTitle);let T=I.description;const i={after:()=>{C==null||C.setValue(T)}};C=new ae("codeEditRef",i),u.value=!1};return te(async()=>{if(Array.isArray(t.params.problemId)?l.value=t.params.problemId[0]:l.value=t.params.problemId,!l.value){ie(o,"题目不存在"),await B.push({name:"problem"});return}u.value=!0,Tt(-1).then(async P=>{P.code===0?(P.data.list&&P.data.list.forEach(I=>{f.value.push({label:I.name,value:I.id})}),await G()):(H(o,P.code),console.error("problem tag get failed",P.code),await B.push({name:"problem"}))}).catch(async P=>{console.error(P),H(o,"获取数据异常"),await B.push({name:"problem"})})}),(P,I)=>{const T=ve,i=Se,y=oa,c=sa,S=la,v=Ce,_=se,g=_e,h=K,R=de,U=De,A=$e,F=fe,q=pe;return z(),O(q,{loading:u.value},{default:n(()=>[a(F,null,{default:n(()=>[a(g,{span:8},{default:n(()=>[D("div",bo,[a(_,{class:"sh-card"},{default:n(()=>[a(v,{model:r.value},{default:n(()=>[a(i,{label:"标题"},{default:n(()=>[a(T,{modelValue:r.value.title,"onUpdate:modelValue":I[0]||(I[0]=b=>r.value.title=b),placeholder:"问题标题"},null,8,["modelValue"])]),_:1}),a(i,{label:"时间限制"},{default:n(()=>[a(y,{modelValue:r.value.timeLimit,"onUpdate:modelValue":I[1]||(I[1]=b=>r.value.timeLimit=b),theme:"normal",min:0},{suffix:n(()=>I[4]||(I[4]=[D("span",null,"ms",-1)])),_:1},8,["modelValue"])]),_:1}),a(i,{label:"内存限制"},{default:n(()=>[a(y,{modelValue:r.value.memoryLimit,"onUpdate:modelValue":I[2]||(I[2]=b=>r.value.memoryLimit=b),theme:"normal",min:0},{suffix:n(()=>I[5]||(I[5]=[D("span",null,"KB",-1)])),_:1},8,["modelValue"])]),_:1}),a(i,{label:"来源"},{default:n(()=>[a(T,{modelValue:r.value.source,"onUpdate:modelValue":I[3]||(I[3]=b=>r.value.source=b),placeholder:"请输入题目来源"},null,8,["modelValue"])]),_:1}),a(i,{label:"标签"},{default:n(()=>[a(S,{value:p.value,"allow-input":!0,placeholder:"请选择或输入","tag-input-props":{excessTagsDisplayType:"break-line"},"popup-props":{overlayInnerClassName:["narrow-scrollbar"],overlayInnerStyle:{maxHeight:"280px",overflowY:"auto",overscrollBehavior:"contain",padding:"6px"}},clearable:"",multiple:"",onTagChange:w},{panel:n(()=>[f.value.length?(z(),O(c,{key:0,value:L.value,options:f.value,onChange:j},null,8,["value","options"])):(z(),X("div",yo,"暂无数据"))]),suffixIcon:n(()=>[a(ne(qt))]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1})])]),_:1}),a(g,{span:4},{default:n(()=>[D("div",wo,[D("div",ko,[a(R,null,{default:n(()=>[a(h,{onClick:$,theme:"danger",loading:x.value},{default:n(()=>I[6]||(I[6]=[k("保存")])),_:1},8,["loading"]),a(h,{onClick:E,theme:"warning"},{default:n(()=>I[7]||(I[7]=[k("判题数据")])),_:1}),a(h,{onClick:V},{default:n(()=>I[8]||(I[8]=[k("查看")])),_:1})]),_:1})]),a(A,{layout:"vertical",bordered:!0},{default:n(()=>[a(U,{label:"创建时间"},{default:n(()=>{var b;return[k(M((b=m.value)==null?void 0:b.insertTime),1)]}),_:1}),a(U,{label:"更新时间"},{default:n(()=>{var b;return[k(M((b=m.value)==null?void 0:b.updateTime),1)]}),_:1}),a(U,{label:"判题方式"},{default:n(()=>{var b;return[k(M((b=m.value)==null?void 0:b.judgeType),1)]}),_:1}),a(U,{label:"上传用户"},{default:n(()=>{var b;return[k(M((b=m.value)==null?void 0:b.creatorNickname),1)]}),_:1})]),_:1})])]),_:1})]),_:1}),I[9]||(I[9]=D("div",{id:"codeEditRef",class:"dida-description-editor"},null,-1))]),_:1},8,["loading"])}}}),So=J(Co,[["__scopeId","data-v-b8d494d1"]]),Lo={style:{margin:"10px"}},Po={style:{margin:"12px"}},To={class:"dida-edit-container"},Io=Q({__name:"ProblemJudge",setup(e){let t=le();const{globalProperties:o}=oe(),s=xe(),l=d(""),u=d(!1),C=d(null);let x=null;const m=d(null),r=d(""),p=d(!1),f=d(!1),L=d([{title:"文件",colKey:"file"},{title:"大小",colKey:"size",width:150,cell:(v,_)=>_.row.size.toFixed(0)+" B"},{title:"最后修改时间",colKey:"lastModified",width:180,cell:(v,_)=>new Date(_.row.lastModified).toLocaleString()},{title:"操作",colKey:"action",width:100,cell:(v,_)=>a(K,{onClick:()=>G(_.row.file)},{default:()=>[k("下载")]})}]),w=d([]),j=be(()=>({border:"2px dashed #ccc",borderRadius:"6px",padding:"20px",textAlign:"center",cursor:"pointer",backgroundColor:p.value?"#f0f9ff":"#fff",transition:"background-color 0.2s ease"})),V=be(()=>r.value?`已选择：${r.value}`:p.value?"松开文件以上传":"拖拽文件到这里，或点击选择文件"),E=()=>{B.push({name:"problem-detail",params:{problemId:l.value}})},$=()=>{B.push({name:"manage-problem",params:{problemId:l.value}})},G=async v=>{const _=await yn(l.value,v);if(_.code!==0){H(o,_.code);return}const g=document.createElement("a");g.href=_.data,g.target="_blank",g.click(),URL.revokeObjectURL(g.href)},P=async()=>{if(!x){ie(o,"请选择压缩包");return}f.value=!0,wn(l.value,x).then(async v=>{v.code==0?(m.value.value=null,x=null,r.value="",u.value=!0,ht(o,"上传成功"),await S()):H(o,v.code)}).catch(v=>{console.log(v),o.$message.error({duration:3e3,content:"申请失败"})}).finally(()=>{f.value=!1})},I=()=>{var v;(v=m.value)==null||v.click()},T=v=>{const _=v.target.files[0];_&&(r.value=_.name,x=_)},i=v=>{p.value=!0},y=()=>{p.value=!1},c=v=>{v.preventDefault(),v.stopPropagation(),p.value=!1;const _=v.dataTransfer.files[0];if(_){r.value=_.name;const g=new DataTransfer;g.items.add(_),m.value.files=g.files,x=_}},S=async()=>{const v=await vn(l.value);if(v.code!==0){H(o,v.code),await B.push({name:"problem"});return}const _=v.data.problem;C.value=Ke(_,{}),s.setTitle(_.title+" - "+s.getTitle),w.value=[],v.data.judges?v.data.judges.forEach(g=>{w.value.push({file:g.key,size:g.size,lastModified:g.last_modified})}):ie(o,"评测数据不存在"),u.value=!1};return te(async()=>{if(Array.isArray(t.params.problemId)?l.value=t.params.problemId[0]:l.value=t.params.problemId,!l.value){ie(o,"题目不存在"),await B.push({name:"problem"});return}u.value=!0,await S()}),(v,_)=>{const g=Le,h=_e,R=K,U=de,A=De,F=$e,q=fe,b=pe;return z(),O(b,{loading:u.value},{default:n(()=>[a(q,null,{default:n(()=>[a(h,{span:7},{default:n(()=>[D("div",Lo,[D("div",{id:"drop-zone",style:st(j.value),onClick:I,onDragenter:je(i,["prevent"]),onDragover:_[0]||(_[0]=je(()=>{},["prevent"])),onDragleave:je(y,["prevent"]),onDrop:c},[D("input",{ref_key:"fileInput",ref:m,type:"file",style:{display:"none"},onChange:T},null,544),k(" "+M(V.value),1)],36)]),a(g,{data:w.value,columns:L.value,"row-key":"id","vertical-align":"top",hover:!0},null,8,["data","columns"])]),_:1}),a(h,{span:5},{default:n(()=>[D("div",Po,[D("div",To,[a(U,null,{default:n(()=>[a(R,{onClick:P,theme:"danger",loading:f.value},{default:n(()=>_[1]||(_[1]=[k("上传")])),_:1},8,["loading"]),a(R,{onClick:$,theme:"warning"},{default:n(()=>_[2]||(_[2]=[k("编辑")])),_:1}),a(R,{onClick:E},{default:n(()=>_[3]||(_[3]=[k("查看")])),_:1})]),_:1})]),a(F,{layout:"vertical",bordered:!0},{default:n(()=>[a(A,{label:"标题"},{default:n(()=>{var N;return[k(M((N=C.value)==null?void 0:N.title),1)]}),_:1}),a(A,{label:"创建时间"},{default:n(()=>{var N;return[k(M((N=C.value)==null?void 0:N.insertTime),1)]}),_:1}),a(A,{label:"更新时间"},{default:n(()=>{var N;return[k(M((N=C.value)==null?void 0:N.updateTime),1)]}),_:1}),a(A,{label:"判题方式"},{default:n(()=>{var N;return[k(M((N=C.value)==null?void 0:N.judgeType),1)]}),_:1}),a(A,{label:"评测数据"},{default:n(()=>{var N;return[k(M((N=C.value)==null?void 0:N.judgeMd5),1)]}),_:1}),a(A,{label:"上传用户"},{default:n(()=>{var N;return[k(M((N=C.value)==null?void 0:N.creatorNickname),1)]}),_:1})]),_:1})])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),Vo=J(Io,[["__scopeId","data-v-17986e38"]]),xt=[{name:"problem-list",tab:"problem",sidebar:"problem-list",path:"",title:"问题列表",icon:"cpu",component:Ln},{name:"problem-detail",tab:"problem",sidebar:"problem-list",path:":problemId+",title:"问题详情",icon:"cpu",component:zn},{name:"problem-recommend",tab:"problem",sidebar:"problem-recommend",path:"recommend/:problemId*",title:"问题推荐",icon:"cpu",component:Rn},{name:"judge-list",tab:"judge",sidebar:"judge-list",path:"",title:"评测列表",icon:"cpu",component:qn},{name:"judge-detail",tab:"judge",sidebar:"judge-list",path:":judgeId+",title:"评测详情",icon:"cpu",component:Kn},{name:"contest-list",tab:"contest",sidebar:"contest-list",path:"",title:"比赛列表",icon:"cpu",component:he},{name:"contest-recent",tab:"contest",sidebar:"contest-recent",path:"recent",title:"近期比赛",icon:"cpu",component:he},{name:"contest-detail",tab:"contest-detail",sidebar:"contest-detail",path:":contestId+",title:"比赛详情",icon:"cpu",component:Qn},{name:"contest-problem",tab:"contest-detail",sidebar:"contest-problem",path:":contestId+/problem",title:"问题列表",icon:"cpu",component:he},{name:"contest-judge",tab:"contest-detail",sidebar:"contest-judge",path:":contestId+/judge",title:"评测列表",icon:"cpu",component:he},{name:"contest-rank",tab:"contest-detail",sidebar:"contest-rank",path:":contestId+/rank",title:"比赛排名",icon:"cpu",component:he},{name:"contest-statistics",tab:"contest-detail",sidebar:"contest-statistics",path:":contestId+/statistics",title:"结果统计",icon:"cpu",component:he},{name:"contest-discuss",tab:"contest-detail",sidebar:"contest-discuss",path:":contestId+/discuss",title:"比赛讨论",icon:"cpu",component:he},{name:"discuss-list",tab:"discuss",sidebar:"discuss-list",path:"",title:"讨论列表",icon:"cpu",component:ro},{name:"discuss-detail",tab:"discuss",sidebar:"discuss-list",path:":discussId+",title:"讨论详情",icon:"cpu",component:go},{name:"manage-problem",tab:"manage",sidebar:"manage-problem",disableSidebar:!0,path:"problem/:problemId+",title:"问题编辑",icon:"cpu",component:So,auths:[ye.ManageProblem]},{name:"manage-problem-judge",tab:"manage",sidebar:"manage-problem-judge",disableSidebar:!0,path:"problem/:problemId+/judge",title:"评测数据",icon:"cpu",component:Vo,auths:[ye.ManageProblem]},{name:"manage-judge",tab:"manage",path:"judge",sidebar:"manage-judge",title:"评测管理",icon:"cpu",auths:["i-manage-judge"],component:ho}],at=(e,t,o,s)=>{s.tab==o&&(s.disableSidebar&&t!=s.sidebar||s.sidebar==null||s.sidebar!=s.name||e.push({name:s.name,title:s.title,icon:s.icon,to:{name:s.name}}))},xo=(e,t)=>{const o=[];return xt.forEach(s=>{if(bt(s)){const l=[];s.children.forEach(u=>{at(l,e,t,u)}),l.length>0&&o.push({title:s.title,children:l})}else at(o,e,t,s)}),o},nt=(e,t)=>{const o=$a(t.tab),s={name:t.name,path:"/"+t.path,meta:{title:t.title+" - "+o.title,tab:t.tab,sidebar:t.sidebar,showSidebar:o.showSidebar,needLogin:o.needLogin||t.needLogin,tabAuths:o.auths,auths:t.auths},component:t.component};o.disablePath||(s.path=o.path+s.path),e.push(s)},jo=e=>{xt.forEach(t=>{bt(t)?t.children.forEach(o=>{nt(e,o)}):nt(e,t)})},Re=[];Ra(Re);jo(Re);Re.push({path:"/403",name:"403",component:yt});Re.push({path:"/:pathMatch(.*)*",name:"404",component:vt});const B=Ut({history:Ht("/"),routes:Re});B.beforeEach((e,t,o)=>{if(e.name==null||!B.hasRoute(e.name)){o({name:"home"});return}const s=e.matched[e.matched.length-1].meta;if(s.redirect){o({name:s.redirect});return}if(s.needLogin){const u=me();if(u.getToken==null||u.getToken==""){o({name:"login",query:{redirect_uri:e.fullPath}});return}}const l=s.tabAuths;if(l&&!me().hasAllAuths(l)){o({name:"403",query:{target:e.fullPath}});return}o()});B.afterEach((e,t)=>{if(e.name===t.name)return;const o=Ne(),s=xe();let l=null;if(e.matched.length>0&&(l=e.matched[e.matched.length-1].meta),l!=null&&l.title&&s.setTitle(l==null?void 0:l.title),l!=null&&l.showSidebar){o.setSidebarShow(!0);const u=xo(l==null?void 0:l.sidebar,l==null?void 0:l.tab);o.setMenuList(u),o.setMenuActiveName(l==null?void 0:l.sidebar)}else o.setSidebarShow(!1)});ua.registerLanguage("verilog",ia);const jt=Nt();jt.use(Kt);const Ee=Ot(sn);Ee.use(jt);Ee.use(B);Ee.use(ra);Ee.use(Ft);Ee.mount("#app");wa().then(()=>{console.log("Text cache reinitialized")}).catch(e=>{console.error("Text cache reinitialization failed",e)});
